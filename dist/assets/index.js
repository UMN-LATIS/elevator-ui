(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))f(y);new MutationObserver(y=>{for(const v of y)if(v.type==="childList")for(const w of v.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&f(w)}).observe(document,{childList:!0,subtree:!0});function c(y){const v={};return y.integrity&&(v.integrity=y.integrity),y.referrerpolicy&&(v.referrerPolicy=y.referrerpolicy),y.crossorigin==="use-credentials"?v.credentials="include":y.crossorigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function f(y){if(y.ep)return;y.ep=!0;const v=c(y);fetch(y.href,v)}})();function To(n,o){const c=Object.create(null),f=n.split(",");for(let y=0;y<f.length;y++)c[f[y]]=!0;return o?y=>!!c[y.toLowerCase()]:y=>!!c[y]}const Gb="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Wb=To(Gb);function My(n){return!!n||n===""}function If(n){if(qt(n)){const o={};for(let c=0;c<n.length;c++){const f=n[c],y=en(f)?Xb(f):If(f);if(y)for(const v in y)o[v]=y[v]}return o}else{if(en(n))return n;if(Li(n))return n}}const Zb=/;(?![^(]*\))/g,Hb=/:(.+)/;function Xb(n){const o={};return n.split(Zb).forEach(c=>{if(c){const f=c.split(Hb);f.length>1&&(o[f[0].trim()]=f[1].trim())}}),o}function ar(n){let o="";if(en(n))o=n;else if(qt(n))for(let c=0;c<n.length;c++){const f=ar(n[c]);f&&(o+=f+" ")}else if(Li(n))for(const c in n)n[c]&&(o+=c+" ");return o.trim()}const Kb="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",Jb="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",Yb=To(Kb),Qb=To(Jb),ii=n=>en(n)?n:n==null?"":qt(n)||Li(n)&&(n.toString===Ly||!Jt(n.toString))?JSON.stringify(n,zy,2):String(n),zy=(n,o)=>o&&o.__v_isRef?zy(n,o.value):ma(o)?{[`Map(${o.size})`]:[...o.entries()].reduce((c,[f,y])=>(c[`${f} =>`]=y,c),{})}:Ry(o)?{[`Set(${o.size})`]:[...o.values()]}:Li(o)&&!qt(o)&&!Oy(o)?String(o):o,Di=Object.freeze({}),pl=Object.freeze([]),mr=()=>{},Dy=()=>!1,e1=/^on[^a-z]/,tu=n=>e1.test(n),zh=n=>n.startsWith("onUpdate:"),an=Object.assign,Af=(n,o)=>{const c=n.indexOf(o);c>-1&&n.splice(c,1)},t1=Object.prototype.hasOwnProperty,mi=(n,o)=>t1.call(n,o),qt=Array.isArray,ma=n=>qh(n)==="[object Map]",Ry=n=>qh(n)==="[object Set]",Jt=n=>typeof n=="function",en=n=>typeof n=="string",Cf=n=>typeof n=="symbol",Li=n=>n!==null&&typeof n=="object",kf=n=>Li(n)&&Jt(n.then)&&Jt(n.catch),Ly=Object.prototype.toString,qh=n=>Ly.call(n),Pf=n=>qh(n).slice(8,-1),Oy=n=>qh(n)==="[object Object]",Mf=n=>en(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Th=To(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),i1=To("bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo"),Gh=n=>{const o=Object.create(null);return c=>o[c]||(o[c]=n(c))},n1=/-(\w)/g,ps=Gh(n=>n.replace(n1,(o,c)=>c?c.toUpperCase():"")),r1=/\B([A-Z])/g,vo=Gh(n=>n.replace(r1,"-$1").toLowerCase()),va=Gh(n=>n.charAt(0).toUpperCase()+n.slice(1)),ra=Gh(n=>n?`on${va(n)}`:""),qc=(n,o)=>!Object.is(n,o),Cc=(n,o)=>{for(let c=0;c<n.length;c++)n[c](o)},Dh=(n,o,c)=>{Object.defineProperty(n,o,{configurable:!0,enumerable:!1,value:c})},By=n=>{const o=parseFloat(n);return isNaN(o)?n:o};let Og;const Fy=()=>Og||(Og=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Rh(n,...o){console.warn(`[Vue warn] ${n}`,...o)}let Sr;class $y{constructor(o=!1){this.active=!0,this.effects=[],this.cleanups=[],!o&&Sr&&(this.parent=Sr,this.index=(Sr.scopes||(Sr.scopes=[])).push(this)-1)}run(o){if(this.active){const c=Sr;try{return Sr=this,o()}finally{Sr=c}}else Rh("cannot run an inactive effect scope.")}on(){Sr=this}off(){Sr=this.parent}stop(o){if(this.active){let c,f;for(c=0,f=this.effects.length;c<f;c++)this.effects[c].stop();for(c=0,f=this.cleanups.length;c<f;c++)this.cleanups[c]();if(this.scopes)for(c=0,f=this.scopes.length;c<f;c++)this.scopes[c].stop(!0);if(this.parent&&!o){const y=this.parent.scopes.pop();y&&y!==this&&(this.parent.scopes[this.index]=y,y.index=this.index)}this.active=!1}}}function Uy(n){return new $y(n)}function s1(n,o=Sr){o&&o.active&&o.effects.push(n)}function o1(){return Sr}function a1(n){Sr?Sr.cleanups.push(n):Rh("onScopeDispose() is called when there is no active effect scope to be associated with.")}const zf=n=>{const o=new Set(n);return o.w=0,o.n=0,o},Ny=n=>(n.w&xo)>0,Vy=n=>(n.n&xo)>0,l1=({deps:n})=>{if(n.length)for(let o=0;o<n.length;o++)n[o].w|=xo},c1=n=>{const{deps:o}=n;if(o.length){let c=0;for(let f=0;f<o.length;f++){const y=o[f];Ny(y)&&!Vy(y)?y.delete(n):o[c++]=y,y.w&=~xo,y.n&=~xo}o.length=c}},Gp=new WeakMap;let Rc=0,xo=1;const Wp=30;let or;const ga=Symbol("iterate"),Zp=Symbol("Map key iterate");class Df{constructor(o,c=null,f){this.fn=o,this.scheduler=c,this.active=!0,this.deps=[],this.parent=void 0,s1(this,f)}run(){if(!this.active)return this.fn();let o=or,c=_o;for(;o;){if(o===this)return;o=o.parent}try{return this.parent=or,or=this,_o=!0,xo=1<<++Rc,Rc<=Wp?l1(this):Bg(this),this.fn()}finally{Rc<=Wp&&c1(this),xo=1<<--Rc,or=this.parent,_o=c,this.parent=void 0,this.deferStop&&this.stop()}}stop(){or===this?this.deferStop=!0:this.active&&(Bg(this),this.onStop&&this.onStop(),this.active=!1)}}function Bg(n){const{deps:o}=n;if(o.length){for(let c=0;c<o.length;c++)o[c].delete(n);o.length=0}}let _o=!0;const jy=[];function Ta(){jy.push(_o),_o=!1}function Ea(){const n=jy.pop();_o=n===void 0?!0:n}function Ir(n,o,c){if(_o&&or){let f=Gp.get(n);f||Gp.set(n,f=new Map);let y=f.get(c);y||f.set(c,y=zf()),qy(y,{effect:or,target:n,type:o,key:c})}}function qy(n,o){let c=!1;Rc<=Wp?Vy(n)||(n.n|=xo,c=!Ny(n)):c=!n.has(or),c&&(n.add(or),or.deps.push(n),or.onTrack&&or.onTrack(Object.assign({effect:or},o)))}function Fs(n,o,c,f,y,v){const w=Gp.get(n);if(!w)return;let a=[];if(o==="clear")a=[...w.values()];else if(c==="length"&&qt(n))w.forEach(($,F)=>{(F==="length"||F>=f)&&a.push($)});else switch(c!==void 0&&a.push(w.get(c)),o){case"add":qt(n)?Mf(c)&&a.push(w.get("length")):(a.push(w.get(ga)),ma(n)&&a.push(w.get(Zp)));break;case"delete":qt(n)||(a.push(w.get(ga)),ma(n)&&a.push(w.get(Zp)));break;case"set":ma(n)&&a.push(w.get(ga));break}const k={target:n,type:o,key:c,newValue:f,oldValue:y,oldTarget:v};if(a.length===1)a[0]&&Hp(a[0],k);else{const $=[];for(const F of a)F&&$.push(...F);Hp(zf($),k)}}function Hp(n,o){const c=qt(n)?n:[...n];for(const f of c)f.computed&&Fg(f,o);for(const f of c)f.computed||Fg(f,o)}function Fg(n,o){(n!==or||n.allowRecurse)&&(n.onTrigger&&n.onTrigger(an({effect:n},o)),n.scheduler?n.scheduler():n.run())}const u1=To("__proto__,__v_isRef,__isVue"),Gy=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Cf)),h1=Wh(),d1=Wh(!1,!0),p1=Wh(!0),f1=Wh(!0,!0),$g=m1();function m1(){const n={};return["includes","indexOf","lastIndexOf"].forEach(o=>{n[o]=function(...c){const f=ti(this);for(let v=0,w=this.length;v<w;v++)Ir(f,"get",v+"");const y=f[o](...c);return y===-1||y===!1?f[o](...c.map(ti)):y}}),["push","pop","shift","unshift","splice"].forEach(o=>{n[o]=function(...c){Ta();const f=ti(this)[o].apply(this,c);return Ea(),f}}),n}function Wh(n=!1,o=!1){return function(f,y,v){if(y==="__v_isReactive")return!n;if(y==="__v_isReadonly")return n;if(y==="__v_isShallow")return o;if(y==="__v_raw"&&v===(n?o?Qy:Yy:o?Jy:Ky).get(f))return f;const w=qt(f);if(!n&&w&&mi($g,y))return Reflect.get($g,y,v);const a=Reflect.get(f,y,v);return(Cf(y)?Gy.has(y):u1(y))||(n||Ir(f,"get",y),o)?a:Ji(a)?w&&Mf(y)?a:a.value:Li(a)?n?ev(a):Il(a):a}}const g1=Wy(),_1=Wy(!0);function Wy(n=!1){return function(c,f,y,v){let w=c[f];if(bo(w)&&Ji(w)&&!Ji(y))return!1;if(!n&&(!Lh(y)&&!bo(y)&&(w=ti(w),y=ti(y)),!qt(c)&&Ji(w)&&!Ji(y)))return w.value=y,!0;const a=qt(c)&&Mf(f)?Number(f)<c.length:mi(c,f),k=Reflect.set(c,f,y,v);return c===ti(v)&&(a?qc(y,w)&&Fs(c,"set",f,y,w):Fs(c,"add",f,y)),k}}function y1(n,o){const c=mi(n,o),f=n[o],y=Reflect.deleteProperty(n,o);return y&&c&&Fs(n,"delete",o,void 0,f),y}function v1(n,o){const c=Reflect.has(n,o);return(!Cf(o)||!Gy.has(o))&&Ir(n,"has",o),c}function x1(n){return Ir(n,"iterate",qt(n)?"length":ga),Reflect.ownKeys(n)}const Zy={get:h1,set:g1,deleteProperty:y1,has:v1,ownKeys:x1},Hy={get:p1,set(n,o){return Rh(`Set operation on key "${String(o)}" failed: target is readonly.`,n),!0},deleteProperty(n,o){return Rh(`Delete operation on key "${String(o)}" failed: target is readonly.`,n),!0}},b1=an({},Zy,{get:d1,set:_1}),w1=an({},Hy,{get:f1}),Rf=n=>n,Zh=n=>Reflect.getPrototypeOf(n);function fh(n,o,c=!1,f=!1){n=n.__v_raw;const y=ti(n),v=ti(o);c||(o!==v&&Ir(y,"get",o),Ir(y,"get",v));const{has:w}=Zh(y),a=f?Rf:c?Lf:Gc;if(w.call(y,o))return a(n.get(o));if(w.call(y,v))return a(n.get(v));n!==y&&n.get(o)}function mh(n,o=!1){const c=this.__v_raw,f=ti(c),y=ti(n);return o||(n!==y&&Ir(f,"has",n),Ir(f,"has",y)),n===y?c.has(n):c.has(n)||c.has(y)}function gh(n,o=!1){return n=n.__v_raw,!o&&Ir(ti(n),"iterate",ga),Reflect.get(n,"size",n)}function Ug(n){n=ti(n);const o=ti(this);return Zh(o).has.call(o,n)||(o.add(n),Fs(o,"add",n,n)),this}function Ng(n,o){o=ti(o);const c=ti(this),{has:f,get:y}=Zh(c);let v=f.call(c,n);v?Xy(c,f,n):(n=ti(n),v=f.call(c,n));const w=y.call(c,n);return c.set(n,o),v?qc(o,w)&&Fs(c,"set",n,o,w):Fs(c,"add",n,o),this}function Vg(n){const o=ti(this),{has:c,get:f}=Zh(o);let y=c.call(o,n);y?Xy(o,c,n):(n=ti(n),y=c.call(o,n));const v=f?f.call(o,n):void 0,w=o.delete(n);return y&&Fs(o,"delete",n,void 0,v),w}function jg(){const n=ti(this),o=n.size!==0,c=ma(n)?new Map(n):new Set(n),f=n.clear();return o&&Fs(n,"clear",void 0,void 0,c),f}function _h(n,o){return function(f,y){const v=this,w=v.__v_raw,a=ti(w),k=o?Rf:n?Lf:Gc;return!n&&Ir(a,"iterate",ga),w.forEach(($,F)=>f.call(y,k($),k(F),v))}}function yh(n,o,c){return function(...f){const y=this.__v_raw,v=ti(y),w=ma(v),a=n==="entries"||n===Symbol.iterator&&w,k=n==="keys"&&w,$=y[n](...f),F=c?Rf:o?Lf:Gc;return!o&&Ir(v,"iterate",k?Zp:ga),{next(){const{value:B,done:M}=$.next();return M?{value:B,done:M}:{value:a?[F(B[0]),F(B[1])]:F(B),done:M}},[Symbol.iterator](){return this}}}}function ao(n){return function(...o){{const c=o[0]?`on key "${o[0]}" `:"";console.warn(`${va(n)} operation ${c}failed: target is readonly.`,ti(this))}return n==="delete"?!1:this}}function T1(){const n={get(v){return fh(this,v)},get size(){return gh(this)},has:mh,add:Ug,set:Ng,delete:Vg,clear:jg,forEach:_h(!1,!1)},o={get(v){return fh(this,v,!1,!0)},get size(){return gh(this)},has:mh,add:Ug,set:Ng,delete:Vg,clear:jg,forEach:_h(!1,!0)},c={get(v){return fh(this,v,!0)},get size(){return gh(this,!0)},has(v){return mh.call(this,v,!0)},add:ao("add"),set:ao("set"),delete:ao("delete"),clear:ao("clear"),forEach:_h(!0,!1)},f={get(v){return fh(this,v,!0,!0)},get size(){return gh(this,!0)},has(v){return mh.call(this,v,!0)},add:ao("add"),set:ao("set"),delete:ao("delete"),clear:ao("clear"),forEach:_h(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(v=>{n[v]=yh(v,!1,!1),c[v]=yh(v,!0,!1),o[v]=yh(v,!1,!0),f[v]=yh(v,!0,!0)}),[n,c,o,f]}const[E1,S1,I1,A1]=T1();function Hh(n,o){const c=o?n?A1:I1:n?S1:E1;return(f,y,v)=>y==="__v_isReactive"?!n:y==="__v_isReadonly"?n:y==="__v_raw"?f:Reflect.get(mi(c,y)&&y in f?c:f,y,v)}const C1={get:Hh(!1,!1)},k1={get:Hh(!1,!0)},P1={get:Hh(!0,!1)},M1={get:Hh(!0,!0)};function Xy(n,o,c){const f=ti(c);if(f!==c&&o.call(n,f)){const y=Pf(n);console.warn(`Reactive ${y} contains both the raw and reactive versions of the same object${y==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}const Ky=new WeakMap,Jy=new WeakMap,Yy=new WeakMap,Qy=new WeakMap;function z1(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function D1(n){return n.__v_skip||!Object.isExtensible(n)?0:z1(Pf(n))}function Il(n){return bo(n)?n:Xh(n,!1,Zy,C1,Ky)}function R1(n){return Xh(n,!1,b1,k1,Jy)}function ev(n){return Xh(n,!0,Hy,P1,Yy)}function hl(n){return Xh(n,!0,w1,M1,Qy)}function Xh(n,o,c,f,y){if(!Li(n))return console.warn(`value cannot be made reactive: ${String(n)}`),n;if(n.__v_raw&&!(o&&n.__v_isReactive))return n;const v=y.get(n);if(v)return v;const w=D1(n);if(w===0)return n;const a=new Proxy(n,w===2?f:c);return y.set(n,a),a}function hs(n){return bo(n)?hs(n.__v_raw):!!(n&&n.__v_isReactive)}function bo(n){return!!(n&&n.__v_isReadonly)}function Lh(n){return!!(n&&n.__v_isShallow)}function Oh(n){return hs(n)||bo(n)}function ti(n){const o=n&&n.__v_raw;return o?ti(o):n}function Hr(n){return Dh(n,"__v_skip",!0),n}const Gc=n=>Li(n)?Il(n):n,Lf=n=>Li(n)?ev(n):n;function tv(n){_o&&or&&(n=ti(n),qy(n.dep||(n.dep=zf()),{target:n,type:"get",key:"value"}))}function iv(n,o){n=ti(n),n.dep&&Hp(n.dep,{target:n,type:"set",key:"value",newValue:o})}function Ji(n){return!!(n&&n.__v_isRef===!0)}function Ci(n){return nv(n,!1)}function L1(n){return nv(n,!0)}function nv(n,o){return Ji(n)?n:new O1(n,o)}class O1{constructor(o,c){this.__v_isShallow=c,this.dep=void 0,this.__v_isRef=!0,this._rawValue=c?o:ti(o),this._value=c?o:Gc(o)}get value(){return tv(this),this._value}set value(o){const c=this.__v_isShallow||Lh(o)||bo(o);o=c?o:ti(o),qc(o,this._rawValue)&&(this._rawValue=o,this._value=c?o:Gc(o),iv(this,o))}}function Ve(n){return Ji(n)?n.value:n}const B1={get:(n,o,c)=>Ve(Reflect.get(n,o,c)),set:(n,o,c,f)=>{const y=n[o];return Ji(y)&&!Ji(c)?(y.value=c,!0):Reflect.set(n,o,c,f)}};function rv(n){return hs(n)?n:new Proxy(n,B1)}function qg(n){Oh(n)||console.warn("toRefs() expects a reactive object but received a plain one.");const o=qt(n)?new Array(n.length):{};for(const c in n)o[c]=Oc(n,c);return o}class F1{constructor(o,c,f){this._object=o,this._key=c,this._defaultValue=f,this.__v_isRef=!0}get value(){const o=this._object[this._key];return o===void 0?this._defaultValue:o}set value(o){this._object[this._key]=o}}function Oc(n,o,c){const f=n[o];return Ji(f)?f:new F1(n,o,c)}var sv;class $1{constructor(o,c,f,y){this._setter=c,this.dep=void 0,this.__v_isRef=!0,this[sv]=!1,this._dirty=!0,this.effect=new Df(o,()=>{this._dirty||(this._dirty=!0,iv(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!y,this.__v_isReadonly=f}get value(){const o=ti(this);return tv(o),(o._dirty||!o._cacheable)&&(o._dirty=!1,o._value=o.effect.run()),o._value}set value(o){this._setter(o)}}sv="__v_isReadonly";function U1(n,o,c=!1){let f,y;const v=Jt(n);v?(f=n,y=()=>{console.warn("Write operation failed: computed value is readonly")}):(f=n.get,y=n.set);const w=new $1(f,y,v||!y,c);return o&&!c&&(w.effect.onTrack=o.onTrack,w.effect.onTrigger=o.onTrigger),w}const _a=[];function Eh(n){_a.push(n)}function Sh(){_a.pop()}function Ge(n,...o){Ta();const c=_a.length?_a[_a.length-1].component:null,f=c&&c.appContext.config.warnHandler,y=N1();if(f)Bs(f,c,11,[n+o.join(""),c&&c.proxy,y.map(({vnode:v})=>`at <${rd(c,v.type)}>`).join(`
`),y]);else{const v=[`[Vue warn]: ${n}`,...o];y.length&&v.push(`
`,...V1(y)),console.warn(...v)}Ea()}function N1(){let n=_a[_a.length-1];if(!n)return[];const o=[];for(;n;){const c=o[0];c&&c.vnode===n?c.recurseCount++:o.push({vnode:n,recurseCount:0});const f=n.component&&n.component.parent;n=f&&f.vnode}return o}function V1(n){const o=[];return n.forEach((c,f)=>{o.push(...f===0?[]:[`
`],...j1(c))}),o}function j1({vnode:n,recurseCount:o}){const c=o>0?`... (${o} recursive calls)`:"",f=n.component?n.component.parent==null:!1,y=` at <${rd(n.component,n.type,f)}`,v=">"+c;return n.props?[y,...q1(n.props),v]:[y+v]}function q1(n){const o=[],c=Object.keys(n);return c.slice(0,3).forEach(f=>{o.push(...ov(f,n[f]))}),c.length>3&&o.push(" ..."),o}function ov(n,o,c){return en(o)?(o=JSON.stringify(o),c?o:[`${n}=${o}`]):typeof o=="number"||typeof o=="boolean"||o==null?c?o:[`${n}=${o}`]:Ji(o)?(o=ov(n,ti(o.value),!0),c?o:[`${n}=Ref<`,o,">"]):Jt(o)?[`${n}=fn${o.name?`<${o.name}>`:""}`]:(o=ti(o),c?o:[`${n}=`,o])}const Of={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",[0]:"setup function",[1]:"render function",[2]:"watcher getter",[3]:"watcher callback",[4]:"watcher cleanup function",[5]:"native event handler",[6]:"component event handler",[7]:"vnode hook",[8]:"directive hook",[9]:"transition hook",[10]:"app errorHandler",[11]:"app warnHandler",[12]:"ref function",[13]:"async component loader",[14]:"scheduler flush. This is likely a Vue internals bug. Please open an issue at https://new-issue.vuejs.org/?repo=vuejs/core"};function Bs(n,o,c,f){let y;try{y=f?n(...f):n()}catch(v){Kh(v,o,c)}return y}function Or(n,o,c,f){if(Jt(n)){const v=Bs(n,o,c,f);return v&&kf(v)&&v.catch(w=>{Kh(w,o,c)}),v}const y=[];for(let v=0;v<n.length;v++)y.push(Or(n[v],o,c,f));return y}function Kh(n,o,c,f=!0){const y=o?o.vnode:null;if(o){let v=o.parent;const w=o.proxy,a=Of[c];for(;v;){const $=v.ec;if($){for(let F=0;F<$.length;F++)if($[F](n,w,a)===!1)return}v=v.parent}const k=o.appContext.config.errorHandler;if(k){Bs(k,null,10,[n,w,a]);return}}G1(n,c,y,f)}function G1(n,o,c,f=!0){{const y=Of[o];if(c&&Eh(c),Ge(`Unhandled error${y?` during execution of ${y}`:""}`),c&&Sh(),f)throw n;console.error(n)}}let Wc=!1,Xp=!1;const Kn=[];let us=0;const fl=[];let cs=null,ho=0;const av=Promise.resolve();let Bf=null;const W1=100;function Zc(n){const o=Bf||av;return n?o.then(this?n.bind(this):n):o}function Z1(n){let o=us+1,c=Kn.length;for(;o<c;){const f=o+c>>>1;Hc(Kn[f])<n?o=f+1:c=f}return o}function Jh(n){(!Kn.length||!Kn.includes(n,Wc&&n.allowRecurse?us+1:us))&&(n.id==null?Kn.push(n):Kn.splice(Z1(n.id),0,n),lv())}function lv(){!Wc&&!Xp&&(Xp=!0,Bf=av.then(hv))}function H1(n){const o=Kn.indexOf(n);o>us&&Kn.splice(o,1)}function cv(n){qt(n)?fl.push(...n):(!cs||!cs.includes(n,n.allowRecurse?ho+1:ho))&&fl.push(n),lv()}function Gg(n,o=Wc?us+1:0){for(n=n||new Map;o<Kn.length;o++){const c=Kn[o];if(c&&c.pre){if(Ff(n,c))continue;Kn.splice(o,1),o--,c()}}}function uv(n){if(fl.length){const o=[...new Set(fl)];if(fl.length=0,cs){cs.push(...o);return}for(cs=o,n=n||new Map,cs.sort((c,f)=>Hc(c)-Hc(f)),ho=0;ho<cs.length;ho++)Ff(n,cs[ho])||cs[ho]();cs=null,ho=0}}const Hc=n=>n.id==null?1/0:n.id,X1=(n,o)=>{const c=Hc(n)-Hc(o);if(c===0){if(n.pre&&!o.pre)return-1;if(o.pre&&!n.pre)return 1}return c};function hv(n){Xp=!1,Wc=!0,n=n||new Map,Kn.sort(X1);const o=c=>Ff(n,c);try{for(us=0;us<Kn.length;us++){const c=Kn[us];if(c&&c.active!==!1){if(o(c))continue;Bs(c,null,14)}}}finally{us=0,Kn.length=0,uv(n),Wc=!1,Bf=null,(Kn.length||fl.length)&&hv(n)}}function Ff(n,o){if(!n.has(o))n.set(o,1);else{const c=n.get(o);if(c>W1){const f=o.ownerInstance,y=f&&Gf(f.type);return Ge(`Maximum recursive updates exceeded${y?` in component <${y}>`:""}. This means you have a reactive effect that is mutating its own dependencies and thus recursively triggering itself. Possible sources include component template, render function, updated hook or watcher source function.`),!0}else n.set(o,c+1)}}let yo=!1;const ul=new Set;Fy().__VUE_HMR_RUNTIME__={createRecord:vp(dv),rerender:vp(Y1),reload:vp(Q1)};const xa=new Map;function K1(n){const o=n.type.__hmrId;let c=xa.get(o);c||(dv(o,n.type),c=xa.get(o)),c.instances.add(n)}function J1(n){xa.get(n.type.__hmrId).instances.delete(n)}function dv(n,o){return xa.has(n)?!1:(xa.set(n,{initialDef:Bc(o),instances:new Set}),!0)}function Bc(n){return Wv(n)?n.__vccOpts:n}function Y1(n,o){const c=xa.get(n);!c||(c.initialDef.render=o,[...c.instances].forEach(f=>{o&&(f.render=o,Bc(f.type).render=o),f.renderCache=[],yo=!0,f.update(),yo=!1}))}function Q1(n,o){const c=xa.get(n);if(!c)return;o=Bc(o),Wg(c.initialDef,o);const f=[...c.instances];for(const y of f){const v=Bc(y.type);ul.has(v)||(v!==c.initialDef&&Wg(v,o),ul.add(v)),y.appContext.optionsCache.delete(y.type),y.ceReload?(ul.add(v),y.ceReload(o.styles),ul.delete(v)):y.parent?(Jh(y.parent.update),y.parent.type.__asyncLoader&&y.parent.ceReload&&y.parent.ceReload(o.styles)):y.appContext.reload?y.appContext.reload():typeof window<"u"?window.location.reload():console.warn("[HMR] Root or manually mounted instance modified. Full reload required.")}cv(()=>{for(const y of f)ul.delete(Bc(y.type))})}function Wg(n,o){an(n,o);for(const c in n)c!=="__file"&&!(c in o)&&delete n[c]}function vp(n){return(o,c)=>{try{return n(o,c)}catch(f){console.error(f),console.warn("[HMR] Something went wrong during Vue component hot-reload. Full reload required.")}}}let la,Lc=[],Kp=!1;function iu(n,...o){la?la.emit(n,...o):Kp||Lc.push({event:n,args:o})}function pv(n,o){var c,f;la=n,la?(la.enabled=!0,Lc.forEach(({event:y,args:v})=>la.emit(y,...v)),Lc=[]):typeof window<"u"&&window.HTMLElement&&!(!((f=(c=window.navigator)===null||c===void 0?void 0:c.userAgent)===null||f===void 0)&&f.includes("jsdom"))?((o.__VUE_DEVTOOLS_HOOK_REPLAY__=o.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(v=>{pv(v,o)}),setTimeout(()=>{la||(o.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Kp=!0,Lc=[])},3e3)):(Kp=!0,Lc=[])}function ew(n,o){iu("app:init",n,o,{Fragment:ui,Text:td,Comment:On,Static:Uc})}function tw(n){iu("app:unmount",n)}const iw=$f("component:added"),fv=$f("component:updated"),nw=$f("component:removed");function $f(n){return o=>{iu(n,o.appContext.app,o.uid,o.parent?o.parent.uid:void 0,o)}}const rw=mv("perf:start"),sw=mv("perf:end");function mv(n){return(o,c,f)=>{iu(n,o.appContext.app,o.uid,o,c,f)}}function ow(n,o,c){iu("component:emit",n.appContext.app,n,o,c)}function aw(n,o,...c){if(n.isUnmounted)return;const f=n.vnode.props||Di;{const{emitsOptions:F,propsOptions:[B]}=n;if(F)if(!(o in F))(!B||!(ra(o)in B))&&Ge(`Component emitted event "${o}" but it is neither declared in the emits option nor as an "${ra(o)}" prop.`);else{const M=F[o];Jt(M)&&(M(...c)||Ge(`Invalid event arguments: event validation failed for event "${o}".`))}}let y=c;const v=o.startsWith("update:"),w=v&&o.slice(7);if(w&&w in f){const F=`${w==="modelValue"?"model":w}Modifiers`,{number:B,trim:M}=f[F]||Di;M&&(y=c.map(le=>le.trim())),B&&(y=c.map(By))}ow(n,o,y);{const F=o.toLowerCase();F!==o&&f[ra(F)]&&Ge(`Event "${F}" is emitted in component ${rd(n,n.type)} but the handler is registered for "${o}". Note that HTML attributes are case-insensitive and you cannot use v-on to listen to camelCase events when using in-DOM templates. You should probably use "${vo(o)}" instead of "${o}".`)}let a,k=f[a=ra(o)]||f[a=ra(ps(o))];!k&&v&&(k=f[a=ra(vo(o))]),k&&Or(k,n,6,y);const $=f[a+"Once"];if($){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Or($,n,6,y)}}function gv(n,o,c=!1){const f=o.emitsCache,y=f.get(n);if(y!==void 0)return y;const v=n.emits;let w={},a=!1;if(!Jt(n)){const k=$=>{const F=gv($,o,!0);F&&(a=!0,an(w,F))};!c&&o.mixins.length&&o.mixins.forEach(k),n.extends&&k(n.extends),n.mixins&&n.mixins.forEach(k)}return!v&&!a?(Li(n)&&f.set(n,null),null):(qt(v)?v.forEach(k=>w[k]=null):an(w,v),Li(n)&&f.set(n,w),w)}function Yh(n,o){return!n||!tu(o)?!1:(o=o.slice(2).replace(/Once$/,""),mi(n,o[0].toLowerCase()+o.slice(1))||mi(n,vo(o))||mi(n,o))}let Ln=null,_v=null;function Bh(n){const o=Ln;return Ln=n,_v=n&&n.type.__scopeId||null,o}function It(n,o=Ln,c){if(!o||n._n)return n;const f=(...y)=>{f._d&&o_(-1);const v=Bh(o),w=n(...y);return Bh(v),f._d&&o_(1),fv(o),w};return f._n=!0,f._c=!0,f._d=!0,f}let Jp=!1;function Fh(){Jp=!0}function xp(n){const{type:o,vnode:c,proxy:f,withProxy:y,props:v,propsOptions:[w],slots:a,attrs:k,emit:$,render:F,renderCache:B,data:M,setupState:le,ctx:Ee,inheritAttrs:Oe}=n;let Je,He;const De=Bh(n);Jp=!1;try{if(c.shapeFlag&4){const Ce=y||f;Je=Xr(F.call(Ce,Ce,B,v,le,M,Ee)),He=k}else{const Ce=o;k===v&&Fh(),Je=Xr(Ce.length>1?Ce(v,{get attrs(){return Fh(),k},slots:a,emit:$}):Ce(v,null)),He=o.props?k:cw(k)}}catch(Ce){Nc.length=0,Kh(Ce,n,1),Je=lt(On)}let tt=Je,Nt;if(Je.patchFlag>0&&Je.patchFlag&2048&&([tt,Nt]=lw(Je)),He&&Oe!==!1){const Ce=Object.keys(He),{shapeFlag:Zt}=tt;if(Ce.length){if(Zt&7)w&&Ce.some(zh)&&(He=uw(He,w)),tt=fs(tt,He);else if(!Jp&&tt.type!==On){const Xe=Object.keys(k),ht=[],it=[];for(let Ue=0,ct=Xe.length;Ue<ct;Ue++){const Re=Xe[Ue];tu(Re)?zh(Re)||ht.push(Re[2].toLowerCase()+Re.slice(3)):it.push(Re)}it.length&&Ge(`Extraneous non-props attributes (${it.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes.`),ht.length&&Ge(`Extraneous non-emits event listeners (${ht.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes. If the listener is intended to be a component custom event listener only, declare it using the "emits" option.`)}}}return c.dirs&&(Zg(tt)||Ge("Runtime directive used on component with non-element root node. The directives will not function as intended."),tt=fs(tt),tt.dirs=tt.dirs?tt.dirs.concat(c.dirs):c.dirs),c.transition&&(Zg(tt)||Ge("Component inside <Transition> renders non-element root node that cannot be animated."),tt.transition=c.transition),Nt?Nt(tt):Je=tt,Bh(De),Je}const lw=n=>{const o=n.children,c=n.dynamicChildren,f=yv(o);if(!f)return[n,void 0];const y=o.indexOf(f),v=c?c.indexOf(f):-1,w=a=>{o[y]=a,c&&(v>-1?c[v]=a:a.patchFlag>0&&(n.dynamicChildren=[...c,a]))};return[Xr(f),w]};function yv(n){let o;for(let c=0;c<n.length;c++){const f=n[c];if(vl(f)){if(f.type!==On||f.children==="v-if"){if(o)return;o=f}}else return}return o}const cw=n=>{let o;for(const c in n)(c==="class"||c==="style"||tu(c))&&((o||(o={}))[c]=n[c]);return o},uw=(n,o)=>{const c={};for(const f in n)(!zh(f)||!(f.slice(9)in o))&&(c[f]=n[f]);return c},Zg=n=>n.shapeFlag&7||n.type===On;function hw(n,o,c){const{props:f,children:y,component:v}=n,{props:w,children:a,patchFlag:k}=o,$=v.emitsOptions;if((y||a)&&yo||o.dirs||o.transition)return!0;if(c&&k>=0){if(k&1024)return!0;if(k&16)return f?Hg(f,w,$):!!w;if(k&8){const F=o.dynamicProps;for(let B=0;B<F.length;B++){const M=F[B];if(w[M]!==f[M]&&!Yh($,M))return!0}}}else return(y||a)&&(!a||!a.$stable)?!0:f===w?!1:f?w?Hg(f,w,$):!0:!!w;return!1}function Hg(n,o,c){const f=Object.keys(o);if(f.length!==Object.keys(n).length)return!0;for(let y=0;y<f.length;y++){const v=f[y];if(o[v]!==n[v]&&!Yh(c,v))return!0}return!1}function dw({vnode:n,parent:o},c){for(;o&&o.subTree===n;)(n=o.vnode).el=c,o=o.parent}const pw=n=>n.__isSuspense;function fw(n,o){o&&o.pendingBranch?qt(n)?o.effects.push(...n):o.effects.push(n):cv(n)}function ml(n,o){if(!Sn)Ge("provide() can only be used inside setup().");else{let c=Sn.provides;const f=Sn.parent&&Sn.parent.provides;f===c&&(c=Sn.provides=Object.create(f)),c[n]=o}}function Jr(n,o,c=!1){const f=Sn||Ln;if(f){const y=f.parent==null?f.vnode.appContext&&f.vnode.appContext.provides:f.parent.provides;if(y&&n in y)return y[n];if(arguments.length>1)return c&&Jt(o)?o.call(f.proxy):o;Ge(`injection "${String(n)}" not found.`)}else Ge("inject() can only be used inside setup() or functional components.")}function vv(n,o){return Uf(n,null,o)}const Xg={};function lr(n,o,c){return Jt(o)||Ge("`watch(fn, options?)` signature has been moved to a separate API. Use `watchEffect(fn, options?)` instead. `watch` now only supports `watch(source, cb, options?) signature."),Uf(n,o,c)}function Uf(n,o,{immediate:c,deep:f,flush:y,onTrack:v,onTrigger:w}=Di){o||(c!==void 0&&Ge('watch() "immediate" option is only respected when using the watch(source, callback, options?) signature.'),f!==void 0&&Ge('watch() "deep" option is only respected when using the watch(source, callback, options?) signature.'));const a=De=>{Ge("Invalid watch source: ",De,"A watch source can only be a getter/effect function, a ref, a reactive object, or an array of these types.")},k=Sn;let $,F=!1,B=!1;if(Ji(n)?($=()=>n.value,F=Lh(n)):hs(n)?($=()=>n,f=!0):qt(n)?(B=!0,F=n.some(De=>hs(De)||Lh(De)),$=()=>n.map(De=>{if(Ji(De))return De.value;if(hs(De))return da(De);if(Jt(De))return Bs(De,k,2);a(De)})):Jt(n)?o?$=()=>Bs(n,k,2):$=()=>{if(!(k&&k.isUnmounted))return M&&M(),Or(n,k,3,[le])}:($=mr,a(n)),o&&f){const De=$;$=()=>da(De())}let M,le=De=>{M=He.onStop=()=>{Bs(De,k,4)}};if(Kc)return le=mr,o?c&&Or(o,k,3,[$(),B?[]:void 0,le]):$(),mr;let Ee=B?[]:Xg;const Oe=()=>{if(!!He.active)if(o){const De=He.run();(f||F||(B?De.some((tt,Nt)=>qc(tt,Ee[Nt])):qc(De,Ee)))&&(M&&M(),Or(o,k,3,[De,Ee===Xg?void 0:Ee,le]),Ee=De)}else He.run()};Oe.allowRecurse=!!o;let Je;y==="sync"?Je=Oe:y==="post"?Je=()=>pr(Oe,k&&k.suspense):(Oe.pre=!0,k&&(Oe.id=k.uid),Je=()=>Jh(Oe));const He=new Df($,Je);return He.onTrack=v,He.onTrigger=w,o?c?Oe():Ee=He.run():y==="post"?pr(He.run.bind(He),k&&k.suspense):He.run(),()=>{He.stop(),k&&k.scope&&Af(k.scope.effects,He)}}function mw(n,o,c){const f=this.proxy,y=en(n)?n.includes(".")?xv(f,n):()=>f[n]:n.bind(f,f);let v;Jt(o)?v=o:(v=o.handler,c=o);const w=Sn;xl(this);const a=Uf(y,v.bind(f),c);return w?xl(w):ya(),a}function xv(n,o){const c=o.split(".");return()=>{let f=n;for(let y=0;y<c.length&&f;y++)f=f[c[y]];return f}}function da(n,o){if(!Li(n)||n.__v_skip||(o=o||new Set,o.has(n)))return n;if(o.add(n),Ji(n))da(n.value,o);else if(qt(n))for(let c=0;c<n.length;c++)da(n[c],o);else if(Ry(n)||ma(n))n.forEach(c=>{da(c,o)});else if(Oy(n))for(const c in n)da(n[c],o);return n}function gw(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Al(()=>{n.isMounted=!0}),Sv(()=>{n.isUnmounting=!0}),n}const Lr=[Function,Array],_w={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Lr,onEnter:Lr,onAfterEnter:Lr,onEnterCancelled:Lr,onBeforeLeave:Lr,onLeave:Lr,onAfterLeave:Lr,onLeaveCancelled:Lr,onBeforeAppear:Lr,onAppear:Lr,onAfterAppear:Lr,onAppearCancelled:Lr},setup(n,{slots:o}){const c=Cl(),f=gw();let y;return()=>{const v=o.default&&Tv(o.default(),!0);if(!v||!v.length)return;let w=v[0];if(v.length>1){let Oe=!1;for(const Je of v)if(Je.type!==On){if(Oe){Ge("<transition> can only be used on a single element or component. Use <transition-group> for lists.");break}w=Je,Oe=!0}}const a=ti(n),{mode:k}=a;if(k&&k!=="in-out"&&k!=="out-in"&&k!=="default"&&Ge(`invalid <transition> mode: ${k}`),f.isLeaving)return bp(w);const $=Kg(w);if(!$)return bp(w);const F=Yp($,a,f,c);Qp($,F);const B=c.subTree,M=B&&Kg(B);let le=!1;const{getTransitionKey:Ee}=$.type;if(Ee){const Oe=Ee();y===void 0?y=Oe:Oe!==y&&(y=Oe,le=!0)}if(M&&M.type!==On&&(!ca($,M)||le)){const Oe=Yp(M,a,f,c);if(Qp(M,Oe),k==="out-in")return f.isLeaving=!0,Oe.afterLeave=()=>{f.isLeaving=!1,c.update()},bp(w);k==="in-out"&&$.type!==On&&(Oe.delayLeave=(Je,He,De)=>{const tt=wv(f,M);tt[String(M.key)]=M,Je._leaveCb=()=>{He(),Je._leaveCb=void 0,delete F.delayedLeave},F.delayedLeave=De})}return w}}},bv=_w;function wv(n,o){const{leavingVNodes:c}=n;let f=c.get(o.type);return f||(f=Object.create(null),c.set(o.type,f)),f}function Yp(n,o,c,f){const{appear:y,mode:v,persisted:w=!1,onBeforeEnter:a,onEnter:k,onAfterEnter:$,onEnterCancelled:F,onBeforeLeave:B,onLeave:M,onAfterLeave:le,onLeaveCancelled:Ee,onBeforeAppear:Oe,onAppear:Je,onAfterAppear:He,onAppearCancelled:De}=o,tt=String(n.key),Nt=wv(c,n),Ce=(ht,it)=>{ht&&Or(ht,f,9,it)},Zt=(ht,it)=>{const Ue=it[1];Ce(ht,it),qt(ht)?ht.every(ct=>ct.length<=1)&&Ue():ht.length<=1&&Ue()},Xe={mode:v,persisted:w,beforeEnter(ht){let it=a;if(!c.isMounted)if(y)it=Oe||a;else return;ht._leaveCb&&ht._leaveCb(!0);const Ue=Nt[tt];Ue&&ca(n,Ue)&&Ue.el._leaveCb&&Ue.el._leaveCb(),Ce(it,[ht])},enter(ht){let it=k,Ue=$,ct=F;if(!c.isMounted)if(y)it=Je||k,Ue=He||$,ct=De||F;else return;let Re=!1;const Rt=ht._enterCb=ai=>{Re||(Re=!0,ai?Ce(ct,[ht]):Ce(Ue,[ht]),Xe.delayedLeave&&Xe.delayedLeave(),ht._enterCb=void 0)};it?Zt(it,[ht,Rt]):Rt()},leave(ht,it){const Ue=String(n.key);if(ht._enterCb&&ht._enterCb(!0),c.isUnmounting)return it();Ce(B,[ht]);let ct=!1;const Re=ht._leaveCb=Rt=>{ct||(ct=!0,it(),Rt?Ce(Ee,[ht]):Ce(le,[ht]),ht._leaveCb=void 0,Nt[Ue]===n&&delete Nt[Ue])};Nt[Ue]=n,M?Zt(M,[ht,Re]):Re()},clone(ht){return Yp(ht,o,c,f)}};return Xe}function bp(n){if(nu(n))return n=fs(n),n.children=null,n}function Kg(n){return nu(n)?n.children?n.children[0]:void 0:n}function Qp(n,o){n.shapeFlag&6&&n.component?Qp(n.component.subTree,o):n.shapeFlag&128?(n.ssContent.transition=o.clone(n.ssContent),n.ssFallback.transition=o.clone(n.ssFallback)):n.transition=o}function Tv(n,o=!1,c){let f=[],y=0;for(let v=0;v<n.length;v++){let w=n[v];const a=c==null?w.key:String(c)+String(w.key!=null?w.key:v);w.type===ui?(w.patchFlag&128&&y++,f=f.concat(Tv(w.children,o,a))):(o||w.type!==On)&&f.push(a!=null?fs(w,{key:a}):w)}if(y>1)for(let v=0;v<f.length;v++)f[v].patchFlag=-2;return f}function Dt(n){return Jt(n)?{setup:n,name:n.name}:n}const Fc=n=>!!n.type.__asyncLoader,nu=n=>n.type.__isKeepAlive;function yw(n,o){Ev(n,"a",o)}function vw(n,o){Ev(n,"da",o)}function Ev(n,o,c=Sn){const f=n.__wdc||(n.__wdc=()=>{let y=c;for(;y;){if(y.isDeactivated)return;y=y.parent}return n()});if(Qh(o,f,c),c){let y=c.parent;for(;y&&y.parent;)nu(y.parent.vnode)&&xw(f,o,c,y),y=y.parent}}function xw(n,o,c,f){const y=Qh(o,n,f,!0);ed(()=>{Af(f[o],y)},c)}function Qh(n,o,c=Sn,f=!1){if(c){const y=c[n]||(c[n]=[]),v=o.__weh||(o.__weh=(...w)=>{if(c.isUnmounted)return;Ta(),xl(c);const a=Or(o,c,n,w);return ya(),Ea(),a});return f?y.unshift(v):y.push(v),v}else{const y=ra(Of[n].replace(/ hook$/,""));Ge(`${y} is called when there is no active component instance to be associated with. Lifecycle injection APIs can only be used during execution of setup(). If you are using async setup(), make sure to register lifecycle hooks before the first await statement.`)}}const $s=n=>(o,c=Sn)=>(!Kc||n==="sp")&&Qh(n,o,c),bw=$s("bm"),Al=$s("m"),ww=$s("bu"),Tw=$s("u"),Sv=$s("bum"),ed=$s("um"),Ew=$s("sp"),Sw=$s("rtg"),Iw=$s("rtc");function Aw(n,o=Sn){Qh("ec",n,o)}function Iv(n){i1(n)&&Ge("Do not use built-in directive ids as custom directive id: "+n)}function Cw(n,o){const c=Ln;if(c===null)return Ge("withDirectives can only be used inside render functions."),n;const f=nd(c)||c.proxy,y=n.dirs||(n.dirs=[]);for(let v=0;v<o.length;v++){let[w,a,k,$=Di]=o[v];Jt(w)&&(w={mounted:w,updated:w}),w.deep&&da(a),y.push({dir:w,instance:f,value:a,oldValue:void 0,arg:k,modifiers:$})}return n}function ea(n,o,c,f){const y=n.dirs,v=o&&o.dirs;for(let w=0;w<y.length;w++){const a=y[w];v&&(a.oldValue=v[w].value);let k=a.dir[f];k&&(Ta(),Or(k,c,8,[n.el,a,n,o]),Ea())}}const $h="components";function Av(n,o){return kv($h,n,!0,o)||n}const Cv=Symbol();function Sa(n){return en(n)?kv($h,n,!1)||n:n||Cv}function kv(n,o,c=!0,f=!1){const y=Ln||Sn;if(y){const v=y.type;if(n===$h){const a=Gf(v,!1);if(a&&(a===o||a===ps(o)||a===va(ps(o))))return v}const w=Jg(y[n]||v[n],o)||Jg(y.appContext[n],o);if(!w&&f)return v;if(c&&!w){const a=n===$h?`
If this is a native custom element, make sure to exclude it from component resolution via compilerOptions.isCustomElement.`:"";Ge(`Failed to resolve ${n.slice(0,-1)}: ${o}${a}`)}return w}else Ge(`resolve${va(n.slice(0,-1))} can only be used in render() or setup().`)}function Jg(n,o){return n&&(n[o]||n[ps(o)]||n[va(ps(o))])}function bn(n,o,c,f){let y;const v=c&&c[f];if(qt(n)||en(n)){y=new Array(n.length);for(let w=0,a=n.length;w<a;w++)y[w]=o(n[w],w,void 0,v&&v[w])}else if(typeof n=="number"){Number.isInteger(n)||Ge(`The v-for range expect an integer value but got ${n}.`),y=new Array(n);for(let w=0;w<n;w++)y[w]=o(w+1,w,void 0,v&&v[w])}else if(Li(n))if(n[Symbol.iterator])y=Array.from(n,(w,a)=>o(w,a,void 0,v&&v[a]));else{const w=Object.keys(n);y=new Array(w.length);for(let a=0,k=w.length;a<k;a++){const $=w[a];y[a]=o(n[$],$,a,v&&v[a])}}else y=[];return c&&(c[f]=y),y}function kw(n,o){for(let c=0;c<o.length;c++){const f=o[c];if(qt(f))for(let y=0;y<f.length;y++)n[f[y].name]=f[y].fn;else f&&(n[f.name]=f.key?(...y)=>{const v=f.fn(...y);return v.key=f.key,v}:f.fn)}return n}function Ui(n,o,c={},f,y){if(Ln.isCE||Ln.parent&&Fc(Ln.parent)&&Ln.parent.isCE)return lt("slot",o==="default"?null:{name:o},f&&f());let v=n[o];v&&v.length>1&&(Ge("SSR-optimized slot function detected in a non-SSR-optimized render function. You need to mark this component with $dynamic-slots in the parent template."),v=()=>[]),v&&v._c&&(v._d=!1),ve();const w=v&&Pv(v(c)),a=hi(ui,{key:c.key||w&&w.key||`_${o}`},w||(f?f():[]),w&&n._===1?64:-2);return!y&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),v&&v._c&&(v._d=!0),a}function Pv(n){return n.some(o=>vl(o)?!(o.type===On||o.type===ui&&!Pv(o.children)):!0)?n:null}const ef=n=>n?jv(n)?nd(n)||n.proxy:ef(n.parent):null,yl=an(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>hl(n.props),$attrs:n=>hl(n.attrs),$slots:n=>hl(n.slots),$refs:n=>hl(n.refs),$parent:n=>ef(n.parent),$root:n=>ef(n.root),$emit:n=>n.emit,$options:n=>Vf(n),$forceUpdate:n=>n.f||(n.f=()=>Jh(n.update)),$nextTick:n=>n.n||(n.n=Zc.bind(n.proxy)),$watch:n=>mw.bind(n)}),Nf=n=>n==="_"||n==="$",Mv={get({_:n},o){const{ctx:c,setupState:f,data:y,props:v,accessCache:w,type:a,appContext:k}=n;if(o==="__isVue")return!0;if(f!==Di&&f.__isScriptSetup&&mi(f,o))return f[o];let $;if(o[0]!=="$"){const le=w[o];if(le!==void 0)switch(le){case 1:return f[o];case 2:return y[o];case 4:return c[o];case 3:return v[o]}else{if(f!==Di&&mi(f,o))return w[o]=1,f[o];if(y!==Di&&mi(y,o))return w[o]=2,y[o];if(($=n.propsOptions[0])&&mi($,o))return w[o]=3,v[o];if(c!==Di&&mi(c,o))return w[o]=4,c[o];tf&&(w[o]=0)}}const F=yl[o];let B,M;if(F)return o==="$attrs"&&(Ir(n,"get",o),Fh()),F(n);if((B=a.__cssModules)&&(B=B[o]))return B;if(c!==Di&&mi(c,o))return w[o]=4,c[o];if(M=k.config.globalProperties,mi(M,o))return M[o];Ln&&(!en(o)||o.indexOf("__v")!==0)&&(y!==Di&&Nf(o[0])&&mi(y,o)?Ge(`Property ${JSON.stringify(o)} must be accessed via $data because it starts with a reserved character ("$" or "_") and is not proxied on the render context.`):n===Ln&&Ge(`Property ${JSON.stringify(o)} was accessed during render but is not defined on instance.`))},set({_:n},o,c){const{data:f,setupState:y,ctx:v}=n;return y!==Di&&mi(y,o)?(y[o]=c,!0):f!==Di&&mi(f,o)?(f[o]=c,!0):mi(n.props,o)?(Ge(`Attempting to mutate prop "${o}". Props are readonly.`,n),!1):o[0]==="$"&&o.slice(1)in n?(Ge(`Attempting to mutate public property "${o}". Properties starting with $ are reserved and readonly.`,n),!1):(o in n.appContext.config.globalProperties?Object.defineProperty(v,o,{enumerable:!0,configurable:!0,value:c}):v[o]=c,!0)},has({_:{data:n,setupState:o,accessCache:c,ctx:f,appContext:y,propsOptions:v}},w){let a;return!!c[w]||n!==Di&&mi(n,w)||o!==Di&&mi(o,w)||(a=v[0])&&mi(a,w)||mi(f,w)||mi(yl,w)||mi(y.config.globalProperties,w)},defineProperty(n,o,c){return c.get!=null?n._.accessCache[o]=0:mi(c,"value")&&this.set(n,o,c.value,null),Reflect.defineProperty(n,o,c)}};Mv.ownKeys=n=>(Ge("Avoid app logic that relies on enumerating keys on a component instance. The keys will be empty in production mode to avoid performance overhead."),Reflect.ownKeys(n));function Pw(n){const o={};return Object.defineProperty(o,"_",{configurable:!0,enumerable:!1,get:()=>n}),Object.keys(yl).forEach(c=>{Object.defineProperty(o,c,{configurable:!0,enumerable:!1,get:()=>yl[c](n),set:mr})}),o}function Mw(n){const{ctx:o,propsOptions:[c]}=n;c&&Object.keys(c).forEach(f=>{Object.defineProperty(o,f,{enumerable:!0,configurable:!0,get:()=>n.props[f],set:mr})})}function zw(n){const{ctx:o,setupState:c}=n;Object.keys(ti(c)).forEach(f=>{if(!c.__isScriptSetup){if(Nf(f[0])){Ge(`setup() return property ${JSON.stringify(f)} should not start with "$" or "_" which are reserved prefixes for Vue internals.`);return}Object.defineProperty(o,f,{enumerable:!0,configurable:!0,get:()=>c[f],set:mr})}})}function Dw(){const n=Object.create(null);return(o,c)=>{n[c]?Ge(`${o} property "${c}" is already defined in ${n[c]}.`):n[c]=o}}let tf=!0;function Rw(n){const o=Vf(n),c=n.proxy,f=n.ctx;tf=!1,o.beforeCreate&&Yg(o.beforeCreate,n,"bc");const{data:y,computed:v,methods:w,watch:a,provide:k,inject:$,created:F,beforeMount:B,mounted:M,beforeUpdate:le,updated:Ee,activated:Oe,deactivated:Je,beforeDestroy:He,beforeUnmount:De,destroyed:tt,unmounted:Nt,render:Ce,renderTracked:Zt,renderTriggered:Xe,errorCaptured:ht,serverPrefetch:it,expose:Ue,inheritAttrs:ct,components:Re,directives:Rt,filters:ai}=o,yi=Dw();{const[St]=n.propsOptions;if(St)for(const Xt in St)yi("Props",Xt)}if($&&Lw($,f,yi,n.appContext.config.unwrapInjectedRef),w)for(const St in w){const Xt=w[St];Jt(Xt)?(Object.defineProperty(f,St,{value:Xt.bind(c),configurable:!0,enumerable:!0,writable:!0}),yi("Methods",St)):Ge(`Method "${St}" has type "${typeof Xt}" in the component definition. Did you reference the function correctly?`)}if(y){Jt(y)||Ge("The data option must be a function. Plain object usage is no longer supported.");const St=y.call(c,c);if(kf(St)&&Ge("data() returned a Promise - note data() cannot be async; If you intend to perform data fetching before component renders, use async setup() + <Suspense>."),!Li(St))Ge("data() should return an object.");else{n.data=Il(St);for(const Xt in St)yi("Data",Xt),Nf(Xt[0])||Object.defineProperty(f,Xt,{configurable:!0,enumerable:!0,get:()=>St[Xt],set:mr})}}if(tf=!0,v)for(const St in v){const Xt=v[St],Oi=Jt(Xt)?Xt.bind(c,c):Jt(Xt.get)?Xt.get.bind(c,c):mr;Oi===mr&&Ge(`Computed property "${St}" has no getter.`);const Ni=!Jt(Xt)&&Jt(Xt.set)?Xt.set.bind(c):()=>{Ge(`Write operation failed: computed property "${St}" is readonly.`)},In=Ut({get:Oi,set:Ni});Object.defineProperty(f,St,{enumerable:!0,configurable:!0,get:()=>In.value,set:Bn=>In.value=Bn}),yi("Computed",St)}if(a)for(const St in a)zv(a[St],f,c,St);if(k){const St=Jt(k)?k.call(c):k;Reflect.ownKeys(St).forEach(Xt=>{ml(Xt,St[Xt])})}F&&Yg(F,n,"c");function We(St,Xt){qt(Xt)?Xt.forEach(Oi=>St(Oi.bind(c))):Xt&&St(Xt.bind(c))}if(We(bw,B),We(Al,M),We(ww,le),We(Tw,Ee),We(yw,Oe),We(vw,Je),We(Aw,ht),We(Iw,Zt),We(Sw,Xe),We(Sv,De),We(ed,Nt),We(Ew,it),qt(Ue))if(Ue.length){const St=n.exposed||(n.exposed={});Ue.forEach(Xt=>{Object.defineProperty(St,Xt,{get:()=>c[Xt],set:Oi=>c[Xt]=Oi})})}else n.exposed||(n.exposed={});Ce&&n.render===mr&&(n.render=Ce),ct!=null&&(n.inheritAttrs=ct),Re&&(n.components=Re),Rt&&(n.directives=Rt)}function Lw(n,o,c=mr,f=!1){qt(n)&&(n=nf(n));for(const y in n){const v=n[y];let w;Li(v)?"default"in v?w=Jr(v.from||y,v.default,!0):w=Jr(v.from||y):w=Jr(v),Ji(w)?f?Object.defineProperty(o,y,{enumerable:!0,configurable:!0,get:()=>w.value,set:a=>w.value=a}):(Ge(`injected property "${y}" is a ref and will be auto-unwrapped and no longer needs \`.value\` in the next minor release. To opt-in to the new behavior now, set \`app.config.unwrapInjectedRef = true\` (this config is temporary and will not be needed in the future.)`),o[y]=w):o[y]=w,c("Inject",y)}}function Yg(n,o,c){Or(qt(n)?n.map(f=>f.bind(o.proxy)):n.bind(o.proxy),o,c)}function zv(n,o,c,f){const y=f.includes(".")?xv(c,f):()=>c[f];if(en(n)){const v=o[n];Jt(v)?lr(y,v):Ge(`Invalid watch handler specified by key "${n}"`,v)}else if(Jt(n))lr(y,n.bind(c));else if(Li(n))if(qt(n))n.forEach(v=>zv(v,o,c,f));else{const v=Jt(n.handler)?n.handler.bind(c):o[n.handler];Jt(v)?lr(y,v,n):Ge(`Invalid watch handler specified by key "${n.handler}"`,v)}else Ge(`Invalid watch option: "${f}"`,n)}function Vf(n){const o=n.type,{mixins:c,extends:f}=o,{mixins:y,optionsCache:v,config:{optionMergeStrategies:w}}=n.appContext,a=v.get(o);let k;return a?k=a:!y.length&&!c&&!f?k=o:(k={},y.length&&y.forEach($=>Uh(k,$,w,!0)),Uh(k,o,w)),Li(o)&&v.set(o,k),k}function Uh(n,o,c,f=!1){const{mixins:y,extends:v}=o;v&&Uh(n,v,c,!0),y&&y.forEach(w=>Uh(n,w,c,!0));for(const w in o)if(f&&w==="expose")Ge('"expose" option is ignored when declared in mixins or extends. It should only be declared in the base component itself.');else{const a=Ow[w]||c&&c[w];n[w]=a?a(n[w],o[w]):o[w]}return n}const Ow={data:Qg,props:sa,emits:sa,methods:sa,computed:sa,beforeCreate:sr,created:sr,beforeMount:sr,mounted:sr,beforeUpdate:sr,updated:sr,beforeDestroy:sr,beforeUnmount:sr,destroyed:sr,unmounted:sr,activated:sr,deactivated:sr,errorCaptured:sr,serverPrefetch:sr,components:sa,directives:sa,watch:Fw,provide:Qg,inject:Bw};function Qg(n,o){return o?n?function(){return an(Jt(n)?n.call(this,this):n,Jt(o)?o.call(this,this):o)}:o:n}function Bw(n,o){return sa(nf(n),nf(o))}function nf(n){if(qt(n)){const o={};for(let c=0;c<n.length;c++)o[n[c]]=n[c];return o}return n}function sr(n,o){return n?[...new Set([].concat(n,o))]:o}function sa(n,o){return n?an(an(Object.create(null),n),o):o}function Fw(n,o){if(!n)return o;if(!o)return n;const c=an(Object.create(null),n);for(const f in o)c[f]=sr(n[f],o[f]);return c}function $w(n,o,c,f=!1){const y={},v={};Dh(v,id,1),n.propsDefaults=Object.create(null),Dv(n,o,y,v);for(const w in n.propsOptions[0])w in y||(y[w]=void 0);Lv(o||{},y,n),c?n.props=f?y:R1(y):n.type.props?n.props=y:n.props=v,n.attrs=v}function Uw(n){for(;n;){if(n.type.__hmrId)return!0;n=n.parent}}function Nw(n,o,c,f){const{props:y,attrs:v,vnode:{patchFlag:w}}=n,a=ti(y),[k]=n.propsOptions;let $=!1;if(!Uw(n)&&(f||w>0)&&!(w&16)){if(w&8){const F=n.vnode.dynamicProps;for(let B=0;B<F.length;B++){let M=F[B];if(Yh(n.emitsOptions,M))continue;const le=o[M];if(k)if(mi(v,M))le!==v[M]&&(v[M]=le,$=!0);else{const Ee=ps(M);y[Ee]=rf(k,a,Ee,le,n,!1)}else le!==v[M]&&(v[M]=le,$=!0)}}}else{Dv(n,o,y,v)&&($=!0);let F;for(const B in a)(!o||!mi(o,B)&&((F=vo(B))===B||!mi(o,F)))&&(k?c&&(c[B]!==void 0||c[F]!==void 0)&&(y[B]=rf(k,a,B,void 0,n,!0)):delete y[B]);if(v!==a)for(const B in v)(!o||!mi(o,B)&&!0)&&(delete v[B],$=!0)}$&&Fs(n,"set","$attrs"),Lv(o||{},y,n)}function Dv(n,o,c,f){const[y,v]=n.propsOptions;let w=!1,a;if(o)for(let k in o){if(Th(k))continue;const $=o[k];let F;y&&mi(y,F=ps(k))?!v||!v.includes(F)?c[F]=$:(a||(a={}))[F]=$:Yh(n.emitsOptions,k)||(!(k in f)||$!==f[k])&&(f[k]=$,w=!0)}if(v){const k=ti(c),$=a||Di;for(let F=0;F<v.length;F++){const B=v[F];c[B]=rf(y,k,B,$[B],n,!mi($,B))}}return w}function rf(n,o,c,f,y,v){const w=n[c];if(w!=null){const a=mi(w,"default");if(a&&f===void 0){const k=w.default;if(w.type!==Function&&Jt(k)){const{propsDefaults:$}=y;c in $?f=$[c]:(xl(y),f=$[c]=k.call(null,o),ya())}else f=k}w[0]&&(v&&!a?f=!1:w[1]&&(f===""||f===vo(c))&&(f=!0))}return f}function Rv(n,o,c=!1){const f=o.propsCache,y=f.get(n);if(y)return y;const v=n.props,w={},a=[];let k=!1;if(!Jt(n)){const F=B=>{k=!0;const[M,le]=Rv(B,o,!0);an(w,M),le&&a.push(...le)};!c&&o.mixins.length&&o.mixins.forEach(F),n.extends&&F(n.extends),n.mixins&&n.mixins.forEach(F)}if(!v&&!k)return Li(n)&&f.set(n,pl),pl;if(qt(v))for(let F=0;F<v.length;F++){en(v[F])||Ge("props must be strings when using array syntax.",v[F]);const B=ps(v[F]);e_(B)&&(w[B]=Di)}else if(v){Li(v)||Ge("invalid props options",v);for(const F in v){const B=ps(F);if(e_(B)){const M=v[F],le=w[B]=qt(M)||Jt(M)?{type:M}:M;if(le){const Ee=i_(Boolean,le.type),Oe=i_(String,le.type);le[0]=Ee>-1,le[1]=Oe<0||Ee<Oe,(Ee>-1||mi(le,"default"))&&a.push(B)}}}}const $=[w,a];return Li(n)&&f.set(n,$),$}function e_(n){return n[0]!=="$"?!0:(Ge(`Invalid prop name: "${n}" is a reserved property.`),!1)}function sf(n){const o=n&&n.toString().match(/^\s*function (\w+)/);return o?o[1]:n===null?"null":""}function t_(n,o){return sf(n)===sf(o)}function i_(n,o){return qt(o)?o.findIndex(c=>t_(c,n)):Jt(o)&&t_(o,n)?0:-1}function Lv(n,o,c){const f=ti(o),y=c.propsOptions[0];for(const v in y){let w=y[v];w!=null&&Vw(v,f[v],w,!mi(n,v)&&!mi(n,vo(v)))}}function Vw(n,o,c,f){const{type:y,required:v,validator:w}=c;if(v&&f){Ge('Missing required prop: "'+n+'"');return}if(!(o==null&&!c.required)){if(y!=null&&y!==!0){let a=!1;const k=qt(y)?y:[y],$=[];for(let F=0;F<k.length&&!a;F++){const{valid:B,expectedType:M}=qw(o,k[F]);$.push(M||""),a=B}if(!a){Ge(Gw(n,o,$));return}}w&&!w(o)&&Ge('Invalid prop: custom validator check failed for prop "'+n+'".')}}const jw=To("String,Number,Boolean,Function,Symbol,BigInt");function qw(n,o){let c;const f=sf(o);if(jw(f)){const y=typeof n;c=y===f.toLowerCase(),!c&&y==="object"&&(c=n instanceof o)}else f==="Object"?c=Li(n):f==="Array"?c=qt(n):f==="null"?c=n===null:c=n instanceof o;return{valid:c,expectedType:f}}function Gw(n,o,c){let f=`Invalid prop: type check failed for prop "${n}". Expected ${c.map(va).join(" | ")}`;const y=c[0],v=Pf(o),w=n_(o,y),a=n_(o,v);return c.length===1&&r_(y)&&!Ww(y,v)&&(f+=` with value ${w}`),f+=`, got ${v} `,r_(v)&&(f+=`with value ${a}.`),f}function n_(n,o){return o==="String"?`"${n}"`:o==="Number"?`${Number(n)}`:`${n}`}function r_(n){return["string","number","boolean"].some(c=>n.toLowerCase()===c)}function Ww(...n){return n.some(o=>o.toLowerCase()==="boolean")}const Ov=n=>n[0]==="_"||n==="$stable",jf=n=>qt(n)?n.map(Xr):[Xr(n)],Zw=(n,o,c)=>{if(o._n)return o;const f=It((...y)=>(Sn&&Ge(`Slot "${n}" invoked outside of the render function: this will not track dependencies used in the slot. Invoke the slot function inside the render function instead.`),jf(o(...y))),c);return f._c=!1,f},Bv=(n,o,c)=>{const f=n._ctx;for(const y in n){if(Ov(y))continue;const v=n[y];if(Jt(v))o[y]=Zw(y,v,f);else if(v!=null){Ge(`Non-function value encountered for slot "${y}". Prefer function slots for better performance.`);const w=jf(v);o[y]=()=>w}}},Fv=(n,o)=>{nu(n.vnode)||Ge("Non-function value encountered for default slot. Prefer function slots for better performance.");const c=jf(o);n.slots.default=()=>c},Hw=(n,o)=>{if(n.vnode.shapeFlag&32){const c=o._;c?(n.slots=ti(o),Dh(o,"_",c)):Bv(o,n.slots={})}else n.slots={},o&&Fv(n,o);Dh(n.slots,id,1)},Xw=(n,o,c)=>{const{vnode:f,slots:y}=n;let v=!0,w=Di;if(f.shapeFlag&32){const a=o._;a?yo?an(y,o):c&&a===1?v=!1:(an(y,o),!c&&a===1&&delete y._):(v=!o.$stable,Bv(o,y)),w=o}else o&&(Fv(n,o),w={default:1});if(v)for(const a in y)!Ov(a)&&!(a in w)&&delete y[a]};function $v(){return{app:null,config:{isNativeTag:Dy,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Kw=0;function Jw(n,o){return function(f,y=null){Jt(f)||(f=Object.assign({},f)),y!=null&&!Li(y)&&(Ge("root props passed to app.mount() must be an object."),y=null);const v=$v(),w=new Set;let a=!1;const k=v.app={_uid:Kw++,_component:f,_props:y,_container:null,_context:v,_instance:null,version:l_,get config(){return v.config},set config($){Ge("app.config cannot be replaced. Modify individual options instead.")},use($,...F){return w.has($)?Ge("Plugin has already been applied to target app."):$&&Jt($.install)?(w.add($),$.install(k,...F)):Jt($)?(w.add($),$(k,...F)):Ge('A plugin must either be a function or an object with an "install" function.'),k},mixin($){return v.mixins.includes($)?Ge("Mixin has already been applied to target app"+($.name?`: ${$.name}`:"")):v.mixins.push($),k},component($,F){return lf($,v.config),F?(v.components[$]&&Ge(`Component "${$}" has already been registered in target app.`),v.components[$]=F,k):v.components[$]},directive($,F){return Iv($),F?(v.directives[$]&&Ge(`Directive "${$}" has already been registered in target app.`),v.directives[$]=F,k):v.directives[$]},mount($,F,B){if(a)Ge("App has already been mounted.\nIf you want to remount the same app, move your app creation logic into a factory function and create fresh app instances for each mount - e.g. `const createMyApp = () => createApp(App)`");else{$.__vue_app__&&Ge("There is already an app instance mounted on the host container.\n If you want to mount another app on the same host container, you need to unmount the previous app by calling `app.unmount()` first.");const M=lt(f,y);return M.appContext=v,v.reload=()=>{n(fs(M),$,B)},F&&o?o(M,$):n(M,$,B),a=!0,k._container=$,$.__vue_app__=k,k._instance=M.component,ew(k,l_),nd(M.component)||M.component.proxy}},unmount(){a?(n(null,k._container),k._instance=null,tw(k),delete k._container.__vue_app__):Ge("Cannot unmount an app that is not mounted.")},provide($,F){return $ in v.provides&&Ge(`App already provides property with key "${String($)}". It will be overwritten with the new value.`),v.provides[$]=F,k}};return k}}function of(n,o,c,f,y=!1){if(qt(n)){n.forEach((M,le)=>of(M,o&&(qt(o)?o[le]:o),c,f,y));return}if(Fc(f)&&!y)return;const v=f.shapeFlag&4?nd(f.component)||f.component.proxy:f.el,w=y?null:v,{i:a,r:k}=n;if(!a){Ge("Missing ref owner context. ref cannot be used on hoisted vnodes. A vnode with ref must be created inside the render function.");return}const $=o&&o.r,F=a.refs===Di?a.refs={}:a.refs,B=a.setupState;if($!=null&&$!==k&&(en($)?(F[$]=null,mi(B,$)&&(B[$]=null)):Ji($)&&($.value=null)),Jt(k))Bs(k,a,12,[w,F]);else{const M=en(k),le=Ji(k);if(M||le){const Ee=()=>{if(n.f){const Oe=M?F[k]:k.value;y?qt(Oe)&&Af(Oe,v):qt(Oe)?Oe.includes(v)||Oe.push(v):M?(F[k]=[v],mi(B,k)&&(B[k]=F[k])):(k.value=[v],n.k&&(F[n.k]=k.value))}else M?(F[k]=w,mi(B,k)&&(B[k]=w)):le?(k.value=w,n.k&&(F[n.k]=w)):Ge("Invalid template ref type:",k,`(${typeof k})`)};w?(Ee.id=-1,pr(Ee,c)):Ee()}else Ge("Invalid template ref type:",k,`(${typeof k})`)}}let kc,go;function Rs(n,o){n.appContext.config.performance&&Nh()&&go.mark(`vue-${o}-${n.uid}`),rw(n,o,Nh()?go.now():Date.now())}function Ls(n,o){if(n.appContext.config.performance&&Nh()){const c=`vue-${o}-${n.uid}`,f=c+":end";go.mark(f),go.measure(`<${rd(n,n.type)}> ${o}`,c,f),go.clearMarks(c),go.clearMarks(f)}sw(n,o,Nh()?go.now():Date.now())}function Nh(){return kc!==void 0||(typeof window<"u"&&window.performance?(kc=!0,go=window.performance):kc=!1),kc}function Yw(){const n=[];if(n.length){const o=n.length>1;console.warn(`Feature flag${o?"s":""} ${n.join(", ")} ${o?"are":"is"} not explicitly defined. You are running the esm-bundler build of Vue, which expects these compile-time feature flags to be globally injected via the bundler config in order to get better tree-shaking in the production bundle.

For more details, see https://link.vuejs.org/feature-flags.`)}}const pr=fw;function Qw(n){return e2(n)}function e2(n,o){Yw();const c=Fy();c.__VUE__=!0,pv(c.__VUE_DEVTOOLS_GLOBAL_HOOK__,c);const{insert:f,remove:y,patchProp:v,createElement:w,createText:a,createComment:k,setText:$,setElementText:F,parentNode:B,nextSibling:M,setScopeId:le=mr,cloneNode:Ee,insertStaticContent:Oe}=n,Je=(X,ie,be,ze=null,ke=null,Ie=null,Ke=!1,je=null,qe=yo?!1:!!ie.dynamicChildren)=>{if(X===ie)return;X&&!ca(X,ie)&&(ze=$t(X),pn(X,ke,Ie,!0),X=null),ie.patchFlag===-2&&(qe=!1,ie.dynamicChildren=null);const{type:Be,ref:bt,shapeFlag:yt}=ie;switch(Be){case td:He(X,ie,be,ze);break;case On:De(X,ie,be,ze);break;case Uc:X==null?tt(ie,be,ze,Ke):Nt(X,ie,be,Ke);break;case ui:ai(X,ie,be,ze,ke,Ie,Ke,je,qe);break;default:yt&1?Xe(X,ie,be,ze,ke,Ie,Ke,je,qe):yt&6?yi(X,ie,be,ze,ke,Ie,Ke,je,qe):yt&64||yt&128?Be.process(X,ie,be,ze,ke,Ie,Ke,je,qe,Gt):Ge("Invalid VNode type:",Be,`(${typeof Be})`)}bt!=null&&ke&&of(bt,X&&X.ref,Ie,ie||X,!ie)},He=(X,ie,be,ze)=>{if(X==null)f(ie.el=a(ie.children),be,ze);else{const ke=ie.el=X.el;ie.children!==X.children&&$(ke,ie.children)}},De=(X,ie,be,ze)=>{X==null?f(ie.el=k(ie.children||""),be,ze):ie.el=X.el},tt=(X,ie,be,ze)=>{[X.el,X.anchor]=Oe(X.children,ie,be,ze,X.el,X.anchor)},Nt=(X,ie,be,ze)=>{if(ie.children!==X.children){const ke=M(X.anchor);Zt(X),[ie.el,ie.anchor]=Oe(ie.children,be,ke,ze)}else ie.el=X.el,ie.anchor=X.anchor},Ce=({el:X,anchor:ie},be,ze)=>{let ke;for(;X&&X!==ie;)ke=M(X),f(X,be,ze),X=ke;f(ie,be,ze)},Zt=({el:X,anchor:ie})=>{let be;for(;X&&X!==ie;)be=M(X),y(X),X=be;y(ie)},Xe=(X,ie,be,ze,ke,Ie,Ke,je,qe)=>{Ke=Ke||ie.type==="svg",X==null?ht(ie,be,ze,ke,Ie,Ke,je,qe):ct(X,ie,ke,Ie,Ke,je,qe)},ht=(X,ie,be,ze,ke,Ie,Ke,je)=>{let qe,Be;const{type:bt,props:yt,shapeFlag:At,transition:Lt,patchFlag:he,dirs:Pe}=X;{if(qe=X.el=w(X.type,Ie,yt&&yt.is,yt),At&8?F(qe,X.children):At&16&&Ue(X.children,qe,null,ze,ke,Ie&&bt!=="foreignObject",Ke,je),Pe&&ea(X,null,ze,"created"),yt){for(const li in yt)li!=="value"&&!Th(li)&&v(qe,li,null,yt[li],Ie,X.children,ze,ke,ft);"value"in yt&&v(qe,"value",null,yt.value),(Be=yt.onVnodeBeforeMount)&&ls(Be,ze,X)}it(qe,X,X.scopeId,Ke,ze)}Object.defineProperty(qe,"__vnode",{value:X,enumerable:!1}),Object.defineProperty(qe,"__vueParentComponent",{value:ze,enumerable:!1}),Pe&&ea(X,null,ze,"beforeMount");const gi=(!ke||ke&&!ke.pendingBranch)&&Lt&&!Lt.persisted;gi&&Lt.beforeEnter(qe),f(qe,ie,be),((Be=yt&&yt.onVnodeMounted)||gi||Pe)&&pr(()=>{Be&&ls(Be,ze,X),gi&&Lt.enter(qe),Pe&&ea(X,null,ze,"mounted")},ke)},it=(X,ie,be,ze,ke)=>{if(be&&le(X,be),ze)for(let Ie=0;Ie<ze.length;Ie++)le(X,ze[Ie]);if(ke){let Ie=ke.subTree;if(Ie.patchFlag>0&&Ie.patchFlag&2048&&(Ie=yv(Ie.children)||Ie),ie===Ie){const Ke=ke.vnode;it(X,Ke,Ke.scopeId,Ke.slotScopeIds,ke.parent)}}},Ue=(X,ie,be,ze,ke,Ie,Ke,je,qe=0)=>{for(let Be=qe;Be<X.length;Be++){const bt=X[Be]=je?po(X[Be]):Xr(X[Be]);Je(null,bt,ie,be,ze,ke,Ie,Ke,je)}},ct=(X,ie,be,ze,ke,Ie,Ke)=>{const je=ie.el=X.el;let{patchFlag:qe,dynamicChildren:Be,dirs:bt}=ie;qe|=X.patchFlag&16;const yt=X.props||Di,At=ie.props||Di;let Lt;be&&ta(be,!1),(Lt=At.onVnodeBeforeUpdate)&&ls(Lt,be,ie,X),bt&&ea(ie,X,be,"beforeUpdate"),be&&ta(be,!0),yo&&(qe=0,Ke=!1,Be=null);const he=ke&&ie.type!=="foreignObject";if(Be?(Re(X.dynamicChildren,Be,je,be,ze,he,Ie),be&&be.type.__hmrId&&$c(X,ie)):Ke||Ni(X,ie,je,null,be,ze,he,Ie,!1),qe>0){if(qe&16)Rt(je,ie,yt,At,be,ze,ke);else if(qe&2&&yt.class!==At.class&&v(je,"class",null,At.class,ke),qe&4&&v(je,"style",yt.style,At.style,ke),qe&8){const Pe=ie.dynamicProps;for(let gi=0;gi<Pe.length;gi++){const li=Pe[gi],Ht=yt[li],ln=At[li];(ln!==Ht||li==="value")&&v(je,li,Ht,ln,ke,X.children,be,ze,ft)}}qe&1&&X.children!==ie.children&&F(je,ie.children)}else!Ke&&Be==null&&Rt(je,ie,yt,At,be,ze,ke);((Lt=At.onVnodeUpdated)||bt)&&pr(()=>{Lt&&ls(Lt,be,ie,X),bt&&ea(ie,X,be,"updated")},ze)},Re=(X,ie,be,ze,ke,Ie,Ke)=>{for(let je=0;je<ie.length;je++){const qe=X[je],Be=ie[je],bt=qe.el&&(qe.type===ui||!ca(qe,Be)||qe.shapeFlag&70)?B(qe.el):be;Je(qe,Be,bt,null,ze,ke,Ie,Ke,!0)}},Rt=(X,ie,be,ze,ke,Ie,Ke)=>{if(be!==ze){for(const je in ze){if(Th(je))continue;const qe=ze[je],Be=be[je];qe!==Be&&je!=="value"&&v(X,je,Be,qe,Ke,ie.children,ke,Ie,ft)}if(be!==Di)for(const je in be)!Th(je)&&!(je in ze)&&v(X,je,be[je],null,Ke,ie.children,ke,Ie,ft);"value"in ze&&v(X,"value",be.value,ze.value)}},ai=(X,ie,be,ze,ke,Ie,Ke,je,qe)=>{const Be=ie.el=X?X.el:a(""),bt=ie.anchor=X?X.anchor:a("");let{patchFlag:yt,dynamicChildren:At,slotScopeIds:Lt}=ie;(yo||yt&2048)&&(yt=0,qe=!1,At=null),Lt&&(je=je?je.concat(Lt):Lt),X==null?(f(Be,be,ze),f(bt,be,ze),Ue(ie.children,be,bt,ke,Ie,Ke,je,qe)):yt>0&&yt&64&&At&&X.dynamicChildren?(Re(X.dynamicChildren,At,be,ke,Ie,Ke,je),ke&&ke.type.__hmrId?$c(X,ie):(ie.key!=null||ke&&ie===ke.subTree)&&$c(X,ie,!0)):Ni(X,ie,be,bt,ke,Ie,Ke,je,qe)},yi=(X,ie,be,ze,ke,Ie,Ke,je,qe)=>{ie.slotScopeIds=je,X==null?ie.shapeFlag&512?ke.ctx.activate(ie,be,ze,Ke,qe):We(ie,be,ze,ke,Ie,Ke,qe):St(X,ie,qe)},We=(X,ie,be,ze,ke,Ie,Ke)=>{const je=X.component=p2(X,ze,ke);if(je.type.__hmrId&&K1(je),Eh(X),Rs(je,"mount"),nu(X)&&(je.ctx.renderer=Gt),Rs(je,"init"),m2(je),Ls(je,"init"),je.asyncDep){if(ke&&ke.registerDep(je,Xt),!X.el){const qe=je.subTree=lt(On);De(null,qe,ie,be)}return}Xt(je,X,ie,be,ke,Ie,Ke),Sh(),Ls(je,"mount")},St=(X,ie,be)=>{const ze=ie.component=X.component;if(hw(X,ie,be))if(ze.asyncDep&&!ze.asyncResolved){Eh(ie),Oi(ze,ie,be),Sh();return}else ze.next=ie,H1(ze.update),ze.update();else ie.el=X.el,ze.vnode=ie},Xt=(X,ie,be,ze,ke,Ie,Ke)=>{const je=()=>{if(X.isMounted){let{next:bt,bu:yt,u:At,parent:Lt,vnode:he}=X,Pe=bt,gi;Eh(bt||X.vnode),ta(X,!1),bt?(bt.el=he.el,Oi(X,bt,Ke)):bt=he,yt&&Cc(yt),(gi=bt.props&&bt.props.onVnodeBeforeUpdate)&&ls(gi,Lt,bt,he),ta(X,!0),Rs(X,"render");const li=xp(X);Ls(X,"render");const Ht=X.subTree;X.subTree=li,Rs(X,"patch"),Je(Ht,li,B(Ht.el),$t(Ht),X,ke,Ie),Ls(X,"patch"),bt.el=li.el,Pe===null&&dw(X,li.el),At&&pr(At,ke),(gi=bt.props&&bt.props.onVnodeUpdated)&&pr(()=>ls(gi,Lt,bt,he),ke),fv(X),Sh()}else{let bt;const{el:yt,props:At}=ie,{bm:Lt,m:he,parent:Pe}=X,gi=Fc(ie);if(ta(X,!1),Lt&&Cc(Lt),!gi&&(bt=At&&At.onVnodeBeforeMount)&&ls(bt,Pe,ie),ta(X,!0),yt&&ri){const li=()=>{Rs(X,"render"),X.subTree=xp(X),Ls(X,"render"),Rs(X,"hydrate"),ri(yt,X.subTree,X,ke,null),Ls(X,"hydrate")};gi?ie.type.__asyncLoader().then(()=>!X.isUnmounted&&li()):li()}else{Rs(X,"render");const li=X.subTree=xp(X);Ls(X,"render"),Rs(X,"patch"),Je(null,li,be,ze,X,ke,Ie),Ls(X,"patch"),ie.el=li.el}if(he&&pr(he,ke),!gi&&(bt=At&&At.onVnodeMounted)){const li=ie;pr(()=>ls(bt,Pe,li),ke)}(ie.shapeFlag&256||Pe&&Fc(Pe.vnode)&&Pe.vnode.shapeFlag&256)&&X.a&&pr(X.a,ke),X.isMounted=!0,iw(X),ie=be=ze=null}},qe=X.effect=new Df(je,()=>Jh(Be),X.scope),Be=X.update=()=>qe.run();Be.id=X.uid,ta(X,!0),qe.onTrack=X.rtc?bt=>Cc(X.rtc,bt):void 0,qe.onTrigger=X.rtg?bt=>Cc(X.rtg,bt):void 0,Be.ownerInstance=X,Be()},Oi=(X,ie,be)=>{ie.component=X;const ze=X.vnode.props;X.vnode=ie,X.next=null,Nw(X,ie.props,ze,be),Xw(X,ie.children,be),Ta(),Gg(),Ea()},Ni=(X,ie,be,ze,ke,Ie,Ke,je,qe=!1)=>{const Be=X&&X.children,bt=X?X.shapeFlag:0,yt=ie.children,{patchFlag:At,shapeFlag:Lt}=ie;if(At>0){if(At&128){Bn(Be,yt,be,ze,ke,Ie,Ke,je,qe);return}else if(At&256){In(Be,yt,be,ze,ke,Ie,Ke,je,qe);return}}Lt&8?(bt&16&&ft(Be,ke,Ie),yt!==Be&&F(be,yt)):bt&16?Lt&16?Bn(Be,yt,be,ze,ke,Ie,Ke,je,qe):ft(Be,ke,Ie,!0):(bt&8&&F(be,""),Lt&16&&Ue(yt,be,ze,ke,Ie,Ke,je,qe))},In=(X,ie,be,ze,ke,Ie,Ke,je,qe)=>{X=X||pl,ie=ie||pl;const Be=X.length,bt=ie.length,yt=Math.min(Be,bt);let At;for(At=0;At<yt;At++){const Lt=ie[At]=qe?po(ie[At]):Xr(ie[At]);Je(X[At],Lt,be,null,ke,Ie,Ke,je,qe)}Be>bt?ft(X,ke,Ie,!0,!1,yt):Ue(ie,be,ze,ke,Ie,Ke,je,qe,yt)},Bn=(X,ie,be,ze,ke,Ie,Ke,je,qe)=>{let Be=0;const bt=ie.length;let yt=X.length-1,At=bt-1;for(;Be<=yt&&Be<=At;){const Lt=X[Be],he=ie[Be]=qe?po(ie[Be]):Xr(ie[Be]);if(ca(Lt,he))Je(Lt,he,be,null,ke,Ie,Ke,je,qe);else break;Be++}for(;Be<=yt&&Be<=At;){const Lt=X[yt],he=ie[At]=qe?po(ie[At]):Xr(ie[At]);if(ca(Lt,he))Je(Lt,he,be,null,ke,Ie,Ke,je,qe);else break;yt--,At--}if(Be>yt){if(Be<=At){const Lt=At+1,he=Lt<bt?ie[Lt].el:ze;for(;Be<=At;)Je(null,ie[Be]=qe?po(ie[Be]):Xr(ie[Be]),be,he,ke,Ie,Ke,je,qe),Be++}}else if(Be>At)for(;Be<=yt;)pn(X[Be],ke,Ie,!0),Be++;else{const Lt=Be,he=Be,Pe=new Map;for(Be=he;Be<=At;Be++){const Ne=ie[Be]=qe?po(ie[Be]):Xr(ie[Be]);Ne.key!=null&&(Pe.has(Ne.key)&&Ge("Duplicate keys found during update:",JSON.stringify(Ne.key),"Make sure keys are unique."),Pe.set(Ne.key,Be))}let gi,li=0;const Ht=At-he+1;let ln=!1,An=0;const cn=new Array(Ht);for(Be=0;Be<Ht;Be++)cn[Be]=0;for(Be=Lt;Be<=yt;Be++){const Ne=X[Be];if(li>=Ht){pn(Ne,ke,Ie,!0);continue}let Ot;if(Ne.key!=null)Ot=Pe.get(Ne.key);else for(gi=he;gi<=At;gi++)if(cn[gi-he]===0&&ca(Ne,ie[gi])){Ot=gi;break}Ot===void 0?pn(Ne,ke,Ie,!0):(cn[Ot-he]=Be+1,Ot>=An?An=Ot:ln=!0,Je(Ne,ie[Ot],be,null,ke,Ie,Ke,je,qe),li++)}const _r=ln?t2(cn):pl;for(gi=_r.length-1,Be=Ht-1;Be>=0;Be--){const Ne=he+Be,Ot=ie[Ne],Vt=Ne+1<bt?ie[Ne+1].el:ze;cn[Be]===0?Je(null,Ot,be,Vt,ke,Ie,Ke,je,qe):ln&&(gi<0||Be!==_r[gi]?Fn(Ot,be,Vt,2):gi--)}}},Fn=(X,ie,be,ze,ke=null)=>{const{el:Ie,type:Ke,transition:je,children:qe,shapeFlag:Be}=X;if(Be&6){Fn(X.component.subTree,ie,be,ze);return}if(Be&128){X.suspense.move(ie,be,ze);return}if(Be&64){Ke.move(X,ie,be,Gt);return}if(Ke===ui){f(Ie,ie,be);for(let yt=0;yt<qe.length;yt++)Fn(qe[yt],ie,be,ze);f(X.anchor,ie,be);return}if(Ke===Uc){Ce(X,ie,be);return}if(ze!==2&&Be&1&&je)if(ze===0)je.beforeEnter(Ie),f(Ie,ie,be),pr(()=>je.enter(Ie),ke);else{const{leave:yt,delayLeave:At,afterLeave:Lt}=je,he=()=>f(Ie,ie,be),Pe=()=>{yt(Ie,()=>{he(),Lt&&Lt()})};At?At(Ie,he,Pe):Pe()}else f(Ie,ie,be)},pn=(X,ie,be,ze=!1,ke=!1)=>{const{type:Ie,props:Ke,ref:je,children:qe,dynamicChildren:Be,shapeFlag:bt,patchFlag:yt,dirs:At}=X;if(je!=null&&of(je,null,be,X,!0),bt&256){ie.ctx.deactivate(X);return}const Lt=bt&1&&At,he=!Fc(X);let Pe;if(he&&(Pe=Ke&&Ke.onVnodeBeforeUnmount)&&ls(Pe,ie,X),bt&6)ut(X.component,be,ze);else{if(bt&128){X.suspense.unmount(be,ze);return}Lt&&ea(X,null,ie,"beforeUnmount"),bt&64?X.type.remove(X,ie,be,ke,Gt,ze):Be&&(Ie!==ui||yt>0&&yt&64)?ft(Be,ie,be,!1,!0):(Ie===ui&&yt&384||!ke&&bt&16)&&ft(qe,ie,be),ze&&Te(X)}(he&&(Pe=Ke&&Ke.onVnodeUnmounted)||Lt)&&pr(()=>{Pe&&ls(Pe,ie,X),Lt&&ea(X,null,ie,"unmounted")},be)},Te=X=>{const{type:ie,el:be,anchor:ze,transition:ke}=X;if(ie===ui){X.patchFlag>0&&X.patchFlag&2048&&ke&&!ke.persisted?X.children.forEach(Ke=>{Ke.type===On?y(Ke.el):Te(Ke)}):gt(be,ze);return}if(ie===Uc){Zt(X);return}const Ie=()=>{y(be),ke&&!ke.persisted&&ke.afterLeave&&ke.afterLeave()};if(X.shapeFlag&1&&ke&&!ke.persisted){const{leave:Ke,delayLeave:je}=ke,qe=()=>Ke(be,Ie);je?je(X.el,Ie,qe):qe()}else Ie()},gt=(X,ie)=>{let be;for(;X!==ie;)be=M(X),y(X),X=be;y(ie)},ut=(X,ie,be)=>{X.type.__hmrId&&J1(X);const{bum:ze,scope:ke,update:Ie,subTree:Ke,um:je}=X;ze&&Cc(ze),ke.stop(),Ie&&(Ie.active=!1,pn(Ke,X,ie,be)),je&&pr(je,ie),pr(()=>{X.isUnmounted=!0},ie),ie&&ie.pendingBranch&&!ie.isUnmounted&&X.asyncDep&&!X.asyncResolved&&X.suspenseId===ie.pendingId&&(ie.deps--,ie.deps===0&&ie.resolve()),nw(X)},ft=(X,ie,be,ze=!1,ke=!1,Ie=0)=>{for(let Ke=Ie;Ke<X.length;Ke++)pn(X[Ke],ie,be,ze,ke)},$t=X=>X.shapeFlag&6?$t(X.component.subTree):X.shapeFlag&128?X.suspense.next():M(X.anchor||X.el),ki=(X,ie,be)=>{X==null?ie._vnode&&pn(ie._vnode,null,null,!0):Je(ie._vnode||null,X,ie,null,null,null,be),Gg(),uv(),ie._vnode=X},Gt={p:Je,um:pn,m:Fn,r:Te,mt:We,mc:Ue,pc:Ni,pbc:Re,n:$t,o:n};let Ft,ri;return o&&([Ft,ri]=o(Gt)),{render:ki,hydrate:Ft,createApp:Jw(ki,Ft)}}function ta({effect:n,update:o},c){n.allowRecurse=o.allowRecurse=c}function $c(n,o,c=!1){const f=n.children,y=o.children;if(qt(f)&&qt(y))for(let v=0;v<f.length;v++){const w=f[v];let a=y[v];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=y[v]=po(y[v]),a.el=w.el),c||$c(w,a)),a.type===On&&!a.el&&(a.el=w.el)}}function t2(n){const o=n.slice(),c=[0];let f,y,v,w,a;const k=n.length;for(f=0;f<k;f++){const $=n[f];if($!==0){if(y=c[c.length-1],n[y]<$){o[f]=y,c.push(f);continue}for(v=0,w=c.length-1;v<w;)a=v+w>>1,n[c[a]]<$?v=a+1:w=a;$<n[c[v]]&&(v>0&&(o[f]=c[v-1]),c[v]=f)}}for(v=c.length,w=c[v-1];v-- >0;)c[v]=w,w=o[w];return c}const i2=n=>n.__isTeleport,gl=n=>n&&(n.disabled||n.disabled===""),s_=n=>typeof SVGElement<"u"&&n instanceof SVGElement,af=(n,o)=>{const c=n&&n.to;if(en(c))if(o){const f=o(c);return f||Ge(`Failed to locate Teleport target with selector "${c}". Note the target element must exist before the component is mounted - i.e. the target cannot be rendered by the component itself, and ideally should be outside of the entire Vue component tree.`),f}else return Ge("Current renderer does not support string target for Teleports. (missing querySelector renderer option)"),null;else return!c&&!gl(n)&&Ge(`Invalid Teleport target: ${c}`),c},n2={__isTeleport:!0,process(n,o,c,f,y,v,w,a,k,$){const{mc:F,pc:B,pbc:M,o:{insert:le,querySelector:Ee,createText:Oe,createComment:Je}}=$,He=gl(o.props);let{shapeFlag:De,children:tt,dynamicChildren:Nt}=o;if(yo&&(k=!1,Nt=null),n==null){const Ce=o.el=Je("teleport start"),Zt=o.anchor=Je("teleport end");le(Ce,c,f),le(Zt,c,f);const Xe=o.target=af(o.props,Ee),ht=o.targetAnchor=Oe("");Xe?(le(ht,Xe),w=w||s_(Xe)):He||Ge("Invalid Teleport target on mount:",Xe,`(${typeof Xe})`);const it=(Ue,ct)=>{De&16&&F(tt,Ue,ct,y,v,w,a,k)};He?it(c,Zt):Xe&&it(Xe,ht)}else{o.el=n.el;const Ce=o.anchor=n.anchor,Zt=o.target=n.target,Xe=o.targetAnchor=n.targetAnchor,ht=gl(n.props),it=ht?c:Zt,Ue=ht?Ce:Xe;if(w=w||s_(Zt),Nt?(M(n.dynamicChildren,Nt,it,y,v,w,a),$c(n,o,!0)):k||B(n,o,it,Ue,y,v,w,a,!1),He)ht||vh(o,c,Ce,$,1);else if((o.props&&o.props.to)!==(n.props&&n.props.to)){const ct=o.target=af(o.props,Ee);ct?vh(o,ct,null,$,0):Ge("Invalid Teleport target on update:",Zt,`(${typeof Zt})`)}else ht&&vh(o,Zt,Xe,$,1)}},remove(n,o,c,f,{um:y,o:{remove:v}},w){const{shapeFlag:a,children:k,anchor:$,targetAnchor:F,target:B,props:M}=n;if(B&&v(F),(w||!gl(M))&&(v($),a&16))for(let le=0;le<k.length;le++){const Ee=k[le];y(Ee,o,c,!0,!!Ee.dynamicChildren)}},move:vh,hydrate:r2};function vh(n,o,c,{o:{insert:f},m:y},v=2){v===0&&f(n.targetAnchor,o,c);const{el:w,anchor:a,shapeFlag:k,children:$,props:F}=n,B=v===2;if(B&&f(w,o,c),(!B||gl(F))&&k&16)for(let M=0;M<$.length;M++)y($[M],o,c,2);B&&f(a,o,c)}function r2(n,o,c,f,y,v,{o:{nextSibling:w,parentNode:a,querySelector:k}},$){const F=o.target=af(o.props,k);if(F){const B=F._lpa||F.firstChild;if(o.shapeFlag&16)if(gl(o.props))o.anchor=$(w(n),o,a(n),c,f,y,v),o.targetAnchor=B;else{o.anchor=w(n);let M=B;for(;M;)if(M=w(M),M&&M.nodeType===8&&M.data==="teleport anchor"){o.targetAnchor=M,F._lpa=o.targetAnchor&&w(o.targetAnchor);break}$(B,o,F,c,f,y,v)}}return o.anchor&&w(o.anchor)}const s2=n2,ui=Symbol("Fragment"),td=Symbol("Text"),On=Symbol("Comment"),Uc=Symbol("Static"),Nc=[];let Kr=null;function ve(n=!1){Nc.push(Kr=n?null:[])}function o2(){Nc.pop(),Kr=Nc[Nc.length-1]||null}let Xc=1;function o_(n){Xc+=n}function Uv(n){return n.dynamicChildren=Xc>0?Kr||pl:null,o2(),Xc>0&&Kr&&Kr.push(n),n}function $e(n,o,c,f,y,v){return Uv(_t(n,o,c,f,y,v,!0))}function hi(n,o,c,f,y){return Uv(lt(n,o,c,f,y,!0))}function vl(n){return n?n.__v_isVNode===!0:!1}function ca(n,o){return o.shapeFlag&6&&ul.has(o.type)?!1:n.type===o.type&&n.key===o.key}const a2=(...n)=>l2(...n),id="__vInternal",Nv=({key:n})=>n!=null?n:null,Ih=({ref:n,ref_key:o,ref_for:c})=>n!=null?en(n)||Ji(n)||Jt(n)?{i:Ln,r:n,k:o,f:!!c}:n:null;function _t(n,o=null,c=null,f=0,y=null,v=n===ui?0:1,w=!1,a=!1){const k={__v_isVNode:!0,__v_skip:!0,type:n,props:o,key:o&&Nv(o),ref:o&&Ih(o),scopeId:_v,slotScopeIds:null,children:c,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:v,patchFlag:f,dynamicProps:y,dynamicChildren:null,appContext:null};return a?(qf(k,c),v&128&&n.normalize(k)):c&&(k.shapeFlag|=en(c)?8:16),k.key!==k.key&&Ge("VNode created with invalid key (NaN). VNode type:",k.type),Xc>0&&!w&&Kr&&(k.patchFlag>0||v&6)&&k.patchFlag!==32&&Kr.push(k),k}const lt=a2;function l2(n,o=null,c=null,f=0,y=null,v=!1){if((!n||n===Cv)&&(n||Ge(`Invalid vnode type when creating vnode: ${n}.`),n=On),vl(n)){const a=fs(n,o,!0);return c&&qf(a,c),Xc>0&&!v&&Kr&&(a.shapeFlag&6?Kr[Kr.indexOf(n)]=a:Kr.push(a)),a.patchFlag|=-2,a}if(Wv(n)&&(n=n.__vccOpts),o){o=c2(o);let{class:a,style:k}=o;a&&!en(a)&&(o.class=ar(a)),Li(k)&&(Oh(k)&&!qt(k)&&(k=an({},k)),o.style=If(k))}const w=en(n)?1:pw(n)?128:i2(n)?64:Li(n)?4:Jt(n)?2:0;return w&4&&Oh(n)&&(n=ti(n),Ge("Vue received a Component which was made a reactive object. This can lead to unnecessary performance overhead, and should be avoided by marking the component with `markRaw` or using `shallowRef` instead of `ref`.",`
Component that was made reactive: `,n)),_t(n,o,c,f,y,w,v,!0)}function c2(n){return n?Oh(n)||id in n?an({},n):n:null}function fs(n,o,c=!1){const{props:f,ref:y,patchFlag:v,children:w}=n,a=o?ru(f||{},o):f;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:a,key:a&&Nv(a),ref:o&&o.ref?c&&y?qt(y)?y.concat(Ih(o)):[y,Ih(o)]:Ih(o):y,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:v===-1&&qt(w)?w.map(Vv):w,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:o&&n.type!==ui?v===-1?16:v|16:v,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&fs(n.ssContent),ssFallback:n.ssFallback&&fs(n.ssFallback),el:n.el,anchor:n.anchor}}function Vv(n){const o=fs(n);return qt(n.children)&&(o.children=n.children.map(Vv)),o}function _i(n=" ",o=0){return lt(td,null,n,o)}function u2(n,o){const c=lt(Uc,null,n);return c.staticCount=o,c}function bi(n="",o=!1){return o?(ve(),hi(On,null,n)):lt(On,null,n)}function Xr(n){return n==null||typeof n=="boolean"?lt(On):qt(n)?lt(ui,null,n.slice()):typeof n=="object"?po(n):lt(td,null,String(n))}function po(n){return n.el===null||n.memo?n:fs(n)}function qf(n,o){let c=0;const{shapeFlag:f}=n;if(o==null)o=null;else if(qt(o))c=16;else if(typeof o=="object")if(f&65){const y=o.default;y&&(y._c&&(y._d=!1),qf(n,y()),y._c&&(y._d=!0));return}else{c=32;const y=o._;!y&&!(id in o)?o._ctx=Ln:y===3&&Ln&&(Ln.slots._===1?o._=1:(o._=2,n.patchFlag|=1024))}else Jt(o)?(o={default:o,_ctx:Ln},c=32):(o=String(o),f&64?(c=16,o=[_i(o)]):c=8);n.children=o,n.shapeFlag|=c}function ru(...n){const o={};for(let c=0;c<n.length;c++){const f=n[c];for(const y in f)if(y==="class")o.class!==f.class&&(o.class=ar([o.class,f.class]));else if(y==="style")o.style=If([o.style,f.style]);else if(tu(y)){const v=o[y],w=f[y];w&&v!==w&&!(qt(v)&&v.includes(w))&&(o[y]=v?[].concat(v,w):w)}else y!==""&&(o[y]=f[y])}return o}function ls(n,o,c,f=null){Or(n,o,7,[c,f])}const h2=$v();let d2=0;function p2(n,o,c){const f=n.type,y=(o?o.appContext:n.appContext)||h2,v={uid:d2++,vnode:n,type:f,parent:o,appContext:y,root:null,next:null,subTree:null,effect:null,update:null,scope:new $y(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:o?o.provides:Object.create(y.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Rv(f,y),emitsOptions:gv(f,y),emit:null,emitted:null,propsDefaults:Di,inheritAttrs:f.inheritAttrs,ctx:Di,data:Di,props:Di,attrs:Di,slots:Di,refs:Di,setupState:Di,setupContext:null,suspense:c,suspenseId:c?c.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return v.ctx=Pw(v),v.root=o?o.root:v,v.emit=aw.bind(null,v),n.ce&&n.ce(v),v}let Sn=null;const Cl=()=>Sn||Ln,xl=n=>{Sn=n,n.scope.on()},ya=()=>{Sn&&Sn.scope.off(),Sn=null},f2=To("slot,component");function lf(n,o){const c=o.isNativeTag||Dy;(f2(n)||c(n))&&Ge("Do not use built-in or reserved HTML elements as component id: "+n)}function jv(n){return n.vnode.shapeFlag&4}let Kc=!1;function m2(n,o=!1){Kc=o;const{props:c,children:f}=n.vnode,y=jv(n);$w(n,c,y,o),Hw(n,f);const v=y?g2(n,o):void 0;return Kc=!1,v}function g2(n,o){var c;const f=n.type;{if(f.name&&lf(f.name,n.appContext.config),f.components){const v=Object.keys(f.components);for(let w=0;w<v.length;w++)lf(v[w],n.appContext.config)}if(f.directives){const v=Object.keys(f.directives);for(let w=0;w<v.length;w++)Iv(v[w])}f.compilerOptions&&qv()&&Ge('"compilerOptions" is only supported when using a build of Vue that includes the runtime compiler. Since you are using a runtime-only build, the options should be passed via your build tool config instead.')}n.accessCache=Object.create(null),n.proxy=Hr(new Proxy(n.ctx,Mv)),Mw(n);const{setup:y}=f;if(y){const v=n.setupContext=y.length>1?y2(n):null;xl(n),Ta();const w=Bs(y,n,0,[hl(n.props),v]);if(Ea(),ya(),kf(w)){if(w.then(ya,ya),o)return w.then(a=>{a_(n,a,o)}).catch(a=>{Kh(a,n,0)});if(n.asyncDep=w,!n.suspense){const a=(c=f.name)!==null&&c!==void 0?c:"Anonymous";Ge(`Component <${a}>: setup function returned a promise, but no <Suspense> boundary was found in the parent component tree. A component with async setup() must be nested in a <Suspense> in order to be rendered.`)}}else a_(n,w,o)}else Gv(n,o)}function a_(n,o,c){Jt(o)?n.type.__ssrInlineRender?n.ssrRender=o:n.render=o:Li(o)?(vl(o)&&Ge("setup() should not return VNodes directly - return a render function instead."),n.devtoolsRawSetupState=o,n.setupState=rv(o),zw(n)):o!==void 0&&Ge(`setup() should return an object. Received: ${o===null?"null":typeof o}`),Gv(n,c)}let cf;const qv=()=>!cf;function Gv(n,o,c){const f=n.type;if(!n.render){if(!o&&cf&&!f.render){const y=f.template||Vf(n).template;if(y){Rs(n,"compile");const{isCustomElement:v,compilerOptions:w}=n.appContext.config,{delimiters:a,compilerOptions:k}=f,$=an(an({isCustomElement:v,delimiters:a},w),k);f.render=cf(y,$),Ls(n,"compile")}}n.render=f.render||mr}xl(n),Ta(),Rw(n),Ea(),ya(),!f.render&&n.render===mr&&!o&&(f.template?Ge('Component provided template option but runtime compilation is not supported in this build of Vue. Configure your bundler to alias "vue" to "vue/dist/vue.esm-bundler.js".'):Ge("Component is missing template or render function."))}function _2(n){return new Proxy(n.attrs,{get(o,c){return Fh(),Ir(n,"get","$attrs"),o[c]},set(){return Ge("setupContext.attrs is readonly."),!1},deleteProperty(){return Ge("setupContext.attrs is readonly."),!1}})}function y2(n){const o=f=>{n.exposed&&Ge("expose() should be called only once per setup()."),n.exposed=f||{}};let c;return Object.freeze({get attrs(){return c||(c=_2(n))},get slots(){return hl(n.slots)},get emit(){return(f,...y)=>n.emit(f,...y)},expose:o})}function nd(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(rv(Hr(n.exposed)),{get(o,c){if(c in o)return o[c];if(c in yl)return yl[c](n)}}))}const v2=/(?:^|[-_])(\w)/g,x2=n=>n.replace(v2,o=>o.toUpperCase()).replace(/[-_]/g,"");function Gf(n,o=!0){return Jt(n)?n.displayName||n.name:n.name||o&&n.__name}function rd(n,o,c=!1){let f=Gf(o);if(!f&&o.__file){const y=o.__file.match(/([^/\\]+)\.\w+$/);y&&(f=y[1])}if(!f&&n&&n.parent){const y=v=>{for(const w in v)if(v[w]===o)return w};f=y(n.components||n.parent.type.components)||y(n.appContext.components)}return f?x2(f):c?"App":"Anonymous"}function Wv(n){return Jt(n)&&"__vccOpts"in n}const Ut=(n,o)=>U1(n,o,Kc);function Wf(n,o,c){const f=arguments.length;return f===2?Li(o)&&!qt(o)?vl(o)?lt(n,null,[o]):lt(n,o):lt(n,null,o):(f>3?c=Array.prototype.slice.call(arguments,2):f===3&&vl(c)&&(c=[c]),lt(n,o,c))}function wp(n){return!!(n&&n.__v_isShallow)}function b2(){if(typeof window>"u")return;const n={style:"color:#3ba776"},o={style:"color:#0b1bc9"},c={style:"color:#b62e24"},f={style:"color:#9d288c"},y={header(B){return Li(B)?B.__isVue?["div",n,"VueInstance"]:Ji(B)?["div",{},["span",n,F(B)],"<",a(B.value),">"]:hs(B)?["div",{},["span",n,wp(B)?"ShallowReactive":"Reactive"],"<",a(B),`>${bo(B)?" (readonly)":""}`]:bo(B)?["div",{},["span",n,wp(B)?"ShallowReadonly":"Readonly"],"<",a(B),">"]:null:null},hasBody(B){return B&&B.__isVue},body(B){if(B&&B.__isVue)return["div",{},...v(B.$)]}};function v(B){const M=[];B.type.props&&B.props&&M.push(w("props",ti(B.props))),B.setupState!==Di&&M.push(w("setup",B.setupState)),B.data!==Di&&M.push(w("data",ti(B.data)));const le=k(B,"computed");le&&M.push(w("computed",le));const Ee=k(B,"inject");return Ee&&M.push(w("injected",Ee)),M.push(["div",{},["span",{style:f.style+";opacity:0.66"},"$ (internal): "],["object",{object:B}]]),M}function w(B,M){return M=an({},M),Object.keys(M).length?["div",{style:"line-height:1.25em;margin-bottom:0.6em"},["div",{style:"color:#476582"},B],["div",{style:"padding-left:1.25em"},...Object.keys(M).map(le=>["div",{},["span",f,le+": "],a(M[le],!1)])]]:["span",{}]}function a(B,M=!0){return typeof B=="number"?["span",o,B]:typeof B=="string"?["span",c,JSON.stringify(B)]:typeof B=="boolean"?["span",f,B]:Li(B)?["object",{object:M?ti(B):B}]:["span",c,String(B)]}function k(B,M){const le=B.type;if(Jt(le))return;const Ee={};for(const Oe in B.ctx)$(le,Oe,M)&&(Ee[Oe]=B.ctx[Oe]);return Ee}function $(B,M,le){const Ee=B[le];if(qt(Ee)&&Ee.includes(M)||Li(Ee)&&M in Ee||B.extends&&$(B.extends,M,le)||B.mixins&&B.mixins.some(Oe=>$(Oe,M,le)))return!0}function F(B){return wp(B)?"ShallowRef":B.effect?"ComputedRef":"Ref"}window.devtoolsFormatters?window.devtoolsFormatters.push(y):window.devtoolsFormatters=[y]}const l_="3.2.39",w2="http://www.w3.org/2000/svg",ua=typeof document<"u"?document:null,c_=ua&&ua.createElement("template"),T2={insert:(n,o,c)=>{o.insertBefore(n,c||null)},remove:n=>{const o=n.parentNode;o&&o.removeChild(n)},createElement:(n,o,c,f)=>{const y=o?ua.createElementNS(w2,n):ua.createElement(n,c?{is:c}:void 0);return n==="select"&&f&&f.multiple!=null&&y.setAttribute("multiple",f.multiple),y},createText:n=>ua.createTextNode(n),createComment:n=>ua.createComment(n),setText:(n,o)=>{n.nodeValue=o},setElementText:(n,o)=>{n.textContent=o},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>ua.querySelector(n),setScopeId(n,o){n.setAttribute(o,"")},cloneNode(n){const o=n.cloneNode(!0);return"_value"in n&&(o._value=n._value),o},insertStaticContent(n,o,c,f,y,v){const w=c?c.previousSibling:o.lastChild;if(y&&(y===v||y.nextSibling))for(;o.insertBefore(y.cloneNode(!0),c),!(y===v||!(y=y.nextSibling)););else{c_.innerHTML=f?`<svg>${n}</svg>`:n;const a=c_.content;if(f){const k=a.firstChild;for(;k.firstChild;)a.appendChild(k.firstChild);a.removeChild(k)}o.insertBefore(a,c)}return[w?w.nextSibling:o.firstChild,c?c.previousSibling:o.lastChild]}};function E2(n,o,c){const f=n._vtc;f&&(o=(o?[o,...f]:[...f]).join(" ")),o==null?n.removeAttribute("class"):c?n.setAttribute("class",o):n.className=o}function S2(n,o,c){const f=n.style,y=en(c);if(c&&!y){for(const v in c)uf(f,v,c[v]);if(o&&!en(o))for(const v in o)c[v]==null&&uf(f,v,"")}else{const v=f.display;y?o!==c&&(f.cssText=c):o&&n.removeAttribute("style"),"_vod"in n&&(f.display=v)}}const u_=/\s*!important$/;function uf(n,o,c){if(qt(c))c.forEach(f=>uf(n,o,f));else if(c==null&&(c=""),o.startsWith("--"))n.setProperty(o,c);else{const f=I2(n,o);u_.test(c)?n.setProperty(vo(f),c.replace(u_,""),"important"):n[f]=c}}const h_=["Webkit","Moz","ms"],Tp={};function I2(n,o){const c=Tp[o];if(c)return c;let f=ps(o);if(f!=="filter"&&f in n)return Tp[o]=f;f=va(f);for(let y=0;y<h_.length;y++){const v=h_[y]+f;if(v in n)return Tp[o]=v}return o}const d_="http://www.w3.org/1999/xlink";function A2(n,o,c,f,y){if(f&&o.startsWith("xlink:"))c==null?n.removeAttributeNS(d_,o.slice(6,o.length)):n.setAttributeNS(d_,o,c);else{const v=Wb(o);c==null||v&&!My(c)?n.removeAttribute(o):n.setAttribute(o,v?"":c)}}function C2(n,o,c,f,y,v,w){if(o==="innerHTML"||o==="textContent"){f&&w(f,y,v),n[o]=c==null?"":c;return}if(o==="value"&&n.tagName!=="PROGRESS"&&!n.tagName.includes("-")){n._value=c;const k=c==null?"":c;(n.value!==k||n.tagName==="OPTION")&&(n.value=k),c==null&&n.removeAttribute(o);return}let a=!1;if(c===""||c==null){const k=typeof n[o];k==="boolean"?c=My(c):c==null&&k==="string"?(c="",a=!0):k==="number"&&(c=0,a=!0)}try{n[o]=c}catch(k){Ge(`Failed setting prop "${o}" on <${n.tagName.toLowerCase()}>: value ${c} is invalid.`,k)}a&&n.removeAttribute(o)}const[Zv,k2]=(()=>{let n=Date.now,o=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(n=performance.now.bind(performance));const c=navigator.userAgent.match(/firefox\/(\d+)/i);o=!!(c&&Number(c[1])<=53)}return[n,o]})();let hf=0;const P2=Promise.resolve(),M2=()=>{hf=0},z2=()=>hf||(P2.then(M2),hf=Zv());function D2(n,o,c,f){n.addEventListener(o,c,f)}function R2(n,o,c,f){n.removeEventListener(o,c,f)}function L2(n,o,c,f,y=null){const v=n._vei||(n._vei={}),w=v[o];if(f&&w)w.value=f;else{const[a,k]=O2(o);if(f){const $=v[o]=B2(f,y);D2(n,a,$,k)}else w&&(R2(n,a,w,k),v[o]=void 0)}}const p_=/(?:Once|Passive|Capture)$/;function O2(n){let o;if(p_.test(n)){o={};let f;for(;f=n.match(p_);)n=n.slice(0,n.length-f[0].length),o[f[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):vo(n.slice(2)),o]}function B2(n,o){const c=f=>{const y=f.timeStamp||Zv();(k2||y>=c.attached-1)&&Or(F2(f,c.value),o,5,[f])};return c.value=n,c.attached=z2(),c}function F2(n,o){if(qt(o)){const c=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{c.call(n),n._stopped=!0},o.map(f=>y=>!y._stopped&&f&&f(y))}else return o}const f_=/^on[a-z]/,$2=(n,o,c,f,y=!1,v,w,a,k)=>{o==="class"?E2(n,f,y):o==="style"?S2(n,c,f):tu(o)?zh(o)||L2(n,o,c,f,w):(o[0]==="."?(o=o.slice(1),!0):o[0]==="^"?(o=o.slice(1),!1):U2(n,o,f,y))?C2(n,o,f,v,w,a,k):(o==="true-value"?n._trueValue=f:o==="false-value"&&(n._falseValue=f),A2(n,o,f,y))};function U2(n,o,c,f){return f?!!(o==="innerHTML"||o==="textContent"||o in n&&f_.test(o)&&Jt(c)):o==="spellcheck"||o==="draggable"||o==="translate"||o==="form"||o==="list"&&n.tagName==="INPUT"||o==="type"&&n.tagName==="TEXTAREA"||f_.test(o)&&en(c)?!1:o in n}const lo="transition",Pc="animation",Zf=(n,{slots:o})=>Wf(bv,N2(n),o);Zf.displayName="Transition";const Hv={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Zf.props=an({},bv.props,Hv);const ia=(n,o=[])=>{qt(n)?n.forEach(c=>c(...o)):n&&n(...o)},m_=n=>n?qt(n)?n.some(o=>o.length>1):n.length>1:!1;function N2(n){const o={};for(const Re in n)Re in Hv||(o[Re]=n[Re]);if(n.css===!1)return o;const{name:c="v",type:f,duration:y,enterFromClass:v=`${c}-enter-from`,enterActiveClass:w=`${c}-enter-active`,enterToClass:a=`${c}-enter-to`,appearFromClass:k=v,appearActiveClass:$=w,appearToClass:F=a,leaveFromClass:B=`${c}-leave-from`,leaveActiveClass:M=`${c}-leave-active`,leaveToClass:le=`${c}-leave-to`}=n,Ee=V2(y),Oe=Ee&&Ee[0],Je=Ee&&Ee[1],{onBeforeEnter:He,onEnter:De,onEnterCancelled:tt,onLeave:Nt,onLeaveCancelled:Ce,onBeforeAppear:Zt=He,onAppear:Xe=De,onAppearCancelled:ht=tt}=o,it=(Re,Rt,ai)=>{na(Re,Rt?F:a),na(Re,Rt?$:w),ai&&ai()},Ue=(Re,Rt)=>{Re._isLeaving=!1,na(Re,B),na(Re,le),na(Re,M),Rt&&Rt()},ct=Re=>(Rt,ai)=>{const yi=Re?Xe:De,We=()=>it(Rt,Re,ai);ia(yi,[Rt,We]),g_(()=>{na(Rt,Re?k:v),co(Rt,Re?F:a),m_(yi)||__(Rt,f,Oe,We)})};return an(o,{onBeforeEnter(Re){ia(He,[Re]),co(Re,v),co(Re,w)},onBeforeAppear(Re){ia(Zt,[Re]),co(Re,k),co(Re,$)},onEnter:ct(!1),onAppear:ct(!0),onLeave(Re,Rt){Re._isLeaving=!0;const ai=()=>Ue(Re,Rt);co(Re,B),W2(),co(Re,M),g_(()=>{!Re._isLeaving||(na(Re,B),co(Re,le),m_(Nt)||__(Re,f,Je,ai))}),ia(Nt,[Re,ai])},onEnterCancelled(Re){it(Re,!1),ia(tt,[Re])},onAppearCancelled(Re){it(Re,!0),ia(ht,[Re])},onLeaveCancelled(Re){Ue(Re),ia(Ce,[Re])}})}function V2(n){if(n==null)return null;if(Li(n))return[Ep(n.enter),Ep(n.leave)];{const o=Ep(n);return[o,o]}}function Ep(n){const o=By(n);return j2(o),o}function j2(n){typeof n!="number"?Ge(`<transition> explicit duration is not a valid number - got ${JSON.stringify(n)}.`):isNaN(n)&&Ge("<transition> explicit duration is NaN - the duration expression might be incorrect.")}function co(n,o){o.split(/\s+/).forEach(c=>c&&n.classList.add(c)),(n._vtc||(n._vtc=new Set)).add(o)}function na(n,o){o.split(/\s+/).forEach(f=>f&&n.classList.remove(f));const{_vtc:c}=n;c&&(c.delete(o),c.size||(n._vtc=void 0))}function g_(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let q2=0;function __(n,o,c,f){const y=n._endId=++q2,v=()=>{y===n._endId&&f()};if(c)return setTimeout(v,c);const{type:w,timeout:a,propCount:k}=G2(n,o);if(!w)return f();const $=w+"end";let F=0;const B=()=>{n.removeEventListener($,M),v()},M=le=>{le.target===n&&++F>=k&&B()};setTimeout(()=>{F<k&&B()},a+1),n.addEventListener($,M)}function G2(n,o){const c=window.getComputedStyle(n),f=Ee=>(c[Ee]||"").split(", "),y=f(lo+"Delay"),v=f(lo+"Duration"),w=y_(y,v),a=f(Pc+"Delay"),k=f(Pc+"Duration"),$=y_(a,k);let F=null,B=0,M=0;o===lo?w>0&&(F=lo,B=w,M=v.length):o===Pc?$>0&&(F=Pc,B=$,M=k.length):(B=Math.max(w,$),F=B>0?w>$?lo:Pc:null,M=F?F===lo?v.length:k.length:0);const le=F===lo&&/\b(transform|all)(,|$)/.test(c[lo+"Property"]);return{type:F,timeout:B,propCount:M,hasTransform:le}}function y_(n,o){for(;n.length<o.length;)n=n.concat(n);return Math.max(...o.map((c,f)=>v_(c)+v_(n[f])))}function v_(n){return Number(n.slice(0,-1).replace(",","."))*1e3}function W2(){return document.body.offsetHeight}const Z2=["ctrl","shift","alt","meta"],H2={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,o)=>Z2.some(c=>n[`${c}Key`]&&!o.includes(c))},X2=(n,o)=>(c,...f)=>{for(let y=0;y<o.length;y++){const v=H2[o[y]];if(v&&v(c,o))return}return n(c,...f)},K2={beforeMount(n,{value:o},{transition:c}){n._vod=n.style.display==="none"?"":n.style.display,c&&o?c.beforeEnter(n):Mc(n,o)},mounted(n,{value:o},{transition:c}){c&&o&&c.enter(n)},updated(n,{value:o,oldValue:c},{transition:f}){!o!=!c&&(f?o?(f.beforeEnter(n),Mc(n,!0),f.enter(n)):f.leave(n,()=>{Mc(n,!1)}):Mc(n,o))},beforeUnmount(n,{value:o}){Mc(n,o)}};function Mc(n,o){n.style.display=o?n._vod:"none"}const J2=an({patchProp:$2},T2);let x_;function Y2(){return x_||(x_=Qw(J2))}const Q2=(...n)=>{const o=Y2().createApp(...n);eT(o),tT(o);const{mount:c}=o;return o.mount=f=>{const y=iT(f);if(!y)return;const v=o._component;!Jt(v)&&!v.render&&!v.template&&(v.template=y.innerHTML),y.innerHTML="";const w=c(y,!1,y instanceof SVGElement);return y instanceof Element&&(y.removeAttribute("v-cloak"),y.setAttribute("data-v-app","")),w},o};function eT(n){Object.defineProperty(n.config,"isNativeTag",{value:o=>Yb(o)||Qb(o),writable:!1})}function tT(n){if(qv()){const o=n.config.isCustomElement;Object.defineProperty(n.config,"isCustomElement",{get(){return o},set(){Ge("The `isCustomElement` config option is deprecated. Use `compilerOptions.isCustomElement` instead.")}});const c=n.config.compilerOptions,f='The `compilerOptions` config option is only respected when using a build of Vue.js that includes the runtime compiler (aka "full build"). Since you are using the runtime-only build, `compilerOptions` must be passed to `@vue/compiler-dom` in the build setup instead.\n- For vue-loader: pass it via vue-loader\'s `compilerOptions` loader option.\n- For vue-cli: see https://cli.vuejs.org/guide/webpack.html#modifying-options-of-a-loader\n- For vite: pass it via @vitejs/plugin-vue options. See https://github.com/vitejs/vite/tree/main/packages/plugin-vue#example-for-passing-options-to-vuecompiler-dom';Object.defineProperty(n.config,"compilerOptions",{get(){return Ge(f),c},set(){Ge(f)}})}}function iT(n){if(en(n)){const o=document.querySelector(n);return o||Ge(`Failed to mount app: mount target selector "${n}" returned null.`),o}return window.ShadowRoot&&n instanceof window.ShadowRoot&&n.mode==="closed"&&Ge('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs'),n}function nT(){b2()}nT();const zt=(n,o)=>{const c=n.__vccOpts||n;for(const[f,y]of o)c[f]=y;return c},rT={};function sT(n,o){const c=Av("router-view");return ve(),hi(c)}const oT=zt(rT,[["render",sT],["__file","/opt/elevator/assets/elevator-ui/src/App.vue"]]);var aT=!1;function xh(n,o,c){return Array.isArray(n)?(n.length=Math.max(n.length,o),n.splice(o,1,c),c):(n[o]=c,c)}function Sp(n,o){if(Array.isArray(n)){n.splice(o,1);return}delete n[o]}function lT(){return Xv().__VUE_DEVTOOLS_GLOBAL_HOOK__}function Xv(){return typeof navigator<"u"&&typeof window<"u"?window:typeof global<"u"?global:{}}const cT=typeof Proxy=="function",uT="devtools-plugin:setup",hT="plugin:settings:set";let rl,df;function dT(){var n;return rl!==void 0||(typeof window<"u"&&window.performance?(rl=!0,df=window.performance):typeof global<"u"&&((n=global.perf_hooks)===null||n===void 0?void 0:n.performance)?(rl=!0,df=global.perf_hooks.performance):rl=!1),rl}function pT(){return dT()?df.now():Date.now()}class fT{constructor(o,c){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=o,this.hook=c;const f={};if(o.settings)for(const w in o.settings){const a=o.settings[w];f[w]=a.defaultValue}const y=`__vue-devtools-plugin-settings__${o.id}`;let v=Object.assign({},f);try{const w=localStorage.getItem(y),a=JSON.parse(w);Object.assign(v,a)}catch{}this.fallbacks={getSettings(){return v},setSettings(w){try{localStorage.setItem(y,JSON.stringify(w))}catch{}v=w},now(){return pT()}},c&&c.on(hT,(w,a)=>{w===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(w,a)=>this.target?this.target.on[a]:(...k)=>{this.onQueue.push({method:a,args:k})}}),this.proxiedTarget=new Proxy({},{get:(w,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...k)=>(this.targetQueue.push({method:a,args:k,resolve:()=>{}}),this.fallbacks[a](...k)):(...k)=>new Promise($=>{this.targetQueue.push({method:a,args:k,resolve:$})})})}async setRealTarget(o){this.target=o;for(const c of this.onQueue)this.target.on[c.method](...c.args);for(const c of this.targetQueue)c.resolve(await this.target[c.method](...c.args))}}function Kv(n,o){const c=n,f=Xv(),y=lT(),v=cT&&c.enableEarlyProxy;if(y&&(f.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!v))y.emit(uT,n,o);else{const w=v?new fT(c,y):null;(f.__VUE_DEVTOOLS_PLUGINS__=f.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:c,setupFn:o,proxy:w}),w&&o(w.proxiedTarget)}}/*!
  * pinia v2.0.22
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let pf;const Jc=n=>pf=n,Jv=Symbol("pinia");function ba(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var ds;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(ds||(ds={}));const pa=typeof window<"u",b_=pa,w_=(()=>typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:typeof globalThis=="object"?globalThis:{HTMLElement:null})();function mT(n,{autoBom:o=!1}={}){return o&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob([String.fromCharCode(65279),n],{type:n.type}):n}function Hf(n,o,c){const f=new XMLHttpRequest;f.open("GET",n),f.responseType="blob",f.onload=function(){ex(f.response,o,c)},f.onerror=function(){console.error("could not download file")},f.send()}function Yv(n){const o=new XMLHttpRequest;o.open("HEAD",n,!1);try{o.send()}catch{}return o.status>=200&&o.status<=299}function Ah(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{const c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(c)}}const Ch=typeof navigator=="object"?navigator:{userAgent:""},Qv=(()=>/Macintosh/.test(Ch.userAgent)&&/AppleWebKit/.test(Ch.userAgent)&&!/Safari/.test(Ch.userAgent))(),ex=pa?typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype&&!Qv?gT:"msSaveOrOpenBlob"in Ch?_T:yT:()=>{};function gT(n,o="download",c){const f=document.createElement("a");f.download=o,f.rel="noopener",typeof n=="string"?(f.href=n,f.origin!==location.origin?Yv(f.href)?Hf(n,o,c):(f.target="_blank",Ah(f)):Ah(f)):(f.href=URL.createObjectURL(n),setTimeout(function(){URL.revokeObjectURL(f.href)},4e4),setTimeout(function(){Ah(f)},0))}function _T(n,o="download",c){if(typeof n=="string")if(Yv(n))Hf(n,o,c);else{const f=document.createElement("a");f.href=n,f.target="_blank",setTimeout(function(){Ah(f)})}else navigator.msSaveOrOpenBlob(mT(n,c),o)}function yT(n,o,c,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof n=="string")return Hf(n,o,c);const y=n.type==="application/octet-stream",v=/constructor/i.test(String(w_.HTMLElement))||"safari"in w_,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||y&&v||Qv)&&typeof FileReader<"u"){const a=new FileReader;a.onloadend=function(){let k=a.result;if(typeof k!="string")throw f=null,new Error("Wrong reader.result type");k=w?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=k:location.assign(k),f=null},a.readAsDataURL(n)}else{const a=URL.createObjectURL(n);f?f.location.assign(a):location.href=a,f=null,setTimeout(function(){URL.revokeObjectURL(a)},4e4)}}function Rn(n,o){const c="\u{1F34D} "+n;typeof __VUE_DEVTOOLS_TOAST__=="function"?__VUE_DEVTOOLS_TOAST__(c,o):o==="error"?console.error(c):o==="warn"?console.warn(c):console.log(c)}function Xf(n){return"_a"in n&&"install"in n}function tx(){if(!("clipboard"in navigator))return Rn("Your browser doesn't support the Clipboard API","error"),!0}function ix(n){return n instanceof Error&&n.message.toLowerCase().includes("document is not focused")?(Rn('You need to activate the "Emulate a focused page" setting in the "Rendering" panel of devtools.',"warn"),!0):!1}async function vT(n){if(!tx())try{await navigator.clipboard.writeText(JSON.stringify(n.state.value)),Rn("Global state copied to clipboard.")}catch(o){if(ix(o))return;Rn("Failed to serialize the state. Check the console for more details.","error"),console.error(o)}}async function xT(n){if(!tx())try{n.state.value=JSON.parse(await navigator.clipboard.readText()),Rn("Global state pasted from clipboard.")}catch(o){if(ix(o))return;Rn("Failed to deserialize the state from clipboard. Check the console for more details.","error"),console.error(o)}}async function bT(n){try{ex(new Blob([JSON.stringify(n.state.value)],{type:"text/plain;charset=utf-8"}),"pinia-state.json")}catch(o){Rn("Failed to export the state as JSON. Check the console for more details.","error"),console.error(o)}}let zs;function wT(){zs||(zs=document.createElement("input"),zs.type="file",zs.accept=".json");function n(){return new Promise((o,c)=>{zs.onchange=async()=>{const f=zs.files;if(!f)return o(null);const y=f.item(0);return o(y?{text:await y.text(),file:y}:null)},zs.oncancel=()=>o(null),zs.onerror=c,zs.click()})}return n}async function TT(n){try{const c=await(await wT())();if(!c)return;const{text:f,file:y}=c;n.state.value=JSON.parse(f),Rn(`Global state imported from "${y.name}".`)}catch(o){Rn("Failed to export the state as JSON. Check the console for more details.","error"),console.error(o)}}function Wr(n){return{_custom:{display:n}}}const nx="\u{1F34D} Pinia (root)",ff="_root";function ET(n){return Xf(n)?{id:ff,label:nx}:{id:n.$id,label:n.$id}}function ST(n){if(Xf(n)){const c=Array.from(n._s.keys()),f=n._s;return{state:c.map(v=>({editable:!0,key:v,value:n.state.value[v]})),getters:c.filter(v=>f.get(v)._getters).map(v=>{const w=f.get(v);return{editable:!1,key:v,value:w._getters.reduce((a,k)=>(a[k]=w[k],a),{})}})}}const o={state:Object.keys(n.$state).map(c=>({editable:!0,key:c,value:n.$state[c]}))};return n._getters&&n._getters.length&&(o.getters=n._getters.map(c=>({editable:!1,key:c,value:n[c]}))),n._customProperties.size&&(o.customProperties=Array.from(n._customProperties).map(c=>({editable:!0,key:c,value:n[c]}))),o}function IT(n){return n?Array.isArray(n)?n.reduce((o,c)=>(o.keys.push(c.key),o.operations.push(c.type),o.oldValue[c.key]=c.oldValue,o.newValue[c.key]=c.newValue,o),{oldValue:{},keys:[],operations:[],newValue:{}}):{operation:Wr(n.type),key:Wr(n.key),oldValue:n.oldValue,newValue:n.newValue}:{}}function AT(n){switch(n){case ds.direct:return"mutation";case ds.patchFunction:return"$patch";case ds.patchObject:return"$patch";default:return"unknown"}}let dl=!0;const kh=[],oa="pinia:mutations",Xn="pinia",Vh=n=>"\u{1F34D} "+n;function CT(n,o){Kv({id:"dev.esm.pinia",label:"Pinia \u{1F34D}",logo:"https://pinia.vuejs.org/logo.svg",packageName:"pinia",homepage:"https://pinia.vuejs.org",componentStateTypes:kh,app:n},c=>{typeof c.now!="function"&&Rn("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),c.addTimelineLayer({id:oa,label:"Pinia \u{1F34D}",color:15064968}),c.addInspector({id:Xn,label:"Pinia \u{1F34D}",icon:"storage",treeFilterPlaceholder:"Search stores",actions:[{icon:"content_copy",action:()=>{vT(o)},tooltip:"Serialize and copy the state"},{icon:"content_paste",action:async()=>{await xT(o),c.sendInspectorTree(Xn),c.sendInspectorState(Xn)},tooltip:"Replace the state with the content of your clipboard"},{icon:"save",action:()=>{bT(o)},tooltip:"Save the state as a JSON file"},{icon:"folder_open",action:async()=>{await TT(o),c.sendInspectorTree(Xn),c.sendInspectorState(Xn)},tooltip:"Import the state from a JSON file"}],nodeActions:[{icon:"restore",tooltip:"Reset the state (option store only)",action:f=>{const y=o._s.get(f);y?y._isOptionsAPI?(y.$reset(),Rn(`Store "${f}" reset.`)):Rn(`Cannot reset "${f}" store because it's a setup store.`,"warn"):Rn(`Cannot reset "${f}" store because it wasn't found.`,"warn")}}]}),c.on.inspectComponent((f,y)=>{const v=f.componentInstance&&f.componentInstance.proxy;if(v&&v._pStores){const w=f.componentInstance.proxy._pStores;Object.values(w).forEach(a=>{f.instanceData.state.push({type:Vh(a.$id),key:"state",editable:!0,value:a._isOptionsAPI?{_custom:{value:ti(a.$state),actions:[{icon:"restore",tooltip:"Reset the state of this store",action:()=>a.$reset()}]}}:Object.keys(a.$state).reduce((k,$)=>(k[$]=a.$state[$],k),{})}),a._getters&&a._getters.length&&f.instanceData.state.push({type:Vh(a.$id),key:"getters",editable:!1,value:a._getters.reduce((k,$)=>{try{k[$]=a[$]}catch(F){k[$]=F}return k},{})})})}}),c.on.getInspectorTree(f=>{if(f.app===n&&f.inspectorId===Xn){let y=[o];y=y.concat(Array.from(o._s.values())),f.rootNodes=(f.filter?y.filter(v=>"$id"in v?v.$id.toLowerCase().includes(f.filter.toLowerCase()):nx.toLowerCase().includes(f.filter.toLowerCase())):y).map(ET)}}),c.on.getInspectorState(f=>{if(f.app===n&&f.inspectorId===Xn){const y=f.nodeId===ff?o:o._s.get(f.nodeId);if(!y)return;y&&(f.state=ST(y))}}),c.on.editInspectorState((f,y)=>{if(f.app===n&&f.inspectorId===Xn){const v=f.nodeId===ff?o:o._s.get(f.nodeId);if(!v)return Rn(`store "${f.nodeId}" not found`,"error");const{path:w}=f;Xf(v)?w.unshift("state"):(w.length!==1||!v._customProperties.has(w[0])||w[0]in v.$state)&&w.unshift("$state"),dl=!1,f.set(v,w,f.state.value),dl=!0}}),c.on.editComponentState(f=>{if(f.type.startsWith("\u{1F34D}")){const y=f.type.replace(/^🍍\s*/,""),v=o._s.get(y);if(!v)return Rn(`store "${y}" not found`,"error");const{path:w}=f;if(w[0]!=="state")return Rn(`Invalid path for store "${y}":
${w}
Only state can be modified.`);w[0]="$state",dl=!1,f.set(v,w,f.state.value),dl=!0}})})}function kT(n,o){kh.includes(Vh(o.$id))||kh.push(Vh(o.$id)),Kv({id:"dev.esm.pinia",label:"Pinia \u{1F34D}",logo:"https://pinia.vuejs.org/logo.svg",packageName:"pinia",homepage:"https://pinia.vuejs.org",componentStateTypes:kh,app:n,settings:{logStoreChanges:{label:"Notify about new/deleted stores",type:"boolean",defaultValue:!0}}},c=>{const f=typeof c.now=="function"?c.now.bind(c):Date.now;o.$onAction(({after:w,onError:a,name:k,args:$})=>{const F=rx++;c.addTimelineEvent({layerId:oa,event:{time:f(),title:"\u{1F6EB} "+k,subtitle:"start",data:{store:Wr(o.$id),action:Wr(k),args:$},groupId:F}}),w(B=>{ha=void 0,c.addTimelineEvent({layerId:oa,event:{time:f(),title:"\u{1F6EC} "+k,subtitle:"end",data:{store:Wr(o.$id),action:Wr(k),args:$,result:B},groupId:F}})}),a(B=>{ha=void 0,c.addTimelineEvent({layerId:oa,event:{time:f(),logType:"error",title:"\u{1F4A5} "+k,subtitle:"end",data:{store:Wr(o.$id),action:Wr(k),args:$,error:B},groupId:F}})})},!0),o._customProperties.forEach(w=>{lr(()=>Ve(o[w]),(a,k)=>{c.notifyComponentUpdate(),c.sendInspectorState(Xn),dl&&c.addTimelineEvent({layerId:oa,event:{time:f(),title:"Change",subtitle:w,data:{newValue:a,oldValue:k},groupId:ha}})},{deep:!0})}),o.$subscribe(({events:w,type:a},k)=>{if(c.notifyComponentUpdate(),c.sendInspectorState(Xn),!dl)return;const $={time:f(),title:AT(a),data:{store:Wr(o.$id),...IT(w)},groupId:ha};ha=void 0,a===ds.patchFunction?$.subtitle="\u2935\uFE0F":a===ds.patchObject?$.subtitle="\u{1F9E9}":w&&!Array.isArray(w)&&($.subtitle=w.type),w&&($.data["rawEvent(s)"]={_custom:{display:"DebuggerEvent",type:"object",tooltip:"raw DebuggerEvent[]",value:w}}),c.addTimelineEvent({layerId:oa,event:$})},{detached:!0,flush:"sync"});const y=o._hotUpdate;o._hotUpdate=Hr(w=>{y(w),c.addTimelineEvent({layerId:oa,event:{time:f(),title:"\u{1F525} "+o.$id,subtitle:"HMR update",data:{store:Wr(o.$id),info:Wr("HMR update")}}}),c.notifyComponentUpdate(),c.sendInspectorTree(Xn),c.sendInspectorState(Xn)});const{$dispose:v}=o;o.$dispose=()=>{v(),c.notifyComponentUpdate(),c.sendInspectorTree(Xn),c.sendInspectorState(Xn),c.getSettings().logStoreChanges&&Rn(`Disposed "${o.$id}" store \u{1F5D1}`)},c.notifyComponentUpdate(),c.sendInspectorTree(Xn),c.sendInspectorState(Xn),c.getSettings().logStoreChanges&&Rn(`"${o.$id}" store installed \u{1F195}`)})}let rx=0,ha;function T_(n,o){const c=o.reduce((f,y)=>(f[y]=ti(n)[y],f),{});for(const f in c)n[f]=function(){const y=rx,v=new Proxy(n,{get(...w){return ha=y,Reflect.get(...w)},set(...w){return ha=y,Reflect.set(...w)}});return c[f].apply(v,arguments)}}function PT({app:n,store:o,options:c}){if(!o.$id.startsWith("__hot:")){if(c.state&&(o._isOptionsAPI=!0),typeof c.state=="function"){T_(o,Object.keys(c.actions));const f=o._hotUpdate;ti(o)._hotUpdate=function(y){f.apply(this,arguments),T_(o,Object.keys(y._hmrPayload.actions))}}kT(n,o)}}function MT(){const n=Uy(!0),o=n.run(()=>Ci({}));let c=[],f=[];const y=Hr({install(v){Jc(y),y._a=v,v.provide(Jv,y),v.config.globalProperties.$pinia=y,b_&&CT(v,y),f.forEach(w=>c.push(w)),f=[]},use(v){return!this._a&&!aT?f.push(v):c.push(v),this},_p:c,_a:null,_e:n,_s:new Map,state:o});return b_&&typeof Proxy<"u"&&y.use(PT),y}function sx(n,o){for(const c in o){const f=o[c];if(!(c in n))continue;const y=n[c];ba(y)&&ba(f)&&!Ji(f)&&!hs(f)?n[c]=sx(y,f):n[c]=f}return n}const zT=()=>{};function E_(n,o,c,f=zT){n.push(o);const y=()=>{const v=n.indexOf(o);v>-1&&(n.splice(v,1),f())};return!c&&Cl()&&ed(y),y}function sl(n,...o){n.slice().forEach(c=>{c(...o)})}function mf(n,o){n instanceof Map&&o instanceof Map&&o.forEach((c,f)=>n.set(f,c)),n instanceof Set&&o instanceof Set&&o.forEach(n.add,n);for(const c in o){if(!o.hasOwnProperty(c))continue;const f=o[c],y=n[c];ba(y)&&ba(f)&&n.hasOwnProperty(c)&&!Ji(f)&&!hs(f)?n[c]=mf(y,f):n[c]=f}return n}const DT=Symbol("pinia:skipHydration");function RT(n){return!ba(n)||!n.hasOwnProperty(DT)}const{assign:Zr}=Object;function S_(n){return!!(Ji(n)&&n.effect)}function I_(n,o,c,f){const{state:y,actions:v,getters:w}=o,a=c.state.value[n];let k;function $(){!a&&!f&&(c.state.value[n]=y?y():{});const F=qg(f?Ci(y?y():{}).value:c.state.value[n]);return Zr(F,v,Object.keys(w||{}).reduce((B,M)=>(M in F&&console.warn(`[\u{1F34D}]: A getter cannot have the same name as another state property. Rename one of them. Found with "${M}" in store "${n}".`),B[M]=Hr(Ut(()=>{Jc(c);const le=c._s.get(n);return w[M].call(le,le)})),B),{}))}return k=gf(n,$,o,c,f,!0),k.$reset=function(){const B=y?y():{};this.$patch(M=>{Zr(M,B)})},k}function gf(n,o,c={},f,y,v){let w;const a=Zr({actions:{}},c);if(!f._e.active)throw new Error("Pinia destroyed");const k={deep:!0};k.onTrigger=it=>{$?le=it:$==!1&&!Xe._hotUpdating&&(Array.isArray(le)?le.push(it):console.error("\u{1F34D} debuggerEvents should be an array. This is most likely an internal Pinia bug."))};let $,F,B=Hr([]),M=Hr([]),le;const Ee=f.state.value[n];!v&&!Ee&&!y&&(f.state.value[n]={});const Oe=Ci({});let Je;function He(it){let Ue;$=F=!1,le=[],typeof it=="function"?(it(f.state.value[n]),Ue={type:ds.patchFunction,storeId:n,events:le}):(mf(f.state.value[n],it),Ue={type:ds.patchObject,payload:it,storeId:n,events:le});const ct=Je=Symbol();Zc().then(()=>{Je===ct&&($=!0)}),F=!0,sl(B,Ue,f.state.value[n])}const De=()=>{throw new Error(`\u{1F34D}: Store "${n}" is built using the setup syntax and does not implement $reset().`)};function tt(){w.stop(),B=[],M=[],f._s.delete(n)}function Nt(it,Ue){return function(){Jc(f);const ct=Array.from(arguments),Re=[],Rt=[];function ai(St){Re.push(St)}function yi(St){Rt.push(St)}sl(M,{args:ct,name:it,store:Xe,after:ai,onError:yi});let We;try{We=Ue.apply(this&&this.$id===n?this:Xe,ct)}catch(St){throw sl(Rt,St),St}return We instanceof Promise?We.then(St=>(sl(Re,St),St)).catch(St=>(sl(Rt,St),Promise.reject(St))):(sl(Re,We),We)}}const Ce=Hr({actions:{},getters:{},state:[],hotState:Oe}),Zt={_p:f,$id:n,$onAction:E_.bind(null,M),$patch:He,$reset:De,$subscribe(it,Ue={}){const ct=E_(B,it,Ue.detached,()=>Re()),Re=w.run(()=>lr(()=>f.state.value[n],Rt=>{(Ue.flush==="sync"?F:$)&&it({storeId:n,type:ds.direct,events:le},Rt)},Zr({},k,Ue)));return ct},$dispose:tt},Xe=Il(Zr(pa?{_customProperties:Hr(new Set),_hmrPayload:Ce}:{},Zt));f._s.set(n,Xe);const ht=f._e.run(()=>(w=Uy(),w.run(()=>o())));for(const it in ht){const Ue=ht[it];if(Ji(Ue)&&!S_(Ue)||hs(Ue))y?xh(Oe.value,it,Oc(ht,it)):v||(Ee&&RT(Ue)&&(Ji(Ue)?Ue.value=Ee[it]:mf(Ue,Ee[it])),f.state.value[n][it]=Ue),Ce.state.push(it);else if(typeof Ue=="function"){const ct=y?Ue:Nt(it,Ue);ht[it]=ct,Ce.actions[it]=Ue,a.actions[it]=Ue}else S_(Ue)&&(Ce.getters[it]=v?c.getters[it]:Ue,pa&&(ht._getters||(ht._getters=Hr([]))).push(it))}Zr(Xe,ht),Zr(ti(Xe),ht),Object.defineProperty(Xe,"$state",{get:()=>y?Oe.value:f.state.value[n],set:it=>{if(y)throw new Error("cannot set hotState");He(Ue=>{Zr(Ue,it)})}});{Xe._hotUpdate=Hr(Ue=>{Xe._hotUpdating=!0,Ue._hmrPayload.state.forEach(ct=>{if(ct in Xe.$state){const Re=Ue.$state[ct],Rt=Xe.$state[ct];typeof Re=="object"&&ba(Re)&&ba(Rt)?sx(Re,Rt):Ue.$state[ct]=Rt}xh(Xe,ct,Oc(Ue.$state,ct))}),Object.keys(Xe.$state).forEach(ct=>{ct in Ue.$state||Sp(Xe,ct)}),$=!1,F=!1,f.state.value[n]=Oc(Ue._hmrPayload,"hotState"),F=!0,Zc().then(()=>{$=!0});for(const ct in Ue._hmrPayload.actions){const Re=Ue[ct];xh(Xe,ct,Nt(ct,Re))}for(const ct in Ue._hmrPayload.getters){const Re=Ue._hmrPayload.getters[ct],Rt=v?Ut(()=>(Jc(f),Re.call(Xe,Xe))):Re;xh(Xe,ct,Rt)}Object.keys(Xe._hmrPayload.getters).forEach(ct=>{ct in Ue._hmrPayload.getters||Sp(Xe,ct)}),Object.keys(Xe._hmrPayload.actions).forEach(ct=>{ct in Ue._hmrPayload.actions||Sp(Xe,ct)}),Xe._hmrPayload=Ue._hmrPayload,Xe._getters=Ue._getters,Xe._hotUpdating=!1});const it={writable:!0,configurable:!0,enumerable:!1};pa&&["_p","_hmrPayload","_getters","_customProperties"].forEach(Ue=>{Object.defineProperty(Xe,Ue,{value:Xe[Ue],...it})})}return f._p.forEach(it=>{if(pa){const Ue=w.run(()=>it({store:Xe,app:f._a,pinia:f,options:a}));Object.keys(Ue||{}).forEach(ct=>Xe._customProperties.add(ct)),Zr(Xe,Ue)}else Zr(Xe,w.run(()=>it({store:Xe,app:f._a,pinia:f,options:a})))}),Xe.$state&&typeof Xe.$state=="object"&&typeof Xe.$state.constructor=="function"&&!Xe.$state.constructor.toString().includes("[native code]")&&console.warn(`[\u{1F34D}]: The "state" must be a plain object. It cannot be
	state: () => new MyClass()
Found in store "${Xe.$id}".`),Ee&&v&&c.hydrate&&c.hydrate(Xe.$state,Ee),$=!0,F=!0,Xe}function LT(n,o,c){let f,y;const v=typeof o=="function";typeof n=="string"?(f=n,y=v?c:o):(y=n,f=n.id);function w(a,k){const $=Cl();if(a=a||$&&Jr(Jv),a&&Jc(a),!pf)throw new Error(`[\u{1F34D}]: getActivePinia was called with no active Pinia. Did you forget to install pinia?
	const pinia = createPinia()
	app.use(pinia)
This will fail in production.`);a=pf,a._s.has(f)||(v?gf(f,o,y,a):I_(f,y,a),w._pinia=a);const F=a._s.get(f);if(k){const B="__hot:"+f,M=v?gf(B,o,y,a,!0):I_(B,Zr({},y),a,!0);k._hotUpdate(M),delete a.state.value[B],a._s.delete(B)}if(pa&&$&&$.proxy&&!k){const B=$.proxy,M="_pStores"in B?B._pStores:B._pStores={};M[f]=F}return F}return w.$id=f,w}function OT(){return ox().__VUE_DEVTOOLS_GLOBAL_HOOK__}function ox(){return typeof navigator<"u"&&typeof window<"u"?window:typeof global<"u"?global:{}}const BT=typeof Proxy=="function",FT="devtools-plugin:setup",$T="plugin:settings:set";let ol,_f;function UT(){var n;return ol!==void 0||(typeof window<"u"&&window.performance?(ol=!0,_f=window.performance):typeof global<"u"&&((n=global.perf_hooks)===null||n===void 0?void 0:n.performance)?(ol=!0,_f=global.perf_hooks.performance):ol=!1),ol}function NT(){return UT()?_f.now():Date.now()}class VT{constructor(o,c){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=o,this.hook=c;const f={};if(o.settings)for(const w in o.settings){const a=o.settings[w];f[w]=a.defaultValue}const y=`__vue-devtools-plugin-settings__${o.id}`;let v=Object.assign({},f);try{const w=localStorage.getItem(y),a=JSON.parse(w);Object.assign(v,a)}catch{}this.fallbacks={getSettings(){return v},setSettings(w){try{localStorage.setItem(y,JSON.stringify(w))}catch{}v=w},now(){return NT()}},c&&c.on($T,(w,a)=>{w===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(w,a)=>this.target?this.target.on[a]:(...k)=>{this.onQueue.push({method:a,args:k})}}),this.proxiedTarget=new Proxy({},{get:(w,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...k)=>(this.targetQueue.push({method:a,args:k,resolve:()=>{}}),this.fallbacks[a](...k)):(...k)=>new Promise($=>{this.targetQueue.push({method:a,args:k,resolve:$})})})}async setRealTarget(o){this.target=o;for(const c of this.onQueue)this.target.on[c.method](...c.args);for(const c of this.targetQueue)c.resolve(await this.target[c.method](...c.args))}}function jT(n,o){const c=n,f=ox(),y=OT(),v=BT&&c.enableEarlyProxy;if(y&&(f.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!v))y.emit(FT,n,o);else{const w=v?new VT(c,y):null;(f.__VUE_DEVTOOLS_PLUGINS__=f.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:c,setupFn:o,proxy:w}),w&&o(w.proxiedTarget)}}/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Os=typeof window<"u";function qT(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const Ri=Object.assign;function Ip(n,o){const c={};for(const f in o){const y=o[f];c[f]=Ar(y)?y.map(n):n(y)}return c}const Vc=()=>{},Ar=Array.isArray;function Ti(n){const o=Array.from(arguments).slice(1);console.warn.apply(console,["[Vue Router warn]: "+n].concat(o))}const GT=/\/$/,WT=n=>n.replace(GT,"");function Ap(n,o,c="/"){let f,y={},v="",w="";const a=o.indexOf("#");let k=o.indexOf("?");return a<k&&a>=0&&(k=-1),k>-1&&(f=o.slice(0,k),v=o.slice(k+1,a>-1?a:o.length),y=n(v)),a>-1&&(f=f||o.slice(0,a),w=o.slice(a,o.length)),f=XT(f!=null?f:o,c),{fullPath:f+(v&&"?")+v+w,path:f,query:y,hash:w}}function ZT(n,o){const c=o.query?n(o.query):"";return o.path+(c&&"?")+c+(o.hash||"")}function A_(n,o){return!o||!n.toLowerCase().startsWith(o.toLowerCase())?n:n.slice(o.length)||"/"}function C_(n,o,c){const f=o.matched.length-1,y=c.matched.length-1;return f>-1&&f===y&&wo(o.matched[f],c.matched[y])&&ax(o.params,c.params)&&n(o.query)===n(c.query)&&o.hash===c.hash}function wo(n,o){return(n.aliasOf||n)===(o.aliasOf||o)}function ax(n,o){if(Object.keys(n).length!==Object.keys(o).length)return!1;for(const c in n)if(!HT(n[c],o[c]))return!1;return!0}function HT(n,o){return Ar(n)?k_(n,o):Ar(o)?k_(o,n):n===o}function k_(n,o){return Ar(o)?n.length===o.length&&n.every((c,f)=>c===o[f]):n.length===1&&n[0]===o}function XT(n,o){if(n.startsWith("/"))return n;if(!o.startsWith("/"))return Ti(`Cannot resolve a relative location without an absolute path. Trying to resolve "${n}" from "${o}". It should look like "/${o}".`),n;if(!n)return o;const c=o.split("/"),f=n.split("/");let y=c.length-1,v,w;for(v=0;v<f.length;v++)if(w=f[v],w!==".")if(w==="..")y>1&&y--;else break;return c.slice(0,y).join("/")+"/"+f.slice(v-(v===f.length?1:0)).join("/")}var Yc;(function(n){n.pop="pop",n.push="push"})(Yc||(Yc={}));var jc;(function(n){n.back="back",n.forward="forward",n.unknown=""})(jc||(jc={}));function KT(n){if(!n)if(Os){const o=document.querySelector("base");n=o&&o.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),WT(n)}const JT=/^[^#]+#/;function YT(n,o){return n.replace(JT,"#")+o}function QT(n,o){const c=document.documentElement.getBoundingClientRect(),f=n.getBoundingClientRect();return{behavior:o.behavior,left:f.left-c.left-(o.left||0),top:f.top-c.top-(o.top||0)}}const sd=()=>({left:window.pageXOffset,top:window.pageYOffset});function eE(n){let o;if("el"in n){const c=n.el,f=typeof c=="string"&&c.startsWith("#");if(typeof n.el=="string"&&(!f||!document.getElementById(n.el.slice(1))))try{const v=document.querySelector(n.el);if(f&&v){Ti(`The selector "${n.el}" should be passed as "el: document.querySelector('${n.el}')" because it starts with "#".`);return}}catch{Ti(`The selector "${n.el}" is invalid. If you are using an id selector, make sure to escape it. You can find more information about escaping characters in selectors at https://mathiasbynens.be/notes/css-escapes or use CSS.escape (https://developer.mozilla.org/en-US/docs/Web/API/CSS/escape).`);return}const y=typeof c=="string"?f?document.getElementById(c.slice(1)):document.querySelector(c):c;if(!y){Ti(`Couldn't find element using selector "${n.el}" returned by scrollBehavior.`);return}o=QT(y,n)}else o=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(o):window.scrollTo(o.left!=null?o.left:window.pageXOffset,o.top!=null?o.top:window.pageYOffset)}function P_(n,o){return(history.state?history.state.position-o:-1)+n}const yf=new Map;function tE(n,o){yf.set(n,o)}function iE(n){const o=yf.get(n);return yf.delete(n),o}let nE=()=>location.protocol+"//"+location.host;function lx(n,o){const{pathname:c,search:f,hash:y}=o,v=n.indexOf("#");if(v>-1){let a=y.includes(n.slice(v))?n.slice(v).length:1,k=y.slice(a);return k[0]!=="/"&&(k="/"+k),A_(k,"")}return A_(c,n)+f+y}function rE(n,o,c,f){let y=[],v=[],w=null;const a=({state:M})=>{const le=lx(n,location),Ee=c.value,Oe=o.value;let Je=0;if(M){if(c.value=le,o.value=M,w&&w===Ee){w=null;return}Je=Oe?M.position-Oe.position:0}else f(le);y.forEach(He=>{He(c.value,Ee,{delta:Je,type:Yc.pop,direction:Je?Je>0?jc.forward:jc.back:jc.unknown})})};function k(){w=c.value}function $(M){y.push(M);const le=()=>{const Ee=y.indexOf(M);Ee>-1&&y.splice(Ee,1)};return v.push(le),le}function F(){const{history:M}=window;!M.state||M.replaceState(Ri({},M.state,{scroll:sd()}),"")}function B(){for(const M of v)M();v=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",F)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",F),{pauseListeners:k,listen:$,destroy:B}}function M_(n,o,c,f=!1,y=!1){return{back:n,current:o,forward:c,replaced:f,position:window.history.length,scroll:y?sd():null}}function sE(n){const{history:o,location:c}=window,f={value:lx(n,c)},y={value:o.state};y.value||v(f.value,{back:null,current:f.value,forward:null,position:o.length-1,replaced:!0,scroll:null},!0);function v(k,$,F){const B=n.indexOf("#"),M=B>-1?(c.host&&document.querySelector("base")?n:n.slice(B))+k:nE()+n+k;try{o[F?"replaceState":"pushState"]($,"",M),y.value=$}catch(le){Ti("Error with push/replace State",le),c[F?"replace":"assign"](M)}}function w(k,$){const F=Ri({},o.state,M_(y.value.back,k,y.value.forward,!0),$,{position:y.value.position});v(k,F,!0),f.value=k}function a(k,$){const F=Ri({},y.value,o.state,{forward:k,scroll:sd()});o.state||Ti(`history.state seems to have been manually replaced without preserving the necessary values. Make sure to preserve existing history state if you are manually calling history.replaceState:

history.replaceState(history.state, '', url)

You can find more information at https://next.router.vuejs.org/guide/migration/#usage-of-history-state.`),v(F.current,F,!0);const B=Ri({},M_(f.value,k,null),{position:F.position+1},$);v(k,B,!1),f.value=k}return{location:f,state:y,push:a,replace:w}}function oE(n){n=KT(n);const o=sE(n),c=rE(n,o.state,o.location,o.replace);function f(v,w=!0){w||c.pauseListeners(),history.go(v)}const y=Ri({location:"",base:n,go:f,createHref:YT.bind(null,n)},o,c);return Object.defineProperty(y,"location",{enumerable:!0,get:()=>o.location.value}),Object.defineProperty(y,"state",{enumerable:!0,get:()=>o.state.value}),y}function aE(n){return typeof n=="string"||n&&typeof n=="object"}function cx(n){return typeof n=="string"||typeof n=="symbol"}const uo={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},ux=Symbol("navigation failure");var z_;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(z_||(z_={}));const lE={[1]({location:n,currentLocation:o}){return`No match for
 ${JSON.stringify(n)}${o?`
while being at
`+JSON.stringify(o):""}`},[2]({from:n,to:o}){return`Redirected from "${n.fullPath}" to "${uE(o)}" via a navigation guard.`},[4]({from:n,to:o}){return`Navigation aborted from "${n.fullPath}" to "${o.fullPath}" via a navigation guard.`},[8]({from:n,to:o}){return`Navigation cancelled from "${n.fullPath}" to "${o.fullPath}" with a new navigation.`},[16]({from:n,to:o}){return`Avoided redundant navigation to current location: "${n.fullPath}".`}};function bl(n,o){return Ri(new Error(lE[n](o)),{type:n,[ux]:!0},o)}function Ds(n,o){return n instanceof Error&&ux in n&&(o==null||!!(n.type&o))}const cE=["params","query","hash"];function uE(n){if(typeof n=="string")return n;if("path"in n)return n.path;const o={};for(const c of cE)c in n&&(o[c]=n[c]);return JSON.stringify(o,null,2)}const D_="[^/]+?",hE={sensitive:!1,strict:!1,start:!0,end:!0},dE=/[.+*?^${}()[\]/\\]/g;function pE(n,o){const c=Ri({},hE,o),f=[];let y=c.start?"^":"";const v=[];for(const $ of n){const F=$.length?[]:[90];c.strict&&!$.length&&(y+="/");for(let B=0;B<$.length;B++){const M=$[B];let le=40+(c.sensitive?.25:0);if(M.type===0)B||(y+="/"),y+=M.value.replace(dE,"\\$&"),le+=40;else if(M.type===1){const{value:Ee,repeatable:Oe,optional:Je,regexp:He}=M;v.push({name:Ee,repeatable:Oe,optional:Je});const De=He||D_;if(De!==D_){le+=10;try{new RegExp(`(${De})`)}catch(Nt){throw new Error(`Invalid custom RegExp for param "${Ee}" (${De}): `+Nt.message)}}let tt=Oe?`((?:${De})(?:/(?:${De}))*)`:`(${De})`;B||(tt=Je&&$.length<2?`(?:/${tt})`:"/"+tt),Je&&(tt+="?"),y+=tt,le+=20,Je&&(le+=-8),Oe&&(le+=-20),De===".*"&&(le+=-50)}F.push(le)}f.push(F)}if(c.strict&&c.end){const $=f.length-1;f[$][f[$].length-1]+=.7000000000000001}c.strict||(y+="/?"),c.end?y+="$":c.strict&&(y+="(?:/|$)");const w=new RegExp(y,c.sensitive?"":"i");function a($){const F=$.match(w),B={};if(!F)return null;for(let M=1;M<F.length;M++){const le=F[M]||"",Ee=v[M-1];B[Ee.name]=le&&Ee.repeatable?le.split("/"):le}return B}function k($){let F="",B=!1;for(const M of n){(!B||!F.endsWith("/"))&&(F+="/"),B=!1;for(const le of M)if(le.type===0)F+=le.value;else if(le.type===1){const{value:Ee,repeatable:Oe,optional:Je}=le,He=Ee in $?$[Ee]:"";if(Ar(He)&&!Oe)throw new Error(`Provided param "${Ee}" is an array but it is not repeatable (* or + modifiers)`);const De=Ar(He)?He.join("/"):He;if(!De)if(Je)M.length<2&&(F.endsWith("/")?F=F.slice(0,-1):B=!0);else throw new Error(`Missing required param "${Ee}"`);F+=De}}return F||"/"}return{re:w,score:f,keys:v,parse:a,stringify:k}}function fE(n,o){let c=0;for(;c<n.length&&c<o.length;){const f=o[c]-n[c];if(f)return f;c++}return n.length<o.length?n.length===1&&n[0]===40+40?-1:1:n.length>o.length?o.length===1&&o[0]===40+40?1:-1:0}function mE(n,o){let c=0;const f=n.score,y=o.score;for(;c<f.length&&c<y.length;){const v=fE(f[c],y[c]);if(v)return v;c++}if(Math.abs(y.length-f.length)===1){if(R_(f))return 1;if(R_(y))return-1}return y.length-f.length}function R_(n){const o=n[n.length-1];return n.length>0&&o[o.length-1]<0}const gE={type:0,value:""},_E=/[a-zA-Z0-9_]/;function yE(n){if(!n)return[[]];if(n==="/")return[[gE]];if(!n.startsWith("/"))throw new Error(`Route paths should start with a "/": "${n}" should be "/${n}".`);function o(le){throw new Error(`ERR (${c})/"${$}": ${le}`)}let c=0,f=c;const y=[];let v;function w(){v&&y.push(v),v=[]}let a=0,k,$="",F="";function B(){!$||(c===0?v.push({type:0,value:$}):c===1||c===2||c===3?(v.length>1&&(k==="*"||k==="+")&&o(`A repeatable param (${$}) must be alone in its segment. eg: '/:ids+.`),v.push({type:1,value:$,regexp:F,repeatable:k==="*"||k==="+",optional:k==="*"||k==="?"})):o("Invalid state to consume buffer"),$="")}function M(){$+=k}for(;a<n.length;){if(k=n[a++],k==="\\"&&c!==2){f=c,c=4;continue}switch(c){case 0:k==="/"?($&&B(),w()):k===":"?(B(),c=1):M();break;case 4:M(),c=f;break;case 1:k==="("?c=2:_E.test(k)?M():(B(),c=0,k!=="*"&&k!=="?"&&k!=="+"&&a--);break;case 2:k===")"?F[F.length-1]=="\\"?F=F.slice(0,-1)+k:c=3:F+=k;break;case 3:B(),c=0,k!=="*"&&k!=="?"&&k!=="+"&&a--,F="";break;default:o("Unknown state");break}}return c===2&&o(`Unfinished custom RegExp for param "${$}"`),B(),w(),y}function vE(n,o,c){const f=pE(yE(n.path),c);{const v=new Set;for(const w of f.keys)v.has(w.name)&&Ti(`Found duplicated params with name "${w.name}" for path "${n.path}". Only the last one will be available on "$route.params".`),v.add(w.name)}const y=Ri(f,{record:n,parent:o,children:[],alias:[]});return o&&!y.record.aliasOf==!o.record.aliasOf&&o.children.push(y),y}function xE(n,o){const c=[],f=new Map;o=B_({strict:!1,end:!0,sensitive:!1},o);function y(F){return f.get(F)}function v(F,B,M){const le=!M,Ee=bE(F);SE(Ee,B),Ee.aliasOf=M&&M.record;const Oe=B_(o,F),Je=[Ee];if("alias"in F){const tt=typeof F.alias=="string"?[F.alias]:F.alias;for(const Nt of tt)Je.push(Ri({},Ee,{components:M?M.record.components:Ee.components,path:Nt,aliasOf:M?M.record:Ee}))}let He,De;for(const tt of Je){const{path:Nt}=tt;if(B&&Nt[0]!=="/"){const Ce=B.record.path,Zt=Ce[Ce.length-1]==="/"?"":"/";tt.path=B.record.path+(Nt&&Zt+Nt)}if(tt.path==="*")throw new Error(`Catch all routes ("*") must now be defined using a param with a custom regexp.
See more at https://next.router.vuejs.org/guide/migration/#removed-star-or-catch-all-routes.`);if(He=vE(tt,B,Oe),B&&Nt[0]==="/"&&IE(He,B),M?(M.alias.push(He),EE(M,He)):(De=De||He,De!==He&&De.alias.push(He),le&&F.name&&!O_(He)&&w(F.name)),Ee.children){const Ce=Ee.children;for(let Zt=0;Zt<Ce.length;Zt++)v(Ce[Zt],He,M&&M.children[Zt])}M=M||He,k(He)}return De?()=>{w(De)}:Vc}function w(F){if(cx(F)){const B=f.get(F);B&&(f.delete(F),c.splice(c.indexOf(B),1),B.children.forEach(w),B.alias.forEach(w))}else{const B=c.indexOf(F);B>-1&&(c.splice(B,1),F.record.name&&f.delete(F.record.name),F.children.forEach(w),F.alias.forEach(w))}}function a(){return c}function k(F){let B=0;for(;B<c.length&&mE(F,c[B])>=0&&(F.record.path!==c[B].record.path||!hx(F,c[B]));)B++;c.splice(B,0,F),F.record.name&&!O_(F)&&f.set(F.record.name,F)}function $(F,B){let M,le={},Ee,Oe;if("name"in F&&F.name){if(M=f.get(F.name),!M)throw bl(1,{location:F});{const De=Object.keys(F.params||{}).filter(tt=>!M.keys.find(Nt=>Nt.name===tt));De.length&&Ti(`Discarded invalid param(s) "${De.join('", "')}" when navigating. See https://github.com/vuejs/router/blob/main/packages/router/CHANGELOG.md#414-2022-08-22 for more details.`)}Oe=M.record.name,le=Ri(L_(B.params,M.keys.filter(De=>!De.optional).map(De=>De.name)),F.params&&L_(F.params,M.keys.map(De=>De.name))),Ee=M.stringify(le)}else if("path"in F)Ee=F.path,Ee.startsWith("/")||Ti(`The Matcher cannot resolve relative paths but received "${Ee}". Unless you directly called \`matcher.resolve("${Ee}")\`, this is probably a bug in vue-router. Please open an issue at https://new-issue.vuejs.org/?repo=vuejs/router.`),M=c.find(De=>De.re.test(Ee)),M&&(le=M.parse(Ee),Oe=M.record.name);else{if(M=B.name?f.get(B.name):c.find(De=>De.re.test(B.path)),!M)throw bl(1,{location:F,currentLocation:B});Oe=M.record.name,le=Ri({},B.params,F.params),Ee=M.stringify(le)}const Je=[];let He=M;for(;He;)Je.unshift(He.record),He=He.parent;return{name:Oe,path:Ee,params:le,matched:Je,meta:TE(Je)}}return n.forEach(F=>v(F)),{addRoute:v,resolve:$,removeRoute:w,getRoutes:a,getRecordMatcher:y}}function L_(n,o){const c={};for(const f of o)f in n&&(c[f]=n[f]);return c}function bE(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:wE(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function wE(n){const o={},c=n.props||!1;if("component"in n)o.default=c;else for(const f in n.components)o[f]=typeof c=="boolean"?c:c[f];return o}function O_(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function TE(n){return n.reduce((o,c)=>Ri(o,c.meta),{})}function B_(n,o){const c={};for(const f in n)c[f]=f in o?o[f]:n[f];return c}function vf(n,o){return n.name===o.name&&n.optional===o.optional&&n.repeatable===o.repeatable}function EE(n,o){for(const c of n.keys)if(!c.optional&&!o.keys.find(vf.bind(null,c)))return Ti(`Alias "${o.record.path}" and the original record: "${n.record.path}" must have the exact same param named "${c.name}"`);for(const c of o.keys)if(!c.optional&&!n.keys.find(vf.bind(null,c)))return Ti(`Alias "${o.record.path}" and the original record: "${n.record.path}" must have the exact same param named "${c.name}"`)}function SE(n,o){o&&o.record.name&&!n.name&&!n.path&&Ti(`The route named "${String(o.record.name)}" has a child without a name and an empty path. Using that name won't render the empty path child so you probably want to move the name to the child instead. If this is intentional, add a name to the child route to remove the warning.`)}function IE(n,o){for(const c of o.keys)if(!n.keys.find(vf.bind(null,c)))return Ti(`Absolute path "${n.record.path}" must have the exact same param named "${c.name}" as its parent "${o.record.path}".`)}function hx(n,o){return o.children.some(c=>c===n||hx(n,c))}const dx=/#/g,AE=/&/g,CE=/\//g,kE=/=/g,PE=/\?/g,px=/\+/g,ME=/%5B/g,zE=/%5D/g,fx=/%5E/g,DE=/%60/g,mx=/%7B/g,RE=/%7C/g,gx=/%7D/g,LE=/%20/g;function Kf(n){return encodeURI(""+n).replace(RE,"|").replace(ME,"[").replace(zE,"]")}function OE(n){return Kf(n).replace(mx,"{").replace(gx,"}").replace(fx,"^")}function xf(n){return Kf(n).replace(px,"%2B").replace(LE,"+").replace(dx,"%23").replace(AE,"%26").replace(DE,"`").replace(mx,"{").replace(gx,"}").replace(fx,"^")}function BE(n){return xf(n).replace(kE,"%3D")}function FE(n){return Kf(n).replace(dx,"%23").replace(PE,"%3F")}function $E(n){return n==null?"":FE(n).replace(CE,"%2F")}function Qc(n){try{return decodeURIComponent(""+n)}catch{Ti(`Error decoding "${n}". Using original value`)}return""+n}function UE(n){const o={};if(n===""||n==="?")return o;const f=(n[0]==="?"?n.slice(1):n).split("&");for(let y=0;y<f.length;++y){const v=f[y].replace(px," "),w=v.indexOf("="),a=Qc(w<0?v:v.slice(0,w)),k=w<0?null:Qc(v.slice(w+1));if(a in o){let $=o[a];Ar($)||($=o[a]=[$]),$.push(k)}else o[a]=k}return o}function F_(n){let o="";for(let c in n){const f=n[c];if(c=BE(c),f==null){f!==void 0&&(o+=(o.length?"&":"")+c);continue}(Ar(f)?f.map(v=>v&&xf(v)):[f&&xf(f)]).forEach(v=>{v!==void 0&&(o+=(o.length?"&":"")+c,v!=null&&(o+="="+v))})}return o}function NE(n){const o={};for(const c in n){const f=n[c];f!==void 0&&(o[c]=Ar(f)?f.map(y=>y==null?null:""+y):f==null?f:""+f)}return o}const VE=Symbol("router view location matched"),$_=Symbol("router view depth"),Jf=Symbol("router"),Yf=Symbol("route location"),bf=Symbol("router view location");function zc(){let n=[];function o(f){return n.push(f),()=>{const y=n.indexOf(f);y>-1&&n.splice(y,1)}}function c(){n=[]}return{add:o,list:()=>n,reset:c}}function fo(n,o,c,f,y){const v=f&&(f.enterCallbacks[y]=f.enterCallbacks[y]||[]);return()=>new Promise((w,a)=>{const k=B=>{B===!1?a(bl(4,{from:c,to:o})):B instanceof Error?a(B):aE(B)?a(bl(2,{from:o,to:B})):(v&&f.enterCallbacks[y]===v&&typeof B=="function"&&v.push(B),w())},$=n.call(f&&f.instances[y],o,c,jE(k,o,c));let F=Promise.resolve($);if(n.length<3&&(F=F.then(k)),n.length>2){const B=`The "next" callback was never called inside of ${n.name?'"'+n.name+'"':""}:
${n.toString()}
. If you are returning a value instead of calling "next", make sure to remove the "next" parameter from your function.`;if(typeof $=="object"&&"then"in $)F=F.then(M=>k._called?M:(Ti(B),Promise.reject(new Error("Invalid navigation guard"))));else if($!==void 0&&!k._called){Ti(B),a(new Error("Invalid navigation guard"));return}}F.catch(B=>a(B))})}function jE(n,o,c){let f=0;return function(){f++===1&&Ti(`The "next" callback was called more than once in one navigation guard when going from "${c.fullPath}" to "${o.fullPath}". It should be called exactly one time in each navigation guard. This will fail in production.`),n._called=!0,f===1&&n.apply(null,arguments)}}function Cp(n,o,c,f){const y=[];for(const v of n){!v.components&&!v.children.length&&Ti(`Record with path "${v.path}" is either missing a "component(s)" or "children" property.`);for(const w in v.components){let a=v.components[w];{if(!a||typeof a!="object"&&typeof a!="function")throw Ti(`Component "${w}" in record with path "${v.path}" is not a valid component. Received "${String(a)}".`),new Error("Invalid route component");if("then"in a){Ti(`Component "${w}" in record with path "${v.path}" is a Promise instead of a function that returns a Promise. Did you write "import('./MyPage.vue')" instead of "() => import('./MyPage.vue')" ? This will break in production if not fixed.`);const k=a;a=()=>k}else a.__asyncLoader&&!a.__warnedDefineAsync&&(a.__warnedDefineAsync=!0,Ti(`Component "${w}" in record with path "${v.path}" is defined using "defineAsyncComponent()". Write "() => import('./MyPage.vue')" instead of "defineAsyncComponent(() => import('./MyPage.vue'))".`))}if(!(o!=="beforeRouteEnter"&&!v.instances[w]))if(qE(a)){const $=(a.__vccOpts||a)[o];$&&y.push(fo($,c,f,v,w))}else{let k=a();"catch"in k||(Ti(`Component "${w}" in record with path "${v.path}" is a function that does not return a Promise. If you were passing a functional component, make sure to add a "displayName" to the component. This will break in production if not fixed.`),k=Promise.resolve(k)),y.push(()=>k.then($=>{if(!$)return Promise.reject(new Error(`Couldn't resolve component "${w}" at "${v.path}"`));const F=qT($)?$.default:$;v.components[w]=F;const M=(F.__vccOpts||F)[o];return M&&fo(M,c,f,v,w)()}))}}}return y}function qE(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function U_(n){const o=Jr(Jf),c=Jr(Yf),f=Ut(()=>o.resolve(Ve(n.to))),y=Ut(()=>{const{matched:k}=f.value,{length:$}=k,F=k[$-1],B=c.matched;if(!F||!B.length)return-1;const M=B.findIndex(wo.bind(null,F));if(M>-1)return M;const le=N_(k[$-2]);return $>1&&N_(F)===le&&B[B.length-1].path!==le?B.findIndex(wo.bind(null,k[$-2])):M}),v=Ut(()=>y.value>-1&&ZE(c.params,f.value.params)),w=Ut(()=>y.value>-1&&y.value===c.matched.length-1&&ax(c.params,f.value.params));function a(k={}){return WE(k)?o[Ve(n.replace)?"replace":"push"](Ve(n.to)).catch(Vc):Promise.resolve()}if(Os){const k=Cl();if(k){const $={route:f.value,isActive:v.value,isExactActive:w.value};k.__vrl_devtools=k.__vrl_devtools||[],k.__vrl_devtools.push($),vv(()=>{$.route=f.value,$.isActive=v.value,$.isExactActive=w.value},{flush:"post"})}}return{route:f,href:Ut(()=>f.value.href),isActive:v,isExactActive:w,navigate:a}}const GE=Dt({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:U_,setup(n,{slots:o}){const c=Il(U_(n)),{options:f}=Jr(Jf),y=Ut(()=>({[V_(n.activeClass,f.linkActiveClass,"router-link-active")]:c.isActive,[V_(n.exactActiveClass,f.linkExactActiveClass,"router-link-exact-active")]:c.isExactActive}));return()=>{const v=o.default&&o.default(c);return n.custom?v:Wf("a",{"aria-current":c.isExactActive?n.ariaCurrentValue:null,href:c.href,onClick:c.navigate,class:y.value},v)}}}),Qf=GE;function WE(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const o=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(o))return}return n.preventDefault&&n.preventDefault(),!0}}function ZE(n,o){for(const c in o){const f=o[c],y=n[c];if(typeof f=="string"){if(f!==y)return!1}else if(!Ar(y)||y.length!==f.length||f.some((v,w)=>v!==y[w]))return!1}return!0}function N_(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const V_=(n,o,c)=>n!=null?n:o!=null?o:c,HE=Dt({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:o,slots:c}){KE();const f=Jr(bf),y=Ut(()=>n.route||f.value),v=Jr($_,0),w=Ut(()=>{let $=Ve(v);const{matched:F}=y.value;let B;for(;(B=F[$])&&!B.components;)$++;return $}),a=Ut(()=>y.value.matched[w.value]);ml($_,Ut(()=>w.value+1)),ml(VE,a),ml(bf,y);const k=Ci();return lr(()=>[k.value,a.value,n.name],([$,F,B],[M,le,Ee])=>{F&&(F.instances[B]=$,le&&le!==F&&$&&$===M&&(F.leaveGuards.size||(F.leaveGuards=le.leaveGuards),F.updateGuards.size||(F.updateGuards=le.updateGuards))),$&&F&&(!le||!wo(F,le)||!M)&&(F.enterCallbacks[B]||[]).forEach(Oe=>Oe($))},{flush:"post"}),()=>{const $=y.value,F=n.name,B=a.value,M=B&&B.components[F];if(!M)return j_(c.default,{Component:M,route:$});const le=B.props[F],Ee=le?le===!0?$.params:typeof le=="function"?le($):le:null,Je=Wf(M,Ri({},Ee,o,{onVnodeUnmounted:He=>{He.component.isUnmounted&&(B.instances[F]=null)},ref:k}));if(Os&&Je.ref){const He={depth:w.value,name:B.name,path:B.path,meta:B.meta};(Ar(Je.ref)?Je.ref.map(tt=>tt.i):[Je.ref.i]).forEach(tt=>{tt.__vrv_devtools=He})}return j_(c.default,{Component:Je,route:$})||Je}}});function j_(n,o){if(!n)return null;const c=n(o);return c.length===1?c[0]:c}const XE=HE;function KE(){const n=Cl(),o=n.parent&&n.parent.type.name;if(o&&(o==="KeepAlive"||o.includes("Transition"))){const c=o==="KeepAlive"?"keep-alive":"transition";Ti(`<router-view> can no longer be used directly inside <transition> or <keep-alive>.
Use slot props instead:

<router-view v-slot="{ Component }">
  <${c}>
    <component :is="Component" />
  </${c}>
</router-view>`)}}function Dc(n,o){const c=Ri({},n,{matched:n.matched.map(f=>sS(f,["instances","children","aliasOf"]))});return{_custom:{type:null,readOnly:!0,display:n.fullPath,tooltip:o,value:c}}}function bh(n){return{_custom:{display:n}}}let JE=0;function YE(n,o,c){if(o.__hasDevtools)return;o.__hasDevtools=!0;const f=JE++;jT({id:"org.vuejs.router"+(f?"."+f:""),label:"Vue Router",packageName:"vue-router",homepage:"https://router.vuejs.org",logo:"https://router.vuejs.org/logo.png",componentStateTypes:["Routing"],app:n},y=>{typeof y.now!="function"&&console.warn("[Vue Router]: You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),y.on.inspectComponent((F,B)=>{F.instanceData&&F.instanceData.state.push({type:"Routing",key:"$route",editable:!1,value:Dc(o.currentRoute.value,"Current Route")})}),y.on.visitComponentTree(({treeNode:F,componentInstance:B})=>{if(B.__vrv_devtools){const M=B.__vrv_devtools;F.tags.push({label:(M.name?`${M.name.toString()}: `:"")+M.path,textColor:0,tooltip:"This component is rendered by &lt;router-view&gt;",backgroundColor:_x})}Ar(B.__vrl_devtools)&&(B.__devtoolsApi=y,B.__vrl_devtools.forEach(M=>{let le=xx,Ee="";M.isExactActive?(le=vx,Ee="This is exactly active"):M.isActive&&(le=yx,Ee="This link is active"),F.tags.push({label:M.route.path,textColor:0,tooltip:Ee,backgroundColor:le})}))}),lr(o.currentRoute,()=>{k(),y.notifyComponentUpdate(),y.sendInspectorTree(a),y.sendInspectorState(a)});const v="router:navigations:"+f;y.addTimelineLayer({id:v,label:`Router${f?" "+f:""} Navigations`,color:4237508}),o.onError((F,B)=>{y.addTimelineEvent({layerId:v,event:{title:"Error during Navigation",subtitle:B.fullPath,logType:"error",time:y.now(),data:{error:F},groupId:B.meta.__navigationId}})});let w=0;o.beforeEach((F,B)=>{const M={guard:bh("beforeEach"),from:Dc(B,"Current Location during this navigation"),to:Dc(F,"Target location")};Object.defineProperty(F.meta,"__navigationId",{value:w++}),y.addTimelineEvent({layerId:v,event:{time:y.now(),title:"Start of navigation",subtitle:F.fullPath,data:M,groupId:F.meta.__navigationId}})}),o.afterEach((F,B,M)=>{const le={guard:bh("afterEach")};M?(le.failure={_custom:{type:Error,readOnly:!0,display:M?M.message:"",tooltip:"Navigation Failure",value:M}},le.status=bh("\u274C")):le.status=bh("\u2705"),le.from=Dc(B,"Current Location during this navigation"),le.to=Dc(F,"Target location"),y.addTimelineEvent({layerId:v,event:{title:"End of navigation",subtitle:F.fullPath,time:y.now(),data:le,logType:M?"warning":"default",groupId:F.meta.__navigationId}})});const a="router-inspector:"+f;y.addInspector({id:a,label:"Routes"+(f?" "+f:""),icon:"book",treeFilterPlaceholder:"Search routes"});function k(){if(!$)return;const F=$;let B=c.getRoutes().filter(M=>!M.parent);B.forEach(Tx),F.filter&&(B=B.filter(M=>wf(M,F.filter.toLowerCase()))),B.forEach(M=>wx(M,o.currentRoute.value)),F.rootNodes=B.map(bx)}let $;y.on.getInspectorTree(F=>{$=F,F.app===n&&F.inspectorId===a&&k()}),y.on.getInspectorState(F=>{if(F.app===n&&F.inspectorId===a){const M=c.getRoutes().find(le=>le.record.__vd_id===F.nodeId);M&&(F.state={options:eS(M)})}}),y.sendInspectorTree(a),y.sendInspectorState(a)})}function QE(n){return n.optional?n.repeatable?"*":"?":n.repeatable?"+":""}function eS(n){const{record:o}=n,c=[{editable:!1,key:"path",value:o.path}];return o.name!=null&&c.push({editable:!1,key:"name",value:o.name}),c.push({editable:!1,key:"regexp",value:n.re}),n.keys.length&&c.push({editable:!1,key:"keys",value:{_custom:{type:null,readOnly:!0,display:n.keys.map(f=>`${f.name}${QE(f)}`).join(" "),tooltip:"Param keys",value:n.keys}}}),o.redirect!=null&&c.push({editable:!1,key:"redirect",value:o.redirect}),n.alias.length&&c.push({editable:!1,key:"aliases",value:n.alias.map(f=>f.record.path)}),Object.keys(n.record.meta).length&&c.push({editable:!1,key:"meta",value:n.record.meta}),c.push({key:"score",editable:!1,value:{_custom:{type:null,readOnly:!0,display:n.score.map(f=>f.join(", ")).join(" | "),tooltip:"Score used to sort routes",value:n.score}}}),c}const _x=15485081,yx=2450411,vx=8702998,tS=2282478,xx=16486972,iS=6710886;function bx(n){const o=[],{record:c}=n;c.name!=null&&o.push({label:String(c.name),textColor:0,backgroundColor:tS}),c.aliasOf&&o.push({label:"alias",textColor:0,backgroundColor:xx}),n.__vd_match&&o.push({label:"matches",textColor:0,backgroundColor:_x}),n.__vd_exactActive&&o.push({label:"exact",textColor:0,backgroundColor:vx}),n.__vd_active&&o.push({label:"active",textColor:0,backgroundColor:yx}),c.redirect&&o.push({label:typeof c.redirect=="string"?`redirect: ${c.redirect}`:"redirects",textColor:16777215,backgroundColor:iS});let f=c.__vd_id;return f==null&&(f=String(nS++),c.__vd_id=f),{id:f,label:c.path,tags:o,children:n.children.map(bx)}}let nS=0;const rS=/^\/(.*)\/([a-z]*)$/;function wx(n,o){const c=o.matched.length&&wo(o.matched[o.matched.length-1],n.record);n.__vd_exactActive=n.__vd_active=c,c||(n.__vd_active=o.matched.some(f=>wo(f,n.record))),n.children.forEach(f=>wx(f,o))}function Tx(n){n.__vd_match=!1,n.children.forEach(Tx)}function wf(n,o){const c=String(n.re).match(rS);if(n.__vd_match=!1,!c||c.length<3)return!1;if(new RegExp(c[1].replace(/\$$/,""),c[2]).test(o))return n.children.forEach(w=>wf(w,o)),n.record.path!=="/"||o==="/"?(n.__vd_match=n.re.test(o),!0):!1;const y=n.record.path.toLowerCase(),v=Qc(y);return!o.startsWith("/")&&(v.includes(o)||y.includes(o))||v.startsWith(o)||y.startsWith(o)||n.record.name&&String(n.record.name).includes(o)?!0:n.children.some(w=>wf(w,o))}function sS(n,o){const c={};for(const f in n)o.includes(f)||(c[f]=n[f]);return c}function oS(n){const o=xE(n.routes,n),c=n.parseQuery||UE,f=n.stringifyQuery||F_,y=n.history;if(!y)throw new Error('Provide the "history" option when calling "createRouter()": https://next.router.vuejs.org/api/#history.');const v=zc(),w=zc(),a=zc(),k=L1(uo);let $=uo;Os&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const F=Ip.bind(null,Te=>""+Te),B=Ip.bind(null,$E),M=Ip.bind(null,Qc);function le(Te,gt){let ut,ft;return cx(Te)?(ut=o.getRecordMatcher(Te),ft=gt):ft=Te,o.addRoute(ft,ut)}function Ee(Te){const gt=o.getRecordMatcher(Te);gt?o.removeRoute(gt):Ti(`Cannot remove non-existent route "${String(Te)}"`)}function Oe(){return o.getRoutes().map(Te=>Te.record)}function Je(Te){return!!o.getRecordMatcher(Te)}function He(Te,gt){if(gt=Ri({},gt||k.value),typeof Te=="string"){const Ft=Ap(c,Te,gt.path),ri=o.resolve({path:Ft.path},gt),X=y.createHref(Ft.fullPath);return X.startsWith("//")?Ti(`Location "${Te}" resolved to "${X}". A resolved location cannot start with multiple slashes.`):ri.matched.length||Ti(`No match found for location with path "${Te}"`),Ri(Ft,ri,{params:M(ri.params),hash:Qc(Ft.hash),redirectedFrom:void 0,href:X})}let ut;if("path"in Te)"params"in Te&&!("name"in Te)&&Object.keys(Te.params).length&&Ti(`Path "${Te.path}" was passed with params but they will be ignored. Use a named route alongside params instead.`),ut=Ri({},Te,{path:Ap(c,Te.path,gt.path).path});else{const Ft=Ri({},Te.params);for(const ri in Ft)Ft[ri]==null&&delete Ft[ri];ut=Ri({},Te,{params:B(Te.params)}),gt.params=B(gt.params)}const ft=o.resolve(ut,gt),$t=Te.hash||"";$t&&!$t.startsWith("#")&&Ti(`A \`hash\` should always start with the character "#". Replace "${$t}" with "#${$t}".`),ft.params=F(M(ft.params));const ki=ZT(f,Ri({},Te,{hash:OE($t),path:ft.path})),Gt=y.createHref(ki);return Gt.startsWith("//")?Ti(`Location "${Te}" resolved to "${Gt}". A resolved location cannot start with multiple slashes.`):ft.matched.length||Ti(`No match found for location with path "${"path"in Te?Te.path:Te}"`),Ri({fullPath:ki,hash:$t,query:f===F_?NE(Te.query):Te.query||{}},ft,{redirectedFrom:void 0,href:Gt})}function De(Te){return typeof Te=="string"?Ap(c,Te,k.value.path):Ri({},Te)}function tt(Te,gt){if($!==Te)return bl(8,{from:gt,to:Te})}function Nt(Te){return Xe(Te)}function Ce(Te){return Nt(Ri(De(Te),{replace:!0}))}function Zt(Te){const gt=Te.matched[Te.matched.length-1];if(gt&&gt.redirect){const{redirect:ut}=gt;let ft=typeof ut=="function"?ut(Te):ut;if(typeof ft=="string"&&(ft=ft.includes("?")||ft.includes("#")?ft=De(ft):{path:ft},ft.params={}),!("path"in ft)&&!("name"in ft))throw Ti(`Invalid redirect found:
${JSON.stringify(ft,null,2)}
 when navigating to "${Te.fullPath}". A redirect must contain a name or path. This will break in production.`),new Error("Invalid redirect");return Ri({query:Te.query,hash:Te.hash,params:"path"in ft?{}:Te.params},ft)}}function Xe(Te,gt){const ut=$=He(Te),ft=k.value,$t=Te.state,ki=Te.force,Gt=Te.replace===!0,Ft=Zt(ut);if(Ft)return Xe(Ri(De(Ft),{state:typeof Ft=="object"?Ri({},$t,Ft.state):$t,force:ki,replace:Gt}),gt||ut);const ri=ut;ri.redirectedFrom=gt;let X;return!ki&&C_(f,ft,ut)&&(X=bl(16,{to:ri,from:ft}),Ni(ft,ft,!0,!1)),(X?Promise.resolve(X):it(ri,ft)).catch(ie=>Ds(ie)?Ds(ie,2)?ie:Oi(ie):St(ie,ri,ft)).then(ie=>{if(ie){if(Ds(ie,2))return C_(f,He(ie.to),ri)&&gt&&(gt._count=gt._count?gt._count+1:1)>10?(Ti(`Detected an infinite redirection in a navigation guard when going from "${ft.fullPath}" to "${ri.fullPath}". Aborting to avoid a Stack Overflow. This will break in production if not fixed.`),Promise.reject(new Error("Infinite redirect in navigation guard"))):Xe(Ri({replace:Gt},De(ie.to),{state:typeof ie.to=="object"?Ri({},$t,ie.to.state):$t,force:ki}),gt||ri)}else ie=ct(ri,ft,!0,Gt,$t);return Ue(ri,ft,ie),ie})}function ht(Te,gt){const ut=tt(Te,gt);return ut?Promise.reject(ut):Promise.resolve()}function it(Te,gt){let ut;const[ft,$t,ki]=aS(Te,gt);ut=Cp(ft.reverse(),"beforeRouteLeave",Te,gt);for(const Ft of ft)Ft.leaveGuards.forEach(ri=>{ut.push(fo(ri,Te,gt))});const Gt=ht.bind(null,Te,gt);return ut.push(Gt),al(ut).then(()=>{ut=[];for(const Ft of v.list())ut.push(fo(Ft,Te,gt));return ut.push(Gt),al(ut)}).then(()=>{ut=Cp($t,"beforeRouteUpdate",Te,gt);for(const Ft of $t)Ft.updateGuards.forEach(ri=>{ut.push(fo(ri,Te,gt))});return ut.push(Gt),al(ut)}).then(()=>{ut=[];for(const Ft of Te.matched)if(Ft.beforeEnter&&!gt.matched.includes(Ft))if(Ar(Ft.beforeEnter))for(const ri of Ft.beforeEnter)ut.push(fo(ri,Te,gt));else ut.push(fo(Ft.beforeEnter,Te,gt));return ut.push(Gt),al(ut)}).then(()=>(Te.matched.forEach(Ft=>Ft.enterCallbacks={}),ut=Cp(ki,"beforeRouteEnter",Te,gt),ut.push(Gt),al(ut))).then(()=>{ut=[];for(const Ft of w.list())ut.push(fo(Ft,Te,gt));return ut.push(Gt),al(ut)}).catch(Ft=>Ds(Ft,8)?Ft:Promise.reject(Ft))}function Ue(Te,gt,ut){for(const ft of a.list())ft(Te,gt,ut)}function ct(Te,gt,ut,ft,$t){const ki=tt(Te,gt);if(ki)return ki;const Gt=gt===uo,Ft=Os?history.state:{};ut&&(ft||Gt?y.replace(Te.fullPath,Ri({scroll:Gt&&Ft&&Ft.scroll},$t)):y.push(Te.fullPath,$t)),k.value=Te,Ni(Te,gt,ut,Gt),Oi()}let Re;function Rt(){Re||(Re=y.listen((Te,gt,ut)=>{if(!pn.listening)return;const ft=He(Te),$t=Zt(ft);if($t){Xe(Ri($t,{replace:!0}),ft).catch(Vc);return}$=ft;const ki=k.value;Os&&tE(P_(ki.fullPath,ut.delta),sd()),it(ft,ki).catch(Gt=>Ds(Gt,12)?Gt:Ds(Gt,2)?(Xe(Gt.to,ft).then(Ft=>{Ds(Ft,20)&&!ut.delta&&ut.type===Yc.pop&&y.go(-1,!1)}).catch(Vc),Promise.reject()):(ut.delta&&y.go(-ut.delta,!1),St(Gt,ft,ki))).then(Gt=>{Gt=Gt||ct(ft,ki,!1),Gt&&(ut.delta&&!Ds(Gt,8)?y.go(-ut.delta,!1):ut.type===Yc.pop&&Ds(Gt,20)&&y.go(-1,!1)),Ue(ft,ki,Gt)}).catch(Vc)}))}let ai=zc(),yi=zc(),We;function St(Te,gt,ut){Oi(Te);const ft=yi.list();return ft.length?ft.forEach($t=>$t(Te,gt,ut)):(Ti("uncaught error during route navigation:"),console.error(Te)),Promise.reject(Te)}function Xt(){return We&&k.value!==uo?Promise.resolve():new Promise((Te,gt)=>{ai.add([Te,gt])})}function Oi(Te){return We||(We=!Te,Rt(),ai.list().forEach(([gt,ut])=>Te?ut(Te):gt()),ai.reset()),Te}function Ni(Te,gt,ut,ft){const{scrollBehavior:$t}=n;if(!Os||!$t)return Promise.resolve();const ki=!ut&&iE(P_(Te.fullPath,0))||(ft||!ut)&&history.state&&history.state.scroll||null;return Zc().then(()=>$t(Te,gt,ki)).then(Gt=>Gt&&eE(Gt)).catch(Gt=>St(Gt,Te,gt))}const In=Te=>y.go(Te);let Bn;const Fn=new Set,pn={currentRoute:k,listening:!0,addRoute:le,removeRoute:Ee,hasRoute:Je,getRoutes:Oe,resolve:He,options:n,push:Nt,replace:Ce,go:In,back:()=>In(-1),forward:()=>In(1),beforeEach:v.add,beforeResolve:w.add,afterEach:a.add,onError:yi.add,isReady:Xt,install(Te){const gt=this;Te.component("RouterLink",Qf),Te.component("RouterView",XE),Te.config.globalProperties.$router=gt,Object.defineProperty(Te.config.globalProperties,"$route",{enumerable:!0,get:()=>Ve(k)}),Os&&!Bn&&k.value===uo&&(Bn=!0,Nt(y.location).catch($t=>{Ti("Unexpected error when starting the router:",$t)}));const ut={};for(const $t in uo)ut[$t]=Ut(()=>k.value[$t]);Te.provide(Jf,gt),Te.provide(Yf,Il(ut)),Te.provide(bf,k);const ft=Te.unmount;Fn.add(Te),Te.unmount=function(){Fn.delete(Te),Fn.size<1&&($=uo,Re&&Re(),Re=null,k.value=uo,Bn=!1,We=!1),ft()},Os&&YE(Te,gt,o)}};return pn}function al(n){return n.reduce((o,c)=>o.then(()=>c()),Promise.resolve())}function aS(n,o){const c=[],f=[],y=[],v=Math.max(o.matched.length,n.matched.length);for(let w=0;w<v;w++){const a=o.matched[w];a&&(n.matched.find($=>wo($,a))?f.push(a):c.push(a));const k=n.matched[w];k&&(o.matched.find($=>wo($,k))||y.push(k))}return[c,f,y]}function lS(){return Jr(Yf)}var cS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uS(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ex={exports:{}},em={exports:{}},Sx=function(o,c){return function(){for(var y=new Array(arguments.length),v=0;v<y.length;v++)y[v]=arguments[v];return o.apply(c,y)}},hS=Sx,tm=Object.prototype.toString,im=function(n){return function(o){var c=tm.call(o);return n[c]||(n[c]=c.slice(8,-1).toLowerCase())}}(Object.create(null));function Ia(n){return n=n.toLowerCase(),function(c){return im(c)===n}}function nm(n){return Array.isArray(n)}function jh(n){return typeof n>"u"}function dS(n){return n!==null&&!jh(n)&&n.constructor!==null&&!jh(n.constructor)&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}var Ix=Ia("ArrayBuffer");function pS(n){var o;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?o=ArrayBuffer.isView(n):o=n&&n.buffer&&Ix(n.buffer),o}function fS(n){return typeof n=="string"}function mS(n){return typeof n=="number"}function Ax(n){return n!==null&&typeof n=="object"}function Ph(n){if(im(n)!=="object")return!1;var o=Object.getPrototypeOf(n);return o===null||o===Object.prototype}var gS=Ia("Date"),_S=Ia("File"),yS=Ia("Blob"),vS=Ia("FileList");function rm(n){return tm.call(n)==="[object Function]"}function xS(n){return Ax(n)&&rm(n.pipe)}function bS(n){var o="[object FormData]";return n&&(typeof FormData=="function"&&n instanceof FormData||tm.call(n)===o||rm(n.toString)&&n.toString()===o)}var wS=Ia("URLSearchParams");function TS(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function ES(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function sm(n,o){if(!(n===null||typeof n>"u"))if(typeof n!="object"&&(n=[n]),nm(n))for(var c=0,f=n.length;c<f;c++)o.call(null,n[c],c,n);else for(var y in n)Object.prototype.hasOwnProperty.call(n,y)&&o.call(null,n[y],y,n)}function Tf(){var n={};function o(y,v){Ph(n[v])&&Ph(y)?n[v]=Tf(n[v],y):Ph(y)?n[v]=Tf({},y):nm(y)?n[v]=y.slice():n[v]=y}for(var c=0,f=arguments.length;c<f;c++)sm(arguments[c],o);return n}function SS(n,o,c){return sm(o,function(y,v){c&&typeof y=="function"?n[v]=hS(y,c):n[v]=y}),n}function IS(n){return n.charCodeAt(0)===65279&&(n=n.slice(1)),n}function AS(n,o,c,f){n.prototype=Object.create(o.prototype,f),n.prototype.constructor=n,c&&Object.assign(n.prototype,c)}function CS(n,o,c){var f,y,v,w={};o=o||{};do{for(f=Object.getOwnPropertyNames(n),y=f.length;y-- >0;)v=f[y],w[v]||(o[v]=n[v],w[v]=!0);n=Object.getPrototypeOf(n)}while(n&&(!c||c(n,o))&&n!==Object.prototype);return o}function kS(n,o,c){n=String(n),(c===void 0||c>n.length)&&(c=n.length),c-=o.length;var f=n.indexOf(o,c);return f!==-1&&f===c}function PS(n){if(!n)return null;var o=n.length;if(jh(o))return null;for(var c=new Array(o);o-- >0;)c[o]=n[o];return c}var MS=function(n){return function(o){return n&&o instanceof n}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array)),jn={isArray:nm,isArrayBuffer:Ix,isBuffer:dS,isFormData:bS,isArrayBufferView:pS,isString:fS,isNumber:mS,isObject:Ax,isPlainObject:Ph,isUndefined:jh,isDate:gS,isFile:_S,isBlob:yS,isFunction:rm,isStream:xS,isURLSearchParams:wS,isStandardBrowserEnv:ES,forEach:sm,merge:Tf,extend:SS,trim:TS,stripBOM:IS,inherits:AS,toFlatObject:CS,kindOf:im,kindOfTest:Ia,endsWith:kS,toArray:PS,isTypedArray:MS,isFileList:vS},ll=jn;function q_(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Cx=function(o,c,f){if(!c)return o;var y;if(f)y=f(c);else if(ll.isURLSearchParams(c))y=c.toString();else{var v=[];ll.forEach(c,function(k,$){k===null||typeof k>"u"||(ll.isArray(k)?$=$+"[]":k=[k],ll.forEach(k,function(B){ll.isDate(B)?B=B.toISOString():ll.isObject(B)&&(B=JSON.stringify(B)),v.push(q_($)+"="+q_(B))}))}),y=v.join("&")}if(y){var w=o.indexOf("#");w!==-1&&(o=o.slice(0,w)),o+=(o.indexOf("?")===-1?"?":"&")+y}return o},zS=jn;function od(){this.handlers=[]}od.prototype.use=function(o,c,f){return this.handlers.push({fulfilled:o,rejected:c,synchronous:f?f.synchronous:!1,runWhen:f?f.runWhen:null}),this.handlers.length-1};od.prototype.eject=function(o){this.handlers[o]&&(this.handlers[o]=null)};od.prototype.forEach=function(o){zS.forEach(this.handlers,function(f){f!==null&&o(f)})};var DS=od,RS=jn,LS=function(o,c){RS.forEach(o,function(y,v){v!==c&&v.toUpperCase()===c.toUpperCase()&&(o[c]=y,delete o[v])})},kx=jn;function wl(n,o,c,f,y){Error.call(this),this.message=n,this.name="AxiosError",o&&(this.code=o),c&&(this.config=c),f&&(this.request=f),y&&(this.response=y)}kx.inherits(wl,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var Px=wl.prototype,Mx={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(n){Mx[n]={value:n}});Object.defineProperties(wl,Mx);Object.defineProperty(Px,"isAxiosError",{value:!0});wl.from=function(n,o,c,f,y,v){var w=Object.create(Px);return kx.toFlatObject(n,w,function(k){return k!==Error.prototype}),wl.call(w,n.message,o,c,f,y),w.name=n.name,v&&Object.assign(w,v),w};var kl=wl,zx={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Gr=jn;function OS(n,o){o=o||new FormData;var c=[];function f(v){return v===null?"":Gr.isDate(v)?v.toISOString():Gr.isArrayBuffer(v)||Gr.isTypedArray(v)?typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function y(v,w){if(Gr.isPlainObject(v)||Gr.isArray(v)){if(c.indexOf(v)!==-1)throw Error("Circular reference detected in "+w);c.push(v),Gr.forEach(v,function(k,$){if(!Gr.isUndefined(k)){var F=w?w+"."+$:$,B;if(k&&!w&&typeof k=="object"){if(Gr.endsWith($,"{}"))k=JSON.stringify(k);else if(Gr.endsWith($,"[]")&&(B=Gr.toArray(k))){B.forEach(function(M){!Gr.isUndefined(M)&&o.append(F,f(M))});return}}y(k,F)}}),c.pop()}else o.append(w,f(v))}return y(n),o}var Dx=OS,kp,G_;function BS(){if(G_)return kp;G_=1;var n=kl;return kp=function(c,f,y){var v=y.config.validateStatus;!y.status||!v||v(y.status)?c(y):f(new n("Request failed with status code "+y.status,[n.ERR_BAD_REQUEST,n.ERR_BAD_RESPONSE][Math.floor(y.status/100)-4],y.config,y.request,y))},kp}var Pp,W_;function FS(){if(W_)return Pp;W_=1;var n=jn;return Pp=n.isStandardBrowserEnv()?function(){return{write:function(f,y,v,w,a,k){var $=[];$.push(f+"="+encodeURIComponent(y)),n.isNumber(v)&&$.push("expires="+new Date(v).toGMTString()),n.isString(w)&&$.push("path="+w),n.isString(a)&&$.push("domain="+a),k===!0&&$.push("secure"),document.cookie=$.join("; ")},read:function(f){var y=document.cookie.match(new RegExp("(^|;\\s*)("+f+")=([^;]*)"));return y?decodeURIComponent(y[3]):null},remove:function(f){this.write(f,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),Pp}var $S=function(o){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(o)},US=function(o,c){return c?o.replace(/\/+$/,"")+"/"+c.replace(/^\/+/,""):o},NS=$S,VS=US,Rx=function(o,c){return o&&!NS(c)?VS(o,c):c},Mp,Z_;function jS(){if(Z_)return Mp;Z_=1;var n=jn,o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return Mp=function(f){var y={},v,w,a;return f&&n.forEach(f.split(`
`),function($){if(a=$.indexOf(":"),v=n.trim($.substr(0,a)).toLowerCase(),w=n.trim($.substr(a+1)),v){if(y[v]&&o.indexOf(v)>=0)return;v==="set-cookie"?y[v]=(y[v]?y[v]:[]).concat([w]):y[v]=y[v]?y[v]+", "+w:w}}),y},Mp}var zp,H_;function qS(){if(H_)return zp;H_=1;var n=jn;return zp=n.isStandardBrowserEnv()?function(){var c=/(msie|trident)/i.test(navigator.userAgent),f=document.createElement("a"),y;function v(w){var a=w;return c&&(f.setAttribute("href",a),a=f.href),f.setAttribute("href",a),{href:f.href,protocol:f.protocol?f.protocol.replace(/:$/,""):"",host:f.host,search:f.search?f.search.replace(/^\?/,""):"",hash:f.hash?f.hash.replace(/^#/,""):"",hostname:f.hostname,port:f.port,pathname:f.pathname.charAt(0)==="/"?f.pathname:"/"+f.pathname}}return y=v(window.location.href),function(a){var k=n.isString(a)?v(a):a;return k.protocol===y.protocol&&k.host===y.host}}():function(){return function(){return!0}}(),zp}var Dp,X_;function ad(){if(X_)return Dp;X_=1;var n=kl,o=jn;function c(f){n.call(this,f==null?"canceled":f,n.ERR_CANCELED),this.name="CanceledError"}return o.inherits(c,n,{__CANCEL__:!0}),Dp=c,Dp}var Rp,K_;function GS(){return K_||(K_=1,Rp=function(o){var c=/^([-+\w]{1,25})(:?\/\/|:)/.exec(o);return c&&c[1]||""}),Rp}var Lp,J_;function Y_(){if(J_)return Lp;J_=1;var n=jn,o=BS(),c=FS(),f=Cx,y=Rx,v=jS(),w=qS(),a=zx,k=kl,$=ad(),F=GS();return Lp=function(M){return new Promise(function(Ee,Oe){var Je=M.data,He=M.headers,De=M.responseType,tt;function Nt(){M.cancelToken&&M.cancelToken.unsubscribe(tt),M.signal&&M.signal.removeEventListener("abort",tt)}n.isFormData(Je)&&n.isStandardBrowserEnv()&&delete He["Content-Type"];var Ce=new XMLHttpRequest;if(M.auth){var Zt=M.auth.username||"",Xe=M.auth.password?unescape(encodeURIComponent(M.auth.password)):"";He.Authorization="Basic "+btoa(Zt+":"+Xe)}var ht=y(M.baseURL,M.url);Ce.open(M.method.toUpperCase(),f(ht,M.params,M.paramsSerializer),!0),Ce.timeout=M.timeout;function it(){if(!!Ce){var Re="getAllResponseHeaders"in Ce?v(Ce.getAllResponseHeaders()):null,Rt=!De||De==="text"||De==="json"?Ce.responseText:Ce.response,ai={data:Rt,status:Ce.status,statusText:Ce.statusText,headers:Re,config:M,request:Ce};o(function(We){Ee(We),Nt()},function(We){Oe(We),Nt()},ai),Ce=null}}if("onloadend"in Ce?Ce.onloadend=it:Ce.onreadystatechange=function(){!Ce||Ce.readyState!==4||Ce.status===0&&!(Ce.responseURL&&Ce.responseURL.indexOf("file:")===0)||setTimeout(it)},Ce.onabort=function(){!Ce||(Oe(new k("Request aborted",k.ECONNABORTED,M,Ce)),Ce=null)},Ce.onerror=function(){Oe(new k("Network Error",k.ERR_NETWORK,M,Ce,Ce)),Ce=null},Ce.ontimeout=function(){var Rt=M.timeout?"timeout of "+M.timeout+"ms exceeded":"timeout exceeded",ai=M.transitional||a;M.timeoutErrorMessage&&(Rt=M.timeoutErrorMessage),Oe(new k(Rt,ai.clarifyTimeoutError?k.ETIMEDOUT:k.ECONNABORTED,M,Ce)),Ce=null},n.isStandardBrowserEnv()){var Ue=(M.withCredentials||w(ht))&&M.xsrfCookieName?c.read(M.xsrfCookieName):void 0;Ue&&(He[M.xsrfHeaderName]=Ue)}"setRequestHeader"in Ce&&n.forEach(He,function(Rt,ai){typeof Je>"u"&&ai.toLowerCase()==="content-type"?delete He[ai]:Ce.setRequestHeader(ai,Rt)}),n.isUndefined(M.withCredentials)||(Ce.withCredentials=!!M.withCredentials),De&&De!=="json"&&(Ce.responseType=M.responseType),typeof M.onDownloadProgress=="function"&&Ce.addEventListener("progress",M.onDownloadProgress),typeof M.onUploadProgress=="function"&&Ce.upload&&Ce.upload.addEventListener("progress",M.onUploadProgress),(M.cancelToken||M.signal)&&(tt=function(Re){!Ce||(Oe(!Re||Re&&Re.type?new $:Re),Ce.abort(),Ce=null)},M.cancelToken&&M.cancelToken.subscribe(tt),M.signal&&(M.signal.aborted?tt():M.signal.addEventListener("abort",tt))),Je||(Je=null);var ct=F(ht);if(ct&&["http","https","file"].indexOf(ct)===-1){Oe(new k("Unsupported protocol "+ct+":",k.ERR_BAD_REQUEST,M));return}Ce.send(Je)})},Lp}var Op,Q_;function WS(){return Q_||(Q_=1,Op=null),Op}var Dn=jn,ey=LS,ty=kl,ZS=zx,HS=Dx,XS={"Content-Type":"application/x-www-form-urlencoded"};function iy(n,o){!Dn.isUndefined(n)&&Dn.isUndefined(n["Content-Type"])&&(n["Content-Type"]=o)}function KS(){var n;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(n=Y_()),n}function JS(n,o,c){if(Dn.isString(n))try{return(o||JSON.parse)(n),Dn.trim(n)}catch(f){if(f.name!=="SyntaxError")throw f}return(c||JSON.stringify)(n)}var ld={transitional:ZS,adapter:KS(),transformRequest:[function(o,c){if(ey(c,"Accept"),ey(c,"Content-Type"),Dn.isFormData(o)||Dn.isArrayBuffer(o)||Dn.isBuffer(o)||Dn.isStream(o)||Dn.isFile(o)||Dn.isBlob(o))return o;if(Dn.isArrayBufferView(o))return o.buffer;if(Dn.isURLSearchParams(o))return iy(c,"application/x-www-form-urlencoded;charset=utf-8"),o.toString();var f=Dn.isObject(o),y=c&&c["Content-Type"],v;if((v=Dn.isFileList(o))||f&&y==="multipart/form-data"){var w=this.env&&this.env.FormData;return HS(v?{"files[]":o}:o,w&&new w)}else if(f||y==="application/json")return iy(c,"application/json"),JS(o);return o}],transformResponse:[function(o){var c=this.transitional||ld.transitional,f=c&&c.silentJSONParsing,y=c&&c.forcedJSONParsing,v=!f&&this.responseType==="json";if(v||y&&Dn.isString(o)&&o.length)try{return JSON.parse(o)}catch(w){if(v)throw w.name==="SyntaxError"?ty.from(w,ty.ERR_BAD_RESPONSE,this,null,this.response):w}return o}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:WS()},validateStatus:function(o){return o>=200&&o<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Dn.forEach(["delete","get","head"],function(o){ld.headers[o]={}});Dn.forEach(["post","put","patch"],function(o){ld.headers[o]=Dn.merge(XS)});var om=ld,YS=jn,QS=om,eI=function(o,c,f){var y=this||QS;return YS.forEach(f,function(w){o=w.call(y,o,c)}),o},Bp,ny;function Lx(){return ny||(ny=1,Bp=function(o){return!!(o&&o.__CANCEL__)}),Bp}var ry=jn,Fp=eI,tI=Lx(),iI=om,nI=ad();function $p(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new nI}var rI=function(o){$p(o),o.headers=o.headers||{},o.data=Fp.call(o,o.data,o.headers,o.transformRequest),o.headers=ry.merge(o.headers.common||{},o.headers[o.method]||{},o.headers),ry.forEach(["delete","get","head","post","put","patch","common"],function(y){delete o.headers[y]});var c=o.adapter||iI.adapter;return c(o).then(function(y){return $p(o),y.data=Fp.call(o,y.data,y.headers,o.transformResponse),y},function(y){return tI(y)||($p(o),y&&y.response&&(y.response.data=Fp.call(o,y.response.data,y.response.headers,o.transformResponse))),Promise.reject(y)})},Er=jn,Ox=function(o,c){c=c||{};var f={};function y(F,B){return Er.isPlainObject(F)&&Er.isPlainObject(B)?Er.merge(F,B):Er.isPlainObject(B)?Er.merge({},B):Er.isArray(B)?B.slice():B}function v(F){if(Er.isUndefined(c[F])){if(!Er.isUndefined(o[F]))return y(void 0,o[F])}else return y(o[F],c[F])}function w(F){if(!Er.isUndefined(c[F]))return y(void 0,c[F])}function a(F){if(Er.isUndefined(c[F])){if(!Er.isUndefined(o[F]))return y(void 0,o[F])}else return y(void 0,c[F])}function k(F){if(F in c)return y(o[F],c[F]);if(F in o)return y(void 0,o[F])}var $={url:w,method:w,data:w,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:k};return Er.forEach(Object.keys(o).concat(Object.keys(c)),function(B){var M=$[B]||v,le=M(B);Er.isUndefined(le)&&M!==k||(f[B]=le)}),f},Up,sy;function Bx(){return sy||(sy=1,Up={version:"0.27.2"}),Up}var sI=Bx().version,mo=kl,am={};["object","boolean","number","function","string","symbol"].forEach(function(n,o){am[n]=function(f){return typeof f===n||"a"+(o<1?"n ":" ")+n}});var oy={};am.transitional=function(o,c,f){function y(v,w){return"[Axios v"+sI+"] Transitional option '"+v+"'"+w+(f?". "+f:"")}return function(v,w,a){if(o===!1)throw new mo(y(w," has been removed"+(c?" in "+c:"")),mo.ERR_DEPRECATED);return c&&!oy[w]&&(oy[w]=!0,console.warn(y(w," has been deprecated since v"+c+" and will be removed in the near future"))),o?o(v,w,a):!0}};function oI(n,o,c){if(typeof n!="object")throw new mo("options must be an object",mo.ERR_BAD_OPTION_VALUE);for(var f=Object.keys(n),y=f.length;y-- >0;){var v=f[y],w=o[v];if(w){var a=n[v],k=a===void 0||w(a,v,n);if(k!==!0)throw new mo("option "+v+" must be "+k,mo.ERR_BAD_OPTION_VALUE);continue}if(c!==!0)throw new mo("Unknown option "+v,mo.ERR_BAD_OPTION)}}var aI={assertOptions:oI,validators:am},Fx=jn,lI=Cx,ay=DS,ly=rI,cd=Ox,cI=Rx,$x=aI,cl=$x.validators;function Tl(n){this.defaults=n,this.interceptors={request:new ay,response:new ay}}Tl.prototype.request=function(o,c){typeof o=="string"?(c=c||{},c.url=o):c=o||{},c=cd(this.defaults,c),c.method?c.method=c.method.toLowerCase():this.defaults.method?c.method=this.defaults.method.toLowerCase():c.method="get";var f=c.transitional;f!==void 0&&$x.assertOptions(f,{silentJSONParsing:cl.transitional(cl.boolean),forcedJSONParsing:cl.transitional(cl.boolean),clarifyTimeoutError:cl.transitional(cl.boolean)},!1);var y=[],v=!0;this.interceptors.request.forEach(function(le){typeof le.runWhen=="function"&&le.runWhen(c)===!1||(v=v&&le.synchronous,y.unshift(le.fulfilled,le.rejected))});var w=[];this.interceptors.response.forEach(function(le){w.push(le.fulfilled,le.rejected)});var a;if(!v){var k=[ly,void 0];for(Array.prototype.unshift.apply(k,y),k=k.concat(w),a=Promise.resolve(c);k.length;)a=a.then(k.shift(),k.shift());return a}for(var $=c;y.length;){var F=y.shift(),B=y.shift();try{$=F($)}catch(M){B(M);break}}try{a=ly($)}catch(M){return Promise.reject(M)}for(;w.length;)a=a.then(w.shift(),w.shift());return a};Tl.prototype.getUri=function(o){o=cd(this.defaults,o);var c=cI(o.baseURL,o.url);return lI(c,o.params,o.paramsSerializer)};Fx.forEach(["delete","get","head","options"],function(o){Tl.prototype[o]=function(c,f){return this.request(cd(f||{},{method:o,url:c,data:(f||{}).data}))}});Fx.forEach(["post","put","patch"],function(o){function c(f){return function(v,w,a){return this.request(cd(a||{},{method:o,headers:f?{"Content-Type":"multipart/form-data"}:{},url:v,data:w}))}}Tl.prototype[o]=c(),Tl.prototype[o+"Form"]=c(!0)});var uI=Tl,Np,cy;function hI(){if(cy)return Np;cy=1;var n=ad();function o(c){if(typeof c!="function")throw new TypeError("executor must be a function.");var f;this.promise=new Promise(function(w){f=w});var y=this;this.promise.then(function(v){if(!!y._listeners){var w,a=y._listeners.length;for(w=0;w<a;w++)y._listeners[w](v);y._listeners=null}}),this.promise.then=function(v){var w,a=new Promise(function(k){y.subscribe(k),w=k}).then(v);return a.cancel=function(){y.unsubscribe(w)},a},c(function(w){y.reason||(y.reason=new n(w),f(y.reason))})}return o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.prototype.subscribe=function(f){if(this.reason){f(this.reason);return}this._listeners?this._listeners.push(f):this._listeners=[f]},o.prototype.unsubscribe=function(f){if(!!this._listeners){var y=this._listeners.indexOf(f);y!==-1&&this._listeners.splice(y,1)}},o.source=function(){var f,y=new o(function(w){f=w});return{token:y,cancel:f}},Np=o,Np}var Vp,uy;function dI(){return uy||(uy=1,Vp=function(o){return function(f){return o.apply(null,f)}}),Vp}var jp,hy;function pI(){if(hy)return jp;hy=1;var n=jn;return jp=function(c){return n.isObject(c)&&c.isAxiosError===!0},jp}var dy=jn,fI=Sx,Mh=uI,mI=Ox,gI=om;function Ux(n){var o=new Mh(n),c=fI(Mh.prototype.request,o);return dy.extend(c,Mh.prototype,o),dy.extend(c,o),c.create=function(y){return Ux(mI(n,y))},c}var gr=Ux(gI);gr.Axios=Mh;gr.CanceledError=ad();gr.CancelToken=hI();gr.isCancel=Lx();gr.VERSION=Bx().version;gr.toFormData=Dx;gr.AxiosError=kl;gr.Cancel=gr.CanceledError;gr.all=function(o){return Promise.all(o)};gr.spread=dI();gr.isAxiosError=pI();em.exports=gr;em.exports.default=gr;(function(n){n.exports=em.exports})(Ex);const su=uS(Ex.exports);function Qi(n){return n!=null&&typeof n=="object"&&n["@@functional/placeholder"]===!0}function fa(n){return function o(c){return arguments.length===0||Qi(c)?o:n.apply(this,arguments)}}function aa(n){return function o(c,f){switch(arguments.length){case 0:return o;case 1:return Qi(c)?o:fa(function(y){return n(c,y)});default:return Qi(c)&&Qi(f)?o:Qi(c)?fa(function(y){return n(y,f)}):Qi(f)?fa(function(y){return n(c,y)}):n(c,f)}}}function Nx(n){return function o(c,f,y){switch(arguments.length){case 0:return o;case 1:return Qi(c)?o:aa(function(v,w){return n(c,v,w)});case 2:return Qi(c)&&Qi(f)?o:Qi(c)?aa(function(v,w){return n(v,f,w)}):Qi(f)?aa(function(v,w){return n(c,v,w)}):fa(function(v){return n(c,f,v)});default:return Qi(c)&&Qi(f)&&Qi(y)?o:Qi(c)&&Qi(f)?aa(function(v,w){return n(v,w,y)}):Qi(c)&&Qi(y)?aa(function(v,w){return n(v,f,w)}):Qi(f)&&Qi(y)?aa(function(v,w){return n(c,v,w)}):Qi(c)?fa(function(v){return n(v,f,y)}):Qi(f)?fa(function(v){return n(c,v,y)}):Qi(y)?fa(function(v){return n(c,f,v)}):n(c,f,y)}}}function wh(n,o){return Object.prototype.hasOwnProperty.call(o,n)}function py(n){return Object.prototype.toString.call(n)==="[object Object]"}var _I=Nx(function(o,c,f){var y={},v;for(v in c)wh(v,c)&&(y[v]=wh(v,f)?o(v,c[v],f[v]):c[v]);for(v in f)wh(v,f)&&!wh(v,y)&&(y[v]=f[v]);return y});const yI=_I;var vI=Nx(function n(o,c,f){return yI(function(y,v,w){return py(v)&&py(w)?n(o,v,w):o(y,v,w)},c,f)});const xI=vI;var bI=aa(function(o,c){return xI(function(f,y,v){return v},o,c)});const wI=bI;var Cy;const TI={baseUrl:{BASE_URL:"/",MODE:"development",DEV:!0,PROD:!1}.VITE_BASE_URL||"http://localhost",arcgis:{apiKey:(Cy={BASE_URL:"/",MODE:"development",DEV:!0,PROD:!1}.VITE_ARCGIS_API_KEY)!=null?Cy:"PLEASE_SET_MAPBOX_ACCESS_TOKEN"}};var ky,Py;const tn=wI(TI,(Py=(ky=window==null?void 0:window.Elevator)==null?void 0:ky.config)!=null?Py:{}),fy=new Map,my=new Map,gy=new Map,_y=new Map,yy=new Map;async function EI(n){var c;return(c=(await su.get(`${tn.baseUrl}/asset/viewAsset/${n}/true`)).data)!=null?c:null}async function SI(n){var c;return(c=(await su.get(`${tn.baseUrl}/assetManager/getTemplate/${n}`)).data)!=null?c:null}async function II(n){const o=new FormData;return o.append("suppressRecent","true"),o.append("searchReleated","true"),o.append("searchQuery",JSON.stringify({searchText:n})),(await su.post(`${tn.baseUrl}/search/searchResults`,o)).data.matches.filter(f=>f.objectId!==n)}async function AI(n){return(await su.get(`${tn.baseUrl}/fileManager/getMetadataForObject/${n}`)).data}async function CI(n,o){return(await su.get(`${tn.baseUrl}/asset/getEmbedAsJson/${n}/${o!=null?o:""}`)).data}const El={async getAssetWithTemplate(n){if(!n)return{asset:null,template:null};const o=fy.get(n)||await EI(n);if(fy.set(n,o),!o)return{asset:null,template:null};const c=String(o.templateId),f=my.get(c)||await SI(c);return my.set(c,f),{asset:o,template:f}},async getMoreLikeThis(n){if(!n)return[];const o=gy.get(n)||await II(n);return gy.set(n,o),o},async getFileMetaData(n){if(!n)return null;const o=_y.get(n)||await AI(n);return _y.set(n,o),o},async getFileDownloadInfo(n,o){if(!n)return null;const c=`${n}.${o}`,f=yy.get(c)||await CI(n,o);return yy.set(c,f),f}},Aa=LT("asset2",{state:()=>({activeAssetId:null,activeObjectId:null,activeFileObjectId:null}),actions:{async setActiveAsset(n,o){var f,y;const{asset:c}=await El.getAssetWithTemplate(n);return c?(this.activeAssetId=n,o?this.setActiveObject(o):(this.activeObjectId=(f=c==null?void 0:c.firstObjectId)!=null?f:null,this.activeFileObjectId=(y=c==null?void 0:c.firstFileHandlerId)!=null?y:null,c)):(this.activeAssetId=null,this.activeObjectId=null,this.activeFileObjectId=null,null)},async setActiveObject(n){var c;const{asset:o}=await El.getAssetWithTemplate(n);return this.activeObjectId=o?n:null,this.activeFileObjectId=(c=o==null?void 0:o.firstFileHandlerId)!=null?c:null,o}}});function kI(n,o){var c;return(c=n.widgetArray.find(f=>f.fieldTitle===o))!=null?c:null}const Vx=n=>`${tn.baseUrl}/fileManager/tinyImageByFileId/${n}/true`,PI=n=>`${tn.baseUrl}/fileManager/previewImageByFileId/${n}/true`,Sl=n=>`/asset/viewAsset/${n}`;function lm({asset:n,widget:o}){return n[o.fieldTitle]}function MI({widget:n,template:o,asset:c}){if(!c||!o||!c.titleObject)return!1;const f=kI(o,c.titleObject),y=lm({asset:c,widget:n});return!!f&&n.type==="text"&&n.fieldTitle===f.fieldTitle&&y.length===1}function zI({asset:n,widget:o}){const c=lm({asset:n,widget:o});return c!=null}function DI({asset:n,template:o}){if(!(o&&n))return[];const c=o.widgetArray.filter(f=>f.display).filter(f=>zI({asset:n,widget:f}));return c.length<2?c:c.filter(f=>!MI({widget:f,template:o,asset:n})).sort((f,y)=>f.viewOrder-y.viewOrder)}function jx(n){var o,c;return(c=(o=n==null?void 0:n.title)==null?void 0:o[0])!=null?c:"(No Title)"}function qx(n,o){const c=n.trim().replace("?","").replace("...","");return o.clickToSearchType===0?tn.baseUrl+"/search/querySearch/"+encodeURIComponent(c):tn.baseUrl+"/search/scopedQuerySearch/"+o.fieldTitle+"/"+encodeURIComponent(c)}const RI=_i(" - "),LI={inheritAttrs:!1},OI=Dt({...LI,__name:"Tuple",props:{label:{type:String,required:!0},variant:{type:String,required:!1,default:"stacked"}},setup(n){return(o,c)=>(ve(),$e("div",{class:ar(["tuple",{"w-full":n.variant==="stacked","inline-flex items-baseline gap-2":n.variant==="inline"}])},[Ui(o.$slots,"label",{},()=>[_t("span",{class:ar(["tuple__label text-xs block uppercase text-neutral-900 leading-none mb-1 tracking-wide",{"font-bold":n.variant==="stacked","sr-only":n.variant==="value-only"}])},ii(n.label),3)]),_t("span",ru({class:"tuple__value block text-neutral-600"},o.$attrs),[Ui(o.$slots,"default",{},()=>[RI])],16)],2))}}),fr=zt(OI,[["__file","/opt/elevator/assets/elevator-ui/src/components/Tuple/Tuple.vue"]]),BI={key:0},FI=["href"],$I={key:1},UI=Dt({__name:"ClickToSearchLink",props:{linkText:{type:String,required:!0},widget:{type:null,required:!0}},setup(n){const o=n,c=Ut(()=>qx(o.linkText,o.widget));return(f,y)=>o.widget.clickToSearch?(ve(),$e("span",BI,[_t("a",{href:Ve(c)},[Ui(f.$slots,"default")],8,FI)])):(ve(),$e("span",$I,[Ui(f.$slots,"default")]))}}),ud=zt(UI,[["__file","/opt/elevator/assets/elevator-ui/src/components/ClickToSearchLink/ClickToSearchLink.vue"]]),NI=["innerHTML"],VI=Dt({__name:"TextWidget",props:{widget:{type:null,required:!0},contents:{type:Array,required:!0}},setup(n){function o(c){return c.replace(/(<([^>]+)>)/gi,"")!=c?c:c.replace(/(https?:\/\/[a-zA-Z0-9\-_.:@!~*'(¥);/?&=+$,%#]+)/g,'<a href="$1" target="_blank">$1</a>')}return(c,f)=>(ve(),$e("ul",null,[(ve(!0),$e(ui,null,bn(n.contents,(y,v)=>(ve(),$e("li",{key:v},[lt(ud,{widget:n.widget,linkText:y.fieldContents},{default:It(()=>[_t("span",{innerHTML:o(y.fieldContents)},null,8,NI)]),_:2},1032,["widget","linkText"])]))),128))]))}}),jI=zt(VI,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/TextWidget/TextWidget.vue"]]),qI=["innerHTML"],GI=Dt({__name:"SelectItem",props:{selectValues:{type:null,required:!0},widget:{type:null,required:!0}},setup(n){const o=n,c=Ut(()=>typeof o.selectValues.fieldContents=="string"?[o.selectValues.fieldContents]:o.selectValues.fieldContents);function f(y){var v,w;return(v=o.widget.fieldData.selectGroup)!=null&&v.hasOwnProperty(y)?(w=o.widget.fieldData)==null?void 0:w.selectGroup[y]:y}return(y,v)=>(ve(!0),$e(ui,null,bn(Ve(c),(w,a)=>(ve(),$e("li",{key:a},[lt(ud,{widget:n.widget,linkText:f(w)},{default:It(()=>[_t("div",{innerHTML:f(w)},null,8,qI)]),_:2},1032,["widget","linkText"])]))),128))}}),WI=zt(GI,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/SelectWidget/SelectItem.vue"]]),ZI=Dt({__name:"SelectWidget",props:{widget:{type:null,required:!0},contents:{type:Array,required:!0}},setup(n){return(o,c)=>(ve(),$e("ul",null,[(ve(!0),$e(ui,null,bn(n.contents,(f,y)=>(ve(),hi(WI,{key:y,selectValues:f,widget:n.widget},null,8,["selectValues","widget"]))),128))]))}}),HI=zt(ZI,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/SelectWidget/SelectWidget.vue"]]),XI={key:0,class:"material-symbols-outlined"},KI={key:1,class:"material-symbols-outlined"},JI=Dt({__name:"CheckBoxWidget",props:{widget:{type:null,required:!0},contents:{type:Array,required:!0}},setup(n){return(o,c)=>(ve(),$e("ul",null,[(ve(!0),$e(ui,null,bn(n.contents,(f,y)=>(ve(),$e("li",{key:y},[f.fieldContents==!0?(ve(),$e("span",XI," check_circle ")):f.fieldContents==!1?(ve(),$e("span",KI," cancel ")):bi("v-if",!0)]))),128))]))}}),YI=zt(JI,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/CheckBoxWidget/CheckBoxWidget.vue"]]);var vy;const Pl=typeof window<"u",QI=n=>typeof n=="string",qp=()=>{};Pl&&((vy=window==null?void 0:window.navigator)==null?void 0:vy.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function eu(n){return typeof n=="function"?n():Ve(n)}function eA(n,o){function c(...f){n(()=>o.apply(this,f),{fn:o,thisArg:this,args:f})}return c}function tA(n,o={}){let c,f;return v=>{const w=eu(n),a=eu(o.maxWait);if(c&&clearTimeout(c),w<=0||a!==void 0&&a<=0)return f&&(clearTimeout(f),f=null),v();a&&!f&&(f=setTimeout(()=>{c&&clearTimeout(c),f=null,v()},a)),c=setTimeout(()=>{f&&clearTimeout(f),f=null,v()},w)}}function iA(n){return n}function hd(n){return o1()?(a1(n),!0):!1}function nA(n,o=200,c={}){return eA(tA(o,c),n)}function rA(n){return typeof n=="function"?Ut(n):Ci(n)}function sA(n,o=!0){Cl()?Al(n):o?n():Zc(n)}function oA(n,o,c={}){const{immediate:f=!0}=c,y=Ci(!1);let v=null;function w(){v&&(clearTimeout(v),v=null)}function a(){y.value=!1,w()}function k(...$){w(),y.value=!0,v=setTimeout(()=>{y.value=!1,v=null,n(...$)},eu(o))}return f&&(y.value=!0,Pl&&k()),hd(a),{isPending:y,start:k,stop:a}}function Gx(n){var o;const c=eu(n);return(o=c==null?void 0:c.$el)!=null?o:c}const cm=Pl?window:void 0;Pl&&window.document;const aA=Pl?window.navigator:void 0;Pl&&window.location;function lA(...n){let o,c,f,y;if(QI(n[0])?([c,f,y]=n,o=cm):[o,c,f,y]=n,!o)return qp;let v=qp;const w=lr(()=>Gx(o),k=>{v(),k&&(k.addEventListener(c,f,y),v=()=>{k.removeEventListener(c,f,y),v=qp})},{immediate:!0,flush:"post"}),a=()=>{w(),v()};return hd(a),a}function um(n,o=!1){const c=Ci(),f=()=>c.value=Boolean(n());return f(),sA(f,o),c}function cA(n,o={}){const{window:c=cm}=o,f=um(()=>c&&"matchMedia"in c&&typeof c.matchMedia=="function");let y;const v=Ci(!1),w=()=>{!y||("removeEventListener"in y?y.removeEventListener("change",a):y.removeListener(a))},a=()=>{!f.value||(w(),y=c.matchMedia(rA(n).value),v.value=y.matches,"addEventListener"in y?y.addEventListener("change",a):y.addListener(a))};return vv(a),hd(()=>w()),v}function uA(n={}){const{navigator:o=aA,read:c=!1,source:f,copiedDuring:y=1500}=n,v=["copy","cut"],w=um(()=>o&&"clipboard"in o),a=Ci(""),k=Ci(!1),$=oA(()=>k.value=!1,y);function F(){o.clipboard.readText().then(M=>{a.value=M})}if(w.value&&c)for(const M of v)lA(M,F);async function B(M=eu(f)){w.value&&M!=null&&(await o.clipboard.writeText(M),a.value=M,k.value=!0,$.start())}return{isSupported:w,text:a,copied:k,copy:B}}const Ef=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Sf="__vueuse_ssr_handlers__";Ef[Sf]=Ef[Sf]||{};Ef[Sf];var xy=Object.getOwnPropertySymbols,hA=Object.prototype.hasOwnProperty,dA=Object.prototype.propertyIsEnumerable,pA=(n,o)=>{var c={};for(var f in n)hA.call(n,f)&&o.indexOf(f)<0&&(c[f]=n[f]);if(n!=null&&xy)for(var f of xy(n))o.indexOf(f)<0&&dA.call(n,f)&&(c[f]=n[f]);return c};function Wx(n,o,c={}){const f=c,{window:y=cm}=f,v=pA(f,["window"]);let w;const a=um(()=>y&&"ResizeObserver"in y),k=()=>{w&&(w.disconnect(),w=void 0)},$=lr(()=>Gx(n),B=>{k(),a.value&&y&&B&&(w=new ResizeObserver(o),w.observe(B,v))},{immediate:!0,flush:"post"}),F=()=>{k(),$()};return hd(F),{isSupported:a,stop:F}}var by;(function(n){n.UP="UP",n.RIGHT="RIGHT",n.DOWN="DOWN",n.LEFT="LEFT",n.NONE="NONE"})(by||(by={}));var fA=Object.defineProperty,wy=Object.getOwnPropertySymbols,mA=Object.prototype.hasOwnProperty,gA=Object.prototype.propertyIsEnumerable,Ty=(n,o,c)=>o in n?fA(n,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[o]=c,_A=(n,o)=>{for(var c in o||(o={}))mA.call(o,c)&&Ty(n,c,o[c]);if(wy)for(var c of wy(o))gA.call(o,c)&&Ty(n,c,o[c]);return n};const yA={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};_A({linear:iA},yA);/**
  shave - Shave is a javascript plugin that truncates multi-line text within a html element based on set max height
  @version v5.0.0
  @link https://github.com/yowainwright/shave#readme
  @author Jeff Wainwright <yowainwright@gmail.com> (jeffry.in)
  @license MIT
**/function Ey(n,o){var c=typeof Symbol=="function"&&n[Symbol.iterator];if(!c)return n;var f=c.call(n),y,v=[],w;try{for(;(o===void 0||o-- >0)&&!(y=f.next()).done;)v.push(y.value)}catch(a){w={error:a}}finally{try{y&&!y.done&&(c=f.return)&&c.call(f)}finally{if(w)throw w.error}}return v}function Sy(n,o,c){if(c||arguments.length===2)for(var f=0,y=o.length,v;f<y;f++)(v||!(f in o))&&(v||(v=Array.prototype.slice.call(o,0,f)),v[f]=o[f]);return n.concat(v||Array.prototype.slice.call(o))}function vA(n){return typeof n=="string"?Sy([],Ey(document.querySelectorAll(n)),!1):"length"in n?Sy([],Ey(n),!1):[n]}function xA(n,o,c){if(c===void 0&&(c={}),typeof o>"u"||isNaN(o))throw Error("maxHeight is required");var f=vA(n);if(!!f.length)for(var y=c.character,v=y===void 0?"\u2026":y,w=c.classname,a=w===void 0?"js-shave":w,k=c.spaces,$=k===void 0?!0:k,F=c.charclassname,B=F===void 0?"js-shave-char":F,M=c.link,le=M===void 0?{}:M,Ee=typeof $=="boolean"?$:!0,Oe=le&&JSON.stringify(le)!=="{}"&&le.href,Je=Oe?"a":"span",He=0;He<f.length;He+=1){var De=f[He],tt=De.style,Nt=De.querySelector("."+a),Ce=De.textContent===void 0?"innerText":"textContent";Nt&&(De.removeChild(De.querySelector("."+B)),De[Ce]=De[Ce]);var Zt=De[Ce],Xe=Ee?Zt.split(" "):Zt;if(!(Xe.length<2)){var ht=tt.height;tt.height="auto";var it=tt.maxHeight;if(tt.maxHeight="none",De.offsetHeight<=o){tt.height=ht,tt.maxHeight=it;continue}var Ue=Oe&&le.textContent?le.textContent:v,ct=document.createElement(Je),Re={className:B,textContent:Ue};for(var Rt in Re)ct[Rt]=Re[Rt],ct.textContent=v;if(Oe)for(var ai in le)ct[ai]=le[ai];for(var yi=Xe.length-1,We=0,St=void 0;We<yi;)St=We+yi+1>>1,De[Ce]=Ee?Xe.slice(0,St).join(" "):Xe.slice(0,St),De.insertAdjacentElement("beforeend",ct),De.offsetHeight>o?yi=St-1:We=St;De[Ce]=Ee?Xe.slice(0,yi).join(" "):Xe.slice(0,yi),De.insertAdjacentElement("beforeend",ct);var Xt=Ee?" ".concat(Xe.slice(yi).join(" ")):Xe.slice(yi),Oi=document.createTextNode(Xt),Ni=document.createElement("span");Ni.classList.add(a),Ni.style.display="none",Ni.appendChild(Oi),De.insertAdjacentElement("beforeend",Ni),tt.height=ht,tt.maxHeight=it}}}const bA={},wA={class:"icon material-symbols-outlined"};function TA(n,o){return ve(),$e("span",wA,[Ui(n.$slots,"default")])}const Eo=zt(bA,[["render",TA],["__file","/opt/elevator/assets/elevator-ui/src/components/Icon/Icon.vue"]]),EA=["innerHTML"],SA=["innerHTML"],IA=Dt({__name:"TextAreaItem",props:{fieldContents:{type:String,required:!0},widget:{type:null,required:!0},textTruncationLength:{type:Number,required:!1,default:75}},setup(n){const o=n,c=Ci(!1),f=Ci(null),y=Ci(!1),v=nA(()=>{w()},50);function w(){!f.value||(xA([f.value],o.textTruncationLength),y.value=f.value.querySelector(".js-shave")!==null)}return Wx(f,v),Al(()=>{w()}),(a,k)=>(ve(),$e(ui,null,[c.value?bi("v-if",!0):(ve(),$e("div",{key:0,ref_key:"truncateText",ref:f,innerHTML:n.fieldContents},null,8,EA)),c.value?(ve(),$e("div",{key:1,innerHTML:n.fieldContents},null,8,SA)):bi("v-if",!0),_t("button",{class:"flex items-center uppercase text-xs text-blue-600",onClick:k[0]||(k[0]=$=>c.value=!c.value)},[_i(" Show "+ii(c.value?"Less":"More")+" ",1),lt(Eo,null,{default:It(()=>[_i(ii(c.value?"expand_less":"expand_more"),1)]),_:1})])],64))}}),AA=zt(IA,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/TextAreaWidget/TextAreaItem.vue"]]),CA=Dt({__name:"TextAreaWidget",props:{widget:{type:null,required:!0},contents:{type:Array,required:!0}},setup(n){return(o,c)=>(ve(),$e("ul",null,[(ve(!0),$e(ui,null,bn(n.contents,(f,y)=>{var v;return ve(),$e("li",{key:y},[lt(AA,{widget:n.widget,fieldContents:(v=f.fieldContents)!=null?v:""},null,8,["widget","fieldContents"])])}),128))]))}}),kA=zt(CA,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/TextAreaWidget/TextAreaWidget.vue"]]),PA=Dt({__name:"DateWidgetItem",props:{dateContent:{type:null,required:!0},widget:{type:null,required:!0}},setup(n){const o=n,c=Ut(()=>{let f="";return f+=o.dateContent.start.text,o.dateContent.range&&(f+=" - "+o.dateContent.end.text),f});return(f,y)=>(ve(),hi(ud,{widget:n.widget,linkText:Ve(c)},{default:It(()=>[n.dateContent.label?(ve(),hi(fr,{key:0,label:n.dateContent.label,variant:"inline"},{default:It(()=>[_i(ii(Ve(c)),1)]),_:1},8,["label"])):(ve(),$e(ui,{key:1},[_i(ii(Ve(c)),1)],64))]),_:1},8,["widget","linkText"]))}}),MA=zt(PA,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/DateWidget/DateWidgetItem.vue"]]),zA=Dt({__name:"DateWidget",props:{widget:{type:null,required:!0},contents:{type:Array,required:!0}},setup(n){return(o,c)=>(ve(),$e("ul",null,[(ve(!0),$e(ui,null,bn(n.contents,(f,y)=>(ve(),$e("li",{key:y},[lt(MA,{dateContent:f,widget:n.widget},null,8,["dateContent","widget"])]))),128))]))}}),DA=zt(zA,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/DateWidget/DateWidget.vue"]]),Zx=(n,o)=>{let c=[];for(const f in n)o||c.push(f),typeof n[f]=="object"&&(c=c.concat(Zx(n[f],!o)));return c.flat()},RA=n=>n.filter((o,c,f)=>f.indexOf(o)===c),LA={key:0},OA=Dt({__name:"MultiSelectItem",props:{widget:{type:null,required:!0},content:{type:null,required:!0}},setup(n){const o=n,c=Ut(()=>RA(Zx(o.widget.fieldData,!1))),f=y=>{const v=[];for(const w of c.value)if(v.push(o.content.fieldContents[w]),w==y)return v.join(" : ");return v.join(" : ")};return(y,v)=>(ve(),$e("ul",null,[(ve(!0),$e(ui,null,bn(Ve(c),w=>(ve(),$e(ui,{key:w},[n.content.fieldContents[w]?(ve(),$e("li",LA,[lt(ud,{widget:n.widget,linkText:f(w)},{default:It(()=>[_i(ii(n.content.fieldContents[w]),1)]),_:2},1032,["widget","linkText"])])):bi("v-if",!0)],64))),128))]))}});const BA=zt(OA,[["__scopeId","data-v-443bc765"],["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/MultiSelectWidget/MultiSelectItem.vue"]]),FA=Dt({__name:"MultiSelectWidget",props:{widget:{type:null,required:!0},contents:{type:Array,required:!0}},setup(n){return(o,c)=>(ve(),$e("ul",null,[(ve(!0),$e(ui,null,bn(n.contents,(f,y)=>(ve(),$e("li",{key:y},[lt(BA,{widget:n.widget,content:f},null,8,["widget","content"])]))),128))]))}}),$A=zt(FA,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/MultiSelectWidget/MultiSelectWidget.vue"]]),UA=_i("close"),NA=Dt({__name:"XButton",emits:["click"],setup(n){return(o,c)=>(ve(),$e("button",{class:"x-button inline-flex bg-transparent-black-50 text-neutral-700 w-8 h-8 rounded-full leading-none items-center justify-center transition ease-in-out hover:bg-transparent-black-900 hover:text-white",onClick:c[0]||(c[0]=f=>o.$emit("click"))},[lt(Eo,{label:"close"},{default:It(()=>[UA]),_:1})]))}}),VA=zt(NA,[["__file","/opt/elevator/assets/elevator-ui/src/components/XButton/XButton.vue"]]),jA={class:"flex justify-between items-start p-4 md:p-8 border-b bg-neutral-100"},qA={class:"flex-1 font-bold text-2xl mr-12"},GA={class:"flex-1 overflow-auto p-4 md:p-8"},WA=Dt({__name:"Modal",props:{label:{type:[String,null],required:!1,default:""},isOpen:{type:Boolean,required:!0,default:!1}},emits:["close"],setup(n,{emit:o}){const c=n,f=Ci();function y(v){c.isOpen&&v.keyCode===27&&o("close")}return Al(()=>{document.addEventListener("keydown",y)}),ed(()=>document.removeEventListener("keydown",y)),(v,w)=>(ve(),hi(s2,{to:"body"},[_t("div",{ref_key:"modal",ref:f,class:ar({"flex bg-transparent-black-700 fixed inset-0 z-50 justify-center items-center":n.isOpen,hidden:!n.isOpen}),onClick:w[1]||(w[1]=X2(a=>v.$emit("close"),["self"]))},[_t("div",ru({class:"bg-neutral-50 border absolute inset-4 md:inset-16 rounded-2xl flex flex-col overflow-hidden h-fit max-h-[90%] max-w-fit m-auto"},v.$attrs),[lt(VA,{class:"absolute right-4 top-4 md:top-8 md:right-8",onClick:w[0]||(w[0]=a=>v.$emit("close"))}),_t("header",jA,[_t("h2",qA,ii(n.label),1)]),_t("div",GA,[Ui(v.$slots,"default",{},void 0,!0)])],16)],2)]))}});const dd=zt(WA,[["__scopeId","data-v-907877e9"],["__file","/opt/elevator/assets/elevator-ui/src/components/Modal/Modal.vue"]]);var _l={exports:{}};(function(n,o){(function(c,f){n.exports=f()})(cS,function(){var c,f,y;function v(a,k){if(!c)c=k;else if(!f)f=k;else{var $="var sharedChunk = {}; ("+c+")(sharedChunk); ("+f+")(sharedChunk);",F={};c(F),y=k(F),typeof window<"u"&&(y.workerUrl=window.URL.createObjectURL(new Blob([$],{type:"text/javascript"})))}}v(["exports"],function(a){var k=$;function $(i,e,r,l){this.cx=3*i,this.bx=3*(r-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(l-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=e,this.p2x=r,this.p2y=l}function F(i,e,r,l){const d=new k(i,e,r,l);return function(m){return d.solve(m)}}$.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,e){if(e===void 0&&(e=1e-6),i<0)return 0;if(i>1)return 1;for(var r=i,l=0;l<8;l++){var d=this.sampleCurveX(r)-i;if(Math.abs(d)<e)return r;var m=this.sampleCurveDerivativeX(r);if(Math.abs(m)<1e-6)break;r-=d/m}var _=0,b=1;for(r=i,l=0;l<20&&(d=this.sampleCurveX(r),!(Math.abs(d-i)<e));l++)i>d?_=r:b=r,r=.5*(b-_)+_;return r},solve:function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))}};const B=F(.25,.1,.25,1);function M(i,e,r){return Math.min(r,Math.max(e,i))}function le(i,e,r){const l=r-e,d=((i-e)%l+l)%l+e;return d===e?r:d}function Ee(i,...e){for(const r of e)for(const l in r)i[l]=r[l];return i}let Oe=1;function Je(i,e){i.forEach(r=>{e[r]&&(e[r]=e[r].bind(e))})}function He(i,e,r){const l={};for(const d in i)l[d]=e.call(r||this,i[d],d,i);return l}function De(i,e,r){const l={};for(const d in i)e.call(r||this,i[d],d,i)&&(l[d]=i[d]);return l}function tt(i){return Array.isArray(i)?i.map(tt):typeof i=="object"&&i?He(i,tt):i}const Nt={};function Ce(i){Nt[i]||(typeof console<"u"&&console.warn(i),Nt[i]=!0)}function Zt(i,e,r){return(r.y-i.y)*(e.x-i.x)>(e.y-i.y)*(r.x-i.x)}function Xe(i){let e=0;for(let r,l,d=0,m=i.length,_=m-1;d<m;_=d++)r=i[d],l=i[_],e+=(l.x-r.x)*(r.y+l.y);return e}function ht(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function it(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,l,d,m)=>{const _=d||m;return e[l]=!_||_.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}let Ue,ct,Re=null;function Rt(i){if(Re==null){const e=i.navigator?i.navigator.userAgent:null;Re=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Re}function ai(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const yi={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(i){const e=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(i,e=0){const r=window.document.createElement("canvas"),l=r.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return r.width=i.width,r.height=i.height,l.drawImage(i,0,0,i.width,i.height),l.getImageData(-e,-e,i.width+2*e,i.height+2*e)},resolveURL:i=>(Ue||(Ue=document.createElement("a")),Ue.href=i,Ue.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ct==null&&(ct=matchMedia("(prefers-reduced-motion: reduce)")),ct.matches)}};var We=St;function St(i,e){this.x=i,this.y=e}St.prototype={clone:function(){return new St(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,r=i.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),r=Math.sin(i),l=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=l,this},_rotateAround:function(i,e){var r=Math.cos(i),l=Math.sin(i),d=e.y+l*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-l*(this.y-e.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},St.convert=function(i){return i instanceof St?i:Array.isArray(i)?new St(i[0],i[1]):i};const Xt={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Oi="mapbox-tiles";let Ni,In,Bn=500,Fn=50;function pn(){typeof caches>"u"||Ni||(Ni=caches.open(Oi))}let Te=1/0;const gt={supported:!1,testSupport:function(i){!$t&&ft&&(ki?Gt(i):ut=i)}};let ut,ft,$t=!1,ki=!1;function Gt(i){const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,ft),i.isContextLost())return;gt.supported=!0}catch{}i.deleteTexture(e),$t=!0}typeof document<"u"&&(ft=document.createElement("img"),ft.onload=function(){ut&&Gt(ut),ut=null,ki=!0},ft.onerror=function(){$t=!0,ut=null},ft.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Ft={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ft);class ri extends Error{constructor(e,r,l,d){super(`AJAXError: ${r} (${e}): ${l}`),this.status=e,this.statusText=r,this.url=l,this.body=d}}const X=ht()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function ie(i,e){const r=new AbortController,l=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,referrer:X(),signal:r.signal});let d=!1,m=!1;return i.type==="json"&&l.headers.set("Accept","application/json"),((_,b,T)=>{if(m)return;const I=Date.now();fetch(l).then(P=>P.ok?((D,O,N)=>{(i.type==="arrayBuffer"?D.arrayBuffer():i.type==="json"?D.json():D.text()).then(V=>{m||(O&&N&&function(Y,J,ce){if(pn(),!Ni)return;const me={status:J.status,statusText:J.statusText,headers:new Headers};J.headers.forEach((pe,Ae)=>me.headers.set(Ae,pe));const ae=it(J.headers.get("Cache-Control")||"");ae["no-store"]||(ae["max-age"]&&me.headers.set("Expires",new Date(ce+1e3*ae["max-age"]).toUTCString()),new Date(me.headers.get("Expires")).getTime()-ce<42e4||function(pe,Ae){if(In===void 0)try{new Response(new ReadableStream),In=!0}catch{In=!1}In?Ae(pe.body):pe.blob().then(Ae)}(J,pe=>{const Ae=new Response(pe,me);pn(),Ni&&Ni.then(Se=>Se.put(function(pt){const xt=pt.indexOf("?");return xt<0?pt:pt.slice(0,xt)}(Y.url),Ae)).catch(Se=>Ce(Se.message))}))}(l,O,N),d=!0,e(null,V,D.headers.get("Cache-Control"),D.headers.get("Expires")))}).catch(V=>{m||e(new Error(V.message))})})(P,null,I):P.blob().then(D=>e(new ri(P.status,P.statusText,i.url,D)))).catch(P=>{P.code!==20&&e(new Error(P.message))})})(),{cancel:()=>{m=!0,d||r.abort()}}}const be=function(i,e){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){if(ht()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e);if(!ht()){const l=i.url.substring(0,i.url.indexOf("://"));return(Xt.REGISTERED_PROTOCOLS[l]||ie)(i,e)}}if(!(/^file:/.test(r=i.url)||/^file:/.test(X())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return ie(i,e);if(ht()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var r;return function(l,d){const m=new XMLHttpRequest;m.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const _ in l.headers)m.setRequestHeader(_,l.headers[_]);return l.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=l.credentials==="include",m.onerror=()=>{d(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let _=m.response;if(l.type==="json")try{_=JSON.parse(m.response)}catch(b){return d(b)}d(null,_,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else{const _=new Blob([m.response],{type:m.getResponseHeader("Content-Type")});d(new ri(m.status,m.statusText,l.url,_))}},m.send(l.body),{cancel:()=>m.abort()}}(i,e)},ze=function(i,e){return be(Ee(i,{type:"arrayBuffer"}),e)};function ke(i){const e=window.document.createElement("a");return e.href=i,e.protocol===window.document.location.protocol&&e.host===window.document.location.host}const Ie="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ke,je;Ke=[],je=0;const qe=function(i,e){if(gt.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),je>=Xt.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:i,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Ke.push(m),m}je++;let r=!1;const l=()=>{if(!r)for(r=!0,je--;Ke.length&&je<Xt.MAX_PARALLEL_IMAGE_REQUESTS;){const m=Ke.shift(),{requestParameters:_,callback:b,cancelled:T}=m;T||(m.cancel=qe(_,b).cancel)}},d=ze(i,(m,_,b,T)=>{l(),m?e(m):_&&function(I,P){typeof createImageBitmap=="function"?function(D,O){const N=new Blob([new Uint8Array(D)],{type:"image/png"});createImageBitmap(N).then(V=>{O(null,V)}).catch(V=>{O(new Error(`Could not load image because of ${V.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(I,P):function(D,O){const N=new Image;N.onload=()=>{O(null,N),URL.revokeObjectURL(N.src),N.onload=null,window.requestAnimationFrame(()=>{N.src=Ie})},N.onerror=()=>O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const V=new Blob([new Uint8Array(D)],{type:"image/png"});N.src=D.byteLength?URL.createObjectURL(V):Ie}(I,P)}(_,(I,P)=>{I!=null?e(I):P!=null&&e(null,P,{cacheControl:b,expires:T})})});return{cancel:()=>{d.cancel(),l()}}};function Be(i,e,r){r[i]&&r[i].indexOf(e)!==-1||(r[i]=r[i]||[],r[i].push(e))}function bt(i,e,r){if(r&&r[i]){const l=r[i].indexOf(e);l!==-1&&r[i].splice(l,1)}}class yt{constructor(e,r={}){Ee(this,r),this.type=e}}class At extends yt{constructor(e,r={}){super("error",Ee({error:e},r))}}class Lt{on(e,r){return this._listeners=this._listeners||{},Be(e,r,this._listeners),this}off(e,r){return bt(e,r,this._listeners),bt(e,r,this._oneTimeListeners),this}once(e,r){return this._oneTimeListeners=this._oneTimeListeners||{},Be(e,r,this._oneTimeListeners),this}fire(e,r){typeof e=="string"&&(e=new yt(e,r||{}));const l=e.type;if(this.listens(l)){e.target=this;const d=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const b of d)b.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const b of m)bt(l,b,this._oneTimeListeners),b.call(this,e);const _=this._eventedParent;_&&(Ee(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(e))}else e instanceof At&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var he={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Pe{constructor(e,r,l,d){this.message=(e?`${e}: `:"")+l,d&&(this.identifier=d),r!=null&&r.__line__&&(this.line=r.__line__)}}function gi(i){const e=i.value;return e?[new Pe(i.key,e,"constants have been deprecated as of v8")]:[]}function li(i,...e){for(const r of e)for(const l in r)i[l]=r[l];return i}function Ht(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function ln(i){if(Array.isArray(i))return i.map(ln);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const r in i)e[r]=ln(i[r]);return e}return Ht(i)}class An extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}class cn{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[l,d]of r)this.bindings[l]=d}concat(e){return new cn(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const _r={kind:"null"},Ne={kind:"number"},Ot={kind:"string"},Vt={kind:"boolean"},wn={kind:"color"},Yr={kind:"object"},Wt={kind:"value"},Br={kind:"collator"},fn={kind:"formatted"},Us={kind:"padding"},nn={kind:"resolvedImage"};function $n(i,e){return{kind:"array",itemType:i,N:e}}function Ii(i){if(i.kind==="array"){const e=Ii(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const Ns=[_r,Ne,Ot,Vt,wn,fn,Yr,$n(Wt),Us,nn];function Cr(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Cr(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const r of Ns)if(!Cr(r,e))return null}}return`Expected ${Ii(i)} but found ${Ii(e)} instead.`}function ms(i,e){return e.some(r=>r.kind===i.kind)}function gs(i,e){return e.some(r=>r==="null"?i===null:r==="array"?Array.isArray(i):r==="object"?i&&!Array.isArray(i)&&typeof i=="object":r===typeof i)}var Vs,_s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function G(i){return(i=Math.round(i))<0?0:i>255?255:i}function C(i){return G(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function R(i){return(e=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:e>1?1:e;var e}function j(i,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?i+(e-i)*r*6:2*r<1?e:3*r<2?i+(e-i)*(2/3-r)*6:i}try{Vs={}.parseCSSColor=function(i){var e,r=i.replace(/ /g,"").toLowerCase();if(r in _s)return _s[r].slice();if(r[0]==="#")return r.length===4?(e=parseInt(r.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:r.length===7&&(e=parseInt(r.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=r.indexOf("("),d=r.indexOf(")");if(l!==-1&&d+1===r.length){var m=r.substr(0,l),_=r.substr(l+1,d-(l+1)).split(","),b=1;switch(m){case"rgba":if(_.length!==4)return null;b=R(_.pop());case"rgb":return _.length!==3?null:[C(_[0]),C(_[1]),C(_[2]),b];case"hsla":if(_.length!==4)return null;b=R(_.pop());case"hsl":if(_.length!==3)return null;var T=(parseFloat(_[0])%360+360)%360/360,I=R(_[1]),P=R(_[2]),D=P<=.5?P*(I+1):P+I-P*I,O=2*P-D;return[G(255*j(O,D,T+1/3)),G(255*j(O,D,T)),G(255*j(O,D,T-1/3)),b];default:return null}}return null}}catch{}class q{constructor(e,r,l,d=1){this.r=e,this.g=r,this.b=l,this.a=d}static parse(e){if(!e)return;if(e instanceof q)return e;if(typeof e!="string")return;const r=Vs(e);return r?new q(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[e,r,l,d]=this.toArray();return`rgba(${Math.round(e)},${Math.round(r)},${Math.round(l)},${d})`}toArray(){const{r:e,g:r,b:l,a:d}=this;return d===0?[0,0,0,0]:[255*e/d,255*r/d,255*l/d,d]}}q.black=new q(0,0,0,1),q.white=new q(1,1,1,1),q.transparent=new q(0,0,0,0),q.red=new q(1,0,0,1);class Q{constructor(e,r,l){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class re{constructor(e,r,l,d,m){this.text=e,this.image=r,this.scale=l,this.fontStack=d,this.textColor=m}}class te{constructor(e){this.sections=e}static fromString(e){return new te([new re(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof te?e:te.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class ee{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ee)return e;if(typeof e=="number")return new ee([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new ee(e)}}toString(){return JSON.stringify(this.values)}}class se{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new se({name:e,available:!1}):null}}function _e(i,e,r,l){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,e,r,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,e,r,l]:[i,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Me(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof q||i instanceof Q||i instanceof te||i instanceof ee||i instanceof se)return!0;if(Array.isArray(i)){for(const e of i)if(!Me(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!Me(i[e]))return!1;return!0}return!1}function ge(i){if(i===null)return _r;if(typeof i=="string")return Ot;if(typeof i=="boolean")return Vt;if(typeof i=="number")return Ne;if(i instanceof q)return wn;if(i instanceof Q)return Br;if(i instanceof te)return fn;if(i instanceof ee)return Us;if(i instanceof se)return nn;if(Array.isArray(i)){const e=i.length;let r;for(const l of i){const d=ge(l);if(r){if(r===d)continue;r=Wt;break}r=d}return $n(r||Wt,e)}return Yr}function vt(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof q||i instanceof te||i instanceof ee||i instanceof se?i.toString():JSON.stringify(i)}class wt{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Me(e[1]))return r.error("invalid value");const l=e[1];let d=ge(l);const m=r.expectedType;return d.kind!=="array"||d.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(d=m),new wt(d,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ot{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Pt={string:Ot,number:Ne,boolean:Vt,object:Yr};class Bt{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let l,d=1;const m=e[0];if(m==="array"){let b,T;if(e.length>2){const I=e[1];if(typeof I!="string"||!(I in Pt)||I==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);b=Pt[I],d++}else b=Wt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);T=e[2],d++}l=$n(b,T)}else{if(!Pt[m])throw new Error(`Types doesn't contain name = ${m}`);l=Pt[m]}const _=[];for(;d<e.length;d++){const b=r.parse(e[d],d,Wt);if(!b)return null;_.push(b)}return new Bt(l,_)}evaluate(e){for(let r=0;r<this.args.length;r++){const l=this.args[r].evaluate(e);if(!Cr(this.type,ge(l)))return l;if(r===this.args.length-1)throw new ot(`Expected value to be of type ${Ii(this.type)}, but found ${Ii(ge(l))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const di={"to-boolean":Vt,"to-color":wn,"to-number":Ne,"to-string":Ot};class jt{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const l=e[0];if(!di[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&e.length!==2)return r.error("Expected one argument.");const d=di[l],m=[];for(let _=1;_<e.length;_++){const b=r.parse(e[_],_,Wt);if(!b)return null;m.push(b)}return new jt(d,m)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let r,l;for(const d of this.args){if(r=d.evaluate(e),l=null,r instanceof q)return r;if(typeof r=="string"){const m=e.parseColor(r);if(m)return m}else if(Array.isArray(r)&&(l=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:_e(r[0],r[1],r[2],r[3]),!l))return new q(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ot(l||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}if(this.type.kind==="padding"){let r;for(const l of this.args){r=l.evaluate(e);const d=ee.parse(r);if(d)return d}throw new ot(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}if(this.type.kind==="number"){let r=null;for(const l of this.args){if(r=l.evaluate(e),r===null)return 0;const d=Number(r);if(!isNaN(d))return d}throw new ot(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?te.fromString(vt(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?se.fromString(vt(this.args[0].evaluate(e))):vt(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const Yt=["Unknown","Point","LineString","Polygon"];class pi{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Yt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=q.parse(e)),r}}class Pi{constructor(e,r,l,d){this.name=e,this.type=r,this._evaluate=l,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){const l=e[0],d=Pi.definitions[l];if(!d)return r.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,_=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,b=_.filter(([I])=>!Array.isArray(I)||I.length===e.length-1);let T=null;for(const[I,P]of b){T=new Gs(r.registry,r.path,null,r.scope);const D=[];let O=!1;for(let N=1;N<e.length;N++){const V=e[N],Y=Array.isArray(I)?I[N-1]:I.type,J=T.parse(V,1+D.length,Y);if(!J){O=!0;break}D.push(J)}if(!O)if(Array.isArray(I)&&I.length!==D.length)T.error(`Expected ${I.length} arguments, but found ${D.length} instead.`);else{for(let N=0;N<D.length;N++){const V=Array.isArray(I)?I[N]:I.type,Y=D[N];T.concat(N+1).checkSubtype(V,Y.type)}if(T.errors.length===0)return new Pi(l,m,P,D)}}if(b.length===1)r.errors.push(...T.errors);else{const I=(b.length?b:_).map(([D])=>{return O=D,Array.isArray(O)?`(${O.map(Ii).join(", ")})`:`(${Ii(O.type)}...)`;var O}).join(" | "),P=[];for(let D=1;D<e.length;D++){const O=r.parse(e[D],1+P.length);if(!O)return null;P.push(Ii(O.type))}r.error(`Expected arguments of type ${I}, but found (${P.join(", ")}) instead.`)}return null}static register(e,r){Pi.definitions=r;for(const l in r)e[l]=Pi}}class mn{constructor(e,r,l){this.type=Br,this.locale=l,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");const l=e[1];if(typeof l!="object"||Array.isArray(l))return r.error("Collator options argument must be an object.");const d=r.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Vt);if(!d)return null;const m=r.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Vt);if(!m)return null;let _=null;return l.locale&&(_=r.parse(l.locale,1,Ot),!_)?null:new mn(d,m,_)}evaluate(e){return new Q(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const Vi=8192;function Cn(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function js(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function So(i,e){const r=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,d=Math.pow(2,e.z);return[Math.round(r*d*Vi),Math.round(l*d*Vi)]}function Mi(i,e,r){const l=i[0]-e[0],d=i[1]-e[1],m=i[0]-r[0],_=i[1]-r[1];return l*_-m*d==0&&l*m<=0&&d*_<=0}function Ml(i,e){let r=!1;for(let _=0,b=e.length;_<b;_++){const T=e[_];for(let I=0,P=T.length;I<P-1;I++){if(Mi(i,T[I],T[I+1]))return!1;(d=T[I])[1]>(l=i)[1]!=(m=T[I+1])[1]>l[1]&&l[0]<(m[0]-d[0])*(l[1]-d[1])/(m[1]-d[1])+d[0]&&(r=!r)}}var l,d,m;return r}function zl(i,e){for(let r=0;r<e.length;r++)if(Ml(i,e[r]))return!0;return!1}function au(i,e,r,l){const d=l[0]-r[0],m=l[1]-r[1],_=(i[0]-r[0])*m-d*(i[1]-r[1]),b=(e[0]-r[0])*m-d*(e[1]-r[1]);return _>0&&b<0||_<0&&b>0}function lu(i,e,r){for(const I of r)for(let P=0;P<I.length-1;++P)if((b=[(_=I[P+1])[0]-(m=I[P])[0],_[1]-m[1]])[0]*(T=[(d=e)[0]-(l=i)[0],d[1]-l[1]])[1]-b[1]*T[0]!=0&&au(l,d,m,_)&&au(m,_,l,d))return!0;var l,d,m,_,b,T;return!1}function Dl(i,e){for(let r=0;r<i.length;++r)if(!Ml(i[r],e))return!1;for(let r=0;r<i.length-1;++r)if(lu(i[r],i[r+1],e))return!1;return!0}function md(i,e){for(let r=0;r<e.length;r++)if(Dl(i,e[r]))return!0;return!1}function Ca(i,e,r){const l=[];for(let d=0;d<i.length;d++){const m=[];for(let _=0;_<i[d].length;_++){const b=So(i[d][_],r);Cn(e,b),m.push(b)}l.push(m)}return l}function Rl(i,e,r){const l=[];for(let d=0;d<i.length;d++){const m=Ca(i[d],e,r);l.push(m)}return l}function cu(i,e,r,l){if(i[0]<r[0]||i[0]>r[2]){const d=.5*l;let m=i[0]-r[0]>d?-l:r[0]-i[0]>d?l:0;m===0&&(m=i[0]-r[2]>d?-l:r[2]-i[0]>d?l:0),i[0]+=m}Cn(e,i)}function uu(i,e,r,l){const d=Math.pow(2,l.z)*Vi,m=[l.x*Vi,l.y*Vi],_=[];for(const b of i)for(const T of b){const I=[T.x+m[0],T.y+m[1]];cu(I,e,r,d),_.push(I)}return _}function hu(i,e,r,l){const d=Math.pow(2,l.z)*Vi,m=[l.x*Vi,l.y*Vi],_=[];for(const T of i){const I=[];for(const P of T){const D=[P.x+m[0],P.y+m[1]];Cn(e,D),I.push(D)}_.push(I)}if(e[2]-e[0]<=d/2){(b=e)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const T of _)for(const I of T)cu(I,e,r,d)}var b;return _}class ys{constructor(e,r){this.type=Vt,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Me(e[1])){const l=e[1];if(l.type==="FeatureCollection")for(let d=0;d<l.features.length;++d){const m=l.features[d].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new ys(l,l.features[d].geometry)}else if(l.type==="Feature"){const d=l.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new ys(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new ys(l,l)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,l){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=r.canonicalID();if(l.type==="Polygon"){const b=Ca(l.coordinates,m,_),T=uu(r.geometry(),d,m,_);if(!js(d,m))return!1;for(const I of T)if(!Ml(I,b))return!1}if(l.type==="MultiPolygon"){const b=Rl(l.coordinates,m,_),T=uu(r.geometry(),d,m,_);if(!js(d,m))return!1;for(const I of T)if(!zl(I,b))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,l){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=r.canonicalID();if(l.type==="Polygon"){const b=Ca(l.coordinates,m,_),T=hu(r.geometry(),d,m,_);if(!js(d,m))return!1;for(const I of T)if(!Dl(I,b))return!1}if(l.type==="MultiPolygon"){const b=Rl(l.coordinates,m,_),T=hu(r.geometry(),d,m,_);if(!js(d,m))return!1;for(const I of T)if(!md(I,b))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function Io(i){if(i instanceof Pi&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof ys)return!1;let e=!0;return i.eachChild(r=>{e&&!Io(r)&&(e=!1)}),e}function qs(i){if(i instanceof Pi&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(r=>{e&&!qs(r)&&(e=!1)}),e}function ka(i,e){if(i instanceof Pi&&e.indexOf(i.name)>=0)return!1;let r=!0;return i.eachChild(l=>{r&&!ka(l,e)&&(r=!1)}),r}class Pa{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const l=e[1];return r.scope.has(l)?new Pa(l,r.scope.get(l)):r.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Gs{constructor(e,r=[],l,d=new cn,m=[]){this.registry=e,this.path=r,this.key=r.map(_=>`[${_}]`).join(""),this.scope=d,this.errors=m,this.expectedType=l}parse(e,r,l,d,m={}){return r?this.concat(r,l,d)._parse(e,m):this._parse(e,m)}_parse(e,r){function l(d,m,_){return _==="assert"?new Bt(m,[d]):_==="coerce"?new jt(m,[d]):d}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[d];if(m){let _=m.parse(e,this);if(!_)return null;if(this.expectedType){const b=this.expectedType,T=_.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||T.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(b.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array"){if(this.checkSubtype(b,T))return null}else _=l(_,b,r.typeAnnotation||"coerce");else _=l(_,b,r.typeAnnotation||"coerce");else _=l(_,b,r.typeAnnotation||"assert")}if(!(_ instanceof wt)&&_.type.kind!=="resolvedImage"&&Ll(_)){const b=new pi;try{_=new wt(_.type,_.evaluate(b))}catch(T){return this.error(T.message),null}}return _}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,l){const d=typeof e=="number"?this.path.concat(e):this.path,m=l?this.scope.concat(l):this.scope;return new Gs(this.registry,d,r||null,m,this.errors)}error(e,...r){const l=`${this.key}${r.map(d=>`[${d}]`).join("")}`;this.errors.push(new An(l,e))}checkSubtype(e,r){const l=Cr(e,r);return l&&this.error(l),l}}function Ll(i){if(i instanceof Pa)return Ll(i.boundExpression);if(i instanceof Pi&&i.name==="error"||i instanceof mn||i instanceof ys)return!1;const e=i instanceof jt||i instanceof Bt;let r=!0;return i.eachChild(l=>{r=e?r&&Ll(l):r&&l instanceof wt}),!!r&&Io(i)&&ka(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ma(i,e){const r=i.length-1;let l,d,m=0,_=r,b=0;for(;m<=_;)if(b=Math.floor((m+_)/2),l=i[b],d=i[b+1],l<=e){if(b===r||e<d)return b;m=b+1}else{if(!(l>e))throw new ot("Input is not a number.");_=b-1}return 0}class Ao{constructor(e,r,l){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[d,m]of l)this.labels.push(d),this.outputs.push(m)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const l=r.parse(e[1],1,Ne);if(!l)return null;const d=[];let m=null;r.expectedType&&r.expectedType.kind!=="value"&&(m=r.expectedType);for(let _=1;_<e.length;_+=2){const b=_===1?-1/0:e[_],T=e[_+1],I=_,P=_+1;if(typeof b!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(d.length&&d[d.length-1][0]>=b)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const D=r.parse(T,P,m);if(!D)return null;m=m||D.type,d.push([b,D])}return new Ao(m,l,d)}evaluate(e){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(e);const d=this.input.evaluate(e);if(d<=r[0])return l[0].evaluate(e);const m=r.length;return d>=r[m-1]?l[m-1].evaluate(e):l[Ma(r,d)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function ji(i,e,r){return i*(1-r)+e*r}var Co=Object.freeze({__proto__:null,number:ji,color:function(i,e,r){return new q(ji(i.r,e.r,r),ji(i.g,e.g,r),ji(i.b,e.b,r),ji(i.a,e.a,r))},array:function(i,e,r){return i.map((l,d)=>ji(l,e[d],r))},padding:function(i,e,r){const l=i.values,d=e.values;return new ee([ji(l[0],d[0],r),ji(l[1],d[1],r),ji(l[2],d[2],r),ji(l[3],d[3],r)])}});const du=.95047,pu=1.08883,Ol=4/29,za=6/29,fu=3*za*za,gd=Math.PI/180,_d=180/Math.PI;function Bl(i){return i>.008856451679035631?Math.pow(i,1/3):i/fu+Ol}function Fl(i){return i>za?i*i*i:fu*(i-Ol)}function $l(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function Ul(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function vi(i){const e=Ul(i.r),r=Ul(i.g),l=Ul(i.b),d=Bl((.4124564*e+.3575761*r+.1804375*l)/du),m=Bl((.2126729*e+.7151522*r+.072175*l)/1);return{l:116*m-16,a:500*(d-m),b:200*(m-Bl((.0193339*e+.119192*r+.9503041*l)/pu)),alpha:i.a}}function mu(i){let e=(i.l+16)/116,r=isNaN(i.a)?e:e+i.a/500,l=isNaN(i.b)?e:e-i.b/200;return e=1*Fl(e),r=du*Fl(r),l=pu*Fl(l),new q($l(3.2404542*r-1.5371385*e-.4985314*l),$l(-.969266*r+1.8760108*e+.041556*l),$l(.0556434*r-.2040259*e+1.0572252*l),i.alpha)}function yd(i,e,r){const l=e-i;return i+r*(l>180||l<-180?l-360*Math.round(l/360):l)}const ko={forward:vi,reverse:mu,interpolate:function(i,e,r){return{l:ji(i.l,e.l,r),a:ji(i.a,e.a,r),b:ji(i.b,e.b,r),alpha:ji(i.alpha,e.alpha,r)}}},Po={forward:function(i){const{l:e,a:r,b:l}=vi(i),d=Math.atan2(l,r)*_d;return{h:d<0?d+360:d,c:Math.sqrt(r*r+l*l),l:e,alpha:i.a}},reverse:function(i){const e=i.h*gd,r=i.c;return mu({l:i.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:i.alpha})},interpolate:function(i,e,r){return{h:yd(i.h,e.h,r),c:ji(i.c,e.c,r),l:ji(i.l,e.l,r),alpha:ji(i.alpha,e.alpha,r)}}};var gu=Object.freeze({__proto__:null,lab:ko,hcl:Po});class Jn{constructor(e,r,l,d,m){this.type=e,this.operator=r,this.interpolation=l,this.input=d,this.labels=[],this.outputs=[];for(const[_,b]of m)this.labels.push(_),this.outputs.push(b)}static interpolationFactor(e,r,l,d){let m=0;if(e.name==="exponential")m=Nl(r,e.base,l,d);else if(e.name==="linear")m=Nl(r,1,l,d);else if(e.name==="cubic-bezier"){const _=e.controlPoints;m=new k(_[0],_[1],_[2],_[3]).solve(Nl(r,1,l,d))}return m}static parse(e,r){let[l,d,m,..._]=e;if(!Array.isArray(d)||d.length===0)return r.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const I=d[1];if(typeof I!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:I}}else{if(d[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const I=d.slice(1);if(I.length!==4||I.some(P=>typeof P!="number"||P<0||P>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:I}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(m=r.parse(m,2,Ne),!m)return null;const b=[];let T=null;l==="interpolate-hcl"||l==="interpolate-lab"?T=wn:r.expectedType&&r.expectedType.kind!=="value"&&(T=r.expectedType);for(let I=0;I<_.length;I+=2){const P=_[I],D=_[I+1],O=I+3,N=I+4;if(typeof P!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(b.length&&b[b.length-1][0]>=P)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const V=r.parse(D,N,T);if(!V)return null;T=T||V.type,b.push([P,V])}return T.kind==="number"||T.kind==="color"||T.kind==="padding"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new Jn(T,l,d,m,b):r.error(`Type ${Ii(T)} is not interpolatable.`)}evaluate(e){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(e);const d=this.input.evaluate(e);if(d<=r[0])return l[0].evaluate(e);const m=r.length;if(d>=r[m-1])return l[m-1].evaluate(e);const _=Ma(r,d),b=Jn.interpolationFactor(this.interpolation,d,r[_],r[_+1]),T=l[_].evaluate(e),I=l[_+1].evaluate(e);return this.operator==="interpolate"?Co[this.type.kind.toLowerCase()](T,I,b):this.operator==="interpolate-hcl"?Po.reverse(Po.interpolate(Po.forward(T),Po.forward(I),b)):ko.reverse(ko.interpolate(ko.forward(T),ko.forward(I),b))}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Nl(i,e,r,l){const d=l-r,m=i-r;return d===0?0:e===1?m/d:(Math.pow(e,m)-1)/(Math.pow(e,d)-1)}class Da{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let l=null;const d=r.expectedType;d&&d.kind!=="value"&&(l=d);const m=[];for(const b of e.slice(1)){const T=r.parse(b,1+m.length,l,void 0,{typeAnnotation:"omit"});if(!T)return null;l=l||T.type,m.push(T)}if(!l)throw new Error("No output type");const _=d&&m.some(b=>Cr(d,b.type));return new Da(_?Wt:l,m)}evaluate(e){let r,l=null,d=0;for(const m of this.args)if(d++,l=m.evaluate(e),l&&l instanceof se&&!l.available&&(r||(r=l.name),l=null,d===this.args.length&&(l=r)),l!==null)break;return l}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class Ra{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const l=[];for(let m=1;m<e.length-1;m+=2){const _=e[m];if(typeof _!="string")return r.error(`Expected string, but found ${typeof _} instead.`,m);if(/[^a-zA-Z0-9_]/.test(_))return r.error("Variable names must contain only alphanumeric characters or '_'.",m);const b=r.parse(e[m+1],m+1);if(!b)return null;l.push([_,b])}const d=r.parse(e[e.length-1],e.length-1,r.expectedType,l);return d?new Ra(l,d):null}outputDefined(){return this.result.outputDefined()}}class Vl{constructor(e,r,l){this.type=e,this.index=r,this.input=l}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=r.parse(e[1],1,Ne),d=r.parse(e[2],2,$n(r.expectedType||Wt));return l&&d?new Vl(d.type.itemType,l,d):null}evaluate(e){const r=this.index.evaluate(e),l=this.input.evaluate(e);if(r<0)throw new ot(`Array index out of bounds: ${r} < 0.`);if(r>=l.length)throw new ot(`Array index out of bounds: ${r} > ${l.length-1}.`);if(r!==Math.floor(r))throw new ot(`Array index must be an integer, but found ${r} instead.`);return l[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class jl{constructor(e,r){this.type=Vt,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=r.parse(e[1],1,Wt),d=r.parse(e[2],2,Wt);return l&&d?ms(l.type,[Vt,Ot,Ne,_r,Wt])?new jl(l,d):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(l.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!l)return!1;if(!gs(r,["boolean","string","number","null"]))throw new ot(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(ge(r))} instead.`);if(!gs(l,["string","array"]))throw new ot(`Expected second argument to be of type array or string, but found ${Ii(ge(l))} instead.`);return l.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class La{constructor(e,r,l){this.type=Ne,this.needle=e,this.haystack=r,this.fromIndex=l}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=r.parse(e[1],1,Wt),d=r.parse(e[2],2,Wt);if(!l||!d)return null;if(!ms(l.type,[Vt,Ot,Ne,_r,Wt]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(l.type)} instead`);if(e.length===4){const m=r.parse(e[3],3,Ne);return m?new La(l,d,m):null}return new La(l,d)}evaluate(e){const r=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!gs(r,["boolean","string","number","null"]))throw new ot(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(ge(r))} instead.`);if(!gs(l,["string","array"]))throw new ot(`Expected second argument to be of type array or string, but found ${Ii(ge(l))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(e);return l.indexOf(r,d)}return l.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class ql{constructor(e,r,l,d,m,_){this.inputType=e,this.type=r,this.input=l,this.cases=d,this.outputs=m,this.otherwise=_}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let l,d;r.expectedType&&r.expectedType.kind!=="value"&&(d=r.expectedType);const m={},_=[];for(let I=2;I<e.length-1;I+=2){let P=e[I];const D=e[I+1];Array.isArray(P)||(P=[P]);const O=r.concat(I);if(P.length===0)return O.error("Expected at least one branch label.");for(const V of P){if(typeof V!="number"&&typeof V!="string")return O.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof V=="number"&&Math.floor(V)!==V)return O.error("Numeric branch labels must be integer values.");if(l){if(O.checkSubtype(l,ge(V)))return null}else l=ge(V);if(m[String(V)]!==void 0)return O.error("Branch labels must be unique.");m[String(V)]=_.length}const N=r.parse(D,I,d);if(!N)return null;d=d||N.type,_.push(N)}const b=r.parse(e[1],1,Wt);if(!b)return null;const T=r.parse(e[e.length-1],e.length-1,d);return T?b.type.kind!=="value"&&r.concat(1).checkSubtype(l,b.type)?null:new ql(l,d,b,m,_,T):null}evaluate(e){const r=this.input.evaluate(e);return(ge(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Gl{constructor(e,r,l){this.type=e,this.branches=r,this.otherwise=l}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let l;r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);const d=[];for(let _=1;_<e.length-1;_+=2){const b=r.parse(e[_],_,Vt);if(!b)return null;const T=r.parse(e[_+1],_+1,l);if(!T)return null;d.push([b,T]),l=l||T.type}const m=r.parse(e[e.length-1],e.length-1,l);if(!m)return null;if(!l)throw new Error("Can't infer output type");return new Gl(l,d,m)}evaluate(e){for(const[r,l]of this.branches)if(r.evaluate(e))return l.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,l]of this.branches)e(r),e(l);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class Oa{constructor(e,r,l,d){this.type=e,this.input=r,this.beginIndex=l,this.endIndex=d}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=r.parse(e[1],1,Wt),d=r.parse(e[2],2,Ne);if(!l||!d)return null;if(!ms(l.type,[$n(Wt),Ot,Wt]))return r.error(`Expected first argument to be of type array or string, but found ${Ii(l.type)} instead`);if(e.length===4){const m=r.parse(e[3],3,Ne);return m?new Oa(l.type,l,d,m):null}return new Oa(l.type,l,d)}evaluate(e){const r=this.input.evaluate(e),l=this.beginIndex.evaluate(e);if(!gs(r,["string","array"]))throw new ot(`Expected first argument to be of type array or string, but found ${Ii(ge(r))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(e);return r.slice(l,d)}return r.slice(l)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function _u(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function yu(i,e,r,l){return l.compare(e,r)===0}function Ws(i,e,r){const l=i!=="=="&&i!=="!=";return class Hx{constructor(m,_,b){this.type=Vt,this.lhs=m,this.rhs=_,this.collator=b,this.hasUntypedArgument=m.type.kind==="value"||_.type.kind==="value"}static parse(m,_){if(m.length!==3&&m.length!==4)return _.error("Expected two or three arguments.");const b=m[0];let T=_.parse(m[1],1,Wt);if(!T)return null;if(!_u(b,T.type))return _.concat(1).error(`"${b}" comparisons are not supported for type '${Ii(T.type)}'.`);let I=_.parse(m[2],2,Wt);if(!I)return null;if(!_u(b,I.type))return _.concat(2).error(`"${b}" comparisons are not supported for type '${Ii(I.type)}'.`);if(T.type.kind!==I.type.kind&&T.type.kind!=="value"&&I.type.kind!=="value")return _.error(`Cannot compare types '${Ii(T.type)}' and '${Ii(I.type)}'.`);l&&(T.type.kind==="value"&&I.type.kind!=="value"?T=new Bt(I.type,[T]):T.type.kind!=="value"&&I.type.kind==="value"&&(I=new Bt(T.type,[I])));let P=null;if(m.length===4){if(T.type.kind!=="string"&&I.type.kind!=="string"&&T.type.kind!=="value"&&I.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(P=_.parse(m[3],3,Br),!P)return null}return new Hx(T,I,P)}evaluate(m){const _=this.lhs.evaluate(m),b=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){const T=ge(_),I=ge(b);if(T.kind!==I.kind||T.kind!=="string"&&T.kind!=="number")throw new ot(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${T.kind}, ${I.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const T=ge(_),I=ge(b);if(T.kind!=="string"||I.kind!=="string")return e(m,_,b)}return this.collator?r(m,_,b,this.collator.evaluate(m)):e(m,_,b)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const vd=Ws("==",function(i,e,r){return e===r},yu),xd=Ws("!=",function(i,e,r){return e!==r},function(i,e,r,l){return!yu(0,e,r,l)}),bd=Ws("<",function(i,e,r){return e<r},function(i,e,r,l){return l.compare(e,r)<0}),wd=Ws(">",function(i,e,r){return e>r},function(i,e,r,l){return l.compare(e,r)>0}),Td=Ws("<=",function(i,e,r){return e<=r},function(i,e,r,l){return l.compare(e,r)<=0}),Ed=Ws(">=",function(i,e,r){return e>=r},function(i,e,r,l){return l.compare(e,r)>=0});class Wl{constructor(e,r,l,d,m){this.type=Ot,this.number=e,this.locale=r,this.currency=l,this.minFractionDigits=d,this.maxFractionDigits=m}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");const l=r.parse(e[1],1,Ne);if(!l)return null;const d=e[2];if(typeof d!="object"||Array.isArray(d))return r.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=r.parse(d.locale,1,Ot),!m))return null;let _=null;if(d.currency&&(_=r.parse(d.currency,1,Ot),!_))return null;let b=null;if(d["min-fraction-digits"]&&(b=r.parse(d["min-fraction-digits"],1,Ne),!b))return null;let T=null;return d["max-fraction-digits"]&&(T=r.parse(d["max-fraction-digits"],1,Ne),!T)?null:new Wl(l,m,_,b,T)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Ba{constructor(e){this.type=fn,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const l=e[1];if(!Array.isArray(l)&&typeof l=="object")return r.error("First argument must be an image or text section.");const d=[];let m=!1;for(let _=1;_<=e.length-1;++_){const b=e[_];if(m&&typeof b=="object"&&!Array.isArray(b)){m=!1;let T=null;if(b["font-scale"]&&(T=r.parse(b["font-scale"],1,Ne),!T))return null;let I=null;if(b["text-font"]&&(I=r.parse(b["text-font"],1,$n(Ot)),!I))return null;let P=null;if(b["text-color"]&&(P=r.parse(b["text-color"],1,wn),!P))return null;const D=d[d.length-1];D.scale=T,D.font=I,D.textColor=P}else{const T=r.parse(e[_],1,Wt);if(!T)return null;const I=T.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:T,scale:null,font:null,textColor:null})}}return new Ba(d)}evaluate(e){return new te(this.sections.map(r=>{const l=r.content.evaluate(e);return ge(l)===nn?new re("",l,null,null,null):new re(vt(l),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}}class Zl{constructor(e){this.type=nn,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");const l=r.parse(e[1],1,Ot);return l?new Zl(l):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),l=se.fromString(r);return l&&e.availableImages&&(l.available=e.availableImages.indexOf(r)>-1),l}eachChild(e){e(this.input)}outputDefined(){return!1}}class Hl{constructor(e){this.type=Ne,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const l=r.parse(e[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${Ii(l.type)} instead.`):new Hl(l):null}evaluate(e){const r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new ot(`Expected value to be of type string or array, but found ${Ii(ge(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Zs={"==":vd,"!=":xd,">":wd,"<":bd,">=":Ed,"<=":Td,array:Bt,at:Vl,boolean:Bt,case:Gl,coalesce:Da,collator:mn,format:Ba,image:Zl,in:jl,"index-of":La,interpolate:Jn,"interpolate-hcl":Jn,"interpolate-lab":Jn,length:Hl,let:Ra,literal:wt,match:ql,number:Bt,"number-format":Wl,object:Bt,slice:Oa,step:Ao,string:Bt,"to-boolean":jt,"to-color":jt,"to-number":jt,"to-string":jt,var:Pa,within:ys};function vu(i,[e,r,l,d]){e=e.evaluate(i),r=r.evaluate(i),l=l.evaluate(i);const m=d?d.evaluate(i):1,_=_e(e,r,l,m);if(_)throw new ot(_);return new q(e/255*m,r/255*m,l/255*m,m)}function xu(i,e){return i in e}function Fa(i,e){const r=e[i];return r===void 0?null:r}function vs(i){return{type:i}}function bu(i){return{result:"success",value:i}}function Hs(i){return{result:"error",value:i}}function Fi(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function wu(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function oi(i){return!!i.expression&&i.expression.interpolated}function xi(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Bi(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function qi(i){return i}function Mo(i,e){const r=e.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",d=l||!(l||i.property!==void 0),m=i.type||(oi(e)?"exponential":"interval");if(r||e.type==="padding"){const I=r?q.parse:ee.parse;(i=li({},i)).stops&&(i.stops=i.stops.map(P=>[P[0],I(P[1])])),i.default=I(i.default?i.default:e.default)}if(i.colorSpace&&i.colorSpace!=="rgb"&&!gu[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let _,b,T;if(m==="exponential")_=Tu;else if(m==="interval")_=Id;else if(m==="categorical"){_=Sd,b=Object.create(null);for(const I of i.stops)b[I[0]]=I[1];T=typeof i.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);_=Ad}if(l){const I={},P=[];for(let N=0;N<i.stops.length;N++){const V=i.stops[N],Y=V[0].zoom;I[Y]===void 0&&(I[Y]={zoom:Y,type:i.type,property:i.property,default:i.default,stops:[]},P.push(Y)),I[Y].stops.push([V[0].value,V[1]])}const D=[];for(const N of P)D.push([I[N].zoom,Mo(I[N],e)]);const O={name:"linear"};return{kind:"composite",interpolationType:O,interpolationFactor:Jn.interpolationFactor.bind(void 0,O),zoomStops:D.map(N=>N[0]),evaluate:({zoom:N},V)=>Tu({stops:D,base:i.base},e,N).evaluate(N,V)}}if(d){const I=m==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:Jn.interpolationFactor.bind(void 0,I),zoomStops:i.stops.map(P=>P[0]),evaluate:({zoom:P})=>_(i,e,P,b,T)}}return{kind:"source",evaluate(I,P){const D=P&&P.properties?P.properties[i.property]:void 0;return D===void 0?Xs(i.default,e.default):_(i,e,D,b,T)}}}function Xs(i,e,r){return i!==void 0?i:e!==void 0?e:r!==void 0?r:void 0}function Sd(i,e,r,l,d){return Xs(typeof r===d?l[r]:void 0,i.default,e.default)}function Id(i,e,r){if(xi(r)!=="number")return Xs(i.default,e.default);const l=i.stops.length;if(l===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[l-1][0])return i.stops[l-1][1];const d=Ma(i.stops.map(m=>m[0]),r);return i.stops[d][1]}function Tu(i,e,r){const l=i.base!==void 0?i.base:1;if(xi(r)!=="number")return Xs(i.default,e.default);const d=i.stops.length;if(d===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[d-1][0])return i.stops[d-1][1];const m=Ma(i.stops.map(P=>P[0]),r),_=function(P,D,O,N){const V=N-O,Y=P-O;return V===0?0:D===1?Y/V:(Math.pow(D,Y)-1)/(Math.pow(D,V)-1)}(r,l,i.stops[m][0],i.stops[m+1][0]),b=i.stops[m][1],T=i.stops[m+1][1];let I=Co[e.type]||qi;if(i.colorSpace&&i.colorSpace!=="rgb"){const P=gu[i.colorSpace];I=(D,O)=>P.reverse(P.interpolate(P.forward(D),P.forward(O),_))}return typeof b.evaluate=="function"?{evaluate(...P){const D=b.evaluate.apply(void 0,P),O=T.evaluate.apply(void 0,P);if(D!==void 0&&O!==void 0)return I(D,O,_)}}:I(b,T,_)}function Ad(i,e,r){switch(e.type){case"color":r=q.parse(r);break;case"formatted":r=te.fromString(r.toString());break;case"resolvedImage":r=se.fromString(r.toString());break;case"padding":r=ee.parse(r);break;default:xi(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0)}return Xs(r,i.default,e.default)}Pi.register(Zs,{error:[{kind:"error"},[Ot],(i,[e])=>{throw new ot(e.evaluate(i))}],typeof:[Ot,[Wt],(i,[e])=>Ii(ge(e.evaluate(i)))],"to-rgba":[$n(Ne,4),[wn],(i,[e])=>e.evaluate(i).toArray()],rgb:[wn,[Ne,Ne,Ne],vu],rgba:[wn,[Ne,Ne,Ne,Ne],vu],has:{type:Vt,overloads:[[[Ot],(i,[e])=>xu(e.evaluate(i),i.properties())],[[Ot,Yr],(i,[e,r])=>xu(e.evaluate(i),r.evaluate(i))]]},get:{type:Wt,overloads:[[[Ot],(i,[e])=>Fa(e.evaluate(i),i.properties())],[[Ot,Yr],(i,[e,r])=>Fa(e.evaluate(i),r.evaluate(i))]]},"feature-state":[Wt,[Ot],(i,[e])=>Fa(e.evaluate(i),i.featureState||{})],properties:[Yr,[],i=>i.properties()],"geometry-type":[Ot,[],i=>i.geometryType()],id:[Wt,[],i=>i.id()],zoom:[Ne,[],i=>i.globals.zoom],"heatmap-density":[Ne,[],i=>i.globals.heatmapDensity||0],"line-progress":[Ne,[],i=>i.globals.lineProgress||0],accumulated:[Wt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Ne,vs(Ne),(i,e)=>{let r=0;for(const l of e)r+=l.evaluate(i);return r}],"*":[Ne,vs(Ne),(i,e)=>{let r=1;for(const l of e)r*=l.evaluate(i);return r}],"-":{type:Ne,overloads:[[[Ne,Ne],(i,[e,r])=>e.evaluate(i)-r.evaluate(i)],[[Ne],(i,[e])=>-e.evaluate(i)]]},"/":[Ne,[Ne,Ne],(i,[e,r])=>e.evaluate(i)/r.evaluate(i)],"%":[Ne,[Ne,Ne],(i,[e,r])=>e.evaluate(i)%r.evaluate(i)],ln2:[Ne,[],()=>Math.LN2],pi:[Ne,[],()=>Math.PI],e:[Ne,[],()=>Math.E],"^":[Ne,[Ne,Ne],(i,[e,r])=>Math.pow(e.evaluate(i),r.evaluate(i))],sqrt:[Ne,[Ne],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[Ne,[Ne],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[Ne,[Ne],(i,[e])=>Math.log(e.evaluate(i))],log2:[Ne,[Ne],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[Ne,[Ne],(i,[e])=>Math.sin(e.evaluate(i))],cos:[Ne,[Ne],(i,[e])=>Math.cos(e.evaluate(i))],tan:[Ne,[Ne],(i,[e])=>Math.tan(e.evaluate(i))],asin:[Ne,[Ne],(i,[e])=>Math.asin(e.evaluate(i))],acos:[Ne,[Ne],(i,[e])=>Math.acos(e.evaluate(i))],atan:[Ne,[Ne],(i,[e])=>Math.atan(e.evaluate(i))],min:[Ne,vs(Ne),(i,e)=>Math.min(...e.map(r=>r.evaluate(i)))],max:[Ne,vs(Ne),(i,e)=>Math.max(...e.map(r=>r.evaluate(i)))],abs:[Ne,[Ne],(i,[e])=>Math.abs(e.evaluate(i))],round:[Ne,[Ne],(i,[e])=>{const r=e.evaluate(i);return r<0?-Math.round(-r):Math.round(r)}],floor:[Ne,[Ne],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[Ne,[Ne],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Vt,[Ot,Wt],(i,[e,r])=>i.properties()[e.value]===r.value],"filter-id-==":[Vt,[Wt],(i,[e])=>i.id()===e.value],"filter-type-==":[Vt,[Ot],(i,[e])=>i.geometryType()===e.value],"filter-<":[Vt,[Ot,Wt],(i,[e,r])=>{const l=i.properties()[e.value],d=r.value;return typeof l==typeof d&&l<d}],"filter-id-<":[Vt,[Wt],(i,[e])=>{const r=i.id(),l=e.value;return typeof r==typeof l&&r<l}],"filter->":[Vt,[Ot,Wt],(i,[e,r])=>{const l=i.properties()[e.value],d=r.value;return typeof l==typeof d&&l>d}],"filter-id->":[Vt,[Wt],(i,[e])=>{const r=i.id(),l=e.value;return typeof r==typeof l&&r>l}],"filter-<=":[Vt,[Ot,Wt],(i,[e,r])=>{const l=i.properties()[e.value],d=r.value;return typeof l==typeof d&&l<=d}],"filter-id-<=":[Vt,[Wt],(i,[e])=>{const r=i.id(),l=e.value;return typeof r==typeof l&&r<=l}],"filter->=":[Vt,[Ot,Wt],(i,[e,r])=>{const l=i.properties()[e.value],d=r.value;return typeof l==typeof d&&l>=d}],"filter-id->=":[Vt,[Wt],(i,[e])=>{const r=i.id(),l=e.value;return typeof r==typeof l&&r>=l}],"filter-has":[Vt,[Wt],(i,[e])=>e.value in i.properties()],"filter-has-id":[Vt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Vt,[$n(Ot)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Vt,[$n(Wt)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Vt,[Ot,$n(Wt)],(i,[e,r])=>r.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Vt,[Ot,$n(Wt)],(i,[e,r])=>function(l,d,m,_){for(;m<=_;){const b=m+_>>1;if(d[b]===l)return!0;d[b]>l?_=b-1:m=b+1}return!1}(i.properties()[e.value],r.value,0,r.value.length-1)],all:{type:Vt,overloads:[[[Vt,Vt],(i,[e,r])=>e.evaluate(i)&&r.evaluate(i)],[vs(Vt),(i,e)=>{for(const r of e)if(!r.evaluate(i))return!1;return!0}]]},any:{type:Vt,overloads:[[[Vt,Vt],(i,[e,r])=>e.evaluate(i)||r.evaluate(i)],[vs(Vt),(i,e)=>{for(const r of e)if(r.evaluate(i))return!0;return!1}]]},"!":[Vt,[Vt],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Vt,[Ot],(i,[e])=>{const r=i.globals&&i.globals.isSupportedScript;return!r||r(e.evaluate(i))}],upcase:[Ot,[Ot],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[Ot,[Ot],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[Ot,vs(Wt),(i,e)=>e.map(r=>vt(r.evaluate(i))).join("")],"resolved-locale":[Ot,[Br],(i,[e])=>e.evaluate(i).resolvedLocale()]});class $a{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new pi,this._defaultValue=r?function(l){return l.type==="color"&&Bi(l.default)?new q(0,0,0,0):l.type==="color"?q.parse(l.default)||null:l.type==="padding"?ee.parse(l.default)||null:l.default===void 0?null:l.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,l,d,m,_){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=l,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(e,r,l,d,m,_){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=l||null,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new ot(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function zo(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Zs}function Do(i,e){const r=new Gs(Zs,[],e?function(d){const m={color:wn,string:Ot,number:Ne,enum:Ot,boolean:Vt,formatted:fn,padding:Us,resolvedImage:nn};return d.type==="array"?$n(m[d.value]||Wt,d.length):m[d.type]}(e):void 0),l=r.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?bu(new $a(l,e)):Hs(r.errors)}class Ro{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!qs(r.expression)}evaluateWithoutErrorHandling(e,r,l,d,m,_){return this._styleExpression.evaluateWithoutErrorHandling(e,r,l,d,m,_)}evaluate(e,r,l,d,m,_){return this._styleExpression.evaluate(e,r,l,d,m,_)}}class Xl{constructor(e,r,l,d){this.kind=e,this.zoomStops=l,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!qs(r.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,r,l,d,m,_){return this._styleExpression.evaluateWithoutErrorHandling(e,r,l,d,m,_)}evaluate(e,r,l,d,m,_){return this._styleExpression.evaluate(e,r,l,d,m,_)}interpolationFactor(e,r,l){return this.interpolationType?Jn.interpolationFactor(this.interpolationType,e,r,l):0}}function Eu(i,e){const r=Do(i,e);if(r.result==="error")return r;const l=r.value.expression,d=Io(l);if(!d&&!Fi(e))return Hs([new An("","data expressions not supported")]);const m=ka(l,["zoom"]);if(!m&&!wu(e))return Hs([new An("","zoom expressions not supported")]);const _=Na(l);return _||m?_ instanceof An?Hs([_]):_ instanceof Jn&&!oi(e)?Hs([new An("",'"interpolate" expressions cannot be used with this property')]):bu(_?new Xl(d?"camera":"composite",r.value,_.labels,_ instanceof Jn?_.interpolation:void 0):new Ro(d?"constant":"source",r.value)):Hs([new An("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ua{constructor(e,r){this._parameters=e,this._specification=r,li(this,Mo(this._parameters,this._specification))}static deserialize(e){return new Ua(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Na(i){let e=null;if(i instanceof Ra)e=Na(i.result);else if(i instanceof Da){for(const r of i.args)if(e=Na(r),e)break}else(i instanceof Ao||i instanceof Jn)&&i.input instanceof Pi&&i.input.name==="zoom"&&(e=i);return e instanceof An||i.eachChild(r=>{const l=Na(r);l instanceof An?e=l:!e&&l?e=new An("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&l&&e!==l&&(e=new An("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function yr(i){const e=i.key,r=i.value,l=i.valueSpec||{},d=i.objectElementValidators||{},m=i.style,_=i.styleSpec;let b=[];const T=xi(r);if(T!=="object")return[new Pe(e,r,`object expected, ${T} found`)];for(const I in r){const P=I.split(".")[0],D=l[P]||l["*"];let O;if(d[P])O=d[P];else if(l[P])O=Qn;else if(d["*"])O=d["*"];else{if(!l["*"]){b.push(new Pe(e,r[I],`unknown property "${I}"`));continue}O=Qn}b=b.concat(O({key:(e&&`${e}.`)+I,value:r[I],valueSpec:D,style:m,styleSpec:_,object:r,objectKey:I},r))}for(const I in l)d[I]||l[I].required&&l[I].default===void 0&&r[I]===void 0&&b.push(new Pe(e,r,`missing required property "${I}"`));return b}function Su(i){const e=i.value,r=i.valueSpec,l=i.style,d=i.styleSpec,m=i.key,_=i.arrayElementValidator||Qn;if(xi(e)!=="array")return[new Pe(m,e,`array expected, ${xi(e)} found`)];if(r.length&&e.length!==r.length)return[new Pe(m,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new Pe(m,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let b={type:r.value,values:r.values};d.$version<7&&(b.function=r.function),xi(r.value)==="object"&&(b=r.value);let T=[];for(let I=0;I<e.length;I++)T=T.concat(_({array:e,arrayIndex:I,value:e[I],valueSpec:b,style:l,styleSpec:d,key:`${m}[${I}]`}));return T}function Kl(i){const e=i.key,r=i.value,l=i.valueSpec;let d=xi(r);return d==="number"&&r!=r&&(d="NaN"),d!=="number"?[new Pe(e,r,`number expected, ${d} found`)]:"minimum"in l&&r<l.minimum?[new Pe(e,r,`${r} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&r>l.maximum?[new Pe(e,r,`${r} is greater than the maximum value ${l.maximum}`)]:[]}function Iu(i){const e=i.valueSpec,r=Ht(i.value.type);let l,d,m,_={};const b=r!=="categorical"&&i.value.property===void 0,T=!b,I=xi(i.value.stops)==="array"&&xi(i.value.stops[0])==="array"&&xi(i.value.stops[0][0])==="object",P=yr({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(N){if(r==="identity")return[new Pe(N.key,N.value,'identity function may not have a "stops" property')];let V=[];const Y=N.value;return V=V.concat(Su({key:N.key,value:Y,valueSpec:N.valueSpec,style:N.style,styleSpec:N.styleSpec,arrayElementValidator:D})),xi(Y)==="array"&&Y.length===0&&V.push(new Pe(N.key,Y,"array must have at least one stop")),V},default:function(N){return Qn({key:N.key,value:N.value,valueSpec:e,style:N.style,styleSpec:N.styleSpec})}}});return r==="identity"&&b&&P.push(new Pe(i.key,i.value,'missing required property "property"')),r==="identity"||i.value.stops||P.push(new Pe(i.key,i.value,'missing required property "stops"')),r==="exponential"&&i.valueSpec.expression&&!oi(i.valueSpec)&&P.push(new Pe(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(T&&!Fi(i.valueSpec)?P.push(new Pe(i.key,i.value,"property functions not supported")):b&&!wu(i.valueSpec)&&P.push(new Pe(i.key,i.value,"zoom functions not supported"))),r!=="categorical"&&!I||i.value.property!==void 0||P.push(new Pe(i.key,i.value,'"property" property is required')),P;function D(N){let V=[];const Y=N.value,J=N.key;if(xi(Y)!=="array")return[new Pe(J,Y,`array expected, ${xi(Y)} found`)];if(Y.length!==2)return[new Pe(J,Y,`array length 2 expected, length ${Y.length} found`)];if(I){if(xi(Y[0])!=="object")return[new Pe(J,Y,`object expected, ${xi(Y[0])} found`)];if(Y[0].zoom===void 0)return[new Pe(J,Y,"object stop key must have zoom")];if(Y[0].value===void 0)return[new Pe(J,Y,"object stop key must have value")];if(m&&m>Ht(Y[0].zoom))return[new Pe(J,Y[0].zoom,"stop zoom values must appear in ascending order")];Ht(Y[0].zoom)!==m&&(m=Ht(Y[0].zoom),d=void 0,_={}),V=V.concat(yr({key:`${J}[0]`,value:Y[0],valueSpec:{zoom:{}},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{zoom:Kl,value:O}}))}else V=V.concat(O({key:`${J}[0]`,value:Y[0],valueSpec:{},style:N.style,styleSpec:N.styleSpec},Y));return zo(ln(Y[1]))?V.concat([new Pe(`${J}[1]`,Y[1],"expressions are not allowed in function stops.")]):V.concat(Qn({key:`${J}[1]`,value:Y[1],valueSpec:e,style:N.style,styleSpec:N.styleSpec}))}function O(N,V){const Y=xi(N.value),J=Ht(N.value),ce=N.value!==null?N.value:V;if(l){if(Y!==l)return[new Pe(N.key,ce,`${Y} stop domain type must match previous stop domain type ${l}`)]}else l=Y;if(Y!=="number"&&Y!=="string"&&Y!=="boolean")return[new Pe(N.key,ce,"stop domain value must be a number, string, or boolean")];if(Y!=="number"&&r!=="categorical"){let me=`number expected, ${Y} found`;return Fi(e)&&r===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Pe(N.key,ce,me)]}return r!=="categorical"||Y!=="number"||isFinite(J)&&Math.floor(J)===J?r!=="categorical"&&Y==="number"&&d!==void 0&&J<d?[new Pe(N.key,ce,"stop domain values must appear in ascending order")]:(d=J,r==="categorical"&&J in _?[new Pe(N.key,ce,"stop domain values must be unique")]:(_[J]=!0,[])):[new Pe(N.key,ce,`integer expected, found ${J}`)]}}function xs(i){const e=(i.expressionContext==="property"?Eu:Do)(ln(i.value),i.valueSpec);if(e.result==="error")return e.value.map(l=>new Pe(`${i.key}${l.key}`,i.value,l.message));const r=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!r.outputDefined())return[new Pe(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!qs(r))return[new Pe(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!qs(r))return[new Pe(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!ka(r,["zoom","feature-state"]))return[new Pe(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Io(r))return[new Pe(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Lo(i){const e=i.key,r=i.value,l=i.valueSpec,d=[];return Array.isArray(l.values)?l.values.indexOf(Ht(r))===-1&&d.push(new Pe(e,r,`expected one of [${l.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(l.values).indexOf(Ht(r))===-1&&d.push(new Pe(e,r,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(r)} found`)),d}function Ks(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!Ks(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Cd={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Va(i){if(i==null)return{filter:()=>!0,needGeometry:!1};Ks(i)||(i=Oo(i));const e=Do(i,Cd);if(e.result==="error")throw new Error(e.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,l,d)=>e.value.evaluate(r,l,{},d),needGeometry:Cu(i)}}function Au(i,e){return i<e?-1:i>e?1:0}function Cu(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let e=1;e<i.length;e++)if(Cu(i[e]))return!0;return!1}function Oo(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?Jl(i[1],i[2],"=="):e==="!="?Js(Jl(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Jl(i[1],i[2],e):e==="any"?(r=i.slice(1),["any"].concat(r.map(Oo))):e==="all"?["all"].concat(i.slice(1).map(Oo)):e==="none"?["all"].concat(i.slice(1).map(Oo).map(Js)):e==="in"?ja(i[1],i.slice(2)):e==="!in"?Js(ja(i[1],i.slice(2))):e==="has"?Bo(i[1]):e==="!has"?Js(Bo(i[1])):e!=="within"||i;var r}function Jl(i,e,r){switch(i){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,i,e]}}function ja(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",i,["literal",e.sort(Au)]]:["filter-in-small",i,["literal",e]]}}function Bo(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Js(i){return["!",i]}function Fo(i){return Ks(ln(i.value))?xs(li({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ku(i)}function ku(i){const e=i.value,r=i.key;if(xi(e)!=="array")return[new Pe(r,e,`array expected, ${xi(e)} found`)];const l=i.styleSpec;let d,m=[];if(e.length<1)return[new Pe(r,e,"filter array must have at least 1 element")];switch(m=m.concat(Lo({key:`${r}[0]`,value:e[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),Ht(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Ht(e[1])==="$type"&&m.push(new Pe(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new Pe(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=xi(e[1]),d!=="string"&&m.push(new Pe(`${r}[1]`,e[1],`string expected, ${d} found`)));for(let _=2;_<e.length;_++)d=xi(e[_]),Ht(e[1])==="$type"?m=m.concat(Lo({key:`${r}[${_}]`,value:e[_],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&m.push(new Pe(`${r}[${_}]`,e[_],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let _=1;_<e.length;_++)m=m.concat(ku({key:`${r}[${_}]`,value:e[_],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":d=xi(e[1]),e.length!==2?m.push(new Pe(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="string"&&m.push(new Pe(`${r}[1]`,e[1],`string expected, ${d} found`));break;case"within":d=xi(e[1]),e.length!==2?m.push(new Pe(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="object"&&m.push(new Pe(`${r}[1]`,e[1],`object expected, ${d} found`))}return m}function $o(i,e){const r=i.key,l=i.style,d=i.styleSpec,m=i.value,_=i.objectKey,b=d[`${e}_${i.layerType}`];if(!b)return[];const T=_.match(/^(.*)-transition$/);if(e==="paint"&&T&&b[T[1]]&&b[T[1]].transition)return Qn({key:r,value:m,valueSpec:d.transition,style:l,styleSpec:d});const I=i.valueSpec||b[_];if(!I)return[new Pe(r,m,`unknown property "${_}"`)];let P;if(xi(m)==="string"&&Fi(I)&&!I.tokens&&(P=/^{([^}]+)}$/.exec(m)))return[new Pe(r,m,`"${_}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(P[1])} }\`.`)];const D=[];return i.layerType==="symbol"&&(_==="text-field"&&l&&!l.glyphs&&D.push(new Pe(r,m,'use of "text-field" requires a style "glyphs" property')),_==="text-font"&&Bi(ln(m))&&Ht(m.type)==="identity"&&D.push(new Pe(r,m,'"text-font" does not support identity functions'))),D.concat(Qn({key:i.key,value:m,valueSpec:I,style:l,styleSpec:d,expressionContext:"property",propertyType:e,propertyKey:_}))}function Pu(i){return $o(i,"paint")}function Mu(i){return $o(i,"layout")}function zu(i){let e=[];const r=i.value,l=i.key,d=i.style,m=i.styleSpec;r.type||r.ref||e.push(new Pe(l,r,'either "type" or "ref" is required'));let _=Ht(r.type);const b=Ht(r.ref);if(r.id){const T=Ht(r.id);for(let I=0;I<i.arrayIndex;I++){const P=d.layers[I];Ht(P.id)===T&&e.push(new Pe(l,r.id,`duplicate layer id "${r.id}", previously used at line ${P.id.__line__}`))}}if("ref"in r){let T;["type","source","source-layer","filter","layout"].forEach(I=>{I in r&&e.push(new Pe(l,r[I],`"${I}" is prohibited for ref layers`))}),d.layers.forEach(I=>{Ht(I.id)===b&&(T=I)}),T?T.ref?e.push(new Pe(l,r.ref,"ref cannot reference another ref layer")):_=Ht(T.type):e.push(new Pe(l,r.ref,`ref layer "${b}" not found`))}else if(_!=="background")if(r.source){const T=d.sources&&d.sources[r.source],I=T&&Ht(T.type);T?I==="vector"&&_==="raster"?e.push(new Pe(l,r.source,`layer "${r.id}" requires a raster source`)):I==="raster"&&_!=="raster"?e.push(new Pe(l,r.source,`layer "${r.id}" requires a vector source`)):I!=="vector"||r["source-layer"]?I==="raster-dem"&&_!=="hillshade"?e.push(new Pe(l,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!r.paint||!r.paint["line-gradient"]||I==="geojson"&&T.lineMetrics||e.push(new Pe(l,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Pe(l,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new Pe(l,r.source,`source "${r.source}" not found`))}else e.push(new Pe(l,r,'missing required property "source"'));return e=e.concat(yr({key:l,value:r,valueSpec:m.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Qn({key:`${l}.type`,value:r.type,valueSpec:m.layer.type,style:i.style,styleSpec:i.styleSpec,object:r,objectKey:"type"}),filter:Fo,layout:T=>yr({layer:r,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":I=>Mu(li({layerType:_},I))}}),paint:T=>yr({layer:r,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":I=>Pu(li({layerType:_},I))}})}})),e}function Ys(i){const e=i.value,r=i.key,l=xi(e);return l!=="string"?[new Pe(r,e,`string expected, ${l} found`)]:[]}const Du={promoteId:function({key:i,value:e}){if(xi(e)==="string")return Ys({key:i,value:e});{const r=[];for(const l in e)r.push(...Ys({key:`${i}.${l}`,value:e[l]}));return r}}};function Uo(i){const e=i.value,r=i.key,l=i.styleSpec,d=i.style;if(!e.type)return[new Pe(r,e,'"type" is required')];const m=Ht(e.type);let _;switch(m){case"vector":case"raster":case"raster-dem":return _=yr({key:r,value:e,valueSpec:l[`source_${m.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:Du}),_;case"geojson":if(_=yr({key:r,value:e,valueSpec:l.source_geojson,style:d,styleSpec:l,objectElementValidators:Du}),e.cluster)for(const b in e.clusterProperties){const[T,I]=e.clusterProperties[b],P=typeof T=="string"?[T,["accumulated"],["get",b]]:T;_.push(...xs({key:`${r}.${b}.map`,value:I,expressionContext:"cluster-map"})),_.push(...xs({key:`${r}.${b}.reduce`,value:P,expressionContext:"cluster-reduce"}))}return _;case"video":return yr({key:r,value:e,valueSpec:l.source_video,style:d,styleSpec:l});case"image":return yr({key:r,value:e,valueSpec:l.source_image,style:d,styleSpec:l});case"canvas":return[new Pe(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Lo({key:`${r}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,styleSpec:l})}}function No(i){const e=i.value,r=i.styleSpec,l=r.light,d=i.style;let m=[];const _=xi(e);if(e===void 0)return m;if(_!=="object")return m=m.concat([new Pe("light",e,`object expected, ${_} found`)]),m;for(const b in e){const T=b.match(/^(.*)-transition$/);m=m.concat(T&&l[T[1]]&&l[T[1]].transition?Qn({key:b,value:e[b],valueSpec:r.transition,style:d,styleSpec:r}):l[b]?Qn({key:b,value:e[b],valueSpec:l[b],style:d,styleSpec:r}):[new Pe(b,e[b],`unknown property "${b}"`)])}return m}function Yn(i){const e=i.value,r=i.styleSpec,l=r.terrain,d=i.style;let m=[];const _=xi(e);if(e===void 0)return m;if(_!=="object")return m=m.concat([new Pe("terrain",e,`object expected, ${_} found`)]),m;for(const b in e)m=m.concat(l[b]?Qn({key:b,value:e[b],valueSpec:l[b],style:d,styleSpec:r}):[new Pe(b,e[b],`unknown property "${b}"`)]);return m}const Vo={"*":()=>[],array:Su,boolean:function(i){const e=i.value,r=i.key,l=xi(e);return l!=="boolean"?[new Pe(r,e,`boolean expected, ${l} found`)]:[]},number:Kl,color:function(i){const e=i.key,r=i.value,l=xi(r);return l!=="string"?[new Pe(e,r,`color expected, ${l} found`)]:Vs(r)===null?[new Pe(e,r,`color expected, "${r}" found`)]:[]},constants:gi,enum:Lo,filter:Fo,function:Iu,layer:zu,object:yr,source:Uo,light:No,terrain:Yn,string:Ys,formatted:function(i){return Ys(i).length===0?[]:xs(i)},resolvedImage:function(i){return Ys(i).length===0?[]:xs(i)},padding:function(i){const e=i.key,r=i.value;if(xi(r)==="array"){if(r.length<1||r.length>4)return[new Pe(e,r,`padding requires 1 to 4 values; ${r.length} values found`)];const l={type:"number"};let d=[];for(let m=0;m<r.length;m++)d=d.concat(Qn({key:`${e}[${m}]`,value:r[m],valueSpec:l}));return d}return Kl({key:e,value:r,valueSpec:{}})}};function Qn(i){const e=i.value,r=i.valueSpec,l=i.styleSpec;return r.expression&&Bi(Ht(e))?Iu(i):r.expression&&zo(ln(e))?xs(i):r.type&&Vo[r.type]?Vo[r.type](i):yr(li({},i,{valueSpec:r.type?l[r.type]:r}))}function kd(i){const e=i.value,r=i.key,l=Ys(i);return l.length||(e.indexOf("{fontstack}")===-1&&l.push(new Pe(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&l.push(new Pe(r,e,'"glyphs" url must include a "{range}" token'))),l}function Qr(i,e=he){let r=[];return r=r.concat(Qn({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,objectElementValidators:{glyphs:kd,"*":()=>[]}})),i.constants&&(r=r.concat(gi({key:"constants",value:i.constants,style:i,styleSpec:e}))),Ru(r)}function Ru(i){return[].concat(i).sort((e,r)=>e.line-r.line)}function Fr(i){return function(...e){return Ru(i.apply(this,e))}}Qr.source=Fr(Uo),Qr.light=Fr(No),Qr.terrain=Fr(Yn),Qr.layer=Fr(zu),Qr.filter=Fr(Fo),Qr.paintProperty=Fr(Pu),Qr.layoutProperty=Fr(Mu);const jo=Qr,Yl=jo.light,Pd=jo.paintProperty,Md=jo.layoutProperty;function qa(i,e){let r=!1;if(e&&e.length)for(const l of e)i.fire(new At(new Error(l.message))),r=!0;return r}class qo{constructor(e,r,l){const d=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const _=new Int32Array(this.arrayBuffer);e=_[0],this.d=(r=_[1])+2*(l=_[2]);for(let T=0;T<this.d*this.d;T++){const I=_[3+T],P=_[3+T+1];d.push(I===P?null:_.subarray(I,P))}const b=_[3+d.length+1];this.keys=_.subarray(_[3+d.length],b),this.bboxes=_.subarray(b),this.insert=this._insertReadonly}else{this.d=r+2*l;for(let _=0;_<this.d*this.d;_++)d.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=l,this.scale=r/e,this.uid=0;const m=l/r*e;this.min=-m,this.max=e+m}insert(e,r,l,d,m){this._forEachCell(r,l,d,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,l,d,m,_){this.cells[m].push(_)}query(e,r,l,d,m){const _=this.min,b=this.max;if(e<=_&&r<=_&&b<=l&&b<=d&&!m)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(e,r,l,d,this._queryCell,T,{},m),T}}_queryCell(e,r,l,d,m,_,b,T){const I=this.cells[m];if(I!==null){const P=this.keys,D=this.bboxes;for(let O=0;O<I.length;O++){const N=I[O];if(b[N]===void 0){const V=4*N;(T?T(D[V+0],D[V+1],D[V+2],D[V+3]):e<=D[V+2]&&r<=D[V+3]&&l>=D[V+0]&&d>=D[V+1])?(b[N]=!0,_.push(P[N])):b[N]=!1}}}}_forEachCell(e,r,l,d,m,_,b,T){const I=this._convertToCellCoord(e),P=this._convertToCellCoord(r),D=this._convertToCellCoord(l),O=this._convertToCellCoord(d);for(let N=I;N<=D;N++)for(let V=P;V<=O;V++){const Y=this.d*V+N;if((!T||T(this._convertFromCellCoord(N),this._convertFromCellCoord(V),this._convertFromCellCoord(N+1),this._convertFromCellCoord(V+1)))&&m.call(this,e,r,l,d,Y,_,b,T))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,r=3+this.cells.length+1+1;let l=0;for(let _=0;_<this.cells.length;_++)l+=this.cells[_].length;const d=new Int32Array(r+l+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let m=r;for(let _=0;_<e.length;_++){const b=e[_];d[3+_]=m,d.set(b,m),m+=b.length}return d[3+e.length]=m,d.set(this.keys,m),m+=this.keys.length,d[3+e.length+1]=m,d.set(this.bboxes,m),m+=this.bboxes.length,d.buffer}static serialize(e,r){const l=e.toArrayBuffer();return r&&r.push(l),{buffer:l}}static deserialize(e){return new qo(e.buffer)}}const $r={};function mt(i,e,r={}){if($r[i])throw new Error(`${i} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:i,writeable:!1}),$r[i]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}mt("Object",Object),mt("TransferableGridIndex",qo),mt("Color",q),mt("Error",Error),mt("AJAXError",ri),mt("ResolvedImage",se),mt("StylePropertyFunction",Ua),mt("StyleExpression",$a,{omit:["_evaluator"]}),mt("ZoomDependentExpression",Xl),mt("ZoomConstantExpression",Ro),mt("CompoundExpression",Pi,{omit:["_evaluate"]});for(const i in Zs)Zs[i]._classRegistryKey||mt(`Expression_${i}`,Zs[i]);function Lu(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function bs(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob)return i;if(Lu(i)||ai(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const r=i;return e&&e.push(r.buffer),r}if(i instanceof ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const r=[];for(const l of i)r.push(bs(l,e));return r}if(typeof i=="object"){const r=i.constructor,l=r._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");if(!$r[l])throw new Error(`${l} is not registered.`);const d=r.serialize?r.serialize(i,e):{};if(r.serialize){if(e&&d===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in i){if(!i.hasOwnProperty(m)||$r[l].omit.indexOf(m)>=0)continue;const _=i[m];d[m]=$r[l].shallow.indexOf(m)>=0?_:bs(_,e)}i instanceof Error&&(d.message=i.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(d.$name=l),d}throw new Error("can't serialize object of type "+typeof i)}function es(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||Lu(i)||ai(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(es);if(typeof i=="object"){const e=i.$name||"Object";if(!$r[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:r}=$r[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(i);const l=Object.create(r.prototype);for(const d of Object.keys(i)){if(d==="$name")continue;const m=i[d];l[d]=$r[e].shallow.indexOf(d)>=0?m:es(m)}return l}throw new Error("can't deserialize object of type "+typeof i)}class Ql{constructor(){this.first=!0}update(e,r){const l=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=r),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=l,!0))}}const nt={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Ga(i){for(const e of i)if(tc(e.charCodeAt(0)))return!0;return!1}function zd(i){for(const e of i)if(!ec(e.charCodeAt(0)))return!1;return!0}function ec(i){return!(nt.Arabic(i)||nt["Arabic Supplement"](i)||nt["Arabic Extended-A"](i)||nt["Arabic Presentation Forms-A"](i)||nt["Arabic Presentation Forms-B"](i))}function tc(i){return!(i!==746&&i!==747&&(i<4352||!(nt["Bopomofo Extended"](i)||nt.Bopomofo(i)||nt["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||nt["CJK Compatibility Ideographs"](i)||nt["CJK Compatibility"](i)||nt["CJK Radicals Supplement"](i)||nt["CJK Strokes"](i)||!(!nt["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||nt["CJK Unified Ideographs Extension A"](i)||nt["CJK Unified Ideographs"](i)||nt["Enclosed CJK Letters and Months"](i)||nt["Hangul Compatibility Jamo"](i)||nt["Hangul Jamo Extended-A"](i)||nt["Hangul Jamo Extended-B"](i)||nt["Hangul Jamo"](i)||nt["Hangul Syllables"](i)||nt.Hiragana(i)||nt["Ideographic Description Characters"](i)||nt.Kanbun(i)||nt["Kangxi Radicals"](i)||nt["Katakana Phonetic Extensions"](i)||nt.Katakana(i)&&i!==12540||!(!nt["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!nt["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||nt["Unified Canadian Aboriginal Syllabics"](i)||nt["Unified Canadian Aboriginal Syllabics Extended"](i)||nt["Vertical Forms"](i)||nt["Yijing Hexagram Symbols"](i)||nt["Yi Syllables"](i)||nt["Yi Radicals"](i))))}function Ou(i){return!(tc(i)||function(e){return!!(nt["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||nt["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||nt["Letterlike Symbols"](e)||nt["Number Forms"](e)||nt["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||nt["Control Pictures"](e)&&e!==9251||nt["Optical Character Recognition"](e)||nt["Enclosed Alphanumerics"](e)||nt["Geometric Shapes"](e)||nt["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||nt["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||nt["CJK Symbols and Punctuation"](e)||nt.Katakana(e)||nt["Private Use Area"](e)||nt["CJK Compatibility Forms"](e)||nt["Small Form Variants"](e)||nt["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function Bu(i){return i>=1424&&i<=2303||nt["Arabic Presentation Forms-A"](i)||nt["Arabic Presentation Forms-B"](i)}function Dd(i,e){return!(!e&&Bu(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||nt.Khmer(i))}function Fu(i){for(const e of i)if(Bu(e.charCodeAt(0)))return!0;return!1}const ic="deferred",nc="loading",rc="loaded";let sc=null,qn="unavailable",ts=null;const $u=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(qn="error"),sc&&sc(i)};function Qs(){oc.fire(new yt("pluginStateChange",{pluginStatus:qn,pluginURL:ts}))}const oc=new Lt,Go=function(){return qn},Uu=function(){if(qn!==ic||!ts)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qn=nc,Qs(),ts&&ze({url:ts},i=>{i?$u(i):(qn=rc,Qs())})},cr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>qn===rc||cr.applyArabicShaping!=null,isLoading:()=>qn===nc,setState(i){if(!ht())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");qn=i.pluginStatus,ts=i.pluginURL},isParsed(){if(!ht())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return cr.applyArabicShaping!=null&&cr.processBidirectionalText!=null&&cr.processStyledBidirectionalText!=null},getPluginURL(){if(!ht())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return ts}};class Gi{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ql,this.transition={})}isSupportedScript(e){return function(r,l){for(const d of r)if(!Dd(d.charCodeAt(0),l))return!1;return!0}(e,cr.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,r=e-Math.floor(e),l=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*r}}}class Wo{constructor(e,r){this.property=e,this.value=r,this.expression=function(l,d){if(Bi(l))return new Ua(l,d);if(zo(l)){const m=Eu(l,d);if(m.result==="error")throw new Error(m.value.map(_=>`${_.key}: ${_.message}`).join(", "));return m.value}{let m=l;return d.type==="color"&&typeof l=="string"?m=q.parse(l):d.type!=="padding"||typeof l!="number"&&!Array.isArray(l)||(m=ee.parse(l)),{kind:"constant",evaluate:()=>m}}}(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,l){return this.property.possiblyEvaluate(this,e,r,l)}}class Wa{constructor(e){this.property=e,this.value=new Wo(e,void 0)}transitioned(e,r){return new Vu(this.property,this.value,r,Ee({},e.transition,this.transition),e.now)}untransitioned(){return new Vu(this.property,this.value,null,{},0)}}class Nu{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return tt(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Wa(this._values[e].property)),this._values[e].value=new Wo(this._values[e].property,r===null?void 0:tt(r))}getTransition(e){return tt(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Wa(this._values[e].property)),this._values[e].transition=tt(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(e[r]=l);const d=this.getTransition(r);d!==void 0&&(e[`${r}-transition`]=d)}return e}transitioned(e,r){const l=new ju(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].transitioned(e,r._values[d]);return l}untransitioned(){const e=new ju(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class Vu{constructor(e,r,l,d,m){this.property=e,this.value=r,this.begin=m+d.delay||0,this.end=this.begin+d.duration||0,e.specification.transition&&(d.delay||d.duration)&&(this.prior=l)}possiblyEvaluate(e,r,l){const d=e.now||0,m=this.value.possiblyEvaluate(e,r,l),_=this.prior;if(_){if(d>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(d<this.begin)return _.possiblyEvaluate(e,r,l);{const b=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(e,r,l),m,function(T){if(T<=0)return 0;if(T>=1)return 1;const I=T*T,P=I*T;return 4*(T<.5?P:3*(T-I)+P-.75)}(b))}}return m}}class ju{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,l){const d=new Zo(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,r,l);return d}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Rd{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return tt(this._values[e].value)}setValue(e,r){this._values[e]=new Wo(this._values[e].property,r===null?void 0:tt(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(e[r]=l)}return e}possiblyEvaluate(e,r,l){const d=new Zo(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,r,l);return d}}class kr{constructor(e,r,l){this.property=e,this.value=r,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,l,d){return this.property.evaluate(this.value,this.parameters,e,r,l,d)}}class Zo{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Tt{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,l){const d=Co[this.specification.type];return d?d(e,r,l):e}}class Mt{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,l,d){return new kr(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},l,d)}:e.expression,r)}interpolate(e,r,l){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new kr(this,{kind:"constant",value:void 0},e.parameters);const d=Co[this.specification.type];return d?new kr(this,{kind:"constant",value:d(e.value.value,r.value.value,l)},e.parameters):e}evaluate(e,r,l,d,m,_){return e.kind==="constant"?e.value:e.evaluate(r,l,d,m,_)}}class eo extends Mt{possiblyEvaluate(e,r,l,d){if(e.value===void 0)return new kr(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){const m=e.expression.evaluate(r,null,{},l,d),_=e.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,b=this._calculate(_,_,_,r);return new kr(this,{kind:"constant",value:b},r)}if(e.expression.kind==="camera"){const m=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new kr(this,{kind:"constant",value:m},r)}return new kr(this,e.expression,r)}evaluate(e,r,l,d,m,_){if(e.kind==="source"){const b=e.evaluate(r,l,d,m,_);return this._calculate(b,b,b,r)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},l,d),e.evaluate({zoom:Math.floor(r.zoom)},l,d),e.evaluate({zoom:Math.floor(r.zoom)+1},l,d),r):e.value}_calculate(e,r,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:l,to:r}}interpolate(e){return e}}class ac{constructor(e){this.specification=e}possiblyEvaluate(e,r,l,d){if(e.value!==void 0){if(e.expression.kind==="constant"){const m=e.expression.evaluate(r,null,{},l,d);return this._calculate(m,m,m,r)}return this._calculate(e.expression.evaluate(new Gi(Math.floor(r.zoom-1),r)),e.expression.evaluate(new Gi(Math.floor(r.zoom),r)),e.expression.evaluate(new Gi(Math.floor(r.zoom+1),r)),r)}}_calculate(e,r,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:l,to:r}}interpolate(e){return e}}class is{constructor(e){this.specification=e}possiblyEvaluate(e,r,l,d){return!!e.expression.evaluate(r,null,{},l,d)}interpolate(){return!1}}class Tn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in e){const l=e[r];l.specification.overridable&&this.overridableProperties.push(r);const d=this.defaultPropertyValues[r]=new Wo(l,void 0),m=this.defaultTransitionablePropertyValues[r]=new Wa(l);this.defaultTransitioningPropertyValues[r]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=d.possiblyEvaluate({})}}}mt("DataDrivenProperty",Mt),mt("DataConstantProperty",Tt),mt("CrossFadedDataDrivenProperty",eo),mt("CrossFadedProperty",ac),mt("ColorRampProperty",is);const ns="-transition";class Pr extends Lt{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new Rd(r.layout)),r.paint)){this._transitionablePaint=new Nu(r.paint);for(const l in e.paint)this.setPaintProperty(l,e.paint[l],{validate:!1});for(const l in e.layout)this.setLayoutProperty(l,e.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Zo(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,l={}){r!=null&&this._validate(Md,`layers.${this.id}.layout.${e}`,e,r,l)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return e.endsWith(ns)?this._transitionablePaint.getTransition(e.slice(0,-ns.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,l={}){if(r!=null&&this._validate(Pd,`layers.${this.id}.paint.${e}`,e,r,l))return!1;if(e.endsWith(ns))return this._transitionablePaint.setTransition(e.slice(0,-ns.length),r||void 0),!1;{const d=this._transitionablePaint._values[e],m=d.property.specification["property-type"]==="cross-faded-data-driven",_=d.value.isDataDriven(),b=d.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const T=this._transitionablePaint._values[e].value;return T.isDataDriven()||_||m||this._handleOverridablePaintPropertyUpdate(e,b,T)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,l){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),De(e,(r,l)=>!(r===void 0||l==="layout"&&!Object.keys(r).length||l==="paint"&&!Object.keys(r).length))}_validate(e,r,l,d,m={}){return(!m||m.validate!==!1)&&qa(this,e.call(jo,{key:r,layerType:this.type,objectKey:l,value:d,styleSpec:he,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof kr&&Fi(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const qu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class rs{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Xi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function rn(i,e=1){let r=0,l=0;return{members:i.map(d=>{const m=qu[d.type].BYTES_PER_ELEMENT,_=r=lc(r,Math.max(e,m)),b=d.components||1;return l=Math.max(l,m),r+=m*b,{name:d.name,type:d.type,components:b,offset:_}}),size:lc(r,Math.max(l,e)),alignment:e}}function lc(i,e){return Math.ceil(i/e)*e}class ws extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const l=this.length;return this.resize(l+1),this.emplace(l,e,r)}emplace(e,r,l){const d=2*e;return this.int16[d+0]=r,this.int16[d+1]=l,e}}ws.prototype.bytesPerElement=4,mt("StructArrayLayout2i4",ws);class h extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,l,d)}emplace(e,r,l,d,m){const _=4*e;return this.int16[_+0]=r,this.int16[_+1]=l,this.int16[_+2]=d,this.int16[_+3]=m,e}}h.prototype.bytesPerElement=8,mt("StructArrayLayout4i8",h);class t extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l,d,m,_){const b=this.length;return this.resize(b+1),this.emplace(b,e,r,l,d,m,_)}emplace(e,r,l,d,m,_,b){const T=6*e;return this.int16[T+0]=r,this.int16[T+1]=l,this.int16[T+2]=d,this.int16[T+3]=m,this.int16[T+4]=_,this.int16[T+5]=b,e}}t.prototype.bytesPerElement=12,mt("StructArrayLayout2i4i12",t);class s extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l,d,m,_){const b=this.length;return this.resize(b+1),this.emplace(b,e,r,l,d,m,_)}emplace(e,r,l,d,m,_,b){const T=4*e,I=8*e;return this.int16[T+0]=r,this.int16[T+1]=l,this.uint8[I+4]=d,this.uint8[I+5]=m,this.uint8[I+6]=_,this.uint8[I+7]=b,e}}s.prototype.bytesPerElement=8,mt("StructArrayLayout2i4ub8",s);class u extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const l=this.length;return this.resize(l+1),this.emplace(l,e,r)}emplace(e,r,l){const d=2*e;return this.float32[d+0]=r,this.float32[d+1]=l,e}}u.prototype.bytesPerElement=8,mt("StructArrayLayout2f8",u);class p extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,l,d,m,_,b,T,I,P){const D=this.length;return this.resize(D+1),this.emplace(D,e,r,l,d,m,_,b,T,I,P)}emplace(e,r,l,d,m,_,b,T,I,P,D){const O=10*e;return this.uint16[O+0]=r,this.uint16[O+1]=l,this.uint16[O+2]=d,this.uint16[O+3]=m,this.uint16[O+4]=_,this.uint16[O+5]=b,this.uint16[O+6]=T,this.uint16[O+7]=I,this.uint16[O+8]=P,this.uint16[O+9]=D,e}}p.prototype.bytesPerElement=20,mt("StructArrayLayout10ui20",p);class g extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,l,d,m,_,b,T,I,P,D,O){const N=this.length;return this.resize(N+1),this.emplace(N,e,r,l,d,m,_,b,T,I,P,D,O)}emplace(e,r,l,d,m,_,b,T,I,P,D,O,N){const V=12*e;return this.int16[V+0]=r,this.int16[V+1]=l,this.int16[V+2]=d,this.int16[V+3]=m,this.uint16[V+4]=_,this.uint16[V+5]=b,this.uint16[V+6]=T,this.uint16[V+7]=I,this.int16[V+8]=P,this.int16[V+9]=D,this.int16[V+10]=O,this.int16[V+11]=N,e}}g.prototype.bytesPerElement=24,mt("StructArrayLayout4i4ui4i24",g);class x extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,l)}emplace(e,r,l,d){const m=3*e;return this.float32[m+0]=r,this.float32[m+1]=l,this.float32[m+2]=d,e}}x.prototype.bytesPerElement=12,mt("StructArrayLayout3f12",x);class E extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}E.prototype.bytesPerElement=4,mt("StructArrayLayout1ul4",E);class S extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,l,d,m,_,b,T,I){const P=this.length;return this.resize(P+1),this.emplace(P,e,r,l,d,m,_,b,T,I)}emplace(e,r,l,d,m,_,b,T,I,P){const D=10*e,O=5*e;return this.int16[D+0]=r,this.int16[D+1]=l,this.int16[D+2]=d,this.int16[D+3]=m,this.int16[D+4]=_,this.int16[D+5]=b,this.uint32[O+3]=T,this.uint16[D+8]=I,this.uint16[D+9]=P,e}}S.prototype.bytesPerElement=20,mt("StructArrayLayout6i1ul2ui20",S);class A extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l,d,m,_){const b=this.length;return this.resize(b+1),this.emplace(b,e,r,l,d,m,_)}emplace(e,r,l,d,m,_,b){const T=6*e;return this.int16[T+0]=r,this.int16[T+1]=l,this.int16[T+2]=d,this.int16[T+3]=m,this.int16[T+4]=_,this.int16[T+5]=b,e}}A.prototype.bytesPerElement=12,mt("StructArrayLayout2i2i2i12",A);class z extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l,d,m){const _=this.length;return this.resize(_+1),this.emplace(_,e,r,l,d,m)}emplace(e,r,l,d,m,_){const b=4*e,T=8*e;return this.float32[b+0]=r,this.float32[b+1]=l,this.float32[b+2]=d,this.int16[T+6]=m,this.int16[T+7]=_,e}}z.prototype.bytesPerElement=16,mt("StructArrayLayout2f1f2i16",z);class L extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,l,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,l,d)}emplace(e,r,l,d,m){const _=12*e,b=3*e;return this.uint8[_+0]=r,this.uint8[_+1]=l,this.float32[b+1]=d,this.float32[b+2]=m,e}}L.prototype.bytesPerElement=12,mt("StructArrayLayout2ub2f12",L);class U extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,l)}emplace(e,r,l,d){const m=3*e;return this.uint16[m+0]=r,this.uint16[m+1]=l,this.uint16[m+2]=d,e}}U.prototype.bytesPerElement=6,mt("StructArrayLayout3ui6",U);class H extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,l,d,m,_,b,T,I,P,D,O,N,V,Y,J,ce){const me=this.length;return this.resize(me+1),this.emplace(me,e,r,l,d,m,_,b,T,I,P,D,O,N,V,Y,J,ce)}emplace(e,r,l,d,m,_,b,T,I,P,D,O,N,V,Y,J,ce,me){const ae=24*e,pe=12*e,Ae=48*e;return this.int16[ae+0]=r,this.int16[ae+1]=l,this.uint16[ae+2]=d,this.uint16[ae+3]=m,this.uint32[pe+2]=_,this.uint32[pe+3]=b,this.uint32[pe+4]=T,this.uint16[ae+10]=I,this.uint16[ae+11]=P,this.uint16[ae+12]=D,this.float32[pe+7]=O,this.float32[pe+8]=N,this.uint8[Ae+36]=V,this.uint8[Ae+37]=Y,this.uint8[Ae+38]=J,this.uint32[pe+10]=ce,this.int16[ae+22]=me,e}}H.prototype.bytesPerElement=48,mt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",H);class W extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,l,d,m,_,b,T,I,P,D,O,N,V,Y,J,ce,me,ae,pe,Ae,Se,pt,xt,rt,Qe,Ze,st){const et=this.length;return this.resize(et+1),this.emplace(et,e,r,l,d,m,_,b,T,I,P,D,O,N,V,Y,J,ce,me,ae,pe,Ae,Se,pt,xt,rt,Qe,Ze,st)}emplace(e,r,l,d,m,_,b,T,I,P,D,O,N,V,Y,J,ce,me,ae,pe,Ae,Se,pt,xt,rt,Qe,Ze,st,et){const Fe=34*e,kt=17*e;return this.int16[Fe+0]=r,this.int16[Fe+1]=l,this.int16[Fe+2]=d,this.int16[Fe+3]=m,this.int16[Fe+4]=_,this.int16[Fe+5]=b,this.int16[Fe+6]=T,this.int16[Fe+7]=I,this.uint16[Fe+8]=P,this.uint16[Fe+9]=D,this.uint16[Fe+10]=O,this.uint16[Fe+11]=N,this.uint16[Fe+12]=V,this.uint16[Fe+13]=Y,this.uint16[Fe+14]=J,this.uint16[Fe+15]=ce,this.uint16[Fe+16]=me,this.uint16[Fe+17]=ae,this.uint16[Fe+18]=pe,this.uint16[Fe+19]=Ae,this.uint16[Fe+20]=Se,this.uint16[Fe+21]=pt,this.uint16[Fe+22]=xt,this.uint32[kt+12]=rt,this.float32[kt+13]=Qe,this.float32[kt+14]=Ze,this.float32[kt+15]=st,this.float32[kt+16]=et,e}}W.prototype.bytesPerElement=68,mt("StructArrayLayout8i15ui1ul4f68",W);class Z extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}Z.prototype.bytesPerElement=4,mt("StructArrayLayout1f4",Z);class ne extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,l)}emplace(e,r,l,d){const m=3*e;return this.int16[m+0]=r,this.int16[m+1]=l,this.int16[m+2]=d,e}}ne.prototype.bytesPerElement=6,mt("StructArrayLayout3i6",ne);class oe extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,l)}emplace(e,r,l,d){const m=4*e;return this.uint32[2*e+0]=r,this.uint16[m+2]=l,this.uint16[m+3]=d,e}}oe.prototype.bytesPerElement=8,mt("StructArrayLayout1ul2ui8",oe);class ue extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const l=this.length;return this.resize(l+1),this.emplace(l,e,r)}emplace(e,r,l){const d=2*e;return this.uint16[d+0]=r,this.uint16[d+1]=l,e}}ue.prototype.bytesPerElement=4,mt("StructArrayLayout2ui4",ue);class K extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}K.prototype.bytesPerElement=2,mt("StructArrayLayout1ui2",K);class fe extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,l,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,l,d)}emplace(e,r,l,d,m){const _=4*e;return this.float32[_+0]=r,this.float32[_+1]=l,this.float32[_+2]=d,this.float32[_+3]=m,e}}fe.prototype.bytesPerElement=16,mt("StructArrayLayout4f16",fe);class de extends rs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new We(this.anchorPointX,this.anchorPointY)}}de.prototype.size=20;class xe extends S{get(e){return new de(this,e)}}mt("CollisionBoxArray",xe);class we extends rs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}we.prototype.size=48;class Le extends H{get(e){return new we(this,e)}}mt("PlacedSymbolArray",Le);class ye extends rs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}ye.prototype.size=68;class at extends W{get(e){return new ye(this,e)}}mt("SymbolInstanceArray",at);class Ye extends Z{getoffsetX(e){return this.float32[1*e+0]}}mt("GlyphOffsetArray",Ye);class dt extends ne{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}mt("SymbolLineVertexArray",dt);class Kt extends rs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Kt.prototype.size=8;class Qt extends oe{get(e){return new Kt(this,e)}}mt("FeatureIndexArray",Qt);class Ct extends ws{}class Ei extends ws{}class Si extends ws{}class ci extends t{}class fi extends s{}class Ai extends u{}class gn extends p{}class Mr extends g{}class vr extends x{}class zr extends E{}class ss extends A{}class ur extends L{}class Gn extends U{}class Ur extends ue{}const Za=rn([{name:"a_pos",components:2,type:"Int16"}],4),{members:un}=Za;class ni{constructor(e=[]){this.segments=e}prepareSegment(e,r,l,d){let m=this.segments[this.segments.length-1];return e>ni.MAX_VERTEX_ARRAY_LENGTH&&Ce(`Max vertices per segment is ${ni.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>ni.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==d)&&(m={vertexOffset:r.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},d!==void 0&&(m.sortKey=d),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,l,d){return new ni([{vertexOffset:e,primitiveOffset:r,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])}}function wi(i,e){return 256*(i=M(Math.floor(i),0,255))+M(Math.floor(e),0,255)}ni.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mt("SegmentVector",ni);const _n=rn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var yn={exports:{}},Wi={exports:{}};Wi.exports=function(i,e){var r,l,d,m,_,b,T,I;for(l=i.length-(r=3&i.length),d=e,_=3432918353,b=461845907,I=0;I<l;)T=255&i.charCodeAt(I)|(255&i.charCodeAt(++I))<<8|(255&i.charCodeAt(++I))<<16|(255&i.charCodeAt(++I))<<24,++I,d=27492+(65535&(m=5*(65535&(d=(d^=T=(65535&(T=(T=(65535&T)*_+(((T>>>16)*_&65535)<<16)&4294967295)<<15|T>>>17))*b+(((T>>>16)*b&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(T=0,r){case 3:T^=(255&i.charCodeAt(I+2))<<16;case 2:T^=(255&i.charCodeAt(I+1))<<8;case 1:d^=T=(65535&(T=(T=(65535&(T^=255&i.charCodeAt(I)))*_+(((T>>>16)*_&65535)<<16)&4294967295)<<15|T>>>17))*b+(((T>>>16)*b&65535)<<16)&4294967295}return d^=i.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0};var hr={exports:{}};hr.exports=function(i,e){for(var r,l=i.length,d=e^l,m=0;l>=4;)r=1540483477*(65535&(r=255&i.charCodeAt(m)|(255&i.charCodeAt(++m))<<8|(255&i.charCodeAt(++m))<<16|(255&i.charCodeAt(++m))<<24))+((1540483477*(r>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),l-=4,++m;switch(l){case 3:d^=(255&i.charCodeAt(m+2))<<16;case 2:d^=(255&i.charCodeAt(m+1))<<8;case 1:d=1540483477*(65535&(d^=255&i.charCodeAt(m)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var Ts=Wi.exports,cc=hr.exports;yn.exports=Ts,yn.exports.murmur3=Ts,yn.exports.murmur2=cc;class to{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,l,d){this.ids.push(Gu(e)),this.positions.push(r,l,d)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=Gu(e);let l=0,d=this.ids.length-1;for(;l<d;){const _=l+d>>1;this.ids[_]>=r?d=_:l=_+1}const m=[];for(;this.ids[l]===r;)m.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return m}static serialize(e,r){const l=new Float64Array(e.ids),d=new Uint32Array(e.positions);return uc(l,d,0,l.length-1),r&&r.push(l.buffer,d.buffer),{ids:l,positions:d}}static deserialize(e){const r=new to;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function Gu(i){const e=+i;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:yn.exports(String(i))}function uc(i,e,r,l){for(;r<l;){const d=i[r+l>>1];let m=r-1,_=l+1;for(;;){do m++;while(i[m]<d);do _--;while(i[_]>d);if(m>=_)break;os(i,m,_),os(e,3*m,3*_),os(e,3*m+1,3*_+1),os(e,3*m+2,3*_+2)}_-r<l-_?(uc(i,e,r,_),r=_+1):(uc(i,e,_+1,l),l=_)}}function os(i,e,r){const l=i[e];i[e]=i[r],i[r]=l}mt("FeaturePositionMap",to);class Es{constructor(e,r){this.gl=e.gl,this.location=r}}class Ss extends Es{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Ha extends Es{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class fm extends Es{constructor(e,r){super(e,r),this.current=q.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const n0=new Float32Array(16);function Ld(i){return[wi(255*i.r,255*i.g),wi(255*i.b,255*i.a)]}class hc{constructor(e,r,l){this.value=e,this.uniformNames=r.map(d=>`u_${d}`),this.type=l}setUniform(e,r,l){e.set(l.constantOr(this.value))}getBinding(e,r,l){return this.type==="color"?new fm(e,r):new Ss(e,r)}}class Xa{constructor(e,r){this.uniformNames=r.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,l,d){const m=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&e.set(m)}getBinding(e,r,l){return l.substr(0,9)==="u_pattern"?new Ha(e,r):new Ss(e,r)}}class Is{constructor(e,r,l,d){this.expression=e,this.type=l,this.maxValue=0,this.paintVertexAttributes=r.map(m=>({name:`a_${m}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(e,r,l,d,m){const _=this.paintVertexArray.length,b=this.expression.evaluate(new Gi(0),r,{},d,[],m);this.paintVertexArray.resize(e),this._setPaintValue(_,e,b)}updatePaintArray(e,r,l,d){const m=this.expression.evaluate({zoom:0},l,d);this._setPaintValue(e,r,m)}_setPaintValue(e,r,l){if(this.type==="color"){const d=Ld(l);for(let m=e;m<r;m++)this.paintVertexArray.emplace(m,d[0],d[1])}else{for(let d=e;d<r;d++)this.paintVertexArray.emplace(d,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Nr{constructor(e,r,l,d,m,_){this.expression=e,this.uniformNames=r.map(b=>`u_${b}_t`),this.type=l,this.useIntegerZoom=d,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map(b=>({name:`a_${b}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(e,r,l,d,m){const _=this.expression.evaluate(new Gi(this.zoom),r,{},d,[],m),b=this.expression.evaluate(new Gi(this.zoom+1),r,{},d,[],m),T=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(T,e,_,b)}updatePaintArray(e,r,l,d){const m=this.expression.evaluate({zoom:this.zoom},l,d),_=this.expression.evaluate({zoom:this.zoom+1},l,d);this._setPaintValue(e,r,m,_)}_setPaintValue(e,r,l,d){if(this.type==="color"){const m=Ld(l),_=Ld(d);for(let b=e;b<r;b++)this.paintVertexArray.emplace(b,m[0],m[1],_[0],_[1])}else{for(let m=e;m<r;m++)this.paintVertexArray.emplace(m,l,d);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(d))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){const l=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,d=M(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);e.set(d)}getBinding(e,r,l){return new Ss(e,r)}}class io{constructor(e,r,l,d,m,_){this.expression=e,this.type=r,this.useIntegerZoom=l,this.zoom=d,this.layerId=_,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,r,l){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(d,e,r.patterns&&r.patterns[this.layerId],l)}updatePaintArray(e,r,l,d,m){this._setPaintValues(e,r,l.patterns&&l.patterns[this.layerId],m)}_setPaintValues(e,r,l,d){if(!d||!l)return;const{min:m,mid:_,max:b}=l,T=d[m],I=d[_],P=d[b];if(T&&I&&P)for(let D=e;D<r;D++)this.zoomInPaintVertexArray.emplace(D,I.tl[0],I.tl[1],I.br[0],I.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],I.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(D,I.tl[0],I.tl[1],I.br[0],I.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],I.pixelRatio,P.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,_n.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,_n.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class mm{constructor(e,r,l){this.binders={},this._buffers=[];const d=[];for(const m in e.paint._values){if(!l(m))continue;const _=e.paint.get(m);if(!(_ instanceof kr&&Fi(_.property.specification)))continue;const b=r0(m,e.type),T=_.value,I=_.property.specification.type,P=_.property.useIntegerZoom,D=_.property.specification["property-type"],O=D==="cross-faded"||D==="cross-faded-data-driven";if(T.kind==="constant")this.binders[m]=O?new Xa(T.value,b):new hc(T.value,b,I),d.push(`/u_${m}`);else if(T.kind==="source"||O){const N=gm(m,I,"source");this.binders[m]=O?new io(T,I,P,r,N,e.id):new Is(T,b,I,N),d.push(`/a_${m}`)}else{const N=gm(m,I,"composite");this.binders[m]=new Nr(T,b,I,P,r,N),d.push(`/z_${m}`)}}this.cacheKey=d.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof Is||r instanceof Nr?r.maxValue:0}populatePaintArrays(e,r,l,d,m){for(const _ in this.binders){const b=this.binders[_];(b instanceof Is||b instanceof Nr||b instanceof io)&&b.populatePaintArray(e,r,l,d,m)}}setConstantPatternPositions(e,r){for(const l in this.binders){const d=this.binders[l];d instanceof Xa&&d.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,l,d,m){let _=!1;for(const b in e){const T=r.getPositions(b);for(const I of T){const P=l.feature(I.index);for(const D in this.binders){const O=this.binders[D];if((O instanceof Is||O instanceof Nr||O instanceof io)&&O.expression.isStateDependent===!0){const N=d.paint.get(D);O.expression=N.value,O.updatePaintArray(I.start,I.end,P,e[b],m),_=!0}}}}return _}defines(){const e=[];for(const r in this.binders){const l=this.binders[r];(l instanceof hc||l instanceof Xa)&&e.push(...l.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof Is||l instanceof Nr)for(let d=0;d<l.paintVertexAttributes.length;d++)e.push(l.paintVertexAttributes[d].name);else if(l instanceof io)for(let d=0;d<_n.members.length;d++)e.push(_n.members[d].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof hc||l instanceof Xa||l instanceof Nr)for(const d of l.uniformNames)e.push(d)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){const l=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof hc||m instanceof Xa||m instanceof Nr){for(const _ of m.uniformNames)if(r[_]){const b=m.getBinding(e,r[_],_);l.push({name:_,property:d,binding:b})}}}return l}setUniforms(e,r,l,d){for(const{name:m,property:_,binding:b}of r)this.binders[_].setUniform(b,d,l.get(_),m)}updatePaintBuffers(e){this._buffers=[];for(const r in this.binders){const l=this.binders[r];if(e&&l instanceof io){const d=e.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(l instanceof Is||l instanceof Nr)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(e){for(const r in this.binders){const l=this.binders[r];(l instanceof Is||l instanceof Nr||l instanceof io)&&l.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof Is||r instanceof Nr||r instanceof io)&&r.destroy()}}}class Ho{constructor(e,r,l=()=>!0){this.programConfigurations={};for(const d of e)this.programConfigurations[d.id]=new mm(d,r,l);this.needsUpload=!1,this._featureMap=new to,this._bufferOffset=0}populatePaintArrays(e,r,l,d,m,_){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(e,r,d,m,_);r.id!==void 0&&this._featureMap.add(r.id,l,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,l,d){for(const m of l)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,r,m,d)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function r0(i,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}function gm(i,e,r){const l={color:{source:u,composite:fe},number:{source:Z,composite:u}},d=function(m){return{"line-pattern":{source:gn,composite:gn},"fill-pattern":{source:gn,composite:gn},"fill-extrusion-pattern":{source:gn,composite:gn}}[m]}(i);return d&&d[r]||l[e][r]}mt("ConstantBinder",hc),mt("CrossFadedConstantBinder",Xa),mt("SourceExpressionBinder",Is),mt("CrossFadedCompositeBinder",io),mt("CompositeExpressionBinder",Nr),mt("ProgramConfiguration",mm,{omit:["_buffers"]}),mt("ProgramConfigurationSet",Ho);var hn=8192;const Od=Math.pow(2,14)-1,_m=-Od-1;function Xo(i){const e=hn/i.extent,r=i.loadGeometry();for(let l=0;l<r.length;l++){const d=r[l];for(let m=0;m<d.length;m++){const _=d[m],b=Math.round(_.x*e),T=Math.round(_.y*e);_.x=M(b,_m,Od),_.y=M(T,_m,Od),(b<_.x||b>_.x+1||T<_.y||T>_.y+1)&&Ce("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function Ko(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?Xo(i):[]}}function Wu(i,e,r,l,d){i.emplaceBack(2*e+(l+1)/2,2*r+(d+1)/2)}class Bd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ei,this.indexArray=new Gn,this.segments=new ni,this.programConfigurations=new Ho(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,l){const d=this.layers[0],m=[];let _=null,b=!1;d.type==="circle"&&(_=d.layout.get("circle-sort-key"),b=!_.isConstant());for(const{feature:T,id:I,index:P,sourceLayerIndex:D}of e){const O=this.layers[0]._featureFilter.needGeometry,N=Ko(T,O);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),N,l))continue;const V=b?_.evaluate(N,{},l):void 0,Y={id:I,properties:T.properties,type:T.type,sourceLayerIndex:D,index:P,geometry:O?N.geometry:Xo(T),patterns:{},sortKey:V};m.push(Y)}b&&m.sort((T,I)=>T.sortKey-I.sortKey);for(const T of m){const{geometry:I,index:P,sourceLayerIndex:D}=T,O=e[P].feature;this.addFeature(T,I,P,l),r.featureIndex.insert(O,I,P,D,this.index)}}update(e,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,un),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,l,d){for(const m of r)for(const _ of m){const b=_.x,T=_.y;if(b<0||b>=hn||T<0||T>=hn)continue;const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),P=I.vertexLength;Wu(this.layoutVertexArray,b,T,-1,-1),Wu(this.layoutVertexArray,b,T,1,-1),Wu(this.layoutVertexArray,b,T,1,1),Wu(this.layoutVertexArray,b,T,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+3,P+2),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,{},d)}}function ym(i,e){for(let r=0;r<i.length;r++)if(Ka(e,i[r]))return!0;for(let r=0;r<e.length;r++)if(Ka(i,e[r]))return!0;return!!Fd(i,e)}function s0(i,e,r){return!!Ka(i,e)||!!$d(e,i,r)}function vm(i,e){if(i.length===1)return bm(e,i[0]);for(let r=0;r<e.length;r++){const l=e[r];for(let d=0;d<l.length;d++)if(Ka(i,l[d]))return!0}for(let r=0;r<i.length;r++)if(bm(e,i[r]))return!0;for(let r=0;r<e.length;r++)if(Fd(i,e[r]))return!0;return!1}function o0(i,e,r){if(i.length>1){if(Fd(i,e))return!0;for(let l=0;l<e.length;l++)if($d(e[l],i,r))return!0}for(let l=0;l<i.length;l++)if($d(i[l],e,r))return!0;return!1}function Fd(i,e){if(i.length===0||e.length===0)return!1;for(let r=0;r<i.length-1;r++){const l=i[r],d=i[r+1];for(let m=0;m<e.length-1;m++)if(a0(l,d,e[m],e[m+1]))return!0}return!1}function a0(i,e,r,l){return Zt(i,r,l)!==Zt(e,r,l)&&Zt(i,e,r)!==Zt(i,e,l)}function $d(i,e,r){const l=r*r;if(e.length===1)return i.distSqr(e[0])<l;for(let d=1;d<e.length;d++)if(xm(i,e[d-1],e[d])<l)return!0;return!1}function xm(i,e,r){const l=e.distSqr(r);if(l===0)return i.distSqr(e);const d=((i.x-e.x)*(r.x-e.x)+(i.y-e.y)*(r.y-e.y))/l;return i.distSqr(d<0?e:d>1?r:r.sub(e)._mult(d)._add(e))}function bm(i,e){let r,l,d,m=!1;for(let _=0;_<i.length;_++){r=i[_];for(let b=0,T=r.length-1;b<r.length;T=b++)l=r[b],d=r[T],l.y>e.y!=d.y>e.y&&e.x<(d.x-l.x)*(e.y-l.y)/(d.y-l.y)+l.x&&(m=!m)}return m}function Ka(i,e){let r=!1;for(let l=0,d=i.length-1;l<i.length;d=l++){const m=i[l],_=i[d];m.y>e.y!=_.y>e.y&&e.x<(_.x-m.x)*(e.y-m.y)/(_.y-m.y)+m.x&&(r=!r)}return r}function l0(i,e,r){const l=r[0],d=r[2];if(i.x<l.x&&e.x<l.x||i.x>d.x&&e.x>d.x||i.y<l.y&&e.y<l.y||i.y>d.y&&e.y>d.y)return!1;const m=Zt(i,e,r[0]);return m!==Zt(i,e,r[1])||m!==Zt(i,e,r[2])||m!==Zt(i,e,r[3])}function dc(i,e,r){const l=e.paint.get(i).value;return l.kind==="constant"?l.value:r.programConfigurations.get(e.id).getMaxValue(i)}function Zu(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Hu(i,e,r,l,d){if(!e[0]&&!e[1])return i;const m=We.convert(e)._mult(d);r==="viewport"&&m._rotate(-l);const _=[];for(let b=0;b<i.length;b++)_.push(i[b].sub(m));return _}mt("CircleBucket",Bd,{omit:["layers"]});const c0=new Tn({"circle-sort-key":new Mt(he.layout_circle["circle-sort-key"])});var u0={paint:new Tn({"circle-radius":new Mt(he.paint_circle["circle-radius"]),"circle-color":new Mt(he.paint_circle["circle-color"]),"circle-blur":new Mt(he.paint_circle["circle-blur"]),"circle-opacity":new Mt(he.paint_circle["circle-opacity"]),"circle-translate":new Tt(he.paint_circle["circle-translate"]),"circle-translate-anchor":new Tt(he.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Tt(he.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Tt(he.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Mt(he.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Mt(he.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Mt(he.paint_circle["circle-stroke-opacity"])}),layout:c0},Wn=1e-6,Zn=typeof Float32Array<"u"?Float32Array:Array;function wm(){var i=new Zn(9);return Zn!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function Ud(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Tm(i,e,r){var l=e[0],d=e[1],m=e[2],_=e[3],b=e[4],T=e[5],I=e[6],P=e[7],D=e[8],O=e[9],N=e[10],V=e[11],Y=e[12],J=e[13],ce=e[14],me=e[15],ae=r[0],pe=r[1],Ae=r[2],Se=r[3];return i[0]=ae*l+pe*b+Ae*D+Se*Y,i[1]=ae*d+pe*T+Ae*O+Se*J,i[2]=ae*m+pe*I+Ae*N+Se*ce,i[3]=ae*_+pe*P+Ae*V+Se*me,i[4]=(ae=r[4])*l+(pe=r[5])*b+(Ae=r[6])*D+(Se=r[7])*Y,i[5]=ae*d+pe*T+Ae*O+Se*J,i[6]=ae*m+pe*I+Ae*N+Se*ce,i[7]=ae*_+pe*P+Ae*V+Se*me,i[8]=(ae=r[8])*l+(pe=r[9])*b+(Ae=r[10])*D+(Se=r[11])*Y,i[9]=ae*d+pe*T+Ae*O+Se*J,i[10]=ae*m+pe*I+Ae*N+Se*ce,i[11]=ae*_+pe*P+Ae*V+Se*me,i[12]=(ae=r[12])*l+(pe=r[13])*b+(Ae=r[14])*D+(Se=r[15])*Y,i[13]=ae*d+pe*T+Ae*O+Se*J,i[14]=ae*m+pe*I+Ae*N+Se*ce,i[15]=ae*_+pe*P+Ae*V+Se*me,i}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var pc,h0=Tm;function Em(){var i=new Zn(3);return Zn!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function Sm(i,e,r){var l=new Zn(3);return l[0]=i,l[1]=e,l[2]=r,l}function Xu(i,e,r){var l=e[0],d=e[1],m=e[2],_=e[3];return i[0]=r[0]*l+r[4]*d+r[8]*m+r[12]*_,i[1]=r[1]*l+r[5]*d+r[9]*m+r[13]*_,i[2]=r[2]*l+r[6]*d+r[10]*m+r[14]*_,i[3]=r[3]*l+r[7]*d+r[11]*m+r[15]*_,i}function Im(){var i=new Zn(4);return Zn!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function Am(i,e){const r=Xu([],[i.x,i.y,0,1],e);return new We(r[0]/r[3],r[1]/r[3])}Em(),pc=new Zn(4),Zn!=Float32Array&&(pc[0]=0,pc[1]=0,pc[2]=0,pc[3]=0),Em(),Sm(1,0,0),Sm(0,1,0),Im(),Im(),wm(),function(){var i;i=new Zn(2),Zn!=Float32Array&&(i[0]=0,i[1]=0)}();class Cm extends Bd{}mt("HeatmapBucket",Cm,{omit:["layers"]});var d0={paint:new Tn({"heatmap-radius":new Mt(he.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Mt(he.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Tt(he.paint_heatmap["heatmap-intensity"]),"heatmap-color":new is(he.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Tt(he.paint_heatmap["heatmap-opacity"])})};function Nd(i,{width:e,height:r},l,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==e*r*l)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${e*r*l}`)}else d=new Uint8Array(e*r*l);return i.width=e,i.height=r,i.data=d,i}function km(i,{width:e,height:r},l){if(e===i.width&&r===i.height)return;const d=Nd({},{width:e,height:r},l);Vd(i,d,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,e),height:Math.min(i.height,r)},l),i.width=e,i.height=r,i.data=d.data}function Vd(i,e,r,l,d,m){if(d.width===0||d.height===0)return e;if(d.width>i.width||d.height>i.height||r.x>i.width-d.width||r.y>i.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>e.width||d.height>e.height||l.x>e.width-d.width||l.y>e.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const _=i.data,b=e.data;if(_===b)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<d.height;T++){const I=((r.y+T)*i.width+r.x)*m,P=((l.y+T)*e.width+l.x)*m;for(let D=0;D<d.width*m;D++)b[P+D]=_[I+D]}return e}class fc{constructor(e,r){Nd(this,e,1,r)}resize(e){km(this,e,1)}clone(){return new fc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,l,d,m){Vd(e,r,l,d,m,1)}}class xr{constructor(e,r){Nd(this,e,4,r)}resize(e){km(this,e,4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new xr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,l,d,m){Vd(e,r,l,d,m,4)}}function Pm(i){const e={},r=i.resolution||256,l=i.clips?i.clips.length:1,d=i.image||new xr({width:r,height:l});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const m=(_,b,T)=>{e[i.evaluationKey]=T;const I=i.expression.evaluate(e);d.data[_+b+0]=Math.floor(255*I.r/I.a),d.data[_+b+1]=Math.floor(255*I.g/I.a),d.data[_+b+2]=Math.floor(255*I.b/I.a),d.data[_+b+3]=Math.floor(255*I.a)};if(i.clips)for(let _=0,b=0;_<l;++_,b+=4*r)for(let T=0,I=0;T<r;T++,I+=4){const P=T/(r-1),{start:D,end:O}=i.clips[_];m(b,I,D*(1-P)+O*P)}else for(let _=0,b=0;_<r;_++,b+=4)m(0,b,_/(r-1));return d}mt("AlphaImage",fc),mt("RGBAImage",xr);var p0={paint:new Tn({"hillshade-illumination-direction":new Tt(he.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Tt(he.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Tt(he.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Tt(he.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Tt(he.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Tt(he.paint_hillshade["hillshade-accent-color"])})};const f0=rn([{name:"a_pos",components:2,type:"Int16"}],4),{members:m0}=f0;var Ku={exports:{}};function Ju(i,e,r){r=r||2;var l,d,m,_,b,T,I,P=e&&e.length,D=P?e[0]*r:i.length,O=Mm(i,0,D,r,!0),N=[];if(!O||O.next===O.prev)return N;if(P&&(O=function(Y,J,ce,me){var ae,pe,Ae,Se=[];for(ae=0,pe=J.length;ae<pe;ae++)(Ae=Mm(Y,J[ae]*me,ae<pe-1?J[ae+1]*me:Y.length,me,!1))===Ae.next&&(Ae.steiner=!0),Se.push(T0(Ae));for(Se.sort(x0),ae=0;ae<Se.length;ae++)ce=b0(Se[ae],ce);return ce}(i,e,O,r)),i.length>80*r){l=m=i[0],d=_=i[1];for(var V=r;V<D;V+=r)(b=i[V])<l&&(l=b),(T=i[V+1])<d&&(d=T),b>m&&(m=b),T>_&&(_=T);I=(I=Math.max(m-l,_-d))!==0?32767/I:0}return mc(O,N,r,l,d,I,0),N}function Mm(i,e,r,l,d){var m,_;if(d===Gd(i,e,r,l)>0)for(m=e;m<r;m+=l)_=Rm(m,i[m],i[m+1],_);else for(m=r-l;m>=e;m-=l)_=Rm(m,i[m],i[m+1],_);return _&&Yu(_,_.next)&&(_c(_),_=_.next),_}function Jo(i,e){if(!i)return i;e||(e=i);var r,l=i;do if(r=!1,l.steiner||!Yu(l,l.next)&&Yi(l.prev,l,l.next)!==0)l=l.next;else{if(_c(l),(l=e=l.prev)===l.next)break;r=!0}while(r||l!==e);return e}function mc(i,e,r,l,d,m,_){if(i){!_&&m&&function(P,D,O,N){var V=P;do V.z===0&&(V.z=jd(V.x,V.y,D,O,N)),V.prevZ=V.prev,V.nextZ=V.next,V=V.next;while(V!==P);V.prevZ.nextZ=null,V.prevZ=null,function(Y){var J,ce,me,ae,pe,Ae,Se,pt,xt=1;do{for(ce=Y,Y=null,pe=null,Ae=0;ce;){for(Ae++,me=ce,Se=0,J=0;J<xt&&(Se++,me=me.nextZ);J++);for(pt=xt;Se>0||pt>0&&me;)Se!==0&&(pt===0||!me||ce.z<=me.z)?(ae=ce,ce=ce.nextZ,Se--):(ae=me,me=me.nextZ,pt--),pe?pe.nextZ=ae:Y=ae,ae.prevZ=pe,pe=ae;ce=me}pe.nextZ=null,xt*=2}while(Ae>1)}(V)}(i,l,d,m);for(var b,T,I=i;i.prev!==i.next;)if(b=i.prev,T=i.next,m?_0(i,l,d,m):g0(i))e.push(b.i/r|0),e.push(i.i/r|0),e.push(T.i/r|0),_c(i),i=T.next,I=T.next;else if((i=T)===I){_?_===1?mc(i=y0(Jo(i),e,r),e,r,l,d,m,2):_===2&&v0(i,e,r,l,d,m):mc(Jo(i),e,r,l,d,m,1);break}}}function g0(i){var e=i.prev,r=i,l=i.next;if(Yi(e,r,l)>=0)return!1;for(var d=e.x,m=r.x,_=l.x,b=e.y,T=r.y,I=l.y,P=d<m?d<_?d:_:m<_?m:_,D=b<T?b<I?b:I:T<I?T:I,O=d>m?d>_?d:_:m>_?m:_,N=b>T?b>I?b:I:T>I?T:I,V=l.next;V!==e;){if(V.x>=P&&V.x<=O&&V.y>=D&&V.y<=N&&Ja(d,b,m,T,_,I,V.x,V.y)&&Yi(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function _0(i,e,r,l){var d=i.prev,m=i,_=i.next;if(Yi(d,m,_)>=0)return!1;for(var b=d.x,T=m.x,I=_.x,P=d.y,D=m.y,O=_.y,N=b<T?b<I?b:I:T<I?T:I,V=P<D?P<O?P:O:D<O?D:O,Y=b>T?b>I?b:I:T>I?T:I,J=P>D?P>O?P:O:D>O?D:O,ce=jd(N,V,e,r,l),me=jd(Y,J,e,r,l),ae=i.prevZ,pe=i.nextZ;ae&&ae.z>=ce&&pe&&pe.z<=me;){if(ae.x>=N&&ae.x<=Y&&ae.y>=V&&ae.y<=J&&ae!==d&&ae!==_&&Ja(b,P,T,D,I,O,ae.x,ae.y)&&Yi(ae.prev,ae,ae.next)>=0||(ae=ae.prevZ,pe.x>=N&&pe.x<=Y&&pe.y>=V&&pe.y<=J&&pe!==d&&pe!==_&&Ja(b,P,T,D,I,O,pe.x,pe.y)&&Yi(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;ae&&ae.z>=ce;){if(ae.x>=N&&ae.x<=Y&&ae.y>=V&&ae.y<=J&&ae!==d&&ae!==_&&Ja(b,P,T,D,I,O,ae.x,ae.y)&&Yi(ae.prev,ae,ae.next)>=0)return!1;ae=ae.prevZ}for(;pe&&pe.z<=me;){if(pe.x>=N&&pe.x<=Y&&pe.y>=V&&pe.y<=J&&pe!==d&&pe!==_&&Ja(b,P,T,D,I,O,pe.x,pe.y)&&Yi(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function y0(i,e,r){var l=i;do{var d=l.prev,m=l.next.next;!Yu(d,m)&&zm(d,l,l.next,m)&&gc(d,m)&&gc(m,d)&&(e.push(d.i/r|0),e.push(l.i/r|0),e.push(m.i/r|0),_c(l),_c(l.next),l=i=m),l=l.next}while(l!==i);return Jo(l)}function v0(i,e,r,l,d,m){var _=i;do{for(var b=_.next.next;b!==_.prev;){if(_.i!==b.i&&E0(_,b)){var T=Dm(_,b);return _=Jo(_,_.next),T=Jo(T,T.next),mc(_,e,r,l,d,m,0),void mc(T,e,r,l,d,m,0)}b=b.next}_=_.next}while(_!==i)}function x0(i,e){return i.x-e.x}function b0(i,e){var r=function(d,m){var _,b=m,T=d.x,I=d.y,P=-1/0;do{if(I<=b.y&&I>=b.next.y&&b.next.y!==b.y){var D=b.x+(I-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(D<=T&&D>P&&(P=D,_=b.x<b.next.x?b:b.next,D===T))return _}b=b.next}while(b!==m);if(!_)return null;var O,N=_,V=_.x,Y=_.y,J=1/0;b=_;do T>=b.x&&b.x>=V&&T!==b.x&&Ja(I<Y?T:P,I,V,Y,I<Y?P:T,I,b.x,b.y)&&(O=Math.abs(I-b.y)/(T-b.x),gc(b,d)&&(O<J||O===J&&(b.x>_.x||b.x===_.x&&w0(_,b)))&&(_=b,J=O)),b=b.next;while(b!==N);return _}(i,e);if(!r)return e;var l=Dm(r,i);return Jo(l,l.next),Jo(r,r.next)}function w0(i,e){return Yi(i.prev,i,e.prev)<0&&Yi(e.next,i,i.next)<0}function jd(i,e,r,l,d){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-r)*d|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-l)*d|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function T0(i){var e=i,r=i;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==i);return r}function Ja(i,e,r,l,d,m,_,b){return(d-_)*(e-b)>=(i-_)*(m-b)&&(i-_)*(l-b)>=(r-_)*(e-b)&&(r-_)*(m-b)>=(d-_)*(l-b)}function E0(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(r,l){var d=r;do{if(d.i!==r.i&&d.next.i!==r.i&&d.i!==l.i&&d.next.i!==l.i&&zm(d,d.next,r,l))return!0;d=d.next}while(d!==r);return!1}(i,e)&&(gc(i,e)&&gc(e,i)&&function(r,l){var d=r,m=!1,_=(r.x+l.x)/2,b=(r.y+l.y)/2;do d.y>b!=d.next.y>b&&d.next.y!==d.y&&_<(d.next.x-d.x)*(b-d.y)/(d.next.y-d.y)+d.x&&(m=!m),d=d.next;while(d!==r);return m}(i,e)&&(Yi(i.prev,i,e.prev)||Yi(i,e.prev,e))||Yu(i,e)&&Yi(i.prev,i,i.next)>0&&Yi(e.prev,e,e.next)>0)}function Yi(i,e,r){return(e.y-i.y)*(r.x-e.x)-(e.x-i.x)*(r.y-e.y)}function Yu(i,e){return i.x===e.x&&i.y===e.y}function zm(i,e,r,l){var d=eh(Yi(i,e,r)),m=eh(Yi(i,e,l)),_=eh(Yi(r,l,i)),b=eh(Yi(r,l,e));return d!==m&&_!==b||!(d!==0||!Qu(i,r,e))||!(m!==0||!Qu(i,l,e))||!(_!==0||!Qu(r,i,l))||!(b!==0||!Qu(r,e,l))}function Qu(i,e,r){return e.x<=Math.max(i.x,r.x)&&e.x>=Math.min(i.x,r.x)&&e.y<=Math.max(i.y,r.y)&&e.y>=Math.min(i.y,r.y)}function eh(i){return i>0?1:i<0?-1:0}function gc(i,e){return Yi(i.prev,i,i.next)<0?Yi(i,e,i.next)>=0&&Yi(i,i.prev,e)>=0:Yi(i,e,i.prev)<0||Yi(i,i.next,e)<0}function Dm(i,e){var r=new qd(i.i,i.x,i.y),l=new qd(e.i,e.x,e.y),d=i.next,m=e.prev;return i.next=e,e.prev=i,r.next=d,d.prev=r,l.next=r,r.prev=l,m.next=l,l.prev=m,l}function Rm(i,e,r,l){var d=new qd(i,e,r);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function _c(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function qd(i,e,r){this.i=i,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gd(i,e,r,l){for(var d=0,m=e,_=r-l;m<r;m+=l)d+=(i[_]-i[m])*(i[m+1]+i[_+1]),_=m;return d}function S0(i,e,r,l,d){Lm(i,e,r||0,l||i.length-1,d||I0)}function Lm(i,e,r,l,d){for(;l>r;){if(l-r>600){var m=l-r+1,_=e-r+1,b=Math.log(m),T=.5*Math.exp(2*b/3),I=.5*Math.sqrt(b*T*(m-T)/m)*(_-m/2<0?-1:1);Lm(i,e,Math.max(r,Math.floor(e-_*T/m+I)),Math.min(l,Math.floor(e+(m-_)*T/m+I)),d)}var P=i[e],D=r,O=l;for(yc(i,r,e),d(i[l],P)>0&&yc(i,r,l);D<O;){for(yc(i,D,O),D++,O--;d(i[D],P)<0;)D++;for(;d(i[O],P)>0;)O--}d(i[r],P)===0?yc(i,r,O):yc(i,++O,l),O<=e&&(r=O+1),e<=O&&(l=O-1)}}function yc(i,e,r){var l=i[e];i[e]=i[r],i[r]=l}function I0(i,e){return i<e?-1:i>e?1:0}function Wd(i,e){const r=i.length;if(r<=1)return[i];const l=[];let d,m;for(let _=0;_<r;_++){const b=Xe(i[_]);b!==0&&(i[_].area=Math.abs(b),m===void 0&&(m=b<0),m===b<0?(d&&l.push(d),d=[i[_]]):d.push(i[_]))}if(d&&l.push(d),e>1)for(let _=0;_<l.length;_++)l[_].length<=e||(S0(l[_],e,1,l[_].length-1,A0),l[_]=l[_].slice(0,e));return l}function A0(i,e){return e.area-i.area}function Zd(i,e,r){const l=r.patternDependencies;let d=!1;for(const m of e){const _=m.paint.get(`${i}-pattern`);_.isConstant()||(d=!0);const b=_.constantOr(null);b&&(d=!0,l[b.to]=!0,l[b.from]=!0)}return d}function Hd(i,e,r,l,d){const m=d.patternDependencies;for(const _ of e){const b=_.paint.get(`${i}-pattern`).value;if(b.kind!=="constant"){let T=b.evaluate({zoom:l-1},r,{},d.availableImages),I=b.evaluate({zoom:l},r,{},d.availableImages),P=b.evaluate({zoom:l+1},r,{},d.availableImages);T=T&&T.name?T.name:T,I=I&&I.name?I.name:I,P=P&&P.name?P.name:P,m[T]=!0,m[I]=!0,m[P]=!0,r.patterns[_.id]={min:T,mid:I,max:P}}}return r}Ku.exports=Ju,Ku.exports.default=Ju,Ju.deviation=function(i,e,r,l){var d=e&&e.length,m=Math.abs(Gd(i,0,d?e[0]*r:i.length,r));if(d)for(var _=0,b=e.length;_<b;_++)m-=Math.abs(Gd(i,e[_]*r,_<b-1?e[_+1]*r:i.length,r));var T=0;for(_=0;_<l.length;_+=3){var I=l[_]*r,P=l[_+1]*r,D=l[_+2]*r;T+=Math.abs((i[I]-i[D])*(i[P+1]-i[I+1])-(i[I]-i[P])*(i[D+1]-i[I+1]))}return m===0&&T===0?0:Math.abs((T-m)/m)},Ju.flatten=function(i){for(var e=i[0][0].length,r={vertices:[],holes:[],dimensions:e},l=0,d=0;d<i.length;d++){for(var m=0;m<i[d].length;m++)for(var _=0;_<e;_++)r.vertices.push(i[d][m][_]);d>0&&r.holes.push(l+=i[d-1].length)}return r};class Xd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Si,this.indexArray=new Gn,this.indexArray2=new Ur,this.programConfigurations=new Ho(e.layers,e.zoom),this.segments=new ni,this.segments2=new ni,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,l){this.hasPattern=Zd("fill",this.layers,r);const d=this.layers[0].layout.get("fill-sort-key"),m=!d.isConstant(),_=[];for(const{feature:b,id:T,index:I,sourceLayerIndex:P}of e){const D=this.layers[0]._featureFilter.needGeometry,O=Ko(b,D);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),O,l))continue;const N=m?d.evaluate(O,{},l,r.availableImages):void 0,V={id:T,properties:b.properties,type:b.type,sourceLayerIndex:P,index:I,geometry:D?O.geometry:Xo(b),patterns:{},sortKey:N};_.push(V)}m&&_.sort((b,T)=>b.sortKey-T.sortKey);for(const b of _){const{geometry:T,index:I,sourceLayerIndex:P}=b;if(this.hasPattern){const D=Hd("fill",this.layers,b,this.zoom,r);this.patternFeatures.push(D)}else this.addFeature(b,T,I,l,{});r.featureIndex.insert(e[I].feature,T,I,P,this.index)}}update(e,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,l)}addFeatures(e,r,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,r,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,m0),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,l,d,m){for(const _ of Wd(r,500)){let b=0;for(const N of _)b+=N.length;const T=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),I=T.vertexLength,P=[],D=[];for(const N of _){if(N.length===0)continue;N!==_[0]&&D.push(P.length/2);const V=this.segments2.prepareSegment(N.length,this.layoutVertexArray,this.indexArray2),Y=V.vertexLength;this.layoutVertexArray.emplaceBack(N[0].x,N[0].y),this.indexArray2.emplaceBack(Y+N.length-1,Y),P.push(N[0].x),P.push(N[0].y);for(let J=1;J<N.length;J++)this.layoutVertexArray.emplaceBack(N[J].x,N[J].y),this.indexArray2.emplaceBack(Y+J-1,Y+J),P.push(N[J].x),P.push(N[J].y);V.vertexLength+=N.length,V.primitiveLength+=N.length}const O=Ku.exports(P,D);for(let N=0;N<O.length;N+=3)this.indexArray.emplaceBack(I+O[N],I+O[N+1],I+O[N+2]);T.vertexLength+=b,T.primitiveLength+=O.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,m,d)}}mt("FillBucket",Xd,{omit:["layers","patternFeatures"]});const C0=new Tn({"fill-sort-key":new Mt(he.layout_fill["fill-sort-key"])});var k0={paint:new Tn({"fill-antialias":new Tt(he.paint_fill["fill-antialias"]),"fill-opacity":new Mt(he.paint_fill["fill-opacity"]),"fill-color":new Mt(he.paint_fill["fill-color"]),"fill-outline-color":new Mt(he.paint_fill["fill-outline-color"]),"fill-translate":new Tt(he.paint_fill["fill-translate"]),"fill-translate-anchor":new Tt(he.paint_fill["fill-translate-anchor"]),"fill-pattern":new eo(he.paint_fill["fill-pattern"])}),layout:C0};const P0=rn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),M0=rn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:z0}=P0;var no={},D0=We,Om=Ya;function Ya(i,e,r,l,d){this.properties={},this.extent=r,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=d,i.readFields(R0,this,e)}function R0(i,e,r){i==1?e.id=r.readVarint():i==2?function(l,d){for(var m=l.readVarint()+l.pos;l.pos<m;){var _=d._keys[l.readVarint()],b=d._values[l.readVarint()];d.properties[_]=b}}(r,e):i==3?e.type=r.readVarint():i==4&&(e._geometry=r.pos)}function L0(i){for(var e,r,l=0,d=0,m=i.length,_=m-1;d<m;_=d++)l+=((r=i[_]).x-(e=i[d]).x)*(e.y+r.y);return l}Ya.types=["Unknown","Point","LineString","Polygon"],Ya.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,r=i.readVarint()+i.pos,l=1,d=0,m=0,_=0,b=[];i.pos<r;){if(d<=0){var T=i.readVarint();l=7&T,d=T>>3}if(d--,l===1||l===2)m+=i.readSVarint(),_+=i.readSVarint(),l===1&&(e&&b.push(e),e=[]),e.push(new D0(m,_));else{if(l!==7)throw new Error("unknown command "+l);e&&e.push(e[0].clone())}}return e&&b.push(e),b},Ya.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,r=1,l=0,d=0,m=0,_=1/0,b=-1/0,T=1/0,I=-1/0;i.pos<e;){if(l<=0){var P=i.readVarint();r=7&P,l=P>>3}if(l--,r===1||r===2)(d+=i.readSVarint())<_&&(_=d),d>b&&(b=d),(m+=i.readSVarint())<T&&(T=m),m>I&&(I=m);else if(r!==7)throw new Error("unknown command "+r)}return[_,T,b,I]},Ya.prototype.toGeoJSON=function(i,e,r){var l,d,m=this.extent*Math.pow(2,r),_=this.extent*i,b=this.extent*e,T=this.loadGeometry(),I=Ya.types[this.type];function P(N){for(var V=0;V<N.length;V++){var Y=N[V];N[V]=[360*(Y.x+_)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(Y.y+b)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(l=0;l<T.length;l++)D[l]=T[l][0];P(T=D);break;case 2:for(l=0;l<T.length;l++)P(T[l]);break;case 3:for(T=function(N){var V=N.length;if(V<=1)return[N];for(var Y,J,ce=[],me=0;me<V;me++){var ae=L0(N[me]);ae!==0&&(J===void 0&&(J=ae<0),J===ae<0?(Y&&ce.push(Y),Y=[N[me]]):Y.push(N[me]))}return Y&&ce.push(Y),ce}(T),l=0;l<T.length;l++)for(d=0;d<T[l].length;d++)P(T[l][d])}T.length===1?T=T[0]:I="Multi"+I;var O={type:"Feature",geometry:{type:I,coordinates:T},properties:this.properties};return"id"in this&&(O.id=this.id),O};var O0=Om,Bm=Fm;function Fm(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(B0,this,e),this.length=this._features.length}function B0(i,e,r){i===15?e.version=r.readVarint():i===1?e.name=r.readString():i===5?e.extent=r.readVarint():i===2?e._features.push(r.pos):i===3?e._keys.push(r.readString()):i===4&&e._values.push(function(l){for(var d=null,m=l.readVarint()+l.pos;l.pos<m;){var _=l.readVarint()>>3;d=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return d}(r))}Fm.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new O0(this._pbf,e,this.extent,this._keys,this._values)};var F0=Bm;function $0(i,e,r){if(i===3){var l=new F0(r,r.readVarint()+r.pos);l.length&&(e[l.name]=l)}}no.VectorTile=function(i,e){this.layers=i.readFields($0,{},e)},no.VectorTileFeature=Om,no.VectorTileLayer=Bm;const U0=no.VectorTileFeature.types,Kd=Math.pow(2,13);function vc(i,e,r,l,d,m,_,b){i.emplaceBack(e,r,2*Math.floor(l*Kd)+_,d*Kd*2,m*Kd*2,Math.round(b))}class Jd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ci,this.centroidVertexArray=new Ct,this.indexArray=new Gn,this.programConfigurations=new Ho(e.layers,e.zoom),this.segments=new ni,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,l){this.features=[],this.hasPattern=Zd("fill-extrusion",this.layers,r);for(const{feature:d,id:m,index:_,sourceLayerIndex:b}of e){const T=this.layers[0]._featureFilter.needGeometry,I=Ko(d,T);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),I,l))continue;const P={id:m,sourceLayerIndex:b,index:_,geometry:T?I.geometry:Xo(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(Hd("fill-extrusion",this.layers,P,this.zoom,r)):this.addFeature(P,P.geometry,_,l,{}),r.featureIndex.insert(d,P.geometry,_,b,this.index,!0)}}addFeatures(e,r,l){for(const d of this.features){const{geometry:m}=d;this.addFeature(d,m,d.index,r,l)}}update(e,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,z0),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,M0.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,l,d,m){const _={x:0,y:0,vertexCount:0};for(const b of Wd(r,500)){let T=0;for(const V of b)T+=V.length;let I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const V of b){if(V.length===0||V0(V))continue;let Y=0;for(let J=0;J<V.length;J++){const ce=V[J];if(J>=1){const me=V[J-1];if(!N0(ce,me)){I.vertexLength+4>ni.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ae=ce.sub(me)._perp()._unit(),pe=me.dist(ce);Y+pe>32768&&(Y=0),vc(this.layoutVertexArray,ce.x,ce.y,ae.x,ae.y,0,0,Y),vc(this.layoutVertexArray,ce.x,ce.y,ae.x,ae.y,0,1,Y),_.x+=2*ce.x,_.y+=2*ce.y,_.vertexCount+=2,Y+=pe,vc(this.layoutVertexArray,me.x,me.y,ae.x,ae.y,0,0,Y),vc(this.layoutVertexArray,me.x,me.y,ae.x,ae.y,0,1,Y),_.x+=2*me.x,_.y+=2*me.y,_.vertexCount+=2;const Ae=I.vertexLength;this.indexArray.emplaceBack(Ae,Ae+2,Ae+1),this.indexArray.emplaceBack(Ae+1,Ae+2,Ae+3),I.vertexLength+=4,I.primitiveLength+=2}}}}if(I.vertexLength+T>ni.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),U0[e.type]!=="Polygon")continue;const P=[],D=[],O=I.vertexLength;for(const V of b)if(V.length!==0){V!==b[0]&&D.push(P.length/2);for(let Y=0;Y<V.length;Y++){const J=V[Y];vc(this.layoutVertexArray,J.x,J.y,0,0,1,1,0),_.x+=J.x,_.y+=J.y,_.vertexCount+=1,P.push(J.x),P.push(J.y)}}const N=Ku.exports(P,D);for(let V=0;V<N.length;V+=3)this.indexArray.emplaceBack(O+N[V],O+N[V+2],O+N[V+1]);I.primitiveLength+=N.length/3,I.vertexLength+=T}for(let b=0;b<_.vertexCount;b++)this.centroidVertexArray.emplaceBack(Math.floor(_.x/_.vertexCount),Math.floor(_.y/_.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,m,d)}}function N0(i,e){return i.x===e.x&&(i.x<0||i.x>hn)||i.y===e.y&&(i.y<0||i.y>hn)}function V0(i){return i.every(e=>e.x<0)||i.every(e=>e.x>hn)||i.every(e=>e.y<0)||i.every(e=>e.y>hn)}mt("FillExtrusionBucket",Jd,{omit:["layers","features"]});var j0={paint:new Tn({"fill-extrusion-opacity":new Tt(he["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Mt(he["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Tt(he["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Tt(he["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new eo(he["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Mt(he["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Mt(he["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Tt(he["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function xc(i,e){return i.x*e.x+i.y*e.y}function $m(i,e){if(i.length===1){let r=0;const l=e[r++];let d;for(;!d||l.equals(d);)if(d=e[r++],!d)return 1/0;for(;r<e.length;r++){const m=e[r],_=i[0],b=d.sub(l),T=m.sub(l),I=_.sub(l),P=xc(b,b),D=xc(b,T),O=xc(T,T),N=xc(I,b),V=xc(I,T),Y=P*O-D*D,J=(O*N-D*V)/Y,ce=(P*V-D*N)/Y,me=l.z*(1-J-ce)+d.z*J+m.z*ce;if(isFinite(me))return me}return 1/0}{let r=1/0;for(const l of e)r=Math.min(r,l.z);return r}}const q0=rn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:G0}=q0,W0=rn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Z0}=W0,H0=no.VectorTileFeature.types,X0=Math.cos(Math.PI/180*37.5),Um=Math.pow(2,14)/.5;class Yd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new fi,this.layoutVertexArray2=new Ai,this.indexArray=new Gn,this.programConfigurations=new Ho(e.layers,e.zoom),this.segments=new ni,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,l){this.hasPattern=Zd("line",this.layers,r);const d=this.layers[0].layout.get("line-sort-key"),m=!d.isConstant(),_=[];for(const{feature:b,id:T,index:I,sourceLayerIndex:P}of e){const D=this.layers[0]._featureFilter.needGeometry,O=Ko(b,D);if(!this.layers[0]._featureFilter.filter(new Gi(this.zoom),O,l))continue;const N=m?d.evaluate(O,{},l):void 0,V={id:T,properties:b.properties,type:b.type,sourceLayerIndex:P,index:I,geometry:D?O.geometry:Xo(b),patterns:{},sortKey:N};_.push(V)}m&&_.sort((b,T)=>b.sortKey-T.sortKey);for(const b of _){const{geometry:T,index:I,sourceLayerIndex:P}=b;if(this.hasPattern){const D=Hd("line",this.layers,b,this.zoom,r);this.patternFeatures.push(D)}else this.addFeature(b,T,I,l,{});r.featureIndex.insert(e[I].feature,T,I,P,this.index)}}update(e,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,l)}addFeatures(e,r,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,r,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Z0)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,G0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,l,d,m){const _=this.layers[0].layout,b=_.get("line-join").evaluate(e,{}),T=_.get("line-cap"),I=_.get("line-miter-limit"),P=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const D of r)this.addLine(D,e,b,T,I,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,m,d)}addLine(e,r,l,d,m,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ce=0;ce<e.length-1;ce++)this.totalDistance+=e[ce].dist(e[ce+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=H0[r.type]==="Polygon";let T=e.length;for(;T>=2&&e[T-1].equals(e[T-2]);)T--;let I=0;for(;I<T-1&&e[I].equals(e[I+1]);)I++;if(T<(b?3:2))return;l==="bevel"&&(m=1.05);const P=this.overscaling<=16?122880/(512*this.overscaling):0,D=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let O,N,V,Y,J;this.e1=this.e2=-1,b&&(O=e[T-2],J=e[I].sub(O)._unit()._perp());for(let ce=I;ce<T;ce++){if(V=ce===T-1?b?e[I+1]:void 0:e[ce+1],V&&e[ce].equals(V))continue;J&&(Y=J),O&&(N=O),O=e[ce],J=V?V.sub(O)._unit()._perp():Y,Y=Y||J;let me=Y.add(J);me.x===0&&me.y===0||me._unit();const ae=Y.x*J.x+Y.y*J.y,pe=me.x*J.x+me.y*J.y,Ae=pe!==0?1/pe:1/0,Se=2*Math.sqrt(2-2*pe),pt=pe<X0&&N&&V,xt=Y.x*J.y-Y.y*J.x>0;if(pt&&ce>I){const Ze=O.dist(N);if(Ze>2*P){const st=O.sub(O.sub(N)._mult(P/Ze)._round());this.updateDistance(N,st),this.addCurrentVertex(st,Y,0,0,D),N=st}}const rt=N&&V;let Qe=rt?l:b?"butt":d;if(rt&&Qe==="round"&&(Ae<_?Qe="miter":Ae<=2&&(Qe="fakeround")),Qe==="miter"&&Ae>m&&(Qe="bevel"),Qe==="bevel"&&(Ae>2&&(Qe="flipbevel"),Ae<m&&(Qe="miter")),N&&this.updateDistance(N,O),Qe==="miter")me._mult(Ae),this.addCurrentVertex(O,me,0,0,D);else if(Qe==="flipbevel"){if(Ae>100)me=J.mult(-1);else{const Ze=Ae*Y.add(J).mag()/Y.sub(J).mag();me._perp()._mult(Ze*(xt?-1:1))}this.addCurrentVertex(O,me,0,0,D),this.addCurrentVertex(O,me.mult(-1),0,0,D)}else if(Qe==="bevel"||Qe==="fakeround"){const Ze=-Math.sqrt(Ae*Ae-1),st=xt?Ze:0,et=xt?0:Ze;if(N&&this.addCurrentVertex(O,Y,st,et,D),Qe==="fakeround"){const Fe=Math.round(180*Se/Math.PI/20);for(let kt=1;kt<Fe;kt++){let Et=kt/Fe;if(Et!==.5){const $i=Et-.5;Et+=Et*$i*(Et-1)*((1.0904+ae*(ae*(3.55645-1.43519*ae)-3.2452))*$i*$i+(.848013+ae*(.215638*ae-1.06021)))}const ei=J.sub(Y)._mult(Et)._add(Y)._unit()._mult(xt?-1:1);this.addHalfVertex(O,ei.x,ei.y,!1,xt,0,D)}}V&&this.addCurrentVertex(O,J,-st,-et,D)}else if(Qe==="butt")this.addCurrentVertex(O,me,0,0,D);else if(Qe==="square"){const Ze=N?1:-1;this.addCurrentVertex(O,me,Ze,Ze,D)}else Qe==="round"&&(N&&(this.addCurrentVertex(O,Y,0,0,D),this.addCurrentVertex(O,Y,1,1,D,!0)),V&&(this.addCurrentVertex(O,J,-1,-1,D,!0),this.addCurrentVertex(O,J,0,0,D)));if(pt&&ce<T-1){const Ze=O.dist(V);if(Ze>2*P){const st=O.add(V.sub(O)._mult(P/Ze)._round());this.updateDistance(O,st),this.addCurrentVertex(st,J,0,0,D),O=st}}}}addCurrentVertex(e,r,l,d,m,_=!1){const b=r.y*d-r.x,T=-r.y-r.x*d;this.addHalfVertex(e,r.x+r.y*l,r.y-r.x*l,_,!1,l,m),this.addHalfVertex(e,b,T,_,!0,-d,m),this.distance>Um/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,r,l,d,m,_))}addHalfVertex({x:e,y:r},l,d,m,_,b,T){const I=.5*(this.lineClips?this.scaledDistance*(Um-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(r<<1)+(_?1:0),Math.round(63*l)+128,Math.round(63*d)+128,1+(b===0?0:b<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),T.primitiveLength++),_?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}mt("LineBucket",Yd,{omit:["layers","patternFeatures"]});const K0=new Tn({"line-cap":new Tt(he.layout_line["line-cap"]),"line-join":new Mt(he.layout_line["line-join"]),"line-miter-limit":new Tt(he.layout_line["line-miter-limit"]),"line-round-limit":new Tt(he.layout_line["line-round-limit"]),"line-sort-key":new Mt(he.layout_line["line-sort-key"])});var Nm={paint:new Tn({"line-opacity":new Mt(he.paint_line["line-opacity"]),"line-color":new Mt(he.paint_line["line-color"]),"line-translate":new Tt(he.paint_line["line-translate"]),"line-translate-anchor":new Tt(he.paint_line["line-translate-anchor"]),"line-width":new Mt(he.paint_line["line-width"]),"line-gap-width":new Mt(he.paint_line["line-gap-width"]),"line-offset":new Mt(he.paint_line["line-offset"]),"line-blur":new Mt(he.paint_line["line-blur"]),"line-dasharray":new ac(he.paint_line["line-dasharray"]),"line-pattern":new eo(he.paint_line["line-pattern"]),"line-gradient":new is(he.paint_line["line-gradient"])}),layout:K0};const Vm=new class extends Mt{possiblyEvaluate(i,e){return e=new Gi(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(i,e)}evaluate(i,e,r,l){return e=Ee({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(i,e,r,l)}}(Nm.paint.properties["line-width"].specification);function jm(i,e){return e>0?e+2*i:i}Vm.useIntegerZoom=!0;const J0=rn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Y0=rn([{name:"a_projected_pos",components:3,type:"Float32"}],4);rn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Q0=rn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);rn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const qm=rn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),eb=rn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function tb(i,e,r){return i.sections.forEach(l=>{l.text=function(d,m,_){const b=m.layout.get("text-transform").evaluate(_,{});return b==="uppercase"?d=d.toLocaleUpperCase():b==="lowercase"&&(d=d.toLocaleLowerCase()),cr.applyArabicShaping&&(d=cr.applyArabicShaping(d)),d}(l.text,e,r)}),i}rn([{name:"triangle",components:3,type:"Uint16"}]),rn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),rn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),rn([{type:"Float32",name:"offsetX"}]),rn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const bc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var En=24,Qd=zi,Gm=function(i,e,r,l,d){var m,_,b=8*d-l-1,T=(1<<b)-1,I=T>>1,P=-7,D=r?d-1:0,O=r?-1:1,N=i[e+D];for(D+=O,m=N&(1<<-P)-1,N>>=-P,P+=b;P>0;m=256*m+i[e+D],D+=O,P-=8);for(_=m&(1<<-P)-1,m>>=-P,P+=l;P>0;_=256*_+i[e+D],D+=O,P-=8);if(m===0)m=1-I;else{if(m===T)return _?NaN:1/0*(N?-1:1);_+=Math.pow(2,l),m-=I}return(N?-1:1)*_*Math.pow(2,m-l)},Wm=function(i,e,r,l,d,m){var _,b,T,I=8*m-d-1,P=(1<<I)-1,D=P>>1,O=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=l?0:m-1,V=l?1:-1,Y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(b=isNaN(e)?1:0,_=P):(_=Math.floor(Math.log(e)/Math.LN2),e*(T=Math.pow(2,-_))<1&&(_--,T*=2),(e+=_+D>=1?O/T:O*Math.pow(2,1-D))*T>=2&&(_++,T/=2),_+D>=P?(b=0,_=P):_+D>=1?(b=(e*T-1)*Math.pow(2,d),_+=D):(b=e*Math.pow(2,D-1)*Math.pow(2,d),_=0));d>=8;i[r+N]=255&b,N+=V,b/=256,d-=8);for(_=_<<d|b,I+=d;I>0;i[r+N]=255&_,N+=V,_/=256,I-=8);i[r+N-V]|=128*Y};function zi(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}zi.Varint=0,zi.Fixed64=1,zi.Bytes=2,zi.Fixed32=5;var ro,ep=4294967296,Zm=1/ep,Hm=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function As(i){return i.type===zi.Bytes?i.readVarint()+i.pos:i.pos+1}function Qa(i,e,r){return r?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function Xm(i,e,r){var l=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(l);for(var d=r.pos-1;d>=i;d--)r.buf[d+l]=r.buf[d]}function ib(i,e){for(var r=0;r<i.length;r++)e.writeVarint(i[r])}function nb(i,e){for(var r=0;r<i.length;r++)e.writeSVarint(i[r])}function rb(i,e){for(var r=0;r<i.length;r++)e.writeFloat(i[r])}function sb(i,e){for(var r=0;r<i.length;r++)e.writeDouble(i[r])}function ob(i,e){for(var r=0;r<i.length;r++)e.writeBoolean(i[r])}function ab(i,e){for(var r=0;r<i.length;r++)e.writeFixed32(i[r])}function lb(i,e){for(var r=0;r<i.length;r++)e.writeSFixed32(i[r])}function cb(i,e){for(var r=0;r<i.length;r++)e.writeFixed64(i[r])}function ub(i,e){for(var r=0;r<i.length;r++)e.writeSFixed64(i[r])}function th(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function el(i,e,r){i[r]=e,i[r+1]=e>>>8,i[r+2]=e>>>16,i[r+3]=e>>>24}function Km(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}function hb(i,e,r){i===1&&r.readMessage(db,e)}function db(i,e,r){if(i===3){const{id:l,bitmap:d,width:m,height:_,left:b,top:T,advance:I}=r.readMessage(pb,{});e.push({id:l,bitmap:new fc({width:m+6,height:_+6},d),metrics:{width:m,height:_,left:b,top:T,advance:I}})}}function pb(i,e,r){i===1?e.id=r.readVarint():i===2?e.bitmap=r.readBytes():i===3?e.width=r.readVarint():i===4?e.height=r.readVarint():i===5?e.left=r.readSVarint():i===6?e.top=r.readSVarint():i===7&&(e.advance=r.readVarint())}function Jm(i){let e=0,r=0;for(const _ of i)e+=_.w*_.h,r=Math.max(r,_.w);i.sort((_,b)=>b.h-_.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let d=0,m=0;for(const _ of i)for(let b=l.length-1;b>=0;b--){const T=l[b];if(!(_.w>T.w||_.h>T.h)){if(_.x=T.x,_.y=T.y,m=Math.max(m,_.y+_.h),d=Math.max(d,_.x+_.w),_.w===T.w&&_.h===T.h){const I=l.pop();b<l.length&&(l[b]=I)}else _.h===T.h?(T.x+=_.w,T.w-=_.w):_.w===T.w?(T.y+=_.h,T.h-=_.h):(l.push({x:T.x+_.w,y:T.y,w:T.w-_.w,h:_.h}),T.y+=_.h,T.h-=_.h);break}}return{w:d,h:m,fill:e/(d*m)||0}}zi.prototype={destroy:function(){this.buf=null},readFields:function(i,e,r){for(r=r||this.length;this.pos<r;){var l=this.readVarint(),d=l>>3,m=this.pos;this.type=7&l,i(d,e,this),this.pos===m&&this.skip(l)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=th(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Km(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=th(this.buf,this.pos)+th(this.buf,this.pos+4)*ep;return this.pos+=8,i},readSFixed64:function(){var i=th(this.buf,this.pos)+Km(this.buf,this.pos+4)*ep;return this.pos+=8,i},readFloat:function(){var i=Gm(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=Gm(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,r,l=this.buf;return e=127&(r=l[this.pos++]),r<128?e:(e|=(127&(r=l[this.pos++]))<<7,r<128?e:(e|=(127&(r=l[this.pos++]))<<14,r<128?e:(e|=(127&(r=l[this.pos++]))<<21,r<128?e:function(d,m,_){var b,T,I=_.buf;if(b=(112&(T=I[_.pos++]))>>4,T<128||(b|=(127&(T=I[_.pos++]))<<3,T<128)||(b|=(127&(T=I[_.pos++]))<<10,T<128)||(b|=(127&(T=I[_.pos++]))<<17,T<128)||(b|=(127&(T=I[_.pos++]))<<24,T<128)||(b|=(1&(T=I[_.pos++]))<<31,T<128))return Qa(d,b,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&Hm?function(r,l,d){return Hm.decode(r.subarray(l,d))}(this.buf,e,i):function(r,l,d){for(var m="",_=l;_<d;){var b,T,I,P=r[_],D=null,O=P>239?4:P>223?3:P>191?2:1;if(_+O>d)break;O===1?P<128&&(D=P):O===2?(192&(b=r[_+1]))==128&&(D=(31&P)<<6|63&b)<=127&&(D=null):O===3?(T=r[_+2],(192&(b=r[_+1]))==128&&(192&T)==128&&((D=(15&P)<<12|(63&b)<<6|63&T)<=2047||D>=55296&&D<=57343)&&(D=null)):O===4&&(T=r[_+2],I=r[_+3],(192&(b=r[_+1]))==128&&(192&T)==128&&(192&I)==128&&((D=(15&P)<<18|(63&b)<<12|(63&T)<<6|63&I)<=65535||D>=1114112)&&(D=null)),D===null?(D=65533,O=1):D>65535&&(D-=65536,m+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),m+=String.fromCharCode(D),_+=O}return m}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==zi.Bytes)return i.push(this.readVarint(e));var r=As(this);for(i=i||[];this.pos<r;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==zi.Bytes)return i.push(this.readSVarint());var e=As(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==zi.Bytes)return i.push(this.readBoolean());var e=As(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==zi.Bytes)return i.push(this.readFloat());var e=As(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==zi.Bytes)return i.push(this.readDouble());var e=As(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==zi.Bytes)return i.push(this.readFixed32());var e=As(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==zi.Bytes)return i.push(this.readSFixed32());var e=As(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==zi.Bytes)return i.push(this.readFixed64());var e=As(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==zi.Bytes)return i.push(this.readSFixed64());var e=As(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===zi.Varint)for(;this.buf[this.pos++]>127;);else if(e===zi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===zi.Fixed32)this.pos+=4;else{if(e!==zi.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),el(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),el(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),el(this.buf,-1&i,this.pos),el(this.buf,Math.floor(i*Zm),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),el(this.buf,-1&i,this.pos),el(this.buf,Math.floor(i*Zm),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,r){var l,d;if(e>=0?(l=e%4294967296|0,d=e/4294967296|0):(d=~(-e/4294967296),4294967295^(l=~(-e%4294967296))?l=l+1|0:(l=0,d=d+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(m,_,b){b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,b.buf[b.pos]=127&(m>>>=7)}(l,0,r),function(m,_){var b=(7&m)<<4;_.buf[_.pos++]|=b|((m>>>=3)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m)))))}(d,r)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(l,d,m){for(var _,b,T=0;T<d.length;T++){if((_=d.charCodeAt(T))>55295&&_<57344){if(!b){_>56319||T+1===d.length?(l[m++]=239,l[m++]=191,l[m++]=189):b=_;continue}if(_<56320){l[m++]=239,l[m++]=191,l[m++]=189,b=_;continue}_=b-55296<<10|_-56320|65536,b=null}else b&&(l[m++]=239,l[m++]=191,l[m++]=189,b=null);_<128?l[m++]=_:(_<2048?l[m++]=_>>6|192:(_<65536?l[m++]=_>>12|224:(l[m++]=_>>18|240,l[m++]=_>>12&63|128),l[m++]=_>>6&63|128),l[m++]=63&_|128)}return m}(this.buf,i,this.pos);var r=this.pos-e;r>=128&&Xm(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(i){this.realloc(4),Wm(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Wm(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=i[r]},writeRawMessage:function(i,e){this.pos++;var r=this.pos;i(e,this);var l=this.pos-r;l>=128&&Xm(r,l,this),this.pos=r-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,e,r){this.writeTag(i,zi.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,ib,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,nb,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,ob,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,rb,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,sb,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,ab,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,lb,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,cb,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,ub,e)},writeBytesField:function(i,e){this.writeTag(i,zi.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,zi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,zi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,zi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,zi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,zi.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,zi.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,zi.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,zi.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,zi.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,Boolean(e))}};class tp{constructor(e,{pixelRatio:r,version:l,stretchX:d,stretchY:m,content:_}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=d,this.stretchY=m,this.content=_,this.version=l}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Ym{constructor(e,r){const l={},d={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,l,m),this.addImages(r,d,m);const{w:_,h:b}=Jm(m),T=new xr({width:_||1,height:b||1});for(const I in e){const P=e[I],D=l[I].paddedRect;xr.copy(P.data,T,{x:0,y:0},{x:D.x+1,y:D.y+1},P.data)}for(const I in r){const P=r[I],D=d[I].paddedRect,O=D.x+1,N=D.y+1,V=P.data.width,Y=P.data.height;xr.copy(P.data,T,{x:0,y:0},{x:O,y:N},P.data),xr.copy(P.data,T,{x:0,y:Y-1},{x:O,y:N-1},{width:V,height:1}),xr.copy(P.data,T,{x:0,y:0},{x:O,y:N+Y},{width:V,height:1}),xr.copy(P.data,T,{x:V-1,y:0},{x:O-1,y:N},{width:1,height:Y}),xr.copy(P.data,T,{x:0,y:0},{x:O+V,y:N},{width:1,height:Y})}this.image=T,this.iconPositions=l,this.patternPositions=d}addImages(e,r,l){for(const d in e){const m=e[d],_={x:0,y:0,w:m.data.width+2,h:m.data.height+2};l.push(_),r[d]=new tp(_,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in e.updatedImages)this.patchUpdatedImage(this.iconPositions[l],e.getImage(l),r),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l),r)}patchUpdatedImage(e,r,l){if(!e||!r||e.version===r.version)return;e.version=r.version;const[d,m]=e.tl;l.update(r.data,void 0,{x:d,y:m})}}mt("ImagePosition",tp),mt("ImageAtlas",Ym),a.WritingMode=void 0,(ro=a.WritingMode||(a.WritingMode={}))[ro.none=0]="none",ro[ro.horizontal=1]="horizontal",ro[ro.vertical=2]="vertical",ro[ro.horizontalOnly=3]="horizontalOnly";const ih=-17;class wc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const l=new wc;return l.scale=e||1,l.fontStack=r,l}static forImage(e){const r=new wc;return r.imageName=e,r}}class tl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const l=new tl;for(let d=0;d<e.sections.length;d++){const m=e.sections[d];m.image?l.addImageSection(m):l.addTextSection(m,r)}return l}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let r="";for(let l=0;l<e.length;l++){const d=e.charCodeAt(l+1)||null,m=e.charCodeAt(l-1)||null;r+=d&&Ou(d)&&!bc[e[l+1]]||m&&Ou(m)&&!bc[e[l-1]]||!bc[e[l]]?e[l]:bc[e[l]]}return r}(this.text)}trim(){let e=0;for(let l=0;l<this.text.length&&rh[this.text.charCodeAt(l)];l++)e++;let r=this.text.length;for(let l=this.text.length-1;l>=0&&l>=e&&rh[this.text.charCodeAt(l)];l--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const l=new tl;return l.text=this.text.substring(e,r),l.sectionIndex=this.sectionIndex.slice(e,r),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(wc.forText(e.scale,e.fontStack||r));const l=this.sections.length-1;for(let d=0;d<e.text.length;++d)this.sectionIndex.push(l)}addImageSection(e){const r=e.image?e.image.name:"";if(r.length===0)return void Ce("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(wc.forImage(r)),this.sectionIndex.push(this.sections.length-1)):Ce("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function nh(i,e,r,l,d,m,_,b,T,I,P,D,O,N,V,Y){const J=tl.fromFeature(i,d);let ce;D===a.WritingMode.vertical&&J.verticalizePunctuation();const{processBidirectionalText:me,processStyledBidirectionalText:ae}=cr;if(me&&J.sections.length===1){ce=[];const Se=me(J.toString(),ip(J,I,m,e,l,N,V));for(const pt of Se){const xt=new tl;xt.text=pt,xt.sections=J.sections;for(let rt=0;rt<pt.length;rt++)xt.sectionIndex.push(0);ce.push(xt)}}else if(ae){ce=[];const Se=ae(J.text,J.sectionIndex,ip(J,I,m,e,l,N,V));for(const pt of Se){const xt=new tl;xt.text=pt[0],xt.sectionIndex=pt[1],xt.sections=J.sections,ce.push(xt)}}else ce=function(Se,pt){const xt=[],rt=Se.text;let Qe=0;for(const Ze of pt)xt.push(Se.substring(Qe,Ze)),Qe=Ze;return Qe<rt.length&&xt.push(Se.substring(Qe,rt.length)),xt}(J,ip(J,I,m,e,l,N,V));const pe=[],Ae={positionedLines:pe,text:J.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(Se,pt,xt,rt,Qe,Ze,st,et,Fe,kt,Et,ei){let $i=0,Zi=ih,dn=0,wr=0;const kn=et==="right"?1:et==="left"?0:.5;let sn=0;for(const on of Qe){on.trim();const Mn=on.getMaxScale(),Nn=(Mn-1)*En,Hn={positionedGlyphs:[],lineOffset:0};Se.positionedLines[sn]=Hn;const tr=Hn.positionedGlyphs;let ir=0;if(!on.length()){Zi+=Ze,++sn;continue}for(let xn=0;xn<on.length();xn++){const si=on.getSection(xn),dr=on.getSectionIndex(xn),zn=on.getCharCode(xn);let Vn=0,Dr=null,Vr=null,jr=null,ks=En;const Rr=!(Fe===a.WritingMode.horizontal||!Et&&!tc(zn)||Et&&(rh[zn]||(vn=zn,nt.Arabic(vn)||nt["Arabic Supplement"](vn)||nt["Arabic Extended-A"](vn)||nt["Arabic Presentation Forms-A"](vn)||nt["Arabic Presentation Forms-B"](vn))));if(si.imageName){const Tr=rt[si.imageName];if(!Tr)continue;jr=si.imageName,Se.iconsInText=Se.iconsInText||!0,Vr=Tr.paddedRect;const nr=Tr.displaySize;si.scale=si.scale*En/ei,Dr={width:nr[0],height:nr[1],left:1,top:-3,advance:Rr?nr[1]:nr[0]},Vn=Nn+(En-nr[1]*si.scale),ks=Dr.advance;const Ps=Rr?nr[0]*si.scale-En*Mn:nr[1]*si.scale-En*Mn;Ps>0&&Ps>ir&&(ir=Ps)}else{const Tr=xt[si.fontStack],nr=Tr&&Tr[zn];if(nr&&nr.rect)Vr=nr.rect,Dr=nr.metrics;else{const Ps=pt[si.fontStack],Sc=Ps&&Ps[zn];if(!Sc)continue;Dr=Sc.metrics}Vn=(Mn-si.scale)*En}Rr?(Se.verticalizable=!0,tr.push({glyph:zn,imageName:jr,x:$i,y:Zi+Vn,vertical:Rr,scale:si.scale,fontStack:si.fontStack,sectionIndex:dr,metrics:Dr,rect:Vr}),$i+=ks*si.scale+kt):(tr.push({glyph:zn,imageName:jr,x:$i,y:Zi+Vn,vertical:Rr,scale:si.scale,fontStack:si.fontStack,sectionIndex:dr,metrics:Dr,rect:Vr}),$i+=Dr.advance*si.scale+kt)}tr.length!==0&&(dn=Math.max($i-kt,dn),gb(tr,0,tr.length-1,kn,ir)),$i=0;const Hi=Ze*Mn+ir;Hn.lineOffset=Math.max(ir,Nn),Zi+=Hi,wr=Math.max(Hi,wr),++sn}var vn;const Pn=Zi-ih,{horizontalAlign:Un,verticalAlign:er}=np(st);(function(on,Mn,Nn,Hn,tr,ir,Hi,xn,si){const dr=(Mn-Nn)*tr;let zn=0;zn=ir!==Hi?-xn*Hn-ih:(-Hn*si+.5)*Hi;for(const Vn of on)for(const Dr of Vn.positionedGlyphs)Dr.x+=dr,Dr.y+=zn})(Se.positionedLines,kn,Un,er,dn,wr,Ze,Pn,Qe.length),Se.top+=-er*Pn,Se.bottom=Se.top+Pn,Se.left+=-Un*dn,Se.right=Se.left+dn}(Ae,e,r,l,ce,_,b,T,D,I,O,Y),!function(Se){for(const pt of Se)if(pt.positionedGlyphs.length!==0)return!1;return!0}(pe)&&Ae}const rh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},fb={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Qm(i,e,r,l,d,m){if(e.imageName){const _=l[e.imageName];return _?_.displaySize[0]*e.scale*En/m+d:0}{const _=r[e.fontStack],b=_&&_[i];return b?b.metrics.advance*e.scale+d:0}}function eg(i,e,r,l){const d=Math.pow(i-e,2);return l?i<e?d/2:2*d:d+Math.abs(r)*r}function mb(i,e,r){let l=0;return i===10&&(l-=1e4),r&&(l+=150),i!==40&&i!==65288||(l+=50),e!==41&&e!==65289||(l+=50),l}function tg(i,e,r,l,d,m){let _=null,b=eg(e,r,d,m);for(const T of l){const I=eg(e-T.x,r,d,m)+T.badness;I<=b&&(_=T,b=I)}return{index:i,x:e,priorBreak:_,badness:b}}function ig(i){return i?ig(i.priorBreak).concat(i.index):[]}function ip(i,e,r,l,d,m,_){if(m!=="point")return[];if(!i)return[];const b=[],T=function(O,N,V,Y,J,ce){let me=0;for(let ae=0;ae<O.length();ae++){const pe=O.getSection(ae);me+=Qm(O.getCharCode(ae),pe,Y,J,N,ce)}return me/Math.max(1,Math.ceil(me/V))}(i,e,r,l,d,_),I=i.text.indexOf("\u200B")>=0;let P=0;for(let O=0;O<i.length();O++){const N=i.getSection(O),V=i.getCharCode(O);if(rh[V]||(P+=Qm(V,N,l,d,e,_)),O<i.length()-1){const Y=!((D=V)<11904||!(nt["Bopomofo Extended"](D)||nt.Bopomofo(D)||nt["CJK Compatibility Forms"](D)||nt["CJK Compatibility Ideographs"](D)||nt["CJK Compatibility"](D)||nt["CJK Radicals Supplement"](D)||nt["CJK Strokes"](D)||nt["CJK Symbols and Punctuation"](D)||nt["CJK Unified Ideographs Extension A"](D)||nt["CJK Unified Ideographs"](D)||nt["Enclosed CJK Letters and Months"](D)||nt["Halfwidth and Fullwidth Forms"](D)||nt.Hiragana(D)||nt["Ideographic Description Characters"](D)||nt["Kangxi Radicals"](D)||nt["Katakana Phonetic Extensions"](D)||nt.Katakana(D)||nt["Vertical Forms"](D)||nt["Yi Radicals"](D)||nt["Yi Syllables"](D)));(fb[V]||Y||N.imageName)&&b.push(tg(O+1,P,T,b,mb(V,i.getCharCode(O+1),Y&&I),!1))}}var D;return ig(tg(i.length(),P,T,b,0,!0))}function np(i){let e=.5,r=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function gb(i,e,r,l,d){if(!l&&!d)return;const m=i[r],_=(i[r].x+m.metrics.advance*m.scale)*l;for(let b=e;b<=r;b++)i[b].x-=_,i[b].y+=d}function _b(i,e,r){const{horizontalAlign:l,verticalAlign:d}=np(r),m=e[0]-i.displaySize[0]*l,_=e[1]-i.displaySize[1]*d;return{image:i,top:_,bottom:_+i.displaySize[1],left:m,right:m+i.displaySize[0]}}function ng(i,e,r,l,d,m){const _=i.image;let b;if(_.content){const J=_.content,ce=_.pixelRatio||1;b=[J[0]/ce,J[1]/ce,_.displaySize[0]-J[2]/ce,_.displaySize[1]-J[3]/ce]}const T=e.left*m,I=e.right*m;let P,D,O,N;r==="width"||r==="both"?(N=d[0]+T-l[3],D=d[0]+I+l[1]):(N=d[0]+(T+I-_.displaySize[0])/2,D=N+_.displaySize[0]);const V=e.top*m,Y=e.bottom*m;return r==="height"||r==="both"?(P=d[1]+V-l[0],O=d[1]+Y+l[2]):(P=d[1]+(V+Y-_.displaySize[1])/2,O=P+_.displaySize[1]),{image:_,top:P,right:D,bottom:O,left:N,collisionPadding:b}}const Cs=128;function rg(i,e){const{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Gi(i+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:d}=r;let m=0;for(;m<l.length&&l[m]<=i;)m++;m=Math.max(0,m-1);let _=m;for(;_<l.length&&l[_]<i+1;)_++;_=Math.min(l.length-1,_);const b=l[m],T=l[_];return r.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:T,interpolationType:d}:{kind:"camera",minZoom:b,maxZoom:T,minSize:r.evaluate(new Gi(b)),maxSize:r.evaluate(new Gi(T)),interpolationType:d}}}class so extends We{constructor(e,r,l,d){super(e,r),this.angle=l,d!==void 0&&(this.segment=d)}clone(){return new so(this.x,this.y,this.angle,this.segment)}}function sg(i,e,r,l,d){if(e.segment===void 0)return!0;let m=e,_=e.segment+1,b=0;for(;b>-r/2;){if(_--,_<0)return!1;b-=i[_].dist(m),m=i[_]}b+=i[_].dist(i[_+1]),_++;const T=[];let I=0;for(;b<r/2;){const P=i[_],D=i[_+1];if(!D)return!1;let O=i[_-1].angleTo(P)-P.angleTo(D);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:b,angleDelta:O}),I+=O;b-T[0].distance>l;)I-=T.shift().angleDelta;if(I>d)return!1;_++,b+=P.dist(D)}return!0}function og(i){let e=0;for(let r=0;r<i.length-1;r++)e+=i[r].dist(i[r+1]);return e}function ag(i,e,r){return i?.6*e*r:0}function lg(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function yb(i,e,r,l,d,m){const _=ag(r,d,m),b=lg(r,l)*m;let T=0;const I=og(i)/2;for(let P=0;P<i.length-1;P++){const D=i[P],O=i[P+1],N=D.dist(O);if(T+N>I){const V=(I-T)/N,Y=ji(D.x,O.x,V),J=ji(D.y,O.y,V),ce=new so(Y,J,O.angleTo(D),P);return ce._round(),!_||sg(i,ce,b,_,e)?ce:void 0}T+=N}}function vb(i,e,r,l,d,m,_,b,T){const I=ag(l,m,_),P=lg(l,d),D=P*_,O=i[0].x===0||i[0].x===T||i[0].y===0||i[0].y===T;return e-D<e/4&&(e=D+e/4),cg(i,O?e/2*b%e:(P/2+2*m)*_*b%e,e,I,r,D,O,!1,T)}function cg(i,e,r,l,d,m,_,b,T){const I=m/2,P=og(i);let D=0,O=e-r,N=[];for(let V=0;V<i.length-1;V++){const Y=i[V],J=i[V+1],ce=Y.dist(J),me=J.angleTo(Y);for(;O+r<D+ce;){O+=r;const ae=(O-D)/ce,pe=ji(Y.x,J.x,ae),Ae=ji(Y.y,J.y,ae);if(pe>=0&&pe<T&&Ae>=0&&Ae<T&&O-I>=0&&O+I<=P){const Se=new so(pe,Ae,me,V);Se._round(),l&&!sg(i,Se,m,l,d)||N.push(Se)}}D+=ce}return b||N.length||_||(N=cg(i,D/2,r,l,d,m,_,!0,T)),N}function ug(i,e,r,l,d){const m=[];for(let _=0;_<i.length;_++){const b=i[_];let T;for(let I=0;I<b.length-1;I++){let P=b[I],D=b[I+1];P.x<e&&D.x<e||(P.x<e?P=new We(e,P.y+(e-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x<e&&(D=new We(e,P.y+(e-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y<r&&D.y<r||(P.y<r?P=new We(P.x+(r-P.y)/(D.y-P.y)*(D.x-P.x),r)._round():D.y<r&&(D=new We(P.x+(r-P.y)/(D.y-P.y)*(D.x-P.x),r)._round()),P.x>=l&&D.x>=l||(P.x>=l?P=new We(l,P.y+(l-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x>=l&&(D=new We(l,P.y+(l-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y>=d&&D.y>=d||(P.y>=d?P=new We(P.x+(d-P.y)/(D.y-P.y)*(D.x-P.x),d)._round():D.y>=d&&(D=new We(P.x+(d-P.y)/(D.y-P.y)*(D.x-P.x),d)._round()),T&&P.equals(T[T.length-1])||(T=[P],m.push(T)),T.push(D)))))}}return m}function hg(i,e,r,l){const d=[],m=i.image,_=m.pixelRatio,b=m.paddedRect.w-2,T=m.paddedRect.h-2,I=i.right-i.left,P=i.bottom-i.top,D=m.stretchX||[[0,b]],O=m.stretchY||[[0,T]],N=(Ze,st)=>Ze+st[1]-st[0],V=D.reduce(N,0),Y=O.reduce(N,0),J=b-V,ce=T-Y;let me=0,ae=V,pe=0,Ae=Y,Se=0,pt=J,xt=0,rt=ce;if(m.content&&l){const Ze=m.content;me=sh(D,0,Ze[0]),pe=sh(O,0,Ze[1]),ae=sh(D,Ze[0],Ze[2]),Ae=sh(O,Ze[1],Ze[3]),Se=Ze[0]-me,xt=Ze[1]-pe,pt=Ze[2]-Ze[0]-ae,rt=Ze[3]-Ze[1]-Ae}const Qe=(Ze,st,et,Fe)=>{const kt=oh(Ze.stretch-me,ae,I,i.left),Et=ah(Ze.fixed-Se,pt,Ze.stretch,V),ei=oh(st.stretch-pe,Ae,P,i.top),$i=ah(st.fixed-xt,rt,st.stretch,Y),Zi=oh(et.stretch-me,ae,I,i.left),dn=ah(et.fixed-Se,pt,et.stretch,V),wr=oh(Fe.stretch-pe,Ae,P,i.top),kn=ah(Fe.fixed-xt,rt,Fe.stretch,Y),sn=new We(kt,ei),vn=new We(Zi,ei),Pn=new We(Zi,wr),Un=new We(kt,wr),er=new We(Et/_,$i/_),on=new We(dn/_,kn/_),Mn=e*Math.PI/180;if(Mn){const tr=Math.sin(Mn),ir=Math.cos(Mn),Hi=[ir,-tr,tr,ir];sn._matMult(Hi),vn._matMult(Hi),Un._matMult(Hi),Pn._matMult(Hi)}const Nn=Ze.stretch+Ze.fixed,Hn=st.stretch+st.fixed;return{tl:sn,tr:vn,bl:Un,br:Pn,tex:{x:m.paddedRect.x+1+Nn,y:m.paddedRect.y+1+Hn,w:et.stretch+et.fixed-Nn,h:Fe.stretch+Fe.fixed-Hn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:er,pixelOffsetBR:on,minFontScaleX:pt/_/I,minFontScaleY:rt/_/P,isSDF:r}};if(l&&(m.stretchX||m.stretchY)){const Ze=dg(D,J,V),st=dg(O,ce,Y);for(let et=0;et<Ze.length-1;et++){const Fe=Ze[et],kt=Ze[et+1];for(let Et=0;Et<st.length-1;Et++)d.push(Qe(Fe,st[Et],kt,st[Et+1]))}}else d.push(Qe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:T+1}));return d}function sh(i,e,r){let l=0;for(const d of i)l+=Math.max(e,Math.min(r,d[1]))-Math.max(e,Math.min(r,d[0]));return l}function dg(i,e,r){const l=[{fixed:-1,stretch:0}];for(const[d,m]of i){const _=l[l.length-1];l.push({fixed:d-_.stretch,stretch:_.stretch}),l.push({fixed:d-_.stretch,stretch:_.stretch+(m-d)})}return l.push({fixed:e+1,stretch:r}),l}function oh(i,e,r,l){return i/e*r+l}function ah(i,e,r,l){return i-e*r/l}mt("Anchor",so);class lh{constructor(e,r,l,d,m,_,b,T,I,P){if(this.boxStartIndex=e.length,I){let D=_.top,O=_.bottom;const N=_.collisionPadding;N&&(D-=N[1],O+=N[3]);let V=O-D;V>0&&(V=Math.max(10,V),this.circleDiameter=V)}else{let D=_.top*b-T[0],O=_.bottom*b+T[2],N=_.left*b-T[3],V=_.right*b+T[1];const Y=_.collisionPadding;if(Y&&(N-=Y[0]*b,D-=Y[1]*b,V+=Y[2]*b,O+=Y[3]*b),P){const J=new We(N,D),ce=new We(V,D),me=new We(N,O),ae=new We(V,O),pe=P*Math.PI/180;J._rotate(pe),ce._rotate(pe),me._rotate(pe),ae._rotate(pe),N=Math.min(J.x,ce.x,me.x,ae.x),V=Math.max(J.x,ce.x,me.x,ae.x),D=Math.min(J.y,ce.y,me.y,ae.y),O=Math.max(J.y,ce.y,me.y,ae.y)}e.emplaceBack(r.x,r.y,N,D,V,O,l,d,m)}this.boxEndIndex=e.length}}class xb{constructor(e=[],r=bb){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:l}=this,d=r[e];for(;e>0;){const m=e-1>>1,_=r[m];if(l(d,_)>=0)break;r[e]=_,e=m}r[e]=d}_down(e){const{data:r,compare:l}=this,d=this.length>>1,m=r[e];for(;e<d;){let _=1+(e<<1),b=r[_];const T=_+1;if(T<this.length&&l(r[T],b)<0&&(_=T,b=r[T]),l(b,m)>=0)break;r[e]=b,e=_}r[e]=m}}function bb(i,e){return i<e?-1:i>e?1:0}function wb(i,e=1,r=!1){let l=1/0,d=1/0,m=-1/0,_=-1/0;const b=i[0];for(let N=0;N<b.length;N++){const V=b[N];(!N||V.x<l)&&(l=V.x),(!N||V.y<d)&&(d=V.y),(!N||V.x>m)&&(m=V.x),(!N||V.y>_)&&(_=V.y)}const T=Math.min(m-l,_-d);let I=T/2;const P=new xb([],Tb);if(T===0)return new We(l,d);for(let N=l;N<m;N+=T)for(let V=d;V<_;V+=T)P.push(new il(N+I,V+I,I,i));let D=function(N){let V=0,Y=0,J=0;const ce=N[0];for(let me=0,ae=ce.length,pe=ae-1;me<ae;pe=me++){const Ae=ce[me],Se=ce[pe],pt=Ae.x*Se.y-Se.x*Ae.y;Y+=(Ae.x+Se.x)*pt,J+=(Ae.y+Se.y)*pt,V+=3*pt}return new il(Y/V,J/V,0,N)}(i),O=P.length;for(;P.length;){const N=P.pop();(N.d>D.d||!D.d)&&(D=N,r&&console.log("found best %d after %d probes",Math.round(1e4*N.d)/1e4,O)),N.max-D.d<=e||(I=N.h/2,P.push(new il(N.p.x-I,N.p.y-I,I,i)),P.push(new il(N.p.x+I,N.p.y-I,I,i)),P.push(new il(N.p.x-I,N.p.y+I,I,i)),P.push(new il(N.p.x+I,N.p.y+I,I,i)),O+=4)}return r&&(console.log(`num probes: ${O}`),console.log(`best distance: ${D.d}`)),D.p}function Tb(i,e){return e.max-i.max}function il(i,e,r,l){this.p=new We(i,e),this.h=r,this.d=function(d,m){let _=!1,b=1/0;for(let T=0;T<m.length;T++){const I=m[T];for(let P=0,D=I.length,O=D-1;P<D;O=P++){const N=I[P],V=I[O];N.y>d.y!=V.y>d.y&&d.x<(V.x-N.x)*(d.y-N.y)/(V.y-N.y)+N.x&&(_=!_),b=Math.min(b,xm(d,N,V))}}return(_?1:-1)*Math.sqrt(b)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}const rp=Number.POSITIVE_INFINITY;function pg(i,e){return e[1]!==rp?function(r,l,d){let m=0,_=0;switch(l=Math.abs(l),d=Math.abs(d),r){case"top-right":case"top-left":case"top":_=d-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-d}switch(r){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,_]}(i,e[0],e[1]):function(r,l){let d=0,m=0;l<0&&(l=0);const _=l/Math.sqrt(2);switch(r){case"top-right":case"top-left":m=_-7;break;case"bottom-right":case"bottom-left":m=7-_;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(r){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=l;break;case"right":d=-l}return[d,m]}(i,e[0])}function sp(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Eb(i,e,r,l,d,m,_,b,T,I,P){let D=m.textMaxSize.evaluate(e,{});D===void 0&&(D=_);const O=i.layers[0].layout,N=O.get("icon-offset").evaluate(e,{},P),V=mg(r.horizontal),Y=_/24,J=i.tilePixelRatio*Y,ce=i.tilePixelRatio*D/24,me=i.tilePixelRatio*b,ae=i.tilePixelRatio*O.get("symbol-spacing"),pe=O.get("text-padding")*i.tilePixelRatio,Ae=function(Fe,kt,Et,ei=1){const $i=Fe.get("icon-padding").evaluate(kt,{},Et),Zi=$i&&$i.values;return[Zi[0]*ei,Zi[1]*ei,Zi[2]*ei,Zi[3]*ei]}(O,e,P,i.tilePixelRatio),Se=O.get("text-max-angle")/180*Math.PI,pt=O.get("text-rotation-alignment")!=="viewport"&&O.get("symbol-placement")!=="point",xt=O.get("icon-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",rt=O.get("symbol-placement"),Qe=ae/2,Ze=O.get("icon-text-fit");let st;l&&Ze!=="none"&&(i.allowVerticalPlacement&&r.vertical&&(st=ng(l,r.vertical,Ze,O.get("icon-text-fit-padding"),N,Y)),V&&(l=ng(l,V,Ze,O.get("icon-text-fit-padding"),N,Y)));const et=(Fe,kt)=>{kt.x<0||kt.x>=hn||kt.y<0||kt.y>=hn||function(Et,ei,$i,Zi,dn,wr,kn,sn,vn,Pn,Un,er,on,Mn,Nn,Hn,tr,ir,Hi,xn,si,dr,zn,Vn,Dr){const Vr=Et.addToLineVertexArray(ei,$i);let jr,ks,Rr,Tr,nr=0,Ps=0,Sc=0,Mg=0,mp=-1,gp=-1;const Ms={};let zg=yn.exports(""),_p=0,yp=0;if(sn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[_p,yp]=sn.layout.get("text-offset").evaluate(si,{},Vn).map(rr=>rr*En):(_p=sn.layout.get("text-radial-offset").evaluate(si,{},Vn)*En,yp=rp),Et.allowVerticalPlacement&&Zi.vertical){const rr=sn.layout.get("text-rotate").evaluate(si,{},Vn)+90;Rr=new lh(vn,ei,Pn,Un,er,Zi.vertical,on,Mn,Nn,rr),kn&&(Tr=new lh(vn,ei,Pn,Un,er,kn,tr,ir,Nn,rr))}if(dn){const rr=sn.layout.get("icon-rotate").evaluate(si,{}),as=sn.layout.get("icon-text-fit")!=="none",Ic=hg(dn,rr,zn,as),Ac=kn?hg(kn,rr,zn,as):void 0;ks=new lh(vn,ei,Pn,Un,er,dn,tr,ir,!1,rr),nr=4*Ic.length;const Lg=Et.iconSizeData;let Qo=null;Lg.kind==="source"?(Qo=[Cs*sn.layout.get("icon-size").evaluate(si,{})],Qo[0]>oo&&Ce(`${Et.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Lg.kind==="composite"&&(Qo=[Cs*dr.compositeIconSizes[0].evaluate(si,{},Vn),Cs*dr.compositeIconSizes[1].evaluate(si,{},Vn)],(Qo[0]>oo||Qo[1]>oo)&&Ce(`${Et.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Et.addSymbols(Et.icon,Ic,Qo,xn,Hi,si,a.WritingMode.none,ei,Vr.lineStartIndex,Vr.lineLength,-1,Vn),mp=Et.icon.placedSymbolArray.length-1,Ac&&(Ps=4*Ac.length,Et.addSymbols(Et.icon,Ac,Qo,xn,Hi,si,a.WritingMode.vertical,ei,Vr.lineStartIndex,Vr.lineLength,-1,Vn),gp=Et.icon.placedSymbolArray.length-1)}const Dg=Object.keys(Zi.horizontal);for(const rr of Dg){const as=Zi.horizontal[rr];if(!jr){zg=yn.exports(as.text);const Ac=sn.layout.get("text-rotate").evaluate(si,{},Vn);jr=new lh(vn,ei,Pn,Un,er,as,on,Mn,Nn,Ac)}const Ic=as.positionedLines.length===1;if(Sc+=fg(Et,ei,as,wr,sn,Nn,si,Hn,Vr,Zi.vertical?a.WritingMode.horizontal:a.WritingMode.horizontalOnly,Ic?Dg:[rr],Ms,mp,dr,Vn),Ic)break}Zi.vertical&&(Mg+=fg(Et,ei,Zi.vertical,wr,sn,Nn,si,Hn,Vr,a.WritingMode.vertical,["vertical"],Ms,gp,dr,Vn));const Bb=jr?jr.boxStartIndex:Et.collisionBoxArray.length,Fb=jr?jr.boxEndIndex:Et.collisionBoxArray.length,$b=Rr?Rr.boxStartIndex:Et.collisionBoxArray.length,Ub=Rr?Rr.boxEndIndex:Et.collisionBoxArray.length,Nb=ks?ks.boxStartIndex:Et.collisionBoxArray.length,Vb=ks?ks.boxEndIndex:Et.collisionBoxArray.length,jb=Tr?Tr.boxStartIndex:Et.collisionBoxArray.length,qb=Tr?Tr.boxEndIndex:Et.collisionBoxArray.length;let qr=-1;const ph=(rr,as)=>rr&&rr.circleDiameter?Math.max(rr.circleDiameter,as):as;qr=ph(jr,qr),qr=ph(Rr,qr),qr=ph(ks,qr),qr=ph(Tr,qr);const Rg=qr>-1?1:0;Rg&&(qr*=Dr/En),Et.glyphOffsetArray.length>=nl.MAX_GLYPHS&&Ce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),si.sortKey!==void 0&&Et.addToSortKeyRanges(Et.symbolInstances.length,si.sortKey),Et.symbolInstances.emplaceBack(ei.x,ei.y,Ms.right>=0?Ms.right:-1,Ms.center>=0?Ms.center:-1,Ms.left>=0?Ms.left:-1,Ms.vertical||-1,mp,gp,zg,Bb,Fb,$b,Ub,Nb,Vb,jb,qb,Pn,Sc,Mg,nr,Ps,Rg,0,on,_p,yp,qr)}(i,kt,Fe,r,l,d,st,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,J,[pe,pe,pe,pe],pt,T,me,Ae,xt,N,e,m,I,P,_)};if(rt==="line")for(const Fe of ug(e.geometry,0,0,hn,hn)){const kt=vb(Fe,ae,Se,r.vertical||V,l,24,ce,i.overscaling,hn);for(const Et of kt){const ei=V;ei&&Sb(i,ei.text,Qe,Et)||et(Fe,Et)}}else if(rt==="line-center"){for(const Fe of e.geometry)if(Fe.length>1){const kt=yb(Fe,Se,r.vertical||V,l,24,ce);kt&&et(Fe,kt)}}else if(e.type==="Polygon")for(const Fe of Wd(e.geometry,0)){const kt=wb(Fe,16);et(Fe[0],new so(kt.x,kt.y,0))}else if(e.type==="LineString")for(const Fe of e.geometry)et(Fe,new so(Fe[0].x,Fe[0].y,0));else if(e.type==="Point")for(const Fe of e.geometry)for(const kt of Fe)et([kt],new so(kt.x,kt.y,0))}const oo=32640;function fg(i,e,r,l,d,m,_,b,T,I,P,D,O,N,V){const Y=function(me,ae,pe,Ae,Se,pt,xt,rt){const Qe=Ae.layout.get("text-rotate").evaluate(pt,{})*Math.PI/180,Ze=[];for(const st of ae.positionedLines)for(const et of st.positionedGlyphs){if(!et.rect)continue;const Fe=et.rect||{};let kt=4,Et=!0,ei=1,$i=0;const Zi=(Se||rt)&&et.vertical,dn=et.metrics.advance*et.scale/2;if(rt&&ae.verticalizable){const Hi=(et.scale-1)*En,xn=(En-et.metrics.width*et.scale)/2;$i=st.lineOffset/2-(et.imageName?-xn:Hi)}if(et.imageName){const Hi=xt[et.imageName];Et=Hi.sdf,ei=Hi.pixelRatio,kt=1/ei}const wr=Se?[et.x+dn,et.y]:[0,0];let kn=Se?[0,0]:[et.x+dn+pe[0],et.y+pe[1]-$i],sn=[0,0];Zi&&(sn=kn,kn=[0,0]);const vn=(et.metrics.left-kt)*et.scale-dn+kn[0],Pn=(-et.metrics.top-kt)*et.scale+kn[1],Un=vn+Fe.w*et.scale/ei,er=Pn+Fe.h*et.scale/ei,on=new We(vn,Pn),Mn=new We(Un,Pn),Nn=new We(vn,er),Hn=new We(Un,er);if(Zi){const Hi=new We(-dn,dn-ih),xn=-Math.PI/2,si=12-dn,dr=new We(22-si,-(et.imageName?si:0)),zn=new We(...sn);on._rotateAround(xn,Hi)._add(dr)._add(zn),Mn._rotateAround(xn,Hi)._add(dr)._add(zn),Nn._rotateAround(xn,Hi)._add(dr)._add(zn),Hn._rotateAround(xn,Hi)._add(dr)._add(zn)}if(Qe){const Hi=Math.sin(Qe),xn=Math.cos(Qe),si=[xn,-Hi,Hi,xn];on._matMult(si),Mn._matMult(si),Nn._matMult(si),Hn._matMult(si)}const tr=new We(0,0),ir=new We(0,0);Ze.push({tl:on,tr:Mn,bl:Nn,br:Hn,tex:Fe,writingMode:ae.writingMode,glyphOffset:wr,sectionIndex:et.sectionIndex,isSDF:Et,pixelOffsetTL:tr,pixelOffsetBR:ir,minFontScaleX:0,minFontScaleY:0})}return Ze}(0,r,b,d,m,_,l,i.allowVerticalPlacement),J=i.textSizeData;let ce=null;J.kind==="source"?(ce=[Cs*d.layout.get("text-size").evaluate(_,{})],ce[0]>oo&&Ce(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):J.kind==="composite"&&(ce=[Cs*N.compositeTextSizes[0].evaluate(_,{},V),Cs*N.compositeTextSizes[1].evaluate(_,{},V)],(ce[0]>oo||ce[1]>oo)&&Ce(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,Y,ce,b,m,_,I,e,T.lineStartIndex,T.lineLength,O,V);for(const me of P)D[me]=i.text.placedSymbolArray.length-1;return 4*Y.length}function mg(i){for(const e in i)return i[e];return null}function Sb(i,e,r,l){const d=i.compareText;if(e in d){const m=d[e];for(let _=m.length-1;_>=0;_--)if(l.dist(m[_])<r)return!0}else d[e]=[];return d[e].push(l),!1}const Ib=no.VectorTileFeature.types,Ab=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ch(i,e,r,l,d,m,_,b,T,I,P,D,O){const N=b?Math.min(oo,Math.round(b[0])):0,V=b?Math.min(oo,Math.round(b[1])):0;i.emplaceBack(e,r,Math.round(32*l),Math.round(32*d),m,_,(N<<1)+(T?1:0),V,16*I,16*P,256*D,256*O)}function op(i,e,r){i.emplaceBack(e.x,e.y,r),i.emplaceBack(e.x,e.y,r),i.emplaceBack(e.x,e.y,r),i.emplaceBack(e.x,e.y,r)}function Cb(i){for(const e of i.sections)if(Fu(e.text))return!0;return!1}class ap{constructor(e){this.layoutVertexArray=new Mr,this.indexArray=new Gn,this.programConfigurations=e,this.segments=new ni,this.dynamicLayoutVertexArray=new vr,this.opacityVertexArray=new zr,this.placedSymbolArray=new Le}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,l,d){this.isEmpty()||(l&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,J0.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Y0.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Ab,!0),this.opacityVertexBuffer.itemSize=1),(l||d)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}mt("SymbolBuffers",ap);class lp{constructor(e,r,l){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new l,this.segments=new ni,this.collisionVertexArray=new ur}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Q0.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}mt("CollisionBuffers",lp);class nl{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(_=>_.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ud([]),this.placementViewportMatrix=Ud([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=rg(this.zoom,r["text-size"]),this.iconSizeData=rg(this.zoom,r["icon-size"]);const l=this.layers[0].layout,d=l.get("symbol-sort-key"),m=l.get("symbol-z-order");this.canOverlap=up(l,"text-overlap","text-allow-overlap")!=="never"||up(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(_=>a.WritingMode[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=e.sourceID}createArrays(){this.text=new ap(new Ho(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new ap(new Ho(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Ye,this.lineVertexArray=new dt,this.symbolInstances=new at}calculateGlyphDependencies(e,r,l,d,m){for(let _=0;_<e.length;_++)if(r[e.charCodeAt(_)]=!0,(l||d)&&m){const b=bc[e.charAt(_)];b&&(r[b.charCodeAt(0)]=!0)}}populate(e,r,l){const d=this.layers[0],m=d.layout,_=m.get("text-font"),b=m.get("text-field"),T=m.get("icon-image"),I=(b.value.kind!=="constant"||b.value.value instanceof te&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),P=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,D=m.get("symbol-sort-key");if(this.features=[],!I&&!P)return;const O=r.iconDependencies,N=r.glyphDependencies,V=r.availableImages,Y=new Gi(this.zoom);for(const{feature:J,id:ce,index:me,sourceLayerIndex:ae}of e){const pe=d._featureFilter.needGeometry,Ae=Ko(J,pe);if(!d._featureFilter.filter(Y,Ae,l))continue;let Se,pt;if(pe||(Ae.geometry=Xo(J)),I){const rt=d.getValueAndResolveTokens("text-field",Ae,l,V),Qe=te.factory(rt);Cb(Qe)&&(this.hasRTLText=!0),(!this.hasRTLText||Go()==="unavailable"||this.hasRTLText&&cr.isParsed())&&(Se=tb(Qe,d,Ae))}if(P){const rt=d.getValueAndResolveTokens("icon-image",Ae,l,V);pt=rt instanceof se?rt:se.fromString(rt)}if(!Se&&!pt)continue;const xt=this.sortFeaturesByKey?D.evaluate(Ae,{},l):void 0;if(this.features.push({id:ce,text:Se,icon:pt,index:me,sourceLayerIndex:ae,geometry:Ae.geometry,properties:J.properties,type:Ib[J.type],sortKey:xt}),pt&&(O[pt.name]=!0),Se){const rt=_.evaluate(Ae,{},l).join(","),Qe=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.WritingMode.vertical)>=0;for(const Ze of Se.sections)if(Ze.image)O[Ze.image.name]=!0;else{const st=Ga(Se.toString()),et=Ze.fontStack||rt,Fe=N[et]=N[et]||{};this.calculateGlyphDependencies(Ze.text,Fe,Qe,this.allowVerticalPlacement,st)}}}m.get("symbol-placement")==="line"&&(this.features=function(J){const ce={},me={},ae=[];let pe=0;function Ae(rt){ae.push(J[rt]),pe++}function Se(rt,Qe,Ze){const st=me[rt];return delete me[rt],me[Qe]=st,ae[st].geometry[0].pop(),ae[st].geometry[0]=ae[st].geometry[0].concat(Ze[0]),st}function pt(rt,Qe,Ze){const st=ce[Qe];return delete ce[Qe],ce[rt]=st,ae[st].geometry[0].shift(),ae[st].geometry[0]=Ze[0].concat(ae[st].geometry[0]),st}function xt(rt,Qe,Ze){const st=Ze?Qe[0][Qe[0].length-1]:Qe[0][0];return`${rt}:${st.x}:${st.y}`}for(let rt=0;rt<J.length;rt++){const Qe=J[rt],Ze=Qe.geometry,st=Qe.text?Qe.text.toString():null;if(!st){Ae(rt);continue}const et=xt(st,Ze),Fe=xt(st,Ze,!0);if(et in me&&Fe in ce&&me[et]!==ce[Fe]){const kt=pt(et,Fe,Ze),Et=Se(et,Fe,ae[kt].geometry);delete ce[et],delete me[Fe],me[xt(st,ae[Et].geometry,!0)]=Et,ae[kt].geometry=null}else et in me?Se(et,Fe,Ze):Fe in ce?pt(et,Fe,Ze):(Ae(rt),ce[et]=pe-1,me[Fe]=pe-1)}return ae.filter(rt=>rt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((J,ce)=>J.sortKey-ce.sortKey)}update(e,r,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,l),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const l=this.lineVertexArray.length;if(e.segment!==void 0){let d=e.dist(r[e.segment+1]),m=e.dist(r[e.segment]);const _={};for(let b=e.segment+1;b<r.length;b++)_[b]={x:r[b].x,y:r[b].y,tileUnitDistanceFromAnchor:d},b<r.length-1&&(d+=r[b+1].dist(r[b]));for(let b=e.segment||0;b>=0;b--)_[b]={x:r[b].x,y:r[b].y,tileUnitDistanceFromAnchor:m},b>0&&(m+=r[b-1].dist(r[b]));for(let b=0;b<r.length;b++){const T=_[b];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(e,r,l,d,m,_,b,T,I,P,D,O){const N=e.indexArray,V=e.layoutVertexArray,Y=e.segments.prepareSegment(4*r.length,V,N,this.canOverlap?_.sortKey:void 0),J=this.glyphOffsetArray.length,ce=Y.vertexLength,me=this.allowVerticalPlacement&&b===a.WritingMode.vertical?Math.PI/2:0,ae=_.text&&_.text.sections;for(let pe=0;pe<r.length;pe++){const{tl:Ae,tr:Se,bl:pt,br:xt,tex:rt,pixelOffsetTL:Qe,pixelOffsetBR:Ze,minFontScaleX:st,minFontScaleY:et,glyphOffset:Fe,isSDF:kt,sectionIndex:Et}=r[pe],ei=Y.vertexLength,$i=Fe[1];ch(V,T.x,T.y,Ae.x,$i+Ae.y,rt.x,rt.y,l,kt,Qe.x,Qe.y,st,et),ch(V,T.x,T.y,Se.x,$i+Se.y,rt.x+rt.w,rt.y,l,kt,Ze.x,Qe.y,st,et),ch(V,T.x,T.y,pt.x,$i+pt.y,rt.x,rt.y+rt.h,l,kt,Qe.x,Ze.y,st,et),ch(V,T.x,T.y,xt.x,$i+xt.y,rt.x+rt.w,rt.y+rt.h,l,kt,Ze.x,Ze.y,st,et),op(e.dynamicLayoutVertexArray,T,me),N.emplaceBack(ei,ei+1,ei+2),N.emplaceBack(ei+1,ei+2,ei+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Fe[0]),pe!==r.length-1&&Et===r[pe+1].sectionIndex||e.programConfigurations.populatePaintArrays(V.length,_,_.index,{},O,ae&&ae[Et])}e.placedSymbolArray.emplaceBack(T.x,T.y,J,this.glyphOffsetArray.length-J,ce,I,P,T.segment,l?l[0]:0,l?l[1]:0,d[0],d[1],b,0,!1,0,D)}_addCollisionDebugVertex(e,r,l,d,m,_){return r.emplaceBack(0,0),e.emplaceBack(l.x,l.y,d,m,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(e,r,l,d,m,_,b){const T=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),I=T.vertexLength,P=m.layoutVertexArray,D=m.collisionVertexArray,O=b.anchorX,N=b.anchorY;this._addCollisionDebugVertex(P,D,_,O,N,new We(e,r)),this._addCollisionDebugVertex(P,D,_,O,N,new We(l,r)),this._addCollisionDebugVertex(P,D,_,O,N,new We(l,d)),this._addCollisionDebugVertex(P,D,_,O,N,new We(e,d)),T.vertexLength+=4;const V=m.indexArray;V.emplaceBack(I,I+1),V.emplaceBack(I+1,I+2),V.emplaceBack(I+2,I+3),V.emplaceBack(I+3,I),T.primitiveLength+=4}addDebugCollisionBoxes(e,r,l,d){for(let m=e;m<r;m++){const _=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,d?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new lp(ss,qm.members,Ur),this.iconCollisionBox=new lp(ss,qm.members,Ur);for(let e=0;e<this.symbolInstances.length;e++){const r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,l,d,m,_,b,T,I){const P={};for(let D=r;D<l;D++){const O=e.get(D);P.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.textFeatureIndex=O.featureIndex;break}for(let D=d;D<m;D++){const O=e.get(D);P.verticalTextBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.verticalTextFeatureIndex=O.featureIndex;break}for(let D=_;D<b;D++){const O=e.get(D);P.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.iconFeatureIndex=O.featureIndex;break}for(let D=T;D<I;D++){const O=e.get(D);P.verticalIconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.verticalIconFeatureIndex=O.featureIndex;break}return P}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const l=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const l=e.placedSymbolArray.get(r),d=l.vertexStartIndex+4*l.numGlyphs;for(let m=l.vertexStartIndex;m<d;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(e),l=Math.cos(e),d=[],m=[],_=[];for(let b=0;b<this.symbolInstances.length;++b){_.push(b);const T=this.symbolInstances.get(b);d.push(0|Math.round(r*T.anchorX+l*T.anchorY)),m.push(T.featureIndex)}return _.sort((b,T)=>d[b]-d[T]||m[T]-m[b]),_}addToSortKeyRanges(e,r){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===r?l.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const l=this.symbolInstances.get(r);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((d,m,_)=>{d>=0&&_.indexOf(d)===m&&this.addIndicesForPlacedSymbol(this.text,d)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}mt("SymbolBucket",nl,{omit:["layers","collisionBoxArray","features","compareText"]}),nl.MAX_GLYPHS=65535,nl.addDynamicAttributes=op;const kb=new Tn({"symbol-placement":new Tt(he.layout_symbol["symbol-placement"]),"symbol-spacing":new Tt(he.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Tt(he.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Mt(he.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Tt(he.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Tt(he.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Tt(he.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Tt(he.layout_symbol["icon-ignore-placement"]),"icon-optional":new Tt(he.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Tt(he.layout_symbol["icon-rotation-alignment"]),"icon-size":new Mt(he.layout_symbol["icon-size"]),"icon-text-fit":new Tt(he.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Tt(he.layout_symbol["icon-text-fit-padding"]),"icon-image":new Mt(he.layout_symbol["icon-image"]),"icon-rotate":new Mt(he.layout_symbol["icon-rotate"]),"icon-padding":new Mt(he.layout_symbol["icon-padding"]),"icon-keep-upright":new Tt(he.layout_symbol["icon-keep-upright"]),"icon-offset":new Mt(he.layout_symbol["icon-offset"]),"icon-anchor":new Mt(he.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Tt(he.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Tt(he.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Tt(he.layout_symbol["text-rotation-alignment"]),"text-field":new Mt(he.layout_symbol["text-field"]),"text-font":new Mt(he.layout_symbol["text-font"]),"text-size":new Mt(he.layout_symbol["text-size"]),"text-max-width":new Mt(he.layout_symbol["text-max-width"]),"text-line-height":new Tt(he.layout_symbol["text-line-height"]),"text-letter-spacing":new Mt(he.layout_symbol["text-letter-spacing"]),"text-justify":new Mt(he.layout_symbol["text-justify"]),"text-radial-offset":new Mt(he.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Tt(he.layout_symbol["text-variable-anchor"]),"text-anchor":new Mt(he.layout_symbol["text-anchor"]),"text-max-angle":new Tt(he.layout_symbol["text-max-angle"]),"text-writing-mode":new Tt(he.layout_symbol["text-writing-mode"]),"text-rotate":new Mt(he.layout_symbol["text-rotate"]),"text-padding":new Tt(he.layout_symbol["text-padding"]),"text-keep-upright":new Tt(he.layout_symbol["text-keep-upright"]),"text-transform":new Mt(he.layout_symbol["text-transform"]),"text-offset":new Mt(he.layout_symbol["text-offset"]),"text-allow-overlap":new Tt(he.layout_symbol["text-allow-overlap"]),"text-overlap":new Tt(he.layout_symbol["text-overlap"]),"text-ignore-placement":new Tt(he.layout_symbol["text-ignore-placement"]),"text-optional":new Tt(he.layout_symbol["text-optional"])});var cp={paint:new Tn({"icon-opacity":new Mt(he.paint_symbol["icon-opacity"]),"icon-color":new Mt(he.paint_symbol["icon-color"]),"icon-halo-color":new Mt(he.paint_symbol["icon-halo-color"]),"icon-halo-width":new Mt(he.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Mt(he.paint_symbol["icon-halo-blur"]),"icon-translate":new Tt(he.paint_symbol["icon-translate"]),"icon-translate-anchor":new Tt(he.paint_symbol["icon-translate-anchor"]),"text-opacity":new Mt(he.paint_symbol["text-opacity"]),"text-color":new Mt(he.paint_symbol["text-color"],{runtimeType:wn,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Mt(he.paint_symbol["text-halo-color"]),"text-halo-width":new Mt(he.paint_symbol["text-halo-width"]),"text-halo-blur":new Mt(he.paint_symbol["text-halo-blur"]),"text-translate":new Tt(he.paint_symbol["text-translate"]),"text-translate-anchor":new Tt(he.paint_symbol["text-translate-anchor"])}),layout:kb};class gg{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:_r,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}mt("FormatSectionOverride",gg,{omit:["defaultValue"]});class uh extends Pr{constructor(e){super(e,cp)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const d=[];for(const m of l)d.indexOf(m)<0&&d.push(m);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,l,d){const m=this.layout.get(e).evaluate(r,{},l,d),_=this._unevaluatedLayout._values[e];return _.isDataDriven()||zo(_.value)||!m?m:function(b,T){return T.replace(/{([^{}]+)}/g,(I,P)=>P in b?String(b[P]):"")}(r.properties,m)}createBucket(e){return new nl(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of cp.paint.overridableProperties){if(!uh.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),l=new gg(r),d=new $a(l,r.property.specification);let m=null;m=r.value.kind==="constant"||r.value.kind==="source"?new Ro("source",d):new Xl("composite",d,r.value.zoomStops),this.paint._values[e]=new kr(r.property,m,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,l){return!(!this.layout||r.isDataDriven()||l.isDataDriven())&&uh.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const l=e.get("text-field"),d=cp.paint.properties[r];let m=!1;const _=b=>{for(const T of b)if(d.overrides&&d.overrides.hasOverride(T))return void(m=!0)};if(l.value.kind==="constant"&&l.value.value instanceof te)_(l.value.value.sections);else if(l.value.kind==="source"){const b=I=>{m||(I instanceof wt&&ge(I.value)===fn?_(I.value.sections):I instanceof Ba?_(I.sections):I.eachChild(b))},T=l.value;T._styleExpression&&b(T._styleExpression.expression)}return m}}function up(i,e,r){let l="never";const d=i.get(e);return d?l=d:i.get(r)&&(l="always"),l}var Pb={paint:new Tn({"background-color":new Tt(he.paint_background["background-color"]),"background-pattern":new ac(he.paint_background["background-pattern"]),"background-opacity":new Tt(he.paint_background["background-opacity"])})},Mb={paint:new Tn({"raster-opacity":new Tt(he.paint_raster["raster-opacity"]),"raster-hue-rotate":new Tt(he.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Tt(he.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Tt(he.paint_raster["raster-brightness-max"]),"raster-saturation":new Tt(he.paint_raster["raster-saturation"]),"raster-contrast":new Tt(he.paint_raster["raster-contrast"]),"raster-resampling":new Tt(he.paint_raster["raster-resampling"]),"raster-fade-duration":new Tt(he.paint_raster["raster-fade-duration"])})};class zb extends Pr{constructor(e){super(e,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const Db={circle:class extends Pr{constructor(i){super(i,u0)}createBucket(i){return new Bd(i)}queryRadius(i){const e=i;return dc("circle-radius",this,e)+dc("circle-stroke-width",this,e)+Zu(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,r,l,d,m,_,b){const T=Hu(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,_),I=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r),P=this.paint.get("circle-pitch-alignment")==="map",D=P?T:function(N,V){return N.map(Y=>Am(Y,V))}(T,b),O=P?I*_:I;for(const N of l)for(const V of N){const Y=P?V:Am(V,b);let J=O;const ce=Xu([],[V.x,V.y,0,1],b);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?J*=ce[3]/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(J*=m.cameraToCenterDistance/ce[3]),s0(D,Y,J))return!0}return!1}},heatmap:class extends Pr{constructor(i){super(i,d0),this._updateColorRamp()}createBucket(i){return new Cm(i)}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Pm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Pr{constructor(i){super(i,p0)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Pr{constructor(i){super(i,k0)}recalculate(i,e){super.recalculate(i,e);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Xd(i)}queryRadius(){return Zu(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,r,l,d,m,_){return vm(Hu(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,_),l)}isTileClipped(){return!0}},"fill-extrusion":class extends Pr{constructor(i){super(i,j0)}createBucket(i){return new Jd(i)}queryRadius(){return Zu(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(i,e,r,l,d,m,_,b){const T=Hu(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,_),I=this.paint.get("fill-extrusion-height").evaluate(e,r),P=this.paint.get("fill-extrusion-base").evaluate(e,r),D=function(N,V,Y,J){const ce=[];for(const me of N){const ae=[me.x,me.y,0,1];Xu(ae,ae,V),ce.push(new We(ae[0]/ae[3],ae[1]/ae[3]))}return ce}(T,b),O=function(N,V,Y,J){const ce=[],me=[],ae=J[8]*V,pe=J[9]*V,Ae=J[10]*V,Se=J[11]*V,pt=J[8]*Y,xt=J[9]*Y,rt=J[10]*Y,Qe=J[11]*Y;for(const Ze of N){const st=[],et=[];for(const Fe of Ze){const kt=Fe.x,Et=Fe.y,ei=J[0]*kt+J[4]*Et+J[12],$i=J[1]*kt+J[5]*Et+J[13],Zi=J[2]*kt+J[6]*Et+J[14],dn=J[3]*kt+J[7]*Et+J[15],wr=Zi+Ae,kn=dn+Se,sn=ei+pt,vn=$i+xt,Pn=Zi+rt,Un=dn+Qe,er=new We((ei+ae)/kn,($i+pe)/kn);er.z=wr/kn,st.push(er);const on=new We(sn/Un,vn/Un);on.z=Pn/Un,et.push(on)}ce.push(st),me.push(et)}return[ce,me]}(l,P,I,b);return function(N,V,Y){let J=1/0;vm(Y,V)&&(J=$m(Y,V[0]));for(let ce=0;ce<V.length;ce++){const me=V[ce],ae=N[ce];for(let pe=0;pe<me.length-1;pe++){const Ae=me[pe],Se=[Ae,me[pe+1],ae[pe+1],ae[pe],Ae];ym(Y,Se)&&(J=Math.min(J,$m(Y,Se)))}}return J!==1/0&&J}(O[0],O[1],D)}},line:class extends Pr{constructor(i){super(i,Nm),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ao,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=Vm.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Yd(i)}queryRadius(i){const e=i,r=jm(dc("line-width",this,e),dc("line-gap-width",this,e)),l=dc("line-offset",this,e);return r/2+Math.abs(l)+Zu(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,r,l,d,m,_){const b=Hu(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,_),T=_/2*jm(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),I=this.paint.get("line-offset").evaluate(e,r);return I&&(l=function(P,D){const O=[];for(let N=0;N<P.length;N++){const V=P[N],Y=[];for(let J=0;J<V.length;J++){const ce=V[J-1],me=V[J],ae=V[J+1],pe=J===0?new We(0,0):me.sub(ce)._unit()._perp(),Ae=J===V.length-1?new We(0,0):ae.sub(me)._unit()._perp(),Se=pe._add(Ae)._unit(),pt=Se.x*Ae.x+Se.y*Ae.y;pt!==0&&Se._mult(1/pt),Y.push(Se._mult(D)._add(me))}O.push(Y)}return O}(l,I*_)),function(P,D,O){for(let N=0;N<D.length;N++){const V=D[N];if(P.length>=3){for(let Y=0;Y<V.length;Y++)if(Ka(P,V[Y]))return!0}if(o0(P,V,O))return!0}return!1}(b,l,T)}isTileClipped(){return!0}},symbol:uh,background:class extends Pr{constructor(i){super(i,Pb)}},raster:class extends Pr{constructor(i){super(i,Mb)}}};class Rb{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const _g=63710088e-1;class Ki{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ki(le(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,l=this.lat*r,d=e.lat*r,m=Math.sin(l)*Math.sin(d)+Math.cos(l)*Math.cos(d)*Math.cos((e.lng-this.lng)*r);return _g*Math.acos(Math.min(m,1))}toBounds(e=0){const r=360*e/40075017,l=r/Math.cos(Math.PI/180*this.lat);return new Yo(new Ki(this.lng-l,this.lat-r),new Ki(this.lng+l,this.lat+r))}static convert(e){if(e instanceof Ki)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Ki(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Ki(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Yo{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Ki?new Ki(e.lng,e.lat):Ki.convert(e),this}setSouthWest(e){return this._sw=e instanceof Ki?new Ki(e.lng,e.lat):Ki.convert(e),this}extend(e){const r=this._sw,l=this._ne;let d,m;if(e instanceof Ki)d=e,m=e;else{if(!(e instanceof Yo))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Yo.convert(e)):this.extend(Ki.convert(e)):this;if(d=e._sw,m=e._ne,!d||!m)return this}return r||l?(r.lng=Math.min(d.lng,r.lng),r.lat=Math.min(d.lat,r.lat),l.lng=Math.max(m.lng,l.lng),l.lat=Math.max(m.lat,l.lat)):(this._sw=new Ki(d.lng,d.lat),this._ne=new Ki(m.lng,m.lat)),this}getCenter(){return new Ki((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ki(this.getWest(),this.getNorth())}getSouthEast(){return new Ki(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:l}=Ki.convert(e);let d=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&d}static convert(e){return e instanceof Yo?e:e&&new Yo(e)}}const yg=2*Math.PI*_g;function vg(i){return yg*Math.cos(i*Math.PI/180)}function xg(i){return(180+i)/360}function bg(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function wg(i,e){return i/vg(e)}function hp(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class hh{constructor(e,r,l=0){this.x=+e,this.y=+r,this.z=+l}static fromLngLat(e,r=0){const l=Ki.convert(e);return new hh(xg(l.lng),bg(l.lat),wg(r,l.lat))}toLngLat(){return new Ki(360*this.x-180,hp(this.y))}toAltitude(){return this.z*vg(hp(this.y))}meterInMercatorCoordinateUnits(){return 1/yg*(e=hp(this.y),1/Math.cos(e*Math.PI/180));var e}}function Tg(i,e,r){var l=2*Math.PI*6378137/256/Math.pow(2,r);return[i*l-2*Math.PI*6378137/2,e*l-2*Math.PI*6378137/2]}class dp{constructor(e,r,l){if(e<0||e>25||l<0||l>=Math.pow(2,e)||r<0||r>=Math.pow(2,e))throw new Error(`x=${r}, y=${l}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=r,this.y=l,this.key=Tc(0,e,e,r,l)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,l){const d=(_=this.y,b=this.z,T=Tg(256*(m=this.x),256*(_=Math.pow(2,b)-_-1),b),I=Tg(256*(m+1),256*(_+1),b),T[0]+","+T[1]+","+I[0]+","+I[1]);var m,_,b,T,I;const P=function(D,O,N){let V,Y="";for(let J=D;J>0;J--)V=1<<J-1,Y+=(O&V?1:0)+(N&V?2:0);return Y}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,d)}isChildOf(e){const r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){const r=Math.pow(2,this.z);return new We((e.x*r-this.x)*hn,(e.y*r-this.y)*hn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Eg{constructor(e,r){this.wrap=e,this.canonical=r,this.key=Tc(e,r.z,r.z,r.x,r.y)}}class br{constructor(e,r,l,d,m){if(e<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${l}`);this.overscaledZ=e,this.wrap=r,this.canonical=new dp(l,+d,+m),this.key=Tc(r,e,l,d,m)}clone(){return new br(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-e;return e>this.canonical.z?new br(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new br(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-e;return e>this.canonical.z?Tc(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):Tc(this.wrap*+r,e,e,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new br(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,l=2*this.canonical.x,d=2*this.canonical.y;return[new br(r,this.wrap,r,l,d),new br(r,this.wrap,r,l+1,d),new br(r,this.wrap,r,l,d+1),new br(r,this.wrap,r,l+1,d+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new br(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new br(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Eg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new hh(e.x-this.wrap,e.y))}}function Tc(i,e,r,l,d){(i*=2)<0&&(i=-1*i-1);const m=1<<r;return(m*m*i+m*d+l).toString(36)+r.toString(36)+e.toString(36)}mt("CanonicalTileID",dp),mt("OverscaledTileID",br,{omit:["posMatrix"]});class Sg{constructor(e,r,l){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return void Ce(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const d=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=l||"mapbox";for(let m=0;m<d;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(d,m)]=this.data[this._idx(d-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,d)]=this.data[this._idx(m,d-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(d,-1)]=this.data[this._idx(d-1,0)],this.data[this._idx(-1,d)]=this.data[this._idx(0,d-1)],this.data[this._idx(d,d)]=this.data[this._idx(d-1,d-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let m=0;m<d;m++)for(let _=0;_<d;_++){const b=this.get(m,_);b>this.max&&(this.max=b),b<this.min&&(this.min=b)}}get(e,r){const l=new Uint8Array(this.data.buffer),d=4*this._idx(e,r);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(l[d],l[d+1],l[d+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}_unpackMapbox(e,r,l){return(256*e*256+256*r+l)/10-1e4}_unpackTerrarium(e,r,l){return 256*e+r+l/256-32768}getPixels(){return new xr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,l){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let d=r*this.dim,m=r*this.dim+this.dim,_=l*this.dim,b=l*this.dim+this.dim;switch(r){case-1:d=m-1;break;case 1:m=d+1}switch(l){case-1:_=b-1;break;case 1:b=_+1}const T=-r*this.dim,I=-l*this.dim;for(let P=_;P<b;P++)for(let D=d;D<m;D++)this.data[this._idx(D,P)]=e.data[this._idx(D+T,P+I)]}}mt("DEMData",Sg);class Ig{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const l=e[r];this._stringToNumber[l]=r,this._numberToString[r]=l}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Ag{constructor(e,r,l,d,m){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=l,e._y=d,this.properties=e.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(e[r]=this[r]);return e}}class Cg{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new qo(hn,16,0),this.grid3D=new qo(hn,16,0),this.featureIndexArray=new Qt,this.promoteId=r}insert(e,r,l,d,m,_){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,d,m);const T=_?this.grid3D:this.grid;for(let I=0;I<r.length;I++){const P=r[I],D=[1/0,1/0,-1/0,-1/0];for(let O=0;O<P.length;O++){const N=P[O];D[0]=Math.min(D[0],N.x),D[1]=Math.min(D[1],N.y),D[2]=Math.max(D[2],N.x),D[3]=Math.max(D[3],N.y)}D[0]<hn&&D[1]<hn&&D[2]>=0&&D[3]>=0&&T.insert(b,D[0],D[1],D[2],D[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new no.VectorTile(new Qd(this.rawTileData)).layers,this.sourceLayerCoder=new Ig(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,l,d){this.loadVTLayers();const m=e.params||{},_=hn/e.tileSize/e.scale,b=Va(m.filter),T=e.queryGeometry,I=e.queryPadding*_,P=Pg(T),D=this.grid.query(P.minX-I,P.minY-I,P.maxX+I,P.maxY+I),O=Pg(e.cameraQueryGeometry),N=this.grid3D.query(O.minX-I,O.minY-I,O.maxX+I,O.maxY+I,(J,ce,me,ae)=>function(pe,Ae,Se,pt,xt){for(const Qe of pe)if(Ae<=Qe.x&&Se<=Qe.y&&pt>=Qe.x&&xt>=Qe.y)return!0;const rt=[new We(Ae,Se),new We(Ae,xt),new We(pt,xt),new We(pt,Se)];if(pe.length>2){for(const Qe of rt)if(Ka(pe,Qe))return!0}for(let Qe=0;Qe<pe.length-1;Qe++)if(l0(pe[Qe],pe[Qe+1],rt))return!0;return!1}(e.cameraQueryGeometry,J-I,ce-I,me+I,ae+I));for(const J of N)D.push(J);D.sort(Lb);const V={};let Y;for(let J=0;J<D.length;J++){const ce=D[J];if(ce===Y)continue;Y=ce;const me=this.featureIndexArray.get(ce);let ae=null;this.loadMatchingFeature(V,me.bucketIndex,me.sourceLayerIndex,me.featureIndex,b,m.layers,m.availableImages,r,l,d,(pe,Ae,Se)=>(ae||(ae=Xo(pe)),Ae.queryIntersectsFeature(T,pe,Se,ae,this.z,e.transform,_,e.pixelPosMatrix)))}return V}loadMatchingFeature(e,r,l,d,m,_,b,T,I,P,D){const O=this.bucketLayerIDs[r];if(_&&!function(J,ce){for(let me=0;me<J.length;me++)if(ce.indexOf(J[me])>=0)return!0;return!1}(_,O))return;const N=this.sourceLayerCoder.decode(l),V=this.vtLayers[N].feature(d);if(m.needGeometry){const J=Ko(V,!0);if(!m.filter(new Gi(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!m.filter(new Gi(this.tileID.overscaledZ),V))return;const Y=this.getId(V,N);for(let J=0;J<O.length;J++){const ce=O[J];if(_&&_.indexOf(ce)<0)continue;const me=T[ce];if(!me)continue;let ae={};Y&&P&&(ae=P.getState(me.sourceLayer||"_geojsonTileLayer",Y));const pe=Ee({},I[ce]);pe.paint=kg(pe.paint,me.paint,V,ae,b),pe.layout=kg(pe.layout,me.layout,V,ae,b);const Ae=!D||D(V,me,ae);if(!Ae)continue;const Se=new Ag(V,this.z,this.x,this.y,Y);Se.layer=pe;let pt=e[ce];pt===void 0&&(pt=e[ce]=[]),pt.push({featureIndex:d,feature:Se,intersectionZ:Ae})}}lookupSymbolFeatures(e,r,l,d,m,_,b,T){const I={};this.loadVTLayers();const P=Va(m);for(const D of e)this.loadMatchingFeature(I,l,d,D,P,_,b,T,r);return I}hasLayer(e){for(const r of this.bucketLayerIDs)for(const l of r)if(e===l)return!0;return!1}getId(e,r){let l=e.id;return this.promoteId&&(l=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof l=="boolean"&&(l=Number(l))),l}}function kg(i,e,r,l,d){return He(i,(m,_)=>{const b=e instanceof Zo?e.get(_):null;return b&&b.evaluate?b.evaluate(r,l,d):b})}function Pg(i){let e=1/0,r=1/0,l=-1/0,d=-1/0;for(const m of i)e=Math.min(e,m.x),r=Math.min(r,m.y),l=Math.max(l,m.x),d=Math.max(d,m.y);return{minX:e,minY:r,maxX:l,maxY:d}}function Lb(i,e){return e-i}var pp;mt("FeatureIndex",Cg,{omit:["rawTileData","sourceLayerCoder"]}),a.PerformanceMarkers=void 0,(pp=a.PerformanceMarkers||(a.PerformanceMarkers={})).create="create",pp.load="load",pp.fullLoad="fullLoad";let dh=null,Ec=[];const fp=1e3/30,Ob={mark(i){performance.mark(i)},frame(i){const e=i;dh!=null&&Ec.push(e-dh),dh=e},clearMetrics(){dh=null,Ec=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const i in a.PerformanceMarkers)performance.clearMarks(a.PerformanceMarkers[i])},getPerformanceMetrics(){performance.measure("loadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.load),performance.measure("fullLoadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.fullLoad);const i=performance.getEntriesByName("loadTime")[0].duration,e=performance.getEntriesByName("fullLoadTime")[0].duration,r=Ec.length,l=1/(Ec.reduce((m,_)=>m+_,0)/r/1e3),d=Ec.filter(m=>m>fp).reduce((m,_)=>m+(_-fp)/fp,0);return{loadTime:i,fullLoadTime:e,fps:l,percentDroppedFrames:d/(r+d)*100}}};a.AJAXError=ri,a.ARRAY_TYPE=Zn,a.Actor=class{constructor(i,e,r){this.target=i,this.parent=e,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Je(["receive","process"],this),this.invoker=new Rb(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ht()?i:window}send(i,e,r,l,d=!1){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[m]=r);const _=Rt(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:i,hasCallback:!!r,targetMapId:l,mustQueue:d,sourceMapId:this.mapId,data:bs(e,_)},_),{cancel:()=>{r&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(i){const e=i.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){delete this.tasks[r];const l=this.cancelCallbacks[r];delete this.cancelCallbacks[r],l&&l()}else ht()||e.mustQueue?(this.tasks[r]=e,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,e)}process(){if(!this.taskQueue.length)return;const i=this.taskQueue.shift(),e=this.tasks[i];delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(i,e)}processTask(i,e){if(e.type==="<response>"){const r=this.callbacks[i];delete this.callbacks[i],r&&(e.error?r(es(e.error)):r(null,es(e.data)))}else{let r=!1;const l=Rt(this.globalScope)?void 0:[],d=e.hasCallback?(b,T)=>{r=!0,delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:b?bs(b):null,data:bs(T,l)},l)}:b=>{r=!0};let m=null;const _=es(e.data);if(this.parent[e.type])m=this.parent[e.type](e.sourceMapId,_,d);else if(this.parent.getWorkerSource){const b=e.type.split(".");m=this.parent.getWorkerSource(e.sourceMapId,b[0],_.source)[b[1]](_,d)}else d(new Error(`Could not find function ${e.type}`));!r&&m&&m.cancel&&(this.cancelCallbacks[i]=m.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.AlphaImage=fc,a.CanonicalTileID=dp,a.CollisionBoxArray=xe,a.CollisionCircleLayoutArray=class extends z{},a.Color=q,a.DEMData=Sg,a.DataConstantProperty=Tt,a.DictionaryCoder=Ig,a.EXTENT=hn,a.ErrorEvent=At,a.EvaluationParameters=Gi,a.Event=yt,a.Evented=Lt,a.FeatureIndex=Cg,a.FillBucket=Xd,a.FillExtrusionBucket=Jd,a.GeoJSONFeature=Ag,a.ImageAtlas=Ym,a.ImagePosition=tp,a.LineBucket=Yd,a.LineStripIndexArray=class extends K{},a.LngLat=Ki,a.LngLatBounds=Yo,a.MercatorCoordinate=hh,a.ONE_EM=En,a.OverscaledTileID=br,a.PerformanceUtils=Ob,a.PosArray=Ct,a.Properties=Tn,a.QuadTriangleArray=class extends U{},a.RGBAImage=xr,a.RasterBoundsArray=class extends h{},a.RequestPerformance=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},a.ResourceType=Ft,a.SegmentVector=ni,a.SymbolBucket=nl,a.Transitionable=Nu,a.TriangleIndexArray=Gn,a.Uniform1f=Ss,a.Uniform1i=class extends Es{constructor(i,e){super(i,e),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},a.Uniform2f=class extends Es{constructor(i,e){super(i,e),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},a.Uniform3f=class extends Es{constructor(i,e){super(i,e),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},a.Uniform4f=Ha,a.UniformColor=fm,a.UniformMatrix4f=class extends Es{constructor(i,e){super(i,e),this.current=n0}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let e=1;e<16;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},a.UnwrappedTileID=Eg,a.ValidationError=Pe,a.ZoomHistory=Ql,a.add=function(i,e,r){return i[0]=e[0]+r[0],i[1]=e[1]+r[1],i[2]=e[2]+r[2],i},a.addDynamicAttributes=op,a.asyncAll=function(i,e,r){if(!i.length)return r(null,[]);let l=i.length;const d=new Array(i.length);let m=null;i.forEach((_,b)=>{e(_,(T,I)=>{T&&(m=T),d[b]=I,--l==0&&r(m,d)})})},a.bezier=F,a.bindAll=Je,a.cacheEntryPossiblyAdded=function(i){Te++,Te>Fn&&(i.getActor().send("enforceCacheSizeLimit",Bn),Te=0)},a.clamp=M,a.clearTileCache=function(i){const e=caches.delete(Oi);i&&e.catch(i).then(()=>i())},a.clipLine=ug,a.clone=function(i){var e=new Zn(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},a.clone$1=tt,a.clone$2=function(i){var e=new Zn(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e},a.collisionCircleLayout=eb,a.config=Xt,a.copy=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},a.create=function(){var i=new Zn(16);return Zn!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},a.create$1=wm,a.createExpression=Do,a.createFilter=Va,a.createLayout=rn,a.createStyleLayer=function(i){return i.type==="custom"?new zb(i):new Db[i.type](i)},a.cross=function(i,e,r){var l=e[0],d=e[1],m=e[2],_=r[0],b=r[1],T=r[2];return i[0]=d*T-m*b,i[1]=m*_-l*T,i[2]=l*b-d*_,i},a.dot=function(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]},a.dot$1=function(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]*e[3]},a.ease=B,a.emitValidationErrors=qa,a.enforceCacheSizeLimit=function(i){pn(),Ni&&Ni.then(e=>{e.keys().then(r=>{for(let l=0;l<r.length-i;l++)e.delete(r[l])})})},a.equals=function(i,e){var r=i[0],l=i[1],d=i[2],m=i[3],_=i[4],b=i[5],T=i[6],I=i[7],P=i[8],D=i[9],O=i[10],N=i[11],V=i[12],Y=i[13],J=i[14],ce=i[15],me=e[0],ae=e[1],pe=e[2],Ae=e[3],Se=e[4],pt=e[5],xt=e[6],rt=e[7],Qe=e[8],Ze=e[9],st=e[10],et=e[11],Fe=e[12],kt=e[13],Et=e[14],ei=e[15];return Math.abs(r-me)<=Wn*Math.max(1,Math.abs(r),Math.abs(me))&&Math.abs(l-ae)<=Wn*Math.max(1,Math.abs(l),Math.abs(ae))&&Math.abs(d-pe)<=Wn*Math.max(1,Math.abs(d),Math.abs(pe))&&Math.abs(m-Ae)<=Wn*Math.max(1,Math.abs(m),Math.abs(Ae))&&Math.abs(_-Se)<=Wn*Math.max(1,Math.abs(_),Math.abs(Se))&&Math.abs(b-pt)<=Wn*Math.max(1,Math.abs(b),Math.abs(pt))&&Math.abs(T-xt)<=Wn*Math.max(1,Math.abs(T),Math.abs(xt))&&Math.abs(I-rt)<=Wn*Math.max(1,Math.abs(I),Math.abs(rt))&&Math.abs(P-Qe)<=Wn*Math.max(1,Math.abs(P),Math.abs(Qe))&&Math.abs(D-Ze)<=Wn*Math.max(1,Math.abs(D),Math.abs(Ze))&&Math.abs(O-st)<=Wn*Math.max(1,Math.abs(O),Math.abs(st))&&Math.abs(N-et)<=Wn*Math.max(1,Math.abs(N),Math.abs(et))&&Math.abs(V-Fe)<=Wn*Math.max(1,Math.abs(V),Math.abs(Fe))&&Math.abs(Y-kt)<=Wn*Math.max(1,Math.abs(Y),Math.abs(kt))&&Math.abs(J-Et)<=Wn*Math.max(1,Math.abs(J),Math.abs(Et))&&Math.abs(ce-ei)<=Wn*Math.max(1,Math.abs(ce),Math.abs(ei))},a.evaluateSizeForFeature=function(i,{uSize:e,uSizeT:r},{lowerSize:l,upperSize:d}){return i.kind==="source"?l/Cs:i.kind==="composite"?ji(l/Cs,d/Cs,r):e},a.evaluateSizeForZoom=function(i,e){let r=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:d,minZoom:m,maxZoom:_}=i,b=d?M(Jn.interpolationFactor(d,e,m,_),0,1):0;i.kind==="camera"?l=ji(i.minSize,i.maxSize,b):r=b}return{uSizeT:r,uSize:l}},a.evaluateVariableOffset=pg,a.evented=oc,a.exported=yi,a.exported$1=gt,a.extend=Ee,a.filterObject=De,a.fromRotation=function(i,e){var r=Math.sin(e),l=Math.cos(e);return i[0]=l,i[1]=r,i[2]=0,i[3]=-r,i[4]=l,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},a.fromScaling=function(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},a.getAnchorAlignment=np,a.getAnchorJustification=sp,a.getArrayBuffer=ze,a.getImage=qe,a.getJSON=function(i,e){return be(Ee(i,{type:"json"}),e)},a.getOverlapMode=up,a.getRTLTextPluginStatus=Go,a.getReferrer=X,a.getVideo=function(i,e){const r=window.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let l=0;l<i.length;l++){const d=window.document.createElement("source");ke(i[l])||(r.crossOrigin="Anonymous"),d.src=i[l],r.appendChild(d)}return{cancel:()=>{}}},a.identity=Ud,a.invert=function(i,e){var r=e[0],l=e[1],d=e[2],m=e[3],_=e[4],b=e[5],T=e[6],I=e[7],P=e[8],D=e[9],O=e[10],N=e[11],V=e[12],Y=e[13],J=e[14],ce=e[15],me=r*b-l*_,ae=r*T-d*_,pe=r*I-m*_,Ae=l*T-d*b,Se=l*I-m*b,pt=d*I-m*T,xt=P*Y-D*V,rt=P*J-O*V,Qe=P*ce-N*V,Ze=D*J-O*Y,st=D*ce-N*Y,et=O*ce-N*J,Fe=me*et-ae*st+pe*Ze+Ae*Qe-Se*rt+pt*xt;return Fe?(i[0]=(b*et-T*st+I*Ze)*(Fe=1/Fe),i[1]=(d*st-l*et-m*Ze)*Fe,i[2]=(Y*pt-J*Se+ce*Ae)*Fe,i[3]=(O*Se-D*pt-N*Ae)*Fe,i[4]=(T*Qe-_*et-I*rt)*Fe,i[5]=(r*et-d*Qe+m*rt)*Fe,i[6]=(J*pe-V*pt-ce*ae)*Fe,i[7]=(P*pt-O*pe+N*ae)*Fe,i[8]=(_*st-b*Qe+I*xt)*Fe,i[9]=(l*Qe-r*st-m*xt)*Fe,i[10]=(V*Se-Y*pe+ce*me)*Fe,i[11]=(D*pe-P*Se-N*me)*Fe,i[12]=(b*rt-_*Ze-T*xt)*Fe,i[13]=(r*Ze-l*rt+d*xt)*Fe,i[14]=(Y*ae-V*Ae-J*me)*Fe,i[15]=(P*Ae-D*ae+O*me)*Fe,i):null},a.isImageBitmap=ai,a.isSafari=Rt,a.isWorker=ht,a.keysDifference=function(i,e){const r=[];for(const l in i)l in e||r.push(l);return r},a.lazyLoadRTLTextPlugin=function(){cr.isLoading()||cr.isLoaded()||Go()!=="deferred"||Uu()},a.makeRequest=be,a.mapObject=He,a.mercatorXfromLng=xg,a.mercatorYfromLat=bg,a.mercatorZfromAltitude=wg,a.mul=h0,a.mul$1=function(i,e,r){return i[0]=e[0]*r[0],i[1]=e[1]*r[1],i[2]=e[2]*r[2],i[3]=e[3]*r[3],i},a.multiply=Tm,a.nextPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},a.normalize=function(i,e){var r=e[0],l=e[1],d=e[2],m=r*r+l*l+d*d;return m>0&&(m=1/Math.sqrt(m)),i[0]=e[0]*m,i[1]=e[1]*m,i[2]=e[2]*m,i},a.number=ji,a.ortho=function(i,e,r,l,d,m,_){var b=1/(e-r),T=1/(l-d),I=1/(m-_);return i[0]=-2*b,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*T,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*I,i[11]=0,i[12]=(e+r)*b,i[13]=(d+l)*T,i[14]=(_+m)*I,i[15]=1,i},a.parseCacheControl=it,a.parseGlyphPbf=function(i){return new Qd(i).readFields(hb,[])},a.pbf=Qd,a.performSymbolLayout=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=hn/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const e=i.bucket.layers[0].layout,r=i.bucket.layers[0]._unevaluatedLayout._values,l={layoutIconSize:r["icon-size"].possiblyEvaluate(new Gi(i.bucket.zoom+1),i.canonical),layoutTextSize:r["text-size"].possiblyEvaluate(new Gi(i.bucket.zoom+1),i.canonical),textMaxSize:r["text-size"].possiblyEvaluate(new Gi(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:T,maxZoom:I}=i.bucket.textSizeData;l.compositeTextSizes=[r["text-size"].possiblyEvaluate(new Gi(T),i.canonical),r["text-size"].possiblyEvaluate(new Gi(I),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:T,maxZoom:I}=i.bucket.iconSizeData;l.compositeIconSizes=[r["icon-size"].possiblyEvaluate(new Gi(T),i.canonical),r["icon-size"].possiblyEvaluate(new Gi(I),i.canonical)]}const d=e.get("text-line-height")*En,m=e.get("text-rotation-alignment")!=="viewport"&&e.get("symbol-placement")!=="point",_=e.get("text-keep-upright"),b=e.get("text-size");for(const T of i.bucket.features){const I=e.get("text-font").evaluate(T,{},i.canonical).join(","),P=b.evaluate(T,{},i.canonical),D=l.layoutTextSize.evaluate(T,{},i.canonical),O=l.layoutIconSize.evaluate(T,{},i.canonical),N={horizontal:{},vertical:void 0},V=T.text;let Y,J=[0,0];if(V){const ae=V.toString(),pe=e.get("text-letter-spacing").evaluate(T,{},i.canonical)*En,Ae=zd(ae)?pe:0,Se=e.get("text-anchor").evaluate(T,{},i.canonical),pt=e.get("text-variable-anchor");if(!pt){const st=e.get("text-radial-offset").evaluate(T,{},i.canonical);J=st?pg(Se,[st*En,rp]):e.get("text-offset").evaluate(T,{},i.canonical).map(et=>et*En)}let xt=m?"center":e.get("text-justify").evaluate(T,{},i.canonical);const rt=e.get("symbol-placement"),Qe=rt==="point"?e.get("text-max-width").evaluate(T,{},i.canonical)*En:0,Ze=()=>{i.bucket.allowVerticalPlacement&&Ga(ae)&&(N.vertical=nh(V,i.glyphMap,i.glyphPositions,i.imagePositions,I,Qe,d,Se,"left",Ae,J,a.WritingMode.vertical,!0,rt,D,P))};if(!m&&pt){const st=xt==="auto"?pt.map(Fe=>sp(Fe)):[xt];let et=!1;for(let Fe=0;Fe<st.length;Fe++){const kt=st[Fe];if(!N.horizontal[kt])if(et)N.horizontal[kt]=N.horizontal[0];else{const Et=nh(V,i.glyphMap,i.glyphPositions,i.imagePositions,I,Qe,d,"center",kt,Ae,J,a.WritingMode.horizontal,!1,rt,D,P);Et&&(N.horizontal[kt]=Et,et=Et.positionedLines.length===1)}}Ze()}else{xt==="auto"&&(xt=sp(Se));const st=nh(V,i.glyphMap,i.glyphPositions,i.imagePositions,I,Qe,d,Se,xt,Ae,J,a.WritingMode.horizontal,!1,rt,D,P);st&&(N.horizontal[xt]=st),Ze(),Ga(ae)&&m&&_&&(N.vertical=nh(V,i.glyphMap,i.glyphPositions,i.imagePositions,I,Qe,d,Se,xt,Ae,J,a.WritingMode.vertical,!1,rt,D,P))}}let ce=!1;if(T.icon&&T.icon.name){const ae=i.imageMap[T.icon.name];ae&&(Y=_b(i.imagePositions[T.icon.name],e.get("icon-offset").evaluate(T,{},i.canonical),e.get("icon-anchor").evaluate(T,{},i.canonical)),ce=!!ae.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=ce:i.bucket.sdfIcons!==ce&&Ce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ae.pixelRatio!==i.bucket.pixelRatio||e.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const me=mg(N.horizontal)||N.vertical;i.bucket.iconsInText=!!me&&me.iconsInText,(me||Y)&&Eb(i.bucket,T,N,Y,i.imageMap,l,D,O,J,ce,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},a.perspective=function(i,e,r,l,d){var m,_=1/Math.tan(e/2);return i[0]=_/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=_,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,d!=null&&d!==1/0?(i[10]=(d+l)*(m=1/(l-d)),i[14]=2*d*l*m):(i[10]=-1,i[14]=-2*l),i},a.pick=function(i,e){const r={};for(let l=0;l<e.length;l++){const d=e[l];d in i&&(r[d]=i[d])}return r},a.plugin=cr,a.pointGeometry=We,a.polygonIntersectsPolygon=ym,a.potpack=Jm,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=mt,a.registerForPluginStateChange=function(i){return i({pluginStatus:qn,pluginURL:ts}),oc.on("pluginStateChange",i),i},a.renderColorRamp=Pm,a.rotateX=function(i,e,r){var l=Math.sin(r),d=Math.cos(r),m=e[4],_=e[5],b=e[6],T=e[7],I=e[8],P=e[9],D=e[10],O=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=m*d+I*l,i[5]=_*d+P*l,i[6]=b*d+D*l,i[7]=T*d+O*l,i[8]=I*d-m*l,i[9]=P*d-_*l,i[10]=D*d-b*l,i[11]=O*d-T*l,i},a.rotateZ=function(i,e,r){var l=Math.sin(r),d=Math.cos(r),m=e[0],_=e[1],b=e[2],T=e[3],I=e[4],P=e[5],D=e[6],O=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=m*d+I*l,i[1]=_*d+P*l,i[2]=b*d+D*l,i[3]=T*d+O*l,i[4]=I*d-m*l,i[5]=P*d-_*l,i[6]=D*d-b*l,i[7]=O*d-T*l,i},a.scale=function(i,e,r){var l=r[0],d=r[1],m=r[2];return i[0]=e[0]*l,i[1]=e[1]*l,i[2]=e[2]*l,i[3]=e[3]*l,i[4]=e[4]*d,i[5]=e[5]*d,i[6]=e[6]*d,i[7]=e[7]*d,i[8]=e[8]*m,i[9]=e[9]*m,i[10]=e[10]*m,i[11]=e[11]*m,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},a.scale$1=function(i,e,r){return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i},a.setCacheLimits=function(i,e){Bn=i,Fn=e},a.setRTLTextPlugin=function(i,e,r=!1){if(qn===ic||qn===nc||qn===rc)throw new Error("setRTLTextPlugin cannot be called multiple times.");ts=yi.resolveURL(i),qn=ic,sc=e,Qs(),r||Uu()},a.spec=he,a.sphericalToCartesian=function([i,e,r]){return e+=90,e*=Math.PI/180,r*=Math.PI/180,{x:i*Math.cos(e)*Math.sin(r),y:i*Math.sin(e)*Math.sin(r),z:i*Math.cos(r)}},a.sqrLen=function(i){var e=i[0],r=i[1];return e*e+r*r},a.sub=function(i,e,r){return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],i},a.toEvaluationFeature=Ko,a.transformMat3=function(i,e,r){var l=e[0],d=e[1],m=e[2];return i[0]=l*r[0]+d*r[3]+m*r[6],i[1]=l*r[1]+d*r[4]+m*r[7],i[2]=l*r[2]+d*r[5]+m*r[8],i},a.transformMat4=Xu,a.transformMat4$1=function(i,e,r){var l=e[0],d=e[1];return i[0]=r[0]*l+r[4]*d+r[12],i[1]=r[1]*l+r[5]*d+r[13],i},a.translate=function(i,e,r){var l,d,m,_,b,T,I,P,D,O,N,V,Y=r[0],J=r[1],ce=r[2];return e===i?(i[12]=e[0]*Y+e[4]*J+e[8]*ce+e[12],i[13]=e[1]*Y+e[5]*J+e[9]*ce+e[13],i[14]=e[2]*Y+e[6]*J+e[10]*ce+e[14],i[15]=e[3]*Y+e[7]*J+e[11]*ce+e[15]):(d=e[1],m=e[2],_=e[3],b=e[4],T=e[5],I=e[6],P=e[7],D=e[8],O=e[9],N=e[10],V=e[11],i[0]=l=e[0],i[1]=d,i[2]=m,i[3]=_,i[4]=b,i[5]=T,i[6]=I,i[7]=P,i[8]=D,i[9]=O,i[10]=N,i[11]=V,i[12]=l*Y+b*J+D*ce+e[12],i[13]=d*Y+T*J+O*ce+e[13],i[14]=m*Y+I*J+N*ce+e[14],i[15]=_*Y+P*J+V*ce+e[15]),i},a.triggerPluginCompletionEvent=$u,a.unicodeBlockLookup=nt,a.uniqueId=function(){return Oe++},a.validateCustomStyleLayer=function(i){const e=[],r=i.id;return r===void 0&&e.push({message:`layers.${r}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${r}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},a.validateLight=Yl,a.validateStyle=jo,a.vectorTile=no,a.warnOnce=Ce,a.wrap=le}),v(["./shared"],function(a){function k(G){const C=typeof G;if(C==="number"||C==="boolean"||C==="string"||G==null)return JSON.stringify(G);if(Array.isArray(G)){let q="[";for(const Q of G)q+=`${k(Q)},`;return`${q}]`}const R=Object.keys(G).sort();let j="{";for(let q=0;q<R.length;q++)j+=`${JSON.stringify(R[q])}:${k(G[R[q]])},`;return`${j}}`}function $(G){let C="";for(const R of a.refProperties)C+=`/${k(G[R])}`;return C}class F{constructor(C){this.keyCache={},C&&this.replace(C)}replace(C){this._layerConfigs={},this._layers={},this.update(C,[])}update(C,R){for(const q of C){this._layerConfigs[q.id]=q;const Q=this._layers[q.id]=a.createStyleLayer(q);Q._featureFilter=a.createFilter(Q.filter),this.keyCache[q.id]&&delete this.keyCache[q.id]}for(const q of R)delete this.keyCache[q],delete this._layerConfigs[q],delete this._layers[q];this.familiesBySource={};const j=function(q,Q){const re={};for(let ee=0;ee<q.length;ee++){const se=Q&&Q[q[ee].id]||$(q[ee]);Q&&(Q[q[ee].id]=se);let _e=re[se];_e||(_e=re[se]=[]),_e.push(q[ee])}const te=[];for(const ee in re)te.push(re[ee]);return te}(Object.values(this._layerConfigs),this.keyCache);for(const q of j){const Q=q.map(Me=>this._layers[Me.id]),re=Q[0];if(re.visibility==="none")continue;const te=re.source||"";let ee=this.familiesBySource[te];ee||(ee=this.familiesBySource[te]={});const se=re.sourceLayer||"_geojsonTileLayer";let _e=ee[se];_e||(_e=ee[se]=[]),_e.push(Q)}}}class B{constructor(C){const R={},j=[];for(const te in C){const ee=C[te],se=R[te]={};for(const _e in ee){const Me=ee[+_e];if(!Me||Me.bitmap.width===0||Me.bitmap.height===0)continue;const ge={x:0,y:0,w:Me.bitmap.width+2,h:Me.bitmap.height+2};j.push(ge),se[_e]={rect:ge,metrics:Me.metrics}}}const{w:q,h:Q}=a.potpack(j),re=new a.AlphaImage({width:q||1,height:Q||1});for(const te in C){const ee=C[te];for(const se in ee){const _e=ee[+se];if(!_e||_e.bitmap.width===0||_e.bitmap.height===0)continue;const Me=R[te][se].rect;a.AlphaImage.copy(_e.bitmap,re,{x:0,y:0},{x:Me.x+1,y:Me.y+1},_e.bitmap)}}this.image=re,this.positions=R}}a.register("GlyphAtlas",B);class M{constructor(C){this.tileID=new a.OverscaledTileID(C.tileID.overscaledZ,C.tileID.wrap,C.tileID.canonical.z,C.tileID.canonical.x,C.tileID.canonical.y),this.uid=C.uid,this.zoom=C.zoom,this.pixelRatio=C.pixelRatio,this.tileSize=C.tileSize,this.source=C.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=C.showCollisionBoxes,this.collectResourceTiming=!!C.collectResourceTiming,this.returnDependencies=!!C.returnDependencies,this.promoteId=C.promoteId}parse(C,R,j,q,Q){this.status="parsing",this.data=C,this.collisionBoxArray=new a.CollisionBoxArray;const re=new a.DictionaryCoder(Object.keys(C.layers).sort()),te=new a.FeatureIndex(this.tileID,this.promoteId);te.bucketLayerIDs=[];const ee={},se={featureIndex:te,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:j},_e=R.familiesBySource[this.source];for(const jt in _e){const Yt=C.layers[jt];if(!Yt)continue;Yt.version===1&&a.warnOnce(`Vector tile source "${this.source}" layer "${jt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const pi=re.encode(jt),Pi=[];for(let mn=0;mn<Yt.length;mn++){const Vi=Yt.feature(mn),Cn=te.getId(Vi,jt);Pi.push({feature:Vi,id:Cn,index:mn,sourceLayerIndex:pi})}for(const mn of _e[jt]){const Vi=mn[0];Vi.source!==this.source&&a.warnOnce(`layer.source = ${Vi.source} does not equal this.source = ${this.source}`),Vi.minzoom&&this.zoom<Math.floor(Vi.minzoom)||Vi.maxzoom&&this.zoom>=Vi.maxzoom||Vi.visibility!=="none"&&(le(mn,this.zoom,j),(ee[Vi.id]=Vi.createBucket({index:te.bucketLayerIDs.length,layers:mn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pi,sourceID:this.source})).populate(Pi,se,this.tileID.canonical),te.bucketLayerIDs.push(mn.map(Cn=>Cn.id)))}}let Me,ge,vt,wt;const ot=a.mapObject(se.glyphDependencies,jt=>Object.keys(jt).map(Number));Object.keys(ot).length?q.send("getGlyphs",{uid:this.uid,stacks:ot},(jt,Yt)=>{Me||(Me=jt,ge=Yt,di.call(this))}):ge={};const Pt=Object.keys(se.iconDependencies);Pt.length?q.send("getImages",{icons:Pt,source:this.source,tileID:this.tileID,type:"icons"},(jt,Yt)=>{Me||(Me=jt,vt=Yt,di.call(this))}):vt={};const Bt=Object.keys(se.patternDependencies);function di(){if(Me)return Q(Me);if(ge&&vt&&wt){const jt=new B(ge),Yt=new a.ImageAtlas(vt,wt);for(const pi in ee){const Pi=ee[pi];Pi instanceof a.SymbolBucket?(le(Pi.layers,this.zoom,j),a.performSymbolLayout({bucket:Pi,glyphMap:ge,glyphPositions:jt.positions,imageMap:vt,imagePositions:Yt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Pi.hasPattern&&(Pi instanceof a.LineBucket||Pi instanceof a.FillBucket||Pi instanceof a.FillExtrusionBucket)&&(le(Pi.layers,this.zoom,j),Pi.addFeatures(se,this.tileID.canonical,Yt.patternPositions))}this.status="done",Q(null,{buckets:Object.values(ee).filter(pi=>!pi.isEmpty()),featureIndex:te,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:jt.image,imageAtlas:Yt,glyphMap:this.returnDependencies?ge:null,iconMap:this.returnDependencies?vt:null,glyphPositions:this.returnDependencies?jt.positions:null})}}Bt.length?q.send("getImages",{icons:Bt,source:this.source,tileID:this.tileID,type:"patterns"},(jt,Yt)=>{Me||(Me=jt,wt=Yt,di.call(this))}):wt={},di.call(this)}}function le(G,C,R){const j=new a.EvaluationParameters(C);for(const q of G)q.recalculate(j,R)}function Ee(G,C){const R=a.getArrayBuffer(G.request,(j,q,Q,re)=>{j?C(j):q&&C(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(q)),rawData:q,cacheControl:Q,expires:re})});return()=>{R.cancel(),C()}}class Oe{constructor(C,R,j,q){this.actor=C,this.layerIndex=R,this.availableImages=j,this.loadVectorData=q||Ee,this.loading={},this.loaded={}}loadTile(C,R){const j=C.uid;this.loading||(this.loading={});const q=!!(C&&C.request&&C.request.collectResourceTiming)&&new a.RequestPerformance(C.request),Q=this.loading[j]=new M(C);Q.abort=this.loadVectorData(C,(re,te)=>{if(delete this.loading[j],re||!te)return Q.status="done",this.loaded[j]=Q,R(re);const ee=te.rawData,se={};te.expires&&(se.expires=te.expires),te.cacheControl&&(se.cacheControl=te.cacheControl);const _e={};if(q){const Me=q.finish();Me&&(_e.resourceTiming=JSON.parse(JSON.stringify(Me)))}Q.vectorTile=te.vectorTile,Q.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,(Me,ge)=>{if(Me||!ge)return R(Me);R(null,a.extend({rawTileData:ee.slice(0)},ge,se,_e))}),this.loaded=this.loaded||{},this.loaded[j]=Q})}reloadTile(C,R){const j=this.loaded,q=C.uid,Q=this;if(j&&j[q]){const re=j[q];re.showCollisionBoxes=C.showCollisionBoxes;const te=(ee,se)=>{const _e=re.reloadCallback;_e&&(delete re.reloadCallback,re.parse(re.vectorTile,Q.layerIndex,this.availableImages,Q.actor,_e)),R(ee,se)};re.status==="parsing"?re.reloadCallback=te:re.status==="done"&&(re.vectorTile?re.parse(re.vectorTile,this.layerIndex,this.availableImages,this.actor,te):te())}}abortTile(C,R){const j=this.loading,q=C.uid;j&&j[q]&&j[q].abort&&(j[q].abort(),delete j[q]),R()}removeTile(C,R){const j=this.loaded,q=C.uid;j&&j[q]&&delete j[q],R()}}class Je{constructor(){this.loaded={}}loadTile(C,R){const{uid:j,encoding:q,rawImageData:Q}=C,re=a.isImageBitmap(Q)?this.getImageData(Q):Q,te=new a.DEMData(j,re,q);this.loaded=this.loaded||{},this.loaded[j]=te,R(null,te)}getImageData(C){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(C.width,C.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=C.width,this.offscreenCanvas.height=C.height,this.offscreenCanvasContext.drawImage(C,0,0,C.width,C.height);const R=this.offscreenCanvasContext.getImageData(-1,-1,C.width+2,C.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:R.width,height:R.height},R.data)}removeTile(C){const R=this.loaded,j=C.uid;R&&R[j]&&delete R[j]}}var He=function G(C,R){var j,q=C&&C.type;if(q==="FeatureCollection")for(j=0;j<C.features.length;j++)G(C.features[j],R);else if(q==="GeometryCollection")for(j=0;j<C.geometries.length;j++)G(C.geometries[j],R);else if(q==="Feature")G(C.geometry,R);else if(q==="Polygon")De(C.coordinates,R);else if(q==="MultiPolygon")for(j=0;j<C.coordinates.length;j++)De(C.coordinates[j],R);return C};function De(G,C){if(G.length!==0){tt(G[0],C);for(var R=1;R<G.length;R++)tt(G[R],!C)}}function tt(G,C){for(var R=0,j=0,q=0,Q=G.length,re=Q-1;q<Q;re=q++){var te=(G[q][0]-G[re][0])*(G[re][1]+G[q][1]),ee=R+te;j+=Math.abs(R)>=Math.abs(te)?R-ee+te:te-ee+R,R=ee}R+j>=0!=!!C&&G.reverse()}const Nt=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Ce{constructor(C){this._feature=C,this.extent=a.EXTENT,this.type=C.type,this.properties=C.tags,"id"in C&&!isNaN(C.id)&&(this.id=parseInt(C.id,10))}loadGeometry(){if(this._feature.type===1){const C=[];for(const R of this._feature.geometry)C.push([new a.pointGeometry(R[0],R[1])]);return C}{const C=[];for(const R of this._feature.geometry){const j=[];for(const q of R)j.push(new a.pointGeometry(q[0],q[1]));C.push(j)}return C}}toGeoJSON(C,R,j){return Nt.call(this,C,R,j)}}class Zt{constructor(C){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=C.length,this._features=C}feature(C){return new Ce(this._features[C])}}var Xe={exports:{}},ht=a.pointGeometry,it=a.vectorTile.VectorTileFeature,Ue=ct;function ct(G,C){this.options=C||{},this.features=G,this.length=G.length}function Re(G,C){this.id=typeof G.id=="number"?G.id:void 0,this.type=G.type,this.rawGeometry=G.type===1?[G.geometry]:G.geometry,this.properties=G.tags,this.extent=C||4096}ct.prototype.feature=function(G){return new Re(this.features[G],this.options.extent)},Re.prototype.loadGeometry=function(){var G=this.rawGeometry;this.geometry=[];for(var C=0;C<G.length;C++){for(var R=G[C],j=[],q=0;q<R.length;q++)j.push(new ht(R[q][0],R[q][1]));this.geometry.push(j)}return this.geometry},Re.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var G=this.geometry,C=1/0,R=-1/0,j=1/0,q=-1/0,Q=0;Q<G.length;Q++)for(var re=G[Q],te=0;te<re.length;te++){var ee=re[te];C=Math.min(C,ee.x),R=Math.max(R,ee.x),j=Math.min(j,ee.y),q=Math.max(q,ee.y)}return[C,j,R,q]},Re.prototype.toGeoJSON=it.prototype.toGeoJSON;var Rt=a.pbf,ai=Ue;function yi(G){var C=new Rt;return function(R,j){for(var q in R.layers)j.writeMessage(3,We,R.layers[q])}(G,C),C.finish()}function We(G,C){var R;C.writeVarintField(15,G.version||1),C.writeStringField(1,G.name||""),C.writeVarintField(5,G.extent||4096);var j={keys:[],values:[],keycache:{},valuecache:{}};for(R=0;R<G.length;R++)j.feature=G.feature(R),C.writeMessage(2,St,j);var q=j.keys;for(R=0;R<q.length;R++)C.writeStringField(3,q[R]);var Q=j.values;for(R=0;R<Q.length;R++)C.writeMessage(4,Bn,Q[R])}function St(G,C){var R=G.feature;R.id!==void 0&&C.writeVarintField(1,R.id),C.writeMessage(2,Xt,G),C.writeVarintField(3,R.type),C.writeMessage(4,In,R)}function Xt(G,C){var R=G.feature,j=G.keys,q=G.values,Q=G.keycache,re=G.valuecache;for(var te in R.properties){var ee=R.properties[te],se=Q[te];if(ee!==null){se===void 0&&(j.push(te),Q[te]=se=j.length-1),C.writeVarint(se);var _e=typeof ee;_e!=="string"&&_e!=="boolean"&&_e!=="number"&&(ee=JSON.stringify(ee));var Me=_e+":"+ee,ge=re[Me];ge===void 0&&(q.push(ee),re[Me]=ge=q.length-1),C.writeVarint(ge)}}}function Oi(G,C){return(C<<3)+(7&G)}function Ni(G){return G<<1^G>>31}function In(G,C){for(var R=G.loadGeometry(),j=G.type,q=0,Q=0,re=R.length,te=0;te<re;te++){var ee=R[te],se=1;j===1&&(se=ee.length),C.writeVarint(Oi(1,se));for(var _e=j===3?ee.length-1:ee.length,Me=0;Me<_e;Me++){Me===1&&j!==1&&C.writeVarint(Oi(2,_e-1));var ge=ee[Me].x-q,vt=ee[Me].y-Q;C.writeVarint(Ni(ge)),C.writeVarint(Ni(vt)),q+=ge,Q+=vt}j===3&&C.writeVarint(Oi(7,1))}}function Bn(G,C){var R=typeof G;R==="string"?C.writeStringField(1,G):R==="boolean"?C.writeBooleanField(7,G):R==="number"&&(G%1!=0?C.writeDoubleField(3,G):G<0?C.writeSVarintField(6,G):C.writeVarintField(5,G))}function Fn(G,C,R,j,q,Q){if(q-j<=R)return;const re=j+q>>1;pn(G,C,re,j,q,Q%2),Fn(G,C,R,j,re-1,Q+1),Fn(G,C,R,re+1,q,Q+1)}function pn(G,C,R,j,q,Q){for(;q>j;){if(q-j>600){const se=q-j+1,_e=R-j+1,Me=Math.log(se),ge=.5*Math.exp(2*Me/3),vt=.5*Math.sqrt(Me*ge*(se-ge)/se)*(_e-se/2<0?-1:1);pn(G,C,R,Math.max(j,Math.floor(R-_e*ge/se+vt)),Math.min(q,Math.floor(R+(se-_e)*ge/se+vt)),Q)}const re=C[2*R+Q];let te=j,ee=q;for(Te(G,C,j,R),C[2*q+Q]>re&&Te(G,C,j,q);te<ee;){for(Te(G,C,te,ee),te++,ee--;C[2*te+Q]<re;)te++;for(;C[2*ee+Q]>re;)ee--}C[2*j+Q]===re?Te(G,C,j,ee):(ee++,Te(G,C,ee,q)),ee<=R&&(j=ee+1),R<=ee&&(q=ee-1)}}function Te(G,C,R,j){gt(G,R,j),gt(C,2*R,2*j),gt(C,2*R+1,2*j+1)}function gt(G,C,R){const j=G[C];G[C]=G[R],G[R]=j}function ut(G,C,R,j){const q=G-R,Q=C-j;return q*q+Q*Q}Xe.exports=yi,Xe.exports.fromVectorTileJs=yi,Xe.exports.fromGeojsonVt=function(G,C){C=C||{};var R={};for(var j in G)R[j]=new ai(G[j].features,C),R[j].name=j,R[j].version=C.version,R[j].extent=C.extent;return yi({layers:R})},Xe.exports.GeoJSONWrapper=ai;const ft=G=>G[0],$t=G=>G[1];class ki{constructor(C,R=ft,j=$t,q=64,Q=Float64Array){this.nodeSize=q,this.points=C;const re=C.length<65536?Uint16Array:Uint32Array,te=this.ids=new re(C.length),ee=this.coords=new Q(2*C.length);for(let se=0;se<C.length;se++)te[se]=se,ee[2*se]=R(C[se]),ee[2*se+1]=j(C[se]);Fn(te,ee,q,0,te.length-1,0)}range(C,R,j,q){return function(Q,re,te,ee,se,_e,Me){const ge=[0,Q.length-1,0],vt=[];let wt,ot;for(;ge.length;){const Pt=ge.pop(),Bt=ge.pop(),di=ge.pop();if(Bt-di<=Me){for(let pi=di;pi<=Bt;pi++)wt=re[2*pi],ot=re[2*pi+1],wt>=te&&wt<=se&&ot>=ee&&ot<=_e&&vt.push(Q[pi]);continue}const jt=Math.floor((di+Bt)/2);wt=re[2*jt],ot=re[2*jt+1],wt>=te&&wt<=se&&ot>=ee&&ot<=_e&&vt.push(Q[jt]);const Yt=(Pt+1)%2;(Pt===0?te<=wt:ee<=ot)&&(ge.push(di),ge.push(jt-1),ge.push(Yt)),(Pt===0?se>=wt:_e>=ot)&&(ge.push(jt+1),ge.push(Bt),ge.push(Yt))}return vt}(this.ids,this.coords,C,R,j,q,this.nodeSize)}within(C,R,j){return function(q,Q,re,te,ee,se){const _e=[0,q.length-1,0],Me=[],ge=ee*ee;for(;_e.length;){const vt=_e.pop(),wt=_e.pop(),ot=_e.pop();if(wt-ot<=se){for(let Yt=ot;Yt<=wt;Yt++)ut(Q[2*Yt],Q[2*Yt+1],re,te)<=ge&&Me.push(q[Yt]);continue}const Pt=Math.floor((ot+wt)/2),Bt=Q[2*Pt],di=Q[2*Pt+1];ut(Bt,di,re,te)<=ge&&Me.push(q[Pt]);const jt=(vt+1)%2;(vt===0?re-ee<=Bt:te-ee<=di)&&(_e.push(ot),_e.push(Pt-1),_e.push(jt)),(vt===0?re+ee>=Bt:te+ee>=di)&&(_e.push(Pt+1),_e.push(wt),_e.push(jt))}return Me}(this.ids,this.coords,C,R,j,this.nodeSize)}}const Gt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:G=>G},Ft=Math.fround||(ri=new Float32Array(1),G=>(ri[0]=+G,ri[0]));var ri;class X{constructor(C){this.options=qe(Object.create(Gt),C),this.trees=new Array(this.options.maxZoom+1)}load(C){const{log:R,minZoom:j,maxZoom:q,nodeSize:Q}=this.options;R&&console.time("total time");const re=`prepare ${C.length} points`;R&&console.time(re),this.points=C;let te=[];for(let ee=0;ee<C.length;ee++)C[ee].geometry&&te.push(be(C[ee],ee));this.trees[q+1]=new ki(te,Be,bt,Q,Float32Array),R&&console.timeEnd(re);for(let ee=q;ee>=j;ee--){const se=+Date.now();te=this._cluster(te,ee),this.trees[ee]=new ki(te,Be,bt,Q,Float32Array),R&&console.log("z%d: %d clusters in %dms",ee,te.length,+Date.now()-se)}return R&&console.timeEnd("total time"),this}getClusters(C,R){let j=((C[0]+180)%360+360)%360-180;const q=Math.max(-90,Math.min(90,C[1]));let Q=C[2]===180?180:((C[2]+180)%360+360)%360-180;const re=Math.max(-90,Math.min(90,C[3]));if(C[2]-C[0]>=360)j=-180,Q=180;else if(j>Q){const _e=this.getClusters([j,q,180,re],R),Me=this.getClusters([-180,q,Q,re],R);return _e.concat(Me)}const te=this.trees[this._limitZoom(R)],ee=te.range(Ie(j),Ke(re),Ie(Q),Ke(q)),se=[];for(const _e of ee){const Me=te.points[_e];se.push(Me.numPoints?ze(Me):this.points[Me.index])}return se}getChildren(C){const R=this._getOriginId(C),j=this._getOriginZoom(C),q="No cluster with the specified id.",Q=this.trees[j];if(!Q)throw new Error(q);const re=Q.points[R];if(!re)throw new Error(q);const te=this.options.radius/(this.options.extent*Math.pow(2,j-1)),ee=Q.within(re.x,re.y,te),se=[];for(const _e of ee){const Me=Q.points[_e];Me.parentId===C&&se.push(Me.numPoints?ze(Me):this.points[Me.index])}if(se.length===0)throw new Error(q);return se}getLeaves(C,R,j){const q=[];return this._appendLeaves(q,C,R=R||10,j=j||0,0),q}getTile(C,R,j){const q=this.trees[this._limitZoom(C)],Q=Math.pow(2,C),{extent:re,radius:te}=this.options,ee=te/re,se=(j-ee)/Q,_e=(j+1+ee)/Q,Me={features:[]};return this._addTileFeatures(q.range((R-ee)/Q,se,(R+1+ee)/Q,_e),q.points,R,j,Q,Me),R===0&&this._addTileFeatures(q.range(1-ee/Q,se,1,_e),q.points,Q,j,Q,Me),R===Q-1&&this._addTileFeatures(q.range(0,se,ee/Q,_e),q.points,-1,j,Q,Me),Me.features.length?Me:null}getClusterExpansionZoom(C){let R=this._getOriginZoom(C)-1;for(;R<=this.options.maxZoom;){const j=this.getChildren(C);if(R++,j.length!==1)break;C=j[0].properties.cluster_id}return R}_appendLeaves(C,R,j,q,Q){const re=this.getChildren(R);for(const te of re){const ee=te.properties;if(ee&&ee.cluster?Q+ee.point_count<=q?Q+=ee.point_count:Q=this._appendLeaves(C,ee.cluster_id,j,q,Q):Q<q?Q++:C.push(te),C.length===j)break}return Q}_addTileFeatures(C,R,j,q,Q,re){for(const te of C){const ee=R[te],se=ee.numPoints;let _e,Me,ge;if(se)_e=ke(ee),Me=ee.x,ge=ee.y;else{const ot=this.points[ee.index];_e=ot.properties,Me=Ie(ot.geometry.coordinates[0]),ge=Ke(ot.geometry.coordinates[1])}const vt={type:1,geometry:[[Math.round(this.options.extent*(Me*Q-j)),Math.round(this.options.extent*(ge*Q-q))]],tags:_e};let wt;se?wt=ee.id:this.options.generateId?wt=ee.index:this.points[ee.index].id&&(wt=this.points[ee.index].id),wt!==void 0&&(vt.id=wt),re.features.push(vt)}}_limitZoom(C){return Math.max(this.options.minZoom,Math.min(Math.floor(+C),this.options.maxZoom+1))}_cluster(C,R){const j=[],{radius:q,extent:Q,reduce:re,minPoints:te}=this.options,ee=q/(Q*Math.pow(2,R));for(let se=0;se<C.length;se++){const _e=C[se];if(_e.zoom<=R)continue;_e.zoom=R;const Me=this.trees[R+1],ge=Me.within(_e.x,_e.y,ee),vt=_e.numPoints||1;let wt=vt;for(const ot of ge){const Pt=Me.points[ot];Pt.zoom>R&&(wt+=Pt.numPoints||1)}if(wt>vt&&wt>=te){let ot=_e.x*vt,Pt=_e.y*vt,Bt=re&&vt>1?this._map(_e,!0):null;const di=(se<<5)+(R+1)+this.points.length;for(const jt of ge){const Yt=Me.points[jt];if(Yt.zoom<=R)continue;Yt.zoom=R;const pi=Yt.numPoints||1;ot+=Yt.x*pi,Pt+=Yt.y*pi,Yt.parentId=di,re&&(Bt||(Bt=this._map(_e,!0)),re(Bt,this._map(Yt)))}_e.parentId=di,j.push(ie(ot/wt,Pt/wt,di,wt,Bt))}else if(j.push(_e),wt>1)for(const ot of ge){const Pt=Me.points[ot];Pt.zoom<=R||(Pt.zoom=R,j.push(Pt))}}return j}_getOriginId(C){return C-this.points.length>>5}_getOriginZoom(C){return(C-this.points.length)%32}_map(C,R){if(C.numPoints)return R?qe({},C.properties):C.properties;const j=this.points[C.index].properties,q=this.options.map(j);return R&&q===j?qe({},q):q}}function ie(G,C,R,j,q){return{x:Ft(G),y:Ft(C),zoom:1/0,id:R,parentId:-1,numPoints:j,properties:q}}function be(G,C){const[R,j]=G.geometry.coordinates;return{x:Ft(Ie(R)),y:Ft(Ke(j)),zoom:1/0,index:C,parentId:-1}}function ze(G){return{type:"Feature",id:G.id,properties:ke(G),geometry:{type:"Point",coordinates:[(C=G.x,360*(C-.5)),je(G.y)]}};var C}function ke(G){const C=G.numPoints,R=C>=1e4?`${Math.round(C/1e3)}k`:C>=1e3?Math.round(C/100)/10+"k":C;return qe(qe({},G.properties),{cluster:!0,cluster_id:G.id,point_count:C,point_count_abbreviated:R})}function Ie(G){return G/360+.5}function Ke(G){const C=Math.sin(G*Math.PI/180),R=.5-.25*Math.log((1+C)/(1-C))/Math.PI;return R<0?0:R>1?1:R}function je(G){const C=(180-360*G)*Math.PI/180;return 360*Math.atan(Math.exp(C))/Math.PI-90}function qe(G,C){for(const R in C)G[R]=C[R];return G}function Be(G){return G.x}function bt(G){return G.y}function yt(G,C,R,j){for(var q,Q=j,re=R-C>>1,te=R-C,ee=G[C],se=G[C+1],_e=G[R],Me=G[R+1],ge=C+3;ge<R;ge+=3){var vt=At(G[ge],G[ge+1],ee,se,_e,Me);if(vt>Q)q=ge,Q=vt;else if(vt===Q){var wt=Math.abs(ge-re);wt<te&&(q=ge,te=wt)}}Q>j&&(q-C>3&&yt(G,C,q,j),G[q+2]=Q,R-q>3&&yt(G,q,R,j))}function At(G,C,R,j,q,Q){var re=q-R,te=Q-j;if(re!==0||te!==0){var ee=((G-R)*re+(C-j)*te)/(re*re+te*te);ee>1?(R=q,j=Q):ee>0&&(R+=re*ee,j+=te*ee)}return(re=G-R)*re+(te=C-j)*te}function Lt(G,C,R,j){var q={id:G===void 0?null:G,type:C,geometry:R,tags:j,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Q){var re=Q.geometry,te=Q.type;if(te==="Point"||te==="MultiPoint"||te==="LineString")he(Q,re);else if(te==="Polygon"||te==="MultiLineString")for(var ee=0;ee<re.length;ee++)he(Q,re[ee]);else if(te==="MultiPolygon")for(ee=0;ee<re.length;ee++)for(var se=0;se<re[ee].length;se++)he(Q,re[ee][se])}(q),q}function he(G,C){for(var R=0;R<C.length;R+=3)G.minX=Math.min(G.minX,C[R]),G.minY=Math.min(G.minY,C[R+1]),G.maxX=Math.max(G.maxX,C[R]),G.maxY=Math.max(G.maxY,C[R+1])}function Pe(G,C,R,j){if(C.geometry){var q=C.geometry.coordinates,Q=C.geometry.type,re=Math.pow(R.tolerance/((1<<R.maxZoom)*R.extent),2),te=[],ee=C.id;if(R.promoteId?ee=C.properties[R.promoteId]:R.generateId&&(ee=j||0),Q==="Point")gi(q,te);else if(Q==="MultiPoint")for(var se=0;se<q.length;se++)gi(q[se],te);else if(Q==="LineString")li(q,te,re,!1);else if(Q==="MultiLineString"){if(R.lineMetrics){for(se=0;se<q.length;se++)li(q[se],te=[],re,!1),G.push(Lt(ee,"LineString",te,C.properties));return}Ht(q,te,re,!1)}else if(Q==="Polygon")Ht(q,te,re,!0);else{if(Q!=="MultiPolygon"){if(Q==="GeometryCollection"){for(se=0;se<C.geometry.geometries.length;se++)Pe(G,{id:ee,geometry:C.geometry.geometries[se],properties:C.properties},R,j);return}throw new Error("Input data is not a valid GeoJSON object.")}for(se=0;se<q.length;se++){var _e=[];Ht(q[se],_e,re,!0),te.push(_e)}}G.push(Lt(ee,Q,te,C.properties))}}function gi(G,C){C.push(ln(G[0])),C.push(An(G[1])),C.push(0)}function li(G,C,R,j){for(var q,Q,re=0,te=0;te<G.length;te++){var ee=ln(G[te][0]),se=An(G[te][1]);C.push(ee),C.push(se),C.push(0),te>0&&(re+=j?(q*se-ee*Q)/2:Math.sqrt(Math.pow(ee-q,2)+Math.pow(se-Q,2))),q=ee,Q=se}var _e=C.length-3;C[2]=1,yt(C,0,_e,R),C[_e+2]=1,C.size=Math.abs(re),C.start=0,C.end=C.size}function Ht(G,C,R,j){for(var q=0;q<G.length;q++){var Q=[];li(G[q],Q,R,j),C.push(Q)}}function ln(G){return G/360+.5}function An(G){var C=Math.sin(G*Math.PI/180),R=.5-.25*Math.log((1+C)/(1-C))/Math.PI;return R<0?0:R>1?1:R}function cn(G,C,R,j,q,Q,re,te){if(j/=C,Q>=(R/=C)&&re<j)return G;if(re<R||Q>=j)return null;for(var ee=[],se=0;se<G.length;se++){var _e=G[se],Me=_e.geometry,ge=_e.type,vt=q===0?_e.minX:_e.minY,wt=q===0?_e.maxX:_e.maxY;if(vt>=R&&wt<j)ee.push(_e);else if(!(wt<R||vt>=j)){var ot=[];if(ge==="Point"||ge==="MultiPoint")_r(Me,ot,R,j,q);else if(ge==="LineString")Ne(Me,ot,R,j,q,!1,te.lineMetrics);else if(ge==="MultiLineString")Vt(Me,ot,R,j,q,!1);else if(ge==="Polygon")Vt(Me,ot,R,j,q,!0);else if(ge==="MultiPolygon")for(var Pt=0;Pt<Me.length;Pt++){var Bt=[];Vt(Me[Pt],Bt,R,j,q,!0),Bt.length&&ot.push(Bt)}if(ot.length){if(te.lineMetrics&&ge==="LineString"){for(Pt=0;Pt<ot.length;Pt++)ee.push(Lt(_e.id,ge,ot[Pt],_e.tags));continue}ge!=="LineString"&&ge!=="MultiLineString"||(ot.length===1?(ge="LineString",ot=ot[0]):ge="MultiLineString"),ge!=="Point"&&ge!=="MultiPoint"||(ge=ot.length===3?"Point":"MultiPoint"),ee.push(Lt(_e.id,ge,ot,_e.tags))}}}return ee.length?ee:null}function _r(G,C,R,j,q){for(var Q=0;Q<G.length;Q+=3){var re=G[Q+q];re>=R&&re<=j&&(C.push(G[Q]),C.push(G[Q+1]),C.push(G[Q+2]))}}function Ne(G,C,R,j,q,Q,re){for(var te,ee,se=Ot(G),_e=q===0?Yr:Wt,Me=G.start,ge=0;ge<G.length-3;ge+=3){var vt=G[ge],wt=G[ge+1],ot=G[ge+2],Pt=G[ge+3],Bt=G[ge+4],di=q===0?vt:wt,jt=q===0?Pt:Bt,Yt=!1;re&&(te=Math.sqrt(Math.pow(vt-Pt,2)+Math.pow(wt-Bt,2))),di<R?jt>R&&(ee=_e(se,vt,wt,Pt,Bt,R),re&&(se.start=Me+te*ee)):di>j?jt<j&&(ee=_e(se,vt,wt,Pt,Bt,j),re&&(se.start=Me+te*ee)):wn(se,vt,wt,ot),jt<R&&di>=R&&(ee=_e(se,vt,wt,Pt,Bt,R),Yt=!0),jt>j&&di<=j&&(ee=_e(se,vt,wt,Pt,Bt,j),Yt=!0),!Q&&Yt&&(re&&(se.end=Me+te*ee),C.push(se),se=Ot(G)),re&&(Me+=te)}var pi=G.length-3;vt=G[pi],wt=G[pi+1],ot=G[pi+2],(di=q===0?vt:wt)>=R&&di<=j&&wn(se,vt,wt,ot),pi=se.length-3,Q&&pi>=3&&(se[pi]!==se[0]||se[pi+1]!==se[1])&&wn(se,se[0],se[1],se[2]),se.length&&C.push(se)}function Ot(G){var C=[];return C.size=G.size,C.start=G.start,C.end=G.end,C}function Vt(G,C,R,j,q,Q){for(var re=0;re<G.length;re++)Ne(G[re],C,R,j,q,Q,!1)}function wn(G,C,R,j){G.push(C),G.push(R),G.push(j)}function Yr(G,C,R,j,q,Q){var re=(Q-C)/(j-C);return G.push(Q),G.push(R+(q-R)*re),G.push(1),re}function Wt(G,C,R,j,q,Q){var re=(Q-R)/(q-R);return G.push(C+(j-C)*re),G.push(Q),G.push(1),re}function Br(G,C){for(var R=[],j=0;j<G.length;j++){var q,Q=G[j],re=Q.type;if(re==="Point"||re==="MultiPoint"||re==="LineString")q=fn(Q.geometry,C);else if(re==="MultiLineString"||re==="Polygon"){q=[];for(var te=0;te<Q.geometry.length;te++)q.push(fn(Q.geometry[te],C))}else if(re==="MultiPolygon")for(q=[],te=0;te<Q.geometry.length;te++){for(var ee=[],se=0;se<Q.geometry[te].length;se++)ee.push(fn(Q.geometry[te][se],C));q.push(ee)}R.push(Lt(Q.id,re,q,Q.tags))}return R}function fn(G,C){var R=[];R.size=G.size,G.start!==void 0&&(R.start=G.start,R.end=G.end);for(var j=0;j<G.length;j+=3)R.push(G[j]+C,G[j+1],G[j+2]);return R}function Us(G,C){if(G.transformed)return G;var R,j,q,Q=1<<G.z,re=G.x,te=G.y;for(R=0;R<G.features.length;R++){var ee=G.features[R],se=ee.geometry,_e=ee.type;if(ee.geometry=[],_e===1)for(j=0;j<se.length;j+=2)ee.geometry.push(nn(se[j],se[j+1],C,Q,re,te));else for(j=0;j<se.length;j++){var Me=[];for(q=0;q<se[j].length;q+=2)Me.push(nn(se[j][q],se[j][q+1],C,Q,re,te));ee.geometry.push(Me)}}return G.transformed=!0,G}function nn(G,C,R,j,q,Q){return[Math.round(R*(G*j-q)),Math.round(R*(C*j-Q))]}function $n(G,C,R,j,q){for(var Q=C===q.maxZoom?0:q.tolerance/((1<<C)*q.extent),re={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:R,y:j,z:C,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},te=0;te<G.length;te++){re.numFeatures++,Ii(re,G[te],Q,q);var ee=G[te].minX,se=G[te].minY,_e=G[te].maxX,Me=G[te].maxY;ee<re.minX&&(re.minX=ee),se<re.minY&&(re.minY=se),_e>re.maxX&&(re.maxX=_e),Me>re.maxY&&(re.maxY=Me)}return re}function Ii(G,C,R,j){var q=C.geometry,Q=C.type,re=[];if(Q==="Point"||Q==="MultiPoint")for(var te=0;te<q.length;te+=3)re.push(q[te]),re.push(q[te+1]),G.numPoints++,G.numSimplified++;else if(Q==="LineString")Ns(re,q,G,R,!1,!1);else if(Q==="MultiLineString"||Q==="Polygon")for(te=0;te<q.length;te++)Ns(re,q[te],G,R,Q==="Polygon",te===0);else if(Q==="MultiPolygon")for(var ee=0;ee<q.length;ee++){var se=q[ee];for(te=0;te<se.length;te++)Ns(re,se[te],G,R,!0,te===0)}if(re.length){var _e=C.tags||null;if(Q==="LineString"&&j.lineMetrics){for(var Me in _e={},C.tags)_e[Me]=C.tags[Me];_e.mapbox_clip_start=q.start/q.size,_e.mapbox_clip_end=q.end/q.size}var ge={geometry:re,type:Q==="Polygon"||Q==="MultiPolygon"?3:Q==="LineString"||Q==="MultiLineString"?2:1,tags:_e};C.id!==null&&(ge.id=C.id),G.features.push(ge)}}function Ns(G,C,R,j,q,Q){var re=j*j;if(j>0&&C.size<(q?re:j))R.numPoints+=C.length/3;else{for(var te=[],ee=0;ee<C.length;ee+=3)(j===0||C[ee+2]>re)&&(R.numSimplified++,te.push(C[ee]),te.push(C[ee+1])),R.numPoints++;q&&function(se,_e){for(var Me=0,ge=0,vt=se.length,wt=vt-2;ge<vt;wt=ge,ge+=2)Me+=(se[ge]-se[wt])*(se[ge+1]+se[wt+1]);if(Me>0===_e)for(ge=0,vt=se.length;ge<vt/2;ge+=2){var ot=se[ge],Pt=se[ge+1];se[ge]=se[vt-2-ge],se[ge+1]=se[vt-1-ge],se[vt-2-ge]=ot,se[vt-1-ge]=Pt}}(te,Q),G.push(te)}}function Cr(G,C){var R=(C=this.options=function(q,Q){for(var re in Q)q[re]=Q[re];return q}(Object.create(this.options),C)).debug;if(R&&console.time("preprocess data"),C.maxZoom<0||C.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(C.promoteId&&C.generateId)throw new Error("promoteId and generateId cannot be used together.");var j=function(q,Q){var re=[];if(q.type==="FeatureCollection")for(var te=0;te<q.features.length;te++)Pe(re,q.features[te],Q,te);else Pe(re,q.type==="Feature"?q:{geometry:q},Q);return re}(G,C);this.tiles={},this.tileCoords=[],R&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",C.indexMaxZoom,C.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),j=function(q,Q){var re=Q.buffer/Q.extent,te=q,ee=cn(q,1,-1-re,re,0,-1,2,Q),se=cn(q,1,1-re,2+re,0,-1,2,Q);return(ee||se)&&(te=cn(q,1,-re,1+re,0,-1,2,Q)||[],ee&&(te=Br(ee,1).concat(te)),se&&(te=te.concat(Br(se,-1)))),te}(j,C),j.length&&this.splitTile(j,0,0,0),R&&(j.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ms(G,C,R){return 32*((1<<G)*R+C)+G}function gs(G,C){const R=G.tileID.canonical;if(!this._geoJSONIndex)return C(null,null);const j=this._geoJSONIndex.getTile(R.z,R.x,R.y);if(!j)return C(null,null);const q=new Zt(j.features);let Q=Xe.exports(q);Q.byteOffset===0&&Q.byteLength===Q.buffer.byteLength||(Q=new Uint8Array(Q)),C(null,{vectorTile:q,rawData:Q.buffer})}Cr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Cr.prototype.splitTile=function(G,C,R,j,q,Q,re){for(var te=[G,C,R,j],ee=this.options,se=ee.debug;te.length;){j=te.pop(),R=te.pop(),C=te.pop(),G=te.pop();var _e=1<<C,Me=ms(C,R,j),ge=this.tiles[Me];if(!ge&&(se>1&&console.time("creation"),ge=this.tiles[Me]=$n(G,C,R,j,ee),this.tileCoords.push({z:C,x:R,y:j}),se)){se>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",C,R,j,ge.numFeatures,ge.numPoints,ge.numSimplified),console.timeEnd("creation"));var vt="z"+C;this.stats[vt]=(this.stats[vt]||0)+1,this.total++}if(ge.source=G,q){if(C===ee.maxZoom||C===q)continue;var wt=1<<q-C;if(R!==Math.floor(Q/wt)||j!==Math.floor(re/wt))continue}else if(C===ee.indexMaxZoom||ge.numPoints<=ee.indexMaxPoints)continue;if(ge.source=null,G.length!==0){se>1&&console.time("clipping");var ot,Pt,Bt,di,jt,Yt,pi=.5*ee.buffer/ee.extent,Pi=.5-pi,mn=.5+pi,Vi=1+pi;ot=Pt=Bt=di=null,jt=cn(G,_e,R-pi,R+mn,0,ge.minX,ge.maxX,ee),Yt=cn(G,_e,R+Pi,R+Vi,0,ge.minX,ge.maxX,ee),G=null,jt&&(ot=cn(jt,_e,j-pi,j+mn,1,ge.minY,ge.maxY,ee),Pt=cn(jt,_e,j+Pi,j+Vi,1,ge.minY,ge.maxY,ee),jt=null),Yt&&(Bt=cn(Yt,_e,j-pi,j+mn,1,ge.minY,ge.maxY,ee),di=cn(Yt,_e,j+Pi,j+Vi,1,ge.minY,ge.maxY,ee),Yt=null),se>1&&console.timeEnd("clipping"),te.push(ot||[],C+1,2*R,2*j),te.push(Pt||[],C+1,2*R,2*j+1),te.push(Bt||[],C+1,2*R+1,2*j),te.push(di||[],C+1,2*R+1,2*j+1)}}},Cr.prototype.getTile=function(G,C,R){var j=this.options,q=j.extent,Q=j.debug;if(G<0||G>24)return null;var re=1<<G,te=ms(G,C=(C%re+re)%re,R);if(this.tiles[te])return Us(this.tiles[te],q);Q>1&&console.log("drilling down to z%d-%d-%d",G,C,R);for(var ee,se=G,_e=C,Me=R;!ee&&se>0;)se--,_e=Math.floor(_e/2),Me=Math.floor(Me/2),ee=this.tiles[ms(se,_e,Me)];return ee&&ee.source?(Q>1&&console.log("found parent tile z%d-%d-%d",se,_e,Me),Q>1&&console.time("drilling down"),this.splitTile(ee.source,se,_e,Me,G,C,R),Q>1&&console.timeEnd("drilling down"),this.tiles[te]?Us(this.tiles[te],q):null):null};class Vs extends Oe{constructor(C,R,j,q){super(C,R,j,gs),q&&(this.loadGeoJSON=q)}loadData(C,R){var j;(j=this._pendingRequest)===null||j===void 0||j.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const q=!!(C&&C.request&&C.request.collectResourceTiming)&&new a.RequestPerformance(C.request);this._pendingCallback=R,this._pendingRequest=this.loadGeoJSON(C,(Q,re)=>{if(delete this._pendingCallback,delete this._pendingRequest,Q||!re)return R(Q);if(typeof re!="object")return R(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`));{He(re,!0);try{if(C.filter){const ee=a.createExpression(C.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ee.result==="error")throw new Error(ee.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));const se=re.features.filter(_e=>ee.value.evaluate({zoom:0},_e));re={type:"FeatureCollection",features:se}}this._geoJSONIndex=C.cluster?new X(function({superclusterOptions:ee,clusterProperties:se}){if(!se||!ee)return ee;const _e={},Me={},ge={accumulated:null,zoom:0},vt={properties:null},wt=Object.keys(se);for(const ot of wt){const[Pt,Bt]=se[ot],di=a.createExpression(Bt),jt=a.createExpression(typeof Pt=="string"?[Pt,["accumulated"],["get",ot]]:Pt);_e[ot]=di.value,Me[ot]=jt.value}return ee.map=ot=>{vt.properties=ot;const Pt={};for(const Bt of wt)Pt[Bt]=_e[Bt].evaluate(ge,vt);return Pt},ee.reduce=(ot,Pt)=>{vt.properties=Pt;for(const Bt of wt)ge.accumulated=ot[Bt],ot[Bt]=Me[Bt].evaluate(ge,vt)},ee}(C)).load(re.features):function(ee,se){return new Cr(ee,se)}(re,C.geojsonVtOptions)}catch(ee){return R(ee)}this.loaded={};const te={};if(q){const ee=q.finish();ee&&(te.resourceTiming={},te.resourceTiming[C.source]=JSON.parse(JSON.stringify(ee)))}R(null,te)}})}reloadTile(C,R){const j=this.loaded;return j&&j[C.uid]?super.reloadTile(C,R):this.loadTile(C,R)}loadGeoJSON(C,R){if(C.request)return a.getJSON(C.request,R);if(typeof C.data=="string")try{R(null,JSON.parse(C.data))}catch{R(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`))}else R(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(C,R){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),R()}getClusterExpansionZoom(C,R){try{R(null,this._geoJSONIndex.getClusterExpansionZoom(C.clusterId))}catch(j){R(j)}}getClusterChildren(C,R){try{R(null,this._geoJSONIndex.getChildren(C.clusterId))}catch(j){R(j)}}getClusterLeaves(C,R){try{R(null,this._geoJSONIndex.getLeaves(C.clusterId,C.limit,C.offset))}catch(j){R(j)}}}class _s{constructor(C){this.self=C,this.actor=new a.Actor(C,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Oe,geojson:Vs},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(R,j)=>{if(this.workerSourceTypes[R])throw new Error(`Worker source with name "${R}" already registered.`);this.workerSourceTypes[R]=j},this.self.registerRTLTextPlugin=R=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=R.applyArabicShaping,a.plugin.processBidirectionalText=R.processBidirectionalText,a.plugin.processStyledBidirectionalText=R.processStyledBidirectionalText}}setReferrer(C,R){this.referrer=R}setImages(C,R,j){this.availableImages[C]=R;for(const q in this.workerSources[C]){const Q=this.workerSources[C][q];for(const re in Q)Q[re].availableImages=R}j()}setLayers(C,R,j){this.getLayerIndex(C).replace(R),j()}updateLayers(C,R,j){this.getLayerIndex(C).update(R.layers,R.removedIds),j()}loadTile(C,R,j){this.getWorkerSource(C,R.type,R.source).loadTile(R,j)}loadDEMTile(C,R,j){this.getDEMWorkerSource(C,R.source).loadTile(R,j)}reloadTile(C,R,j){this.getWorkerSource(C,R.type,R.source).reloadTile(R,j)}abortTile(C,R,j){this.getWorkerSource(C,R.type,R.source).abortTile(R,j)}removeTile(C,R,j){this.getWorkerSource(C,R.type,R.source).removeTile(R,j)}removeDEMTile(C,R){this.getDEMWorkerSource(C,R.source).removeTile(R)}removeSource(C,R,j){if(!this.workerSources[C]||!this.workerSources[C][R.type]||!this.workerSources[C][R.type][R.source])return;const q=this.workerSources[C][R.type][R.source];delete this.workerSources[C][R.type][R.source],q.removeSource!==void 0?q.removeSource(R,j):j()}loadWorkerSource(C,R,j){try{this.self.importScripts(R.url),j()}catch(q){j(q.toString())}}syncRTLPluginState(C,R,j){try{a.plugin.setState(R);const q=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&q!=null){this.self.importScripts(q);const Q=a.plugin.isParsed();j(Q?void 0:new Error(`RTL Text Plugin failed to import scripts from ${q}`),Q)}}catch(q){j(q.toString())}}getAvailableImages(C){let R=this.availableImages[C];return R||(R=[]),R}getLayerIndex(C){let R=this.layerIndexes[C];return R||(R=this.layerIndexes[C]=new F),R}getWorkerSource(C,R,j){if(this.workerSources[C]||(this.workerSources[C]={}),this.workerSources[C][R]||(this.workerSources[C][R]={}),!this.workerSources[C][R][j]){const q={send:(Q,re,te)=>{this.actor.send(Q,re,te,C)}};this.workerSources[C][R][j]=new this.workerSourceTypes[R](q,this.getLayerIndex(C),this.getAvailableImages(C))}return this.workerSources[C][R][j]}getDEMWorkerSource(C,R){return this.demWorkerSources[C]||(this.demWorkerSources[C]={}),this.demWorkerSources[C][R]||(this.demWorkerSources[C][R]=new Je),this.demWorkerSources[C][R]}enforceCacheSizeLimit(C,R){a.enforceCacheSizeLimit(R)}}return a.isWorker()&&(self.worker=new _s(self)),_s}),v(["./shared"],function(a){var k=$;function $(h){return!function(t){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var u,p,g=new Blob([""],{type:"text/javascript"}),x=URL.createObjectURL(g);try{p=new Worker(x),u=!0}catch{u=!1}return p&&p.terminate(),URL.revokeObjectURL(x),u}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var u=document.createElement("canvas");u.width=u.height=1;var p=u.getContext("2d");if(!p)return!1;var g=p.getImageData(0,0,1,1);return g&&g.width===u.width}()?(F[s=t&&t.failIfMajorPerformanceCaveat]===void 0&&(F[s]=function(u){var p,g=function(x){var E=document.createElement("canvas"),S=Object.create($.webGLContextAttributes);return S.failIfMajorPerformanceCaveat=x,E.getContext("webgl",S)||E.getContext("experimental-webgl",S)}(u);if(!g)return!1;try{p=g.createShader(g.VERTEX_SHADER)}catch{return!1}return!(!p||g.isContextLost())&&(g.shaderSource(p,"void main() {}"),g.compileShader(p),g.getShaderParameter(p,g.COMPILE_STATUS)===!0)}(s)),F[s]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var s}(h)}var F={};function B(h,t){if(Array.isArray(h)){if(!Array.isArray(t)||h.length!==t.length)return!1;for(let s=0;s<h.length;s++)if(!B(h[s],t[s]))return!1;return!0}if(typeof h=="object"&&h!==null&&t!==null){if(typeof t!="object"||Object.keys(h).length!==Object.keys(t).length)return!1;for(const s in h)if(!B(h[s],t[s]))return!1;return!0}return h===t}$.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class M{static testProp(t){if(!M.docStyle)return t[0];for(let s=0;s<t.length;s++)if(t[s]in M.docStyle)return t[s];return t[0]}static create(t,s,u){const p=window.document.createElement(t);return s!==void 0&&(p.className=s),u&&u.appendChild(p),p}static createNS(t,s){return window.document.createElementNS(t,s)}static disableDrag(){M.docStyle&&M.selectProp&&(M.userSelect=M.docStyle[M.selectProp],M.docStyle[M.selectProp]="none")}static enableDrag(){M.docStyle&&M.selectProp&&(M.docStyle[M.selectProp]=M.userSelect)}static setTransform(t,s){t.style[M.transformProp]=s}static addEventListener(t,s,u,p={}){t.addEventListener(s,u,"passive"in p?p:p.capture)}static removeEventListener(t,s,u,p={}){t.removeEventListener(s,u,"passive"in p?p:p.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",M.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",M.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",M.suppressClickInternal,!0)},0)}static mousePos(t,s){const u=t.getBoundingClientRect();return new a.pointGeometry(s.clientX-u.left-t.clientLeft,s.clientY-u.top-t.clientTop)}static touchPos(t,s){const u=t.getBoundingClientRect(),p=[];for(let g=0;g<s.length;g++)p.push(new a.pointGeometry(s[g].clientX-u.left-t.clientLeft,s[g].clientY-u.top-t.clientTop));return p}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}M.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,M.selectProp=M.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),M.transformProp=M.testProp(["transform","WebkitTransform"]);class le{constructor(t){this._transformRequestFn=t}transformRequest(t,s){return this._transformRequestFn&&this._transformRequestFn(t,s)||{url:t}}normalizeSpriteURL(t,s,u){const p=function(g){const x=g.match(Ee);if(!x)throw new Error(`Unable to parse URL "${g}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}}(t);return p.path+=`${s}${u}`,function(g){const x=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${x}`}(p)}setTransformRequest(t){this._transformRequestFn=t}}const Ee=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class Oe{constructor(t,s,u,p){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(s,p)}update(t,s,u){const{width:p,height:g}=t,x=!(this.size&&this.size[0]===p&&this.size[1]===g||u),{context:E}=this,{gl:S}=E;if(this.useMipmap=Boolean(s&&s.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!s||s.premultiply!==!1)),x)this.size=[p,g],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||a.isImageBitmap(t)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,t):S.texImage2D(S.TEXTURE_2D,0,this.format,p,g,0,this.format,S.UNSIGNED_BYTE,t.data);else{const{x:A,y:z}=u||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||a.isImageBitmap(t)?S.texSubImage2D(S.TEXTURE_2D,0,A,z,S.RGBA,S.UNSIGNED_BYTE,t):S.texSubImage2D(S.TEXTURE_2D,0,A,z,p,g,S.RGBA,S.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(t,s,u){const{context:p}=this,{gl:g}=p;g.bindTexture(g.TEXTURE_2D,this.texture),u!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=g.LINEAR),t!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,t),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,u||t),this.filter=t),s!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,s),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Je(h){const{userImage:t}=h;return!!(t&&t.render&&t.render())&&(h.data.replace(new Uint8Array(t.data.buffer)),!0)}class He extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:s,callback:u}of this.requestors)this._notify(s,u);this.requestors=[]}}getImage(t){return this.images[t]}addImage(t,s){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,s)&&(this.images[t]=s)}_validate(t,s){let u=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),u=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),u=!1),this._validateContent(s.content,s)||(this.fire(new a.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),u=!1),u}_validateStretch(t,s){if(!t)return!0;let u=0;for(const p of t){if(p[0]<u||p[1]<p[0]||s<p[1])return!1;u=p[1]}return!0}_validateContent(t,s){return!(t&&(t.length!==4||t[0]<0||s.data.width<t[0]||t[1]<0||s.data.height<t[1]||t[2]<0||s.data.width<t[2]||t[3]<0||s.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,s){const u=this.images[t];if(u.data.width!==s.data.width||u.data.height!==s.data.height)throw new Error(`size mismatch between old image (${u.data.width}x${u.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=u.version+1,this.images[t]=s,this.updatedImages[t]=!0}removeImage(t){const s=this.images[t];delete this.images[t],delete this.patterns[t],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,s){let u=!0;if(!this.isLoaded())for(const p of t)this.images[p]||(u=!1);this.isLoaded()||u?this._notify(t,s):this.requestors.push({ids:t,callback:s})}_notify(t,s){const u={};for(const p of t){this.images[p]||this.fire(new a.Event("styleimagemissing",{id:p}));const g=this.images[p];g?u[p]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,hasRenderCallback:Boolean(g.userImage&&g.userImage.render)}:a.warnOnce(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,u)}getPixelSize(){const{width:t,height:s}=this.atlasImage;return{width:t,height:s}}getPattern(t){const s=this.patterns[t],u=this.getImage(t);if(!u)return null;if(s&&s.position.version===u.version)return s.position;if(s)s.position.version=u.version;else{const p={w:u.data.width+2,h:u.data.height+2,x:0,y:0},g=new a.ImagePosition(p,u);this.patterns[t]={bin:p,position:g}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const s=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Oe(t,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const g in this.patterns)t.push(this.patterns[g].bin);const{w:s,h:u}=a.potpack(t),p=this.atlasImage;p.resize({width:s||1,height:u||1});for(const g in this.patterns){const{bin:x}=this.patterns[g],E=x.x+1,S=x.y+1,A=this.images[g].data,z=A.width,L=A.height;a.RGBAImage.copy(A,p,{x:0,y:0},{x:E,y:S},{width:z,height:L}),a.RGBAImage.copy(A,p,{x:0,y:L-1},{x:E,y:S-1},{width:z,height:1}),a.RGBAImage.copy(A,p,{x:0,y:0},{x:E,y:S+L},{width:z,height:1}),a.RGBAImage.copy(A,p,{x:z-1,y:0},{x:E-1,y:S},{width:1,height:L}),a.RGBAImage.copy(A,p,{x:0,y:0},{x:E+z,y:S},{width:1,height:L})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const s of t){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const u=this.images[s];u||a.warnOnce(`Image with ID: "${s}" was not found`),Je(u)&&this.updateImage(s,u)}}}const De=1e20;function tt(h,t,s,u,p,g,x,E,S){for(let A=t;A<t+u;A++)Nt(h,s*g+A,g,p,x,E,S);for(let A=s;A<s+p;A++)Nt(h,A*g+t,1,u,x,E,S)}function Nt(h,t,s,u,p,g,x){g[0]=0,x[0]=-De,x[1]=De,p[0]=h[t];for(let E=1,S=0,A=0;E<u;E++){p[E]=h[t+E*s];const z=E*E;do{const L=g[S];A=(p[E]-p[L]+z-L*L)/(E-L)/2}while(A<=x[S]&&--S>-1);S++,g[S]=E,x[S]=A,x[S+1]=De}for(let E=0,S=0;E<u;E++){for(;x[S+1]<E;)S++;const A=g[S],z=E-A;h[t+E*s]=p[A]+z*z}}class Ce{constructor(t,s){this.requestManager=t,this.localIdeographFontFamily=s,this.entries={}}setURL(t){this.url=t}getGlyphs(t,s){const u=[];for(const p in t)for(const g of t[p])u.push({stack:p,id:g});a.asyncAll(u,({stack:p,id:g},x)=>{let E=this.entries[p];E||(E=this.entries[p]={glyphs:{},requests:{},ranges:{}});let S=E.glyphs[g];if(S!==void 0)return void x(null,{stack:p,id:g,glyph:S});if(S=this._tinySDF(E,p,g),S)return E.glyphs[g]=S,void x(null,{stack:p,id:g,glyph:S});const A=Math.floor(g/256);if(256*A>65535)return void x(new Error("glyphs > 65535 not supported"));if(E.ranges[A])return void x(null,{stack:p,id:g,glyph:S});let z=E.requests[A];z||(z=E.requests[A]=[],Ce.loadGlyphRange(p,A,this.url,this.requestManager,(L,U)=>{if(U){for(const H in U)this._doesCharSupportLocalGlyph(+H)||(E.glyphs[+H]=U[+H]);E.ranges[A]=!0}for(const H of z)H(L,U);delete E.requests[A]})),z.push((L,U)=>{L?x(L):U&&x(null,{stack:p,id:g,glyph:U[g]||null})})},(p,g)=>{if(p)s(p);else if(g){const x={};for(const{stack:E,id:S,glyph:A}of g)(x[E]||(x[E]={}))[S]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics};s(null,x)}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(a.unicodeBlockLookup["CJK Unified Ideographs"](t)||a.unicodeBlockLookup["Hangul Syllables"](t)||a.unicodeBlockLookup.Hiragana(t)||a.unicodeBlockLookup.Katakana(t))}_tinySDF(t,s,u){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let g=t.tinySDF;if(!g){let E="400";/bold/i.test(s)?E="900":/medium/i.test(s)?E="500":/light/i.test(s)&&(E="200"),g=t.tinySDF=new Ce.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:p,fontWeight:E})}const x=g.draw(String.fromCharCode(u));return{id:u,bitmap:new a.AlphaImage({width:x.width||30,height:x.height||30},x.data),metrics:{width:x.glyphWidth||24,height:x.glyphHeight||24,left:x.glyphLeft||0,top:x.glyphTop-27||-8,advance:x.glyphAdvance||24}}}}Ce.loadGlyphRange=function(h,t,s,u,p){const g=256*t,x=g+255,E=u.transformRequest(s.replace("{fontstack}",h).replace("{range}",`${g}-${x}`),a.ResourceType.Glyphs);a.getArrayBuffer(E,(S,A)=>{if(S)p(S);else if(A){const z={};for(const L of a.parseGlyphPbf(A))z[L.id]=L;p(null,z)}})},Ce.TinySDF=class{constructor({fontSize:h=24,buffer:t=3,radius:s=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:g="normal",fontStyle:x="normal"}={}){this.buffer=t,this.cutoff=u,this.radius=s;const E=this.size=h+4*t,S=this._createCanvas(E),A=this.ctx=S.getContext("2d",{willReadFrequently:!0});A.font=`${x} ${g} ${h}px ${p}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(h){const t=document.createElement("canvas");return t.width=t.height=h,t}draw(h){const{width:t,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:g}=this.ctx.measureText(h),x=Math.ceil(s),E=Math.min(this.size-this.buffer,Math.ceil(g-p)),S=Math.min(this.size-this.buffer,x+Math.ceil(u)),A=E+2*this.buffer,z=S+2*this.buffer,L=Math.max(A*z,0),U=new Uint8ClampedArray(L),H={data:U,width:A,height:z,glyphWidth:E,glyphHeight:S,glyphTop:x,glyphLeft:0,glyphAdvance:t};if(E===0||S===0)return H;const{ctx:W,buffer:Z,gridInner:ne,gridOuter:oe}=this;W.clearRect(Z,Z,E,S),W.fillText(h,Z,Z+x);const ue=W.getImageData(Z,Z,E,S);oe.fill(De,0,L),ne.fill(0,0,L);for(let K=0;K<S;K++)for(let fe=0;fe<E;fe++){const de=ue.data[4*(K*E+fe)+3]/255;if(de===0)continue;const xe=(K+Z)*A+fe+Z;if(de===1)oe[xe]=0,ne[xe]=De;else{const we=.5-de;oe[xe]=we>0?we*we:0,ne[xe]=we<0?we*we:0}}tt(oe,0,0,A,z,A,this.f,this.v,this.z),tt(ne,Z,Z,E,S,A,this.f,this.v,this.z);for(let K=0;K<L;K++){const fe=Math.sqrt(oe[K])-Math.sqrt(ne[K]);U[K]=Math.round(255-255*(fe/this.radius+this.cutoff))}return H}};const Zt=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(h,t){return a.sphericalToCartesian(h.expression.evaluate(t))}interpolate(h,t,s){return{x:a.number(h.x,t.x,s),y:a.number(h.y,t.y,s),z:a.number(h.z,t.z,s)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),Xe="-transition";class ht extends a.Evented{constructor(t){super(),this._transitionable=new a.Transitionable(Zt),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,s={}){if(!this._validate(a.validateLight,t,s))for(const u in t){const p=t[u];u.endsWith(Xe)?this._transitionable.setTransition(u.slice(0,-Xe.length),p):this._transitionable.setValue(u,p)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,u){return(!u||u.validate!==!1)&&a.emitValidationErrors(this,t.call(a.validateStyle,a.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class it{constructor(t,s){this.width=t,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,s){const u=t.join(",")+String(s);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(t,s)),this.dashEntry[u]}getDashRanges(t,s,u){const p=[];let g=t.length%2==1?-t[t.length-1]*u:0,x=t[0]*u,E=!0;p.push({left:g,right:x,isDash:E,zeroLength:t[0]===0});let S=t[0];for(let A=1;A<t.length;A++){E=!E;const z=t[A];g=S*u,S+=z,x=S*u,p.push({left:g,right:x,isDash:E,zeroLength:z===0})}return p}addRoundDash(t,s,u){const p=s/2;for(let g=-u;g<=u;g++){const x=this.width*(this.nextRow+u+g);let E=0,S=t[E];for(let A=0;A<this.width;A++){A/S.right>1&&(S=t[++E]);const z=Math.abs(A-S.left),L=Math.abs(A-S.right),U=Math.min(z,L);let H;const W=g/u*(p+1);if(S.isDash){const Z=p-Math.abs(W);H=Math.sqrt(U*U+Z*Z)}else H=p-Math.sqrt(U*U+W*W);this.data[x+A]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(t){for(let E=t.length-1;E>=0;--E){const S=t[E],A=t[E+1];S.zeroLength?t.splice(E,1):A&&A.isDash===S.isDash&&(A.left=S.left,t.splice(E,1))}const s=t[0],u=t[t.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);const p=this.width*this.nextRow;let g=0,x=t[g];for(let E=0;E<this.width;E++){E/x.right>1&&(x=t[++g]);const S=Math.abs(E-x.left),A=Math.abs(E-x.right),z=Math.min(S,A);this.data[p+E]=Math.max(0,Math.min(255,(x.isDash?z:-z)+128))}}addDash(t,s){const u=s?7:0,p=2*u+1;if(this.nextRow+p>this.height)return a.warnOnce("LineAtlas out of space"),null;let g=0;for(let E=0;E<t.length;E++)g+=t[E];if(g!==0){const E=this.width/g,S=this.getDashRanges(t,this.width,E);s?this.addRoundDash(S,E,u):this.addRegularDash(S)}const x={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:g};return this.nextRow+=p,this.dirty=!0,x}bind(t){const s=t.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}class Ue{constructor(t,s){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const u=this.workerPool.acquire(this.id);for(let p=0;p<u.length;p++){const g=new Ue.Actor(u[p],s,this.id);g.name=`Worker ${p}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,s,u){a.asyncAll(this.actors,(p,g)=>{p.send(t,s,g)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ct(h,t,s){const u=function(p,g){if(p)return s(p);if(g){const x=a.pick(a.extend(g,h),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(x.vectorLayers=g.vector_layers,x.vectorLayerIds=x.vectorLayers.map(E=>E.id)),s(null,x)}};return h.url?a.getJSON(t.transformRequest(h.url,a.ResourceType.Source),u):a.exported.frame(()=>u(null,h))}Ue.Actor=a.Actor;class Re{constructor(t,s,u){this.bounds=a.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=s||0,this.maxzoom=u||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const s=Math.pow(2,t.z),u=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),p=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),g=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),x=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return t.x>=u&&t.x<g&&t.y>=p&&t.y<x}}class Rt extends a.Evented{constructor(t,s,u,p){if(super(),this.id=t,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(s,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ct(this._options,this.map._requestManager,(t,s)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t?this.fire(new a.ErrorEvent(t)):s&&(a.extend(this,s),s.bounds&&(this.tileBounds=new Re(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(t,s){const u=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(u,a.ResourceType.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function g(x,E){return delete t.request,t.aborted?s(null):x&&x.status!==404?s(x):(E&&E.resourceTiming&&(t.resourceTiming=E.resourceTiming),this.map._refreshExpiredTiles&&E&&t.setExpiryData(E),t.loadVectorData(E,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),s(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}p.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired"?t.state==="loading"?t.reloadCallback=s:t.request=t.actor.send("reloadTile",p,g.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",p,g.bind(this)))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class ai extends a.Evented{constructor(t,s,u,p){super(),this.id=t,this.dispatcher=u,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},s),a.extend(this,a.pick(s,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ct(this._options,this.map._requestManager,(t,s)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new a.ErrorEvent(t)):s&&(a.extend(this,s),s.bounds&&(this.tileBounds=new Re(s.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,s){const u=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.request=a.getImage(this.map._requestManager.transformRequest(u,a.ResourceType.Tile),(p,g,x)=>{if(delete t.request,t.aborted)t.state="unloaded",s(null);else if(p)t.state="errored",s(p);else if(g){this.map._refreshExpiredTiles&&t.setExpiryData(x);const E=this.map.painter.context,S=E.gl;t.texture=this.map.painter.getTileTexture(g.width),t.texture?t.texture.update(g,{useMipmap:!0}):(t.texture=new Oe(E,g,S.RGBA,{useMipmap:!0}),t.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),E.extTextureFilterAnisotropic&&S.texParameterf(S.TEXTURE_2D,E.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,E.extTextureFilterAnisotropicMax)),t.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),s(null)}})}abortTile(t,s){t.request&&(t.request.cancel(),delete t.request),s()}unloadTile(t,s){t.texture&&this.map.painter.saveTileTexture(t.texture),s()}hasTransition(){return!1}}let yi;class We extends ai{constructor(t,s,u,p){super(t,s,u,p),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(t,s){const u=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function p(g,x){g&&(t.state="errored",s(g)),x&&(t.dem=x,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded",s(null))}t.request=a.getImage(this.map._requestManager.transformRequest(u,a.ResourceType.Tile),function(g,x){if(delete t.request,t.aborted)t.state="unloaded",s(null);else if(g)t.state="errored",s(g);else if(x){this.map._refreshExpiredTiles&&t.setExpiryData(x),delete x.cacheControl,delete x.expires;const E=a.isImageBitmap(x)&&(yi==null&&(yi=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),yi)?x:a.exported.getImageData(x,1),S={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:E,encoding:this.encoding};t.actor&&t.state!=="expired"||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",S,p.bind(this)))}}.bind(this)),t.neighboringTiles=this._getNeighboringTiles(t.tileID)}_getNeighboringTiles(t){const s=t.canonical,u=Math.pow(2,s.z),p=(s.x-1+u)%u,g=s.x===0?t.wrap-1:t.wrap,x=(s.x+1+u)%u,E=s.x+1===u?t.wrap+1:t.wrap,S={};return S[new a.OverscaledTileID(t.overscaledZ,g,s.z,p,s.y).key]={backfilled:!1},S[new a.OverscaledTileID(t.overscaledZ,E,s.z,x,s.y).key]={backfilled:!1},s.y>0&&(S[new a.OverscaledTileID(t.overscaledZ,g,s.z,p,s.y-1).key]={backfilled:!1},S[new a.OverscaledTileID(t.overscaledZ,t.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},S[new a.OverscaledTileID(t.overscaledZ,E,s.z,x,s.y-1).key]={backfilled:!1}),s.y+1<u&&(S[new a.OverscaledTileID(t.overscaledZ,g,s.z,p,s.y+1).key]={backfilled:!1},S[new a.OverscaledTileID(t.overscaledZ,t.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},S[new a.OverscaledTileID(t.overscaledZ,E,s.z,x,s.y+1).key]={backfilled:!1}),S}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}class St extends a.Evented{constructor(t,s,u,p){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(p),this._data=s.data,this._options=a.extend({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const g=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*g,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*g,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:a.EXTENT,radius:(s.clusterRadius||50)*g,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData("content"),this}getClusterExpansionZoom(t,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},s),this}getClusterChildren(t,s){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},s),this}getClusterLeaves(t,s,u,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:s,offset:u},p),this}_updateWorkerData(t){const s=a.extend({},this.workerOptions),u=this._data;typeof u=="string"?(s.request=this.map._requestManager.transformRequest(a.exported.resolveURL(u),a.ResourceType.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(u),this._pendingLoads++,this.fire(new a.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,s,(p,g)=>{if(this._pendingLoads--,this._removed||g&&g.abandoned)return void this.fire(new a.Event("dataabort",{dataType:"source",sourceDataType:t}));let x=null;if(g&&g.resourceTiming&&g.resourceTiming[this.id]&&(x=g.resourceTiming[this.id].slice(0)),p)return void this.fire(new a.ErrorEvent(p));const E={dataType:"source",sourceDataType:t};this._collectResourceTiming&&x&&x.length>0&&a.extend(E,{resourceTiming:x}),this.fire(new a.Event("data",E))})}loaded(){return this._pendingLoads===0}loadTile(t,s){const u=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const p={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(u,p,(g,x)=>(delete t.request,t.unloadVectorData(),t.aborted?s(null):g?s(g):(t.loadVectorData(x,this.map.painter,u==="reloadTile"),s(null))))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Xt=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Oi extends a.Evented{constructor(t,s,u,p){super(),this.id=t,this.dispatcher=u,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=s}load(t,s){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(u,p)=>{this._loaded=!0,u?this.fire(new a.ErrorEvent(u)):p&&(this.image=p,t&&(this.coordinates=t),s&&s(),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}setCoordinates(t){this.coordinates=t;const s=t.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(p){let g=1/0,x=1/0,E=-1/0,S=-1/0;for(const U of p)g=Math.min(g,U.x),x=Math.min(x,U.y),E=Math.max(E,U.x),S=Math.max(S,U.y);const A=Math.max(E-g,S-x),z=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),L=Math.pow(2,z);return new a.CanonicalTileID(z,Math.floor((g+E)/2*L),Math.floor((x+S)/2*L))}(s),this.minzoom=this.maxzoom=this.tileID.z;const u=s.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new a.RasterBoundsArray,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(u[2].x,u[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,s=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Xt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Oe(t,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}loadTile(t,s){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},s(null)):(t.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Ni extends Oi{constructor(t,s,u,p){super(t,s,u,p),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const s of t.urls)this.urls.push(this.map._requestManager.transformRequest(s,a.ResourceType.Source).url);a.getVideo(this.urls,(s,u)=>{this._loaded=!0,s?this.fire(new a.ErrorEvent(s)):u&&(this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const s=this.video.seekable;t<s.start(0)||t>s.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,s=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Xt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new Oe(t,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class In extends Oi{constructor(t,s,u,p){super(t,s,u,p),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(x=>typeof x!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${t}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${t}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,u=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Xt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Oe(s,this.canvas,u.RGBA,{premultiply:!0});for(const p in this.tiles){const g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Bn={vector:Rt,raster:ai,"raster-dem":We,geojson:St,video:Ni,image:Oi,canvas:In};function Fn(h,t){const s=a.create();return a.translate(s,s,[1,1,0]),a.scale(s,s,[.5*h.width,.5*h.height,1]),a.multiply(s,s,h.calculatePosMatrix(t.toUnwrapped()))}function pn(h,t,s,u,p,g){const x=function(L,U,H){if(L)for(const W of L){const Z=U[W];if(Z&&Z.source===H&&Z.type==="fill-extrusion")return!0}else for(const W in U){const Z=U[W];if(Z.source===H&&Z.type==="fill-extrusion")return!0}return!1}(p&&p.layers,t,h.id),E=g.maxPitchScaleFactor(),S=h.tilesIn(u,E,x);S.sort(Te);const A=[];for(const L of S)A.push({wrappedTileID:L.tileID.wrapped().key,queryResults:L.tile.queryRenderedFeatures(t,s,h._state,L.queryGeometry,L.cameraQueryGeometry,L.scale,p,g,E,Fn(h.transform,L.tileID))});const z=function(L){const U={},H={};for(const W of L){const Z=W.queryResults,ne=W.wrappedTileID,oe=H[ne]=H[ne]||{};for(const ue in Z){const K=Z[ue],fe=oe[ue]=oe[ue]||{},de=U[ue]=U[ue]||[];for(const xe of K)fe[xe.featureIndex]||(fe[xe.featureIndex]=!0,de.push(xe))}}return U}(A);for(const L in z)z[L].forEach(U=>{const H=U.feature,W=h.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=W});return z}function Te(h,t){const s=h.tileID,u=t.tileID;return s.overscaledZ-u.overscaledZ||s.canonical.y-u.canonical.y||s.wrap-u.wrap||s.canonical.x-u.canonical.x}class gt{constructor(t,s){this.tileID=t,this.uid=a.uniqueId(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const s=t+this.timeAdded;s<a.exported.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.textures.forEach(s=>t.saveTileTexture(s)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(t,s,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(p,g){const x={};if(!g)return x;for(const E of p){const S=E.layerIds.map(A=>g.getLayer(A)).filter(Boolean);if(S.length!==0){E.layers=S,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(A=>S.filter(z=>z.id===A)[0]));for(const A of S)x[A.id]=E}}return x}(t.buckets,s.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const g=this.buckets[p];if(g instanceof a.SymbolBucket){if(this.hasSymbolBuckets=!0,!u)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const g=this.buckets[p];if(g instanceof a.SymbolBucket&&g.hasRTLText){this.hasRTLText=!0,a.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const p in this.buckets){const g=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(p).queryRadius(g))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new a.CollisionBoxArray}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const u in this.buckets){const p=this.buckets[u];p.uploadPending()&&p.upload(t)}const s=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Oe(t,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Oe(t,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,s,u,p,g,x,E,S,A,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:g,scale:x,tileSize:this.tileSize,pixelPosMatrix:z,transform:S,params:E,queryPadding:this.queryPadding*A},t,s,u):{}}querySourceFeatures(t,s){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const p=u.loadVTLayers(),g=s?s.sourceLayer:"",x=p._geojsonTileLayer||p[g];if(!x)return;const E=a.createFilter(s&&s.filter),{z:S,x:A,y:z}=this.tileID.canonical,L={z:S,x:A,y:z};for(let U=0;U<x.length;U++){const H=x.feature(U);if(E.needGeometry){const ne=a.toEvaluationFeature(H,!0);if(!E.filter(new a.EvaluationParameters(this.tileID.overscaledZ),ne,this.tileID.canonical))continue}else if(!E.filter(new a.EvaluationParameters(this.tileID.overscaledZ),H))continue;const W=u.getId(H,g),Z=new a.GeoJSONFeature(H,S,A,z,W);Z.tile=L,t.push(Z)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const s=this.expirationTime;if(t.cacheControl){const u=a.parseCacheControl(t.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const u=Date.now();let p=!1;if(this.expirationTime>u)p=!1;else if(s)if(this.expirationTime<s)p=!0;else{const g=this.expirationTime-s;g?this.expirationTime=u+Math.max(g,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!s.style.hasLayer(p))continue;const g=this.buckets[p],x=g.layers[0].sourceLayer||"_geojsonTileLayer",E=u[x],S=t[x];if(!E||!S||Object.keys(S).length===0)continue;g.update(S,E,this.imageAtlas&&this.imageAtlas.patternPositions||{});const A=s&&s.style&&s.style.getLayer(p);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=a.exported.now()+t}setDependencies(t,s){const u={};for(const p of s)u[p]=!0;this.dependencies[t]=u}hasDependency(t,s){for(const u of t){const p=this.dependencies[u];if(p){for(const g of s)if(p[g])return!0}}return!1}}class ut{constructor(t,s){this.max=t,this.onRemove=s,this.reset()}reset(){for(const t in this.data)for(const s of this.data[t])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(t,s,u){const p=t.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const g={value:s,timeout:void 0};if(u!==void 0&&(g.timeout=setTimeout(()=>{this.remove(t,g)},u)),this.data[p].push(g),this.order.push(p),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const s=this.data[t].shift();return s.timeout&&clearTimeout(s.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),s.value}getByKey(t){const s=this.data[t];return s?s[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,s){if(!this.has(t))return this;const u=t.wrapped().key,p=s===void 0?0:this.data[u].indexOf(s),g=this.data[u][p];return this.data[u].splice(p,1),g.timeout&&clearTimeout(g.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(g.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(t){const s=[];for(const u in this.data)for(const p of this.data[u])t(p.value)||s.push(p);for(const u of s)this.remove(u.value.tileID,u)}}class ft{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,s,u){const p=String(s);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][p]=this.stateChanges[t][p]||{},a.extend(this.stateChanges[t][p],u),this.deletedStates[t]===null){this.deletedStates[t]={};for(const g in this.state[t])g!==p&&(this.deletedStates[t][g]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][p]===null){this.deletedStates[t][p]={};for(const g in this.state[t][p])u[g]||(this.deletedStates[t][p][g]=null)}else for(const g in u)this.deletedStates[t]&&this.deletedStates[t][p]&&this.deletedStates[t][p][g]===null&&delete this.deletedStates[t][p][g]}removeFeatureState(t,s,u){if(this.deletedStates[t]===null)return;const p=String(s);if(this.deletedStates[t]=this.deletedStates[t]||{},u&&s!==void 0)this.deletedStates[t][p]!==null&&(this.deletedStates[t][p]=this.deletedStates[t][p]||{},this.deletedStates[t][p][u]=null);else if(s!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][p])for(u in this.deletedStates[t][p]={},this.stateChanges[t][p])this.deletedStates[t][p][u]=null;else this.deletedStates[t][p]=null;else this.deletedStates[t]=null}getState(t,s){const u=String(s),p=a.extend({},(this.state[t]||{})[u],(this.stateChanges[t]||{})[u]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const g=this.deletedStates[t][s];if(g===null)return{};for(const x in g)delete p[x]}return p}initializeTileState(t,s){t.setFeatureState(this.state,s)}coalesceChanges(t,s){const u={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const g={};for(const x in this.stateChanges[p])this.state[p][x]||(this.state[p][x]={}),a.extend(this.state[p][x],this.stateChanges[p][x]),g[x]=this.state[p][x];u[p]=g}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const g={};if(this.deletedStates[p]===null)for(const x in this.state[p])g[x]={},this.state[p][x]={};else for(const x in this.deletedStates[p]){if(this.deletedStates[p][x]===null)this.state[p][x]={};else for(const E of Object.keys(this.deletedStates[p][x]))delete this.state[p][x][E];g[x]=this.state[p][x]}u[p]=u[p]||{},a.extend(u[p],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const p in t)t[p].setFeatureState(u,s)}}class $t extends a.Evented{constructor(t,s,u){super(),this.id=t,this.dispatcher=u,this.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(p,g,x,E){const S=new Bn[g.type](p,g,x,E);if(S.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${S.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],S),S}(t,s,u,this),this._tiles={},this._cache=new ut(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ft}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const s=this._tiles[t];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,s){return this._source.loadTile(t,s)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){this._source.abortTile&&this._source.abortTile(t,()=>{}),this._source.fire(new a.Event("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const u=this._tiles[s];u.upload(t),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(ki).map(t=>t.key)}getRenderableIds(t){const s=[];for(const u in this._tiles)this._isIdRenderable(u,t)&&s.push(this._tiles[u]);return t?s.sort((u,p)=>{const g=u.tileID,x=p.tileID,E=new a.pointGeometry(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),S=new a.pointGeometry(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-x.overscaledZ||S.y-E.y||S.x-E.x}).map(u=>u.tileID.key):s.map(u=>u.tileID).sort(ki).map(u=>u.key)}hasRenderableParent(t){const s=this.findLoadedParent(t,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(t,s){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(s||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,s){const u=this._tiles[t];u&&(u.state!=="loading"&&(u.state=s),this._loadTile(u,this._tileLoaded.bind(this,u,t,s)))}_tileLoaded(t,s,u,p){if(p)return t.state="errored",void(p.status!==404?this._source.fire(new a.ErrorEvent(p,{tile:t})):this.update(this.transform,this.terrain));t.timeAdded=a.exported.now(),u==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(s,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new a.Event("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const s=this.getRenderableIds();for(let p=0;p<s.length;p++){const g=s[p];if(t.neighboringTiles&&t.neighboringTiles[g]){const x=this.getTileByID(g);u(t,x),u(x,t)}}function u(p,g){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let x=g.tileID.canonical.x-p.tileID.canonical.x;const E=g.tileID.canonical.y-p.tileID.canonical.y,S=Math.pow(2,p.tileID.canonical.z),A=g.tileID.key;x===0&&E===0||Math.abs(E)>1||(Math.abs(x)>1&&(Math.abs(x+S)===1?x+=S:Math.abs(x-S)===1&&(x-=S)),g.dem&&p.dem&&(p.dem.backfillBorder(g.dem,x,E),p.neighboringTiles&&p.neighboringTiles[A]&&(p.neighboringTiles[A].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,s,u,p){for(const g in this._tiles){let x=this._tiles[g];if(p[g]||!x.hasData()||x.tileID.overscaledZ<=s||x.tileID.overscaledZ>u)continue;let E=x.tileID;for(;x&&x.tileID.overscaledZ>s+1;){const A=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[A.key],x&&x.hasData()&&(E=A)}let S=E;for(;S.overscaledZ>s;)if(S=S.scaledTo(S.overscaledZ-1),t[S.key]){p[E.key]=E;break}}}findLoadedParent(t,s){if(t.key in this._loadedParentTiles){const u=this._loadedParentTiles[t.key];return u&&u.tileID.overscaledZ>=s?u:null}for(let u=t.overscaledZ-1;u>=s;u--){const p=t.scaledTo(u),g=this._getLoadedTile(p);if(g)return g}}_getLoadedTile(t){const s=this._tiles[t.key];return s&&s.hasData()?s:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const s=Math.ceil(t.width/this._source.tileSize)+1,u=Math.ceil(t.height/this._source.tileSize)+1,p=Math.floor(s*u*5),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(g)}handleWrapJump(t){const s=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,s){const u={};for(const p in this._tiles){const g=this._tiles[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+s),u[g.tileID.key]=g}this._tiles=u;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}update(t,s){if(this.transform=t,this.terrain=s,!this._sourceLoaded||this._paused)return;let u;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(A=>new a.OverscaledTileID(A.canonical.z,A.wrap,A.canonical.z,A.canonical.x,A.canonical.y)):(u=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(u=u.filter(A=>this._source.hasTile(A)))):u=[];const p=t.coveringZoomLevel(this._source),g=Math.max(p-$t.maxOverzooming,this._source.minzoom),x=Math.max(p+$t.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const A={};for(const z of u)if(z.canonical.z>this._source.minzoom){const L=z.scaledTo(z.canonical.z-1);A[L.key]=L;const U=z.scaledTo(Math.max(this._source.minzoom,Math.min(z.canonical.z,5)));A[U.key]=U}u=u.concat(Object.values(A))}const E=this._updateRetainedTiles(u,p);if(Gt(this._source.type)){const A={},z={},L=Object.keys(E);for(const U of L){const H=E[U],W=this._tiles[U];if(!W||W.fadeEndTime&&W.fadeEndTime<=a.exported.now())continue;const Z=this.findLoadedParent(H,g);Z&&(this._addTile(Z.tileID),A[Z.tileID.key]=Z.tileID),z[U]=H}this._retainLoadedChildren(z,p,x,E);for(const U in A)E[U]||(this._coveredTiles[U]=!0,E[U]=A[U]);if(s){const U={},H={};for(const W of u)this._tiles[W.key].hasData()?U[W.key]=W:H[W.key]=W;for(const W in H){const Z=H[W].children(this._source.maxzoom);this._tiles[Z[0].key]&&this._tiles[Z[1].key]&&this._tiles[Z[2].key]&&this._tiles[Z[3].key]&&(U[Z[0].key]=E[Z[0].key]=Z[0],U[Z[1].key]=E[Z[1].key]=Z[1],U[Z[2].key]=E[Z[2].key]=Z[2],U[Z[3].key]=E[Z[3].key]=Z[3],delete H[W])}for(const W in H){const Z=this.findLoadedParent(H[W],this._source.minzoom);if(Z){U[Z.tileID.key]=E[Z.tileID.key]=Z.tileID;for(const ne in U)U[ne].isChildOf(Z.tileID)&&delete U[ne]}}for(const W in this._tiles)U[W]||(this._coveredTiles[W]=!0)}}for(const A in E)this._tiles[A].clearFadeHold();const S=a.keysDifference(this._tiles,E);for(const A of S){const z=this._tiles[A];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(A)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,s){const u={},p={},g=Math.max(s-$t.maxOverzooming,this._source.minzoom),x=Math.max(s+$t.maxUnderzooming,this._source.minzoom),E={};for(const S of t){const A=this._addTile(S);u[S.key]=S,A.hasData()||s<this._source.maxzoom&&(E[S.key]=S)}this._retainLoadedChildren(E,s,x,u);for(const S of t){let A=this._tiles[S.key];if(A.hasData())continue;if(s+1>this._source.maxzoom){const L=S.children(this._source.maxzoom)[0],U=this.getTile(L);if(U&&U.hasData()){u[L.key]=L;continue}}else{const L=S.children(this._source.maxzoom);if(u[L[0].key]&&u[L[1].key]&&u[L[2].key]&&u[L[3].key])continue}let z=A.wasRequested();for(let L=S.overscaledZ-1;L>=g;--L){const U=S.scaledTo(L);if(p[U.key]||(p[U.key]=!0,A=this.getTile(U),!A&&z&&(A=this._addTile(U)),A&&(u[U.key]=U,z=A.wasRequested(),A.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const s=[];let u,p=this._tiles[t].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){u=this._loadedParentTiles[p.key];break}s.push(p.key);const g=p.scaledTo(p.overscaledZ-1);if(u=this._getLoadedTile(g),u)break;p=g}for(const g of s)this._loadedParentTiles[g]=u}}_addTile(t){let s=this._tiles[t.key];if(s)return s;s=this._cache.getAndRemove(t),s&&(this._setTileReloadTimer(t.key,s),s.tileID=t,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,s)));const u=s;return s||(s=new gt(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(s,this._tileLoaded.bind(this,s,t.key,s.state))),s.uses++,this._tiles[t.key]=s,u||this._source.fire(new a.Event("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(t,s){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const u=s.getExpiryTimeout();u&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},u))}_removeTile(t){const s=this._tiles[t];s&&(s.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,s,u){const p=[],g=this.transform;if(!g)return p;const x=u?g.getCameraQueryGeometry(t):t,E=t.map(W=>g.pointCoordinate(W,this.terrain)),S=x.map(W=>g.pointCoordinate(W,this.terrain)),A=this.getIds();let z=1/0,L=1/0,U=-1/0,H=-1/0;for(const W of S)z=Math.min(z,W.x),L=Math.min(L,W.y),U=Math.max(U,W.x),H=Math.max(H,W.y);for(let W=0;W<A.length;W++){const Z=this._tiles[A[W]];if(Z.holdingForFade())continue;const ne=Z.tileID,oe=Math.pow(2,g.zoom-Z.tileID.overscaledZ),ue=s*Z.queryPadding*a.EXTENT/Z.tileSize/oe,K=[ne.getTilePoint(new a.MercatorCoordinate(z,L)),ne.getTilePoint(new a.MercatorCoordinate(U,H))];if(K[0].x-ue<a.EXTENT&&K[0].y-ue<a.EXTENT&&K[1].x+ue>=0&&K[1].y+ue>=0){const fe=E.map(xe=>ne.getTilePoint(xe)),de=S.map(xe=>ne.getTilePoint(xe));p.push({tile:Z,tileID:ne,queryGeometry:fe,cameraQueryGeometry:de,scale:oe})}}return p}getVisibleCoordinates(t){const s=this.getRenderableIds(t).map(u=>this._tiles[u].tileID);for(const u of s)u.posMatrix=this.transform.calculatePosMatrix(u.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(Gt(this._source.type))for(const t in this._tiles){const s=this._tiles[t];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=a.exported.now())return!0}return!1}setFeatureState(t,s,u){this._state.updateState(t=t||"_geojsonTileLayer",s,u)}removeFeatureState(t,s,u){this._state.removeFeatureState(t=t||"_geojsonTileLayer",s,u)}getFeatureState(t,s){return this._state.getState(t=t||"_geojsonTileLayer",s)}setDependencies(t,s,u){const p=this._tiles[t];p&&p.setDependencies(s,u)}reloadTilesForDependencies(t,s){for(const u in this._tiles)this._tiles[u].hasDependency(t,s)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(t,s))}}function ki(h,t){const s=Math.abs(2*h.wrap)-+(h.wrap<0),u=Math.abs(2*t.wrap)-+(t.wrap<0);return h.overscaledZ-t.overscaledZ||u-s||t.canonical.y-h.canonical.y||t.canonical.x-h.canonical.x}function Gt(h){return h==="raster"||h==="image"||h==="video"}$t.maxOverzooming=10,$t.maxUnderzooming=3;const Ft="mapboxgl_preloaded_worker_pool";class ri{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<ri.workerCount;)this.workers.push(new Worker(ws.workerUrl));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ft]}numActive(){return Object.keys(this.active).length}}const X=Math.floor(a.exported.hardwareConcurrency/2);let ie;function be(){return ie||(ie=new ri),ie}function ze(h,t){const s={};for(const u in h)u!=="ref"&&(s[u]=h[u]);return a.refProperties.forEach(u=>{u in t&&(s[u]=t[u])}),s}function ke(h){h=h.slice();const t=Object.create(null);for(let s=0;s<h.length;s++)t[h[s].id]=h[s];for(let s=0;s<h.length;s++)"ref"in h[s]&&(h[s]=ze(h[s],t[h[s].ref]));return h}ri.workerCount=Math.max(Math.min(X,6),1);const Ie={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ke(h,t,s){s.push({command:Ie.addSource,args:[h,t[h]]})}function je(h,t,s){t.push({command:Ie.removeSource,args:[h]}),s[h]=!0}function qe(h,t,s,u){je(h,s,u),Ke(h,t,s)}function Be(h,t,s){let u;for(u in h[s])if(Object.prototype.hasOwnProperty.call(h[s],u)&&u!=="data"&&!B(h[s][u],t[s][u]))return!1;for(u in t[s])if(Object.prototype.hasOwnProperty.call(t[s],u)&&u!=="data"&&!B(h[s][u],t[s][u]))return!1;return!0}function bt(h,t,s,u,p,g){let x;for(x in t=t||{},h=h||{})Object.prototype.hasOwnProperty.call(h,x)&&(B(h[x],t[x])||s.push({command:g,args:[u,x,t[x],p]}));for(x in t)Object.prototype.hasOwnProperty.call(t,x)&&!Object.prototype.hasOwnProperty.call(h,x)&&(B(h[x],t[x])||s.push({command:g,args:[u,x,t[x],p]}))}function yt(h){return h.id}function At(h,t){return h[t.id]=t,h}class Lt{constructor(t,s){this.reset(t,s)}reset(t,s){this.points=t||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=a.clamp(t,0,1);let s=1,u=this._distances[s];const p=t*this.paddedLength+this.padding;for(;u<p&&s<this._distances.length;)u=this._distances[++s];const g=s-1,x=this._distances[g],E=u-x,S=E>0?(p-x)/E:0;return this.points[g].mult(1-S).add(this.points[s].mult(S))}}function he(h,t){let s=!0;return h==="always"||h!=="never"&&t!=="never"||(s=!1),s}class Pe{constructor(t,s,u){const p=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(t/u),this.yCellCount=Math.ceil(s/u);for(let x=0;x<this.xCellCount*this.yCellCount;x++)p.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=s,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,s,u,p,g){this._forEachCell(s,u,p,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(s),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(g)}insertCircle(t,s,u,p){this._forEachCell(s-p,u-p,s+p,u+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(s),this.circles.push(u),this.circles.push(p)}_insertBoxCell(t,s,u,p,g,x){this.boxCells[g].push(x)}_insertCircleCell(t,s,u,p,g,x){this.circleCells[g].push(x)}_query(t,s,u,p,g,x,E){if(u<0||t>this.width||p<0||s>this.height)return[];const S=[];if(t<=0&&s<=0&&this.width<=u&&this.height<=p){if(g)return[{key:null,x1:t,y1:s,x2:u,y2:p}];for(let A=0;A<this.boxKeys.length;A++)S.push({key:this.boxKeys[A],x1:this.bboxes[4*A],y1:this.bboxes[4*A+1],x2:this.bboxes[4*A+2],y2:this.bboxes[4*A+3]});for(let A=0;A<this.circleKeys.length;A++){const z=this.circles[3*A],L=this.circles[3*A+1],U=this.circles[3*A+2];S.push({key:this.circleKeys[A],x1:z-U,y1:L-U,x2:z+U,y2:L+U})}}else this._forEachCell(t,s,u,p,this._queryCell,S,{hitTest:g,overlapMode:x,seenUids:{box:{},circle:{}}},E);return S}query(t,s,u,p){return this._query(t,s,u,p,!1,null)}hitTest(t,s,u,p,g,x){return this._query(t,s,u,p,!0,g,x).length>0}hitTestCircle(t,s,u,p,g){const x=t-u,E=t+u,S=s-u,A=s+u;if(E<0||x>this.width||A<0||S>this.height)return!1;const z=[];return this._forEachCell(x,S,E,A,this._queryCellCircle,z,{hitTest:!0,overlapMode:p,circle:{x:t,y:s,radius:u},seenUids:{box:{},circle:{}}},g),z.length>0}_queryCell(t,s,u,p,g,x,E,S){const{seenUids:A,hitTest:z,overlapMode:L}=E,U=this.boxCells[g];if(U!==null){const W=this.bboxes;for(const Z of U)if(!A.box[Z]){A.box[Z]=!0;const ne=4*Z,oe=this.boxKeys[Z];if(t<=W[ne+2]&&s<=W[ne+3]&&u>=W[ne+0]&&p>=W[ne+1]&&(!S||S(oe))&&(!z||!he(L,oe.overlapMode))&&(x.push({key:oe,x1:W[ne],y1:W[ne+1],x2:W[ne+2],y2:W[ne+3]}),z))return!0}}const H=this.circleCells[g];if(H!==null){const W=this.circles;for(const Z of H)if(!A.circle[Z]){A.circle[Z]=!0;const ne=3*Z,oe=this.circleKeys[Z];if(this._circleAndRectCollide(W[ne],W[ne+1],W[ne+2],t,s,u,p)&&(!S||S(oe))&&(!z||!he(L,oe.overlapMode))){const ue=W[ne],K=W[ne+1],fe=W[ne+2];if(x.push({key:oe,x1:ue-fe,y1:K-fe,x2:ue+fe,y2:K+fe}),z)return!0}}}return!1}_queryCellCircle(t,s,u,p,g,x,E,S){const{circle:A,seenUids:z,overlapMode:L}=E,U=this.boxCells[g];if(U!==null){const W=this.bboxes;for(const Z of U)if(!z.box[Z]){z.box[Z]=!0;const ne=4*Z,oe=this.boxKeys[Z];if(this._circleAndRectCollide(A.x,A.y,A.radius,W[ne+0],W[ne+1],W[ne+2],W[ne+3])&&(!S||S(oe))&&!he(L,oe.overlapMode))return x.push(!0),!0}}const H=this.circleCells[g];if(H!==null){const W=this.circles;for(const Z of H)if(!z.circle[Z]){z.circle[Z]=!0;const ne=3*Z,oe=this.circleKeys[Z];if(this._circlesCollide(W[ne],W[ne+1],W[ne+2],A.x,A.y,A.radius)&&(!S||S(oe))&&!he(L,oe.overlapMode))return x.push(!0),!0}}}_forEachCell(t,s,u,p,g,x,E,S){const A=this._convertToXCellCoord(t),z=this._convertToYCellCoord(s),L=this._convertToXCellCoord(u),U=this._convertToYCellCoord(p);for(let H=A;H<=L;H++)for(let W=z;W<=U;W++)if(g.call(this,t,s,u,p,this.xCellCount*W+H,x,E,S))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,s,u,p,g,x){const E=p-t,S=g-s,A=u+x;return A*A>E*E+S*S}_circleAndRectCollide(t,s,u,p,g,x,E){const S=(x-p)/2,A=Math.abs(t-(p+S));if(A>S+u)return!1;const z=(E-g)/2,L=Math.abs(s-(g+z));if(L>z+u)return!1;if(A<=S||L<=z)return!0;const U=A-S,H=L-z;return U*U+H*H<=u*u}}function gi(h,t,s,u,p){const g=a.create();return t?(a.scale(g,g,[1/p,1/p,1]),s||a.rotateZ(g,g,u.angle)):a.multiply(g,u.labelPlaneMatrix,h),g}function li(h,t,s,u,p){if(t){const g=a.clone(h);return a.scale(g,g,[p,p,1]),s||a.rotateZ(g,g,-u.angle),g}return u.glCoordMatrix}function Ht(h,t,s){let u;s?(u=[h.x,h.y,s(h.x,h.y),1],a.transformMat4(u,u,t)):(u=[h.x,h.y,0,1],Br(u,u,t));const p=u[3];return{point:new a.pointGeometry(u[0]/p,u[1]/p),signedDistanceFromCamera:p}}function ln(h,t){return .5+h/t*.5}function An(h,t){const s=h[0]/h[3],u=h[1]/h[3];return s>=-t[0]&&s<=t[0]&&u>=-t[1]&&u<=t[1]}function cn(h,t,s,u,p,g,x,E,S,A){const z=u?h.textSizeData:h.iconSizeData,L=a.evaluateSizeForZoom(z,s.transform.zoom),U=[256/s.width*2+1,256/s.height*2+1],H=u?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;H.clear();const W=h.lineVertexArray,Z=u?h.text.placedSymbolArray:h.icon.placedSymbolArray,ne=s.transform.width/s.transform.height;let oe=!1;for(let ue=0;ue<Z.length;ue++){const K=Z.get(ue);if(K.hidden||K.writingMode===a.WritingMode.vertical&&!oe){Wt(K.numGlyphs,H);continue}let fe;if(oe=!1,A?(fe=[K.anchorX,K.anchorY,A(K.anchorX,K.anchorY),1],a.transformMat4(fe,fe,t)):(fe=[K.anchorX,K.anchorY,0,1],Br(fe,fe,t)),!An(fe,U)){Wt(K.numGlyphs,H);continue}const de=ln(s.transform.cameraToCenterDistance,fe[3]),xe=a.evaluateSizeForFeature(z,L,K),we=x?xe/de:xe*de,Le=new a.pointGeometry(K.anchorX,K.anchorY),ye=Ht(Le,p,A).point,at={},Ye=Ot(K,we,!1,E,t,p,g,h.glyphOffsetArray,W,H,ye,Le,at,ne,S,A);oe=Ye.useVertical,(Ye.notEnoughRoom||oe||Ye.needsFlipping&&Ot(K,we,!0,E,t,p,g,h.glyphOffsetArray,W,H,ye,Le,at,ne,S,A).notEnoughRoom)&&Wt(K.numGlyphs,H)}u?h.text.dynamicLayoutVertexBuffer.updateData(H):h.icon.dynamicLayoutVertexBuffer.updateData(H)}function _r(h,t,s,u,p,g,x,E,S,A,z,L,U){const H=E.glyphStartIndex+E.numGlyphs,W=E.lineStartIndex,Z=E.lineStartIndex+E.lineLength,ne=t.getoffsetX(E.glyphStartIndex),oe=t.getoffsetX(H-1),ue=wn(h*ne,s,u,p,g,x,E.segment,W,Z,S,A,z,L,U);if(!ue)return null;const K=wn(h*oe,s,u,p,g,x,E.segment,W,Z,S,A,z,L,U);return K?{first:ue,last:K}:null}function Ne(h,t,s,u){return h===a.WritingMode.horizontal&&Math.abs(s.y-t.y)>Math.abs(s.x-t.x)*u?{useVertical:!0}:(h===a.WritingMode.vertical?t.y<s.y:t.x>s.x)?{needsFlipping:!0}:null}function Ot(h,t,s,u,p,g,x,E,S,A,z,L,U,H,W,Z){const ne=t/24,oe=h.lineOffsetX*ne,ue=h.lineOffsetY*ne;let K;if(h.numGlyphs>1){const fe=h.glyphStartIndex+h.numGlyphs,de=h.lineStartIndex,xe=h.lineStartIndex+h.lineLength,we=_r(ne,E,oe,ue,s,z,L,h,S,g,U,W,Z);if(!we)return{notEnoughRoom:!0};const Le=Ht(we.first.point,x,Z).point,ye=Ht(we.last.point,x,Z).point;if(u&&!s){const at=Ne(h.writingMode,Le,ye,H);if(at)return at}K=[we.first];for(let at=h.glyphStartIndex+1;at<fe-1;at++)K.push(wn(ne*E.getoffsetX(at),oe,ue,s,z,L,h.segment,de,xe,S,g,U,W,Z));K.push(we.last)}else{if(u&&!s){const de=Ht(L,p,Z).point,xe=h.lineStartIndex+h.segment+1,we=new a.pointGeometry(S.getx(xe),S.gety(xe)),Le=Ht(we,p,Z),ye=Le.signedDistanceFromCamera>0?Le.point:Vt(L,we,de,1,p,Z),at=Ne(h.writingMode,de,ye,H);if(at)return at}const fe=wn(ne*E.getoffsetX(h.glyphStartIndex),oe,ue,s,z,L,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,S,g,U,W,Z);if(!fe)return{notEnoughRoom:!0};K=[fe]}for(const fe of K)a.addDynamicAttributes(A,fe.point,fe.angle);return{}}function Vt(h,t,s,u,p,g){const x=Ht(h.add(h.sub(t)._unit()),p,g).point,E=s.sub(x);return s.add(E._mult(u/E.mag()))}function wn(h,t,s,u,p,g,x,E,S,A,z,L,U,H){const W=u?h-t:h+t;let Z=W>0?1:-1,ne=0;u&&(Z*=-1,ne=Math.PI),Z<0&&(ne+=Math.PI);let oe=Z>0?E+x:E+x+1,ue=p,K=p,fe=0,de=0;const xe=Math.abs(W),we=[];for(;fe+de<=xe;){if(oe+=Z,oe<E||oe>=S)return null;if(K=ue,we.push(ue),ue=L[oe],ue===void 0){const dt=new a.pointGeometry(A.getx(oe),A.gety(oe)),Kt=Ht(dt,z,H);if(Kt.signedDistanceFromCamera>0)ue=L[oe]=Kt.point;else{const Qt=oe-Z;ue=Vt(fe===0?g:new a.pointGeometry(A.getx(Qt),A.gety(Qt)),dt,K,xe-fe+1,z,H)}}fe+=de,de=K.dist(ue)}const Le=(xe-fe)/de,ye=ue.sub(K),at=ye.mult(Le)._add(K);at._add(ye._unit()._perp()._mult(s*Z));const Ye=ne+Math.atan2(ue.y-K.y,ue.x-K.x);return we.push(at),{point:at,angle:U?Ye:0,path:we}}const Yr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Wt(h,t){for(let s=0;s<h;s++){const u=t.length;t.resize(u+4),t.float32.set(Yr,3*u)}}function Br(h,t,s){const u=t[0],p=t[1];return h[0]=s[0]*u+s[4]*p+s[12],h[1]=s[1]*u+s[5]*p+s[13],h[3]=s[3]*u+s[7]*p+s[15],h}const fn=100;class Us{constructor(t,s=new Pe(t.width+200,t.height+200,25),u=new Pe(t.width+200,t.height+200,25)){this.transform=t,this.grid=s,this.ignoredGrid=u,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+fn,this.screenBottomBoundary=t.height+fn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,s,u,p,g,x){const E=this.projectAndGetPerspectiveRatio(p,t.anchorPointX,t.anchorPointY,x),S=u*E.perspectiveRatio,A=t.x1*S+E.point.x,z=t.y1*S+E.point.y,L=t.x2*S+E.point.x,U=t.y2*S+E.point.y;return!this.isInsideGrid(A,z,L,U)||s!=="always"&&this.grid.hitTest(A,z,L,U,s,g)||E.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[A,z,L,U],offscreen:this.isOffscreen(A,z,L,U)}}placeCollisionCircles(t,s,u,p,g,x,E,S,A,z,L,U,H,W){const Z=[],ne=new a.pointGeometry(s.anchorX,s.anchorY),oe=Ht(ne,x,W),ue=ln(this.transform.cameraToCenterDistance,oe.signedDistanceFromCamera),K=(z?g/ue:g*ue)/a.ONE_EM,fe=Ht(ne,E,W).point,de=_r(K,p,s.lineOffsetX*K,s.lineOffsetY*K,!1,fe,ne,s,u,E,{},!1,W);let xe=!1,we=!1,Le=!0;if(de){const ye=.5*U*ue+H,at=new a.pointGeometry(-100,-100),Ye=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),dt=new Lt,Kt=de.first,Qt=de.last;let Ct=[];for(let ci=Kt.path.length-1;ci>=1;ci--)Ct.push(Kt.path[ci]);for(let ci=1;ci<Qt.path.length;ci++)Ct.push(Qt.path[ci]);const Ei=2.5*ye;if(S){const ci=Ct.map(fi=>Ht(fi,S,W));Ct=ci.some(fi=>fi.signedDistanceFromCamera<=0)?[]:ci.map(fi=>fi.point)}let Si=[];if(Ct.length>0){const ci=Ct[0].clone(),fi=Ct[0].clone();for(let Ai=1;Ai<Ct.length;Ai++)ci.x=Math.min(ci.x,Ct[Ai].x),ci.y=Math.min(ci.y,Ct[Ai].y),fi.x=Math.max(fi.x,Ct[Ai].x),fi.y=Math.max(fi.y,Ct[Ai].y);Si=ci.x>=at.x&&fi.x<=Ye.x&&ci.y>=at.y&&fi.y<=Ye.y?[Ct]:fi.x<at.x||ci.x>Ye.x||fi.y<at.y||ci.y>Ye.y?[]:a.clipLine([Ct],at.x,at.y,Ye.x,Ye.y)}for(const ci of Si){dt.reset(ci,.25*ye);let fi=0;fi=dt.length<=.5*ye?1:Math.ceil(dt.paddedLength/Ei)+1;for(let Ai=0;Ai<fi;Ai++){const gn=Ai/Math.max(fi-1,1),Mr=dt.lerp(gn),vr=Mr.x+fn,zr=Mr.y+fn;Z.push(vr,zr,ye,0);const ss=vr-ye,ur=zr-ye,Gn=vr+ye,Ur=zr+ye;if(Le=Le&&this.isOffscreen(ss,ur,Gn,Ur),we=we||this.isInsideGrid(ss,ur,Gn,Ur),t!=="always"&&this.grid.hitTestCircle(vr,zr,ye,t,L)&&(xe=!0,!A))return{circles:[],offscreen:!1,collisionDetected:xe}}}}return{circles:!A&&xe||!we||ue<this.perspectiveRatioCutoff?[]:Z,offscreen:Le,collisionDetected:xe}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let u=1/0,p=1/0,g=-1/0,x=-1/0;for(const z of t){const L=new a.pointGeometry(z.x+fn,z.y+fn);u=Math.min(u,L.x),p=Math.min(p,L.y),g=Math.max(g,L.x),x=Math.max(x,L.y),s.push(L)}const E=this.grid.query(u,p,g,x).concat(this.ignoredGrid.query(u,p,g,x)),S={},A={};for(const z of E){const L=z.key;if(S[L.bucketInstanceId]===void 0&&(S[L.bucketInstanceId]={}),S[L.bucketInstanceId][L.featureIndex])continue;const U=[new a.pointGeometry(z.x1,z.y1),new a.pointGeometry(z.x2,z.y1),new a.pointGeometry(z.x2,z.y2),new a.pointGeometry(z.x1,z.y2)];a.polygonIntersectsPolygon(s,U)&&(S[L.bucketInstanceId][L.featureIndex]=!0,A[L.bucketInstanceId]===void 0&&(A[L.bucketInstanceId]=[]),A[L.bucketInstanceId].push(L.featureIndex))}return A}insertCollisionBox(t,s,u,p,g,x){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:g,collisionGroupID:x,overlapMode:s},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,s,u,p,g,x){const E=u?this.ignoredGrid:this.grid,S={bucketInstanceId:p,featureIndex:g,collisionGroupID:x,overlapMode:s};for(let A=0;A<t.length;A+=4)E.insertCircle(S,t[A],t[A+1],t[A+2])}projectAndGetPerspectiveRatio(t,s,u,p){let g;return p?(g=[s,u,p(s,u),1],a.transformMat4(g,g,t)):(g=[s,u,0,1],Br(g,g,t)),{point:new a.pointGeometry((g[0]/g[3]+1)/2*this.transform.width+fn,(-g[1]/g[3]+1)/2*this.transform.height+fn),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}}isOffscreen(t,s,u,p){return u<fn||t>=this.screenRightBoundary||p<fn||s>this.screenBottomBoundary}isInsideGrid(t,s,u,p){return u>=0&&t<this.gridRightBoundary&&p>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const t=a.identity([]);return a.translate(t,t,[-100,-100,0]),t}}function nn(h,t,s){return t*(a.EXTENT/(h.tileSize*Math.pow(2,s-h.tileID.overscaledZ)))}class $n{constructor(t,s,u,p){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?s:-s))):p&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class Ii{constructor(t,s,u,p,g){this.text=new $n(t?t.text:null,s,u,g),this.icon=new $n(t?t.icon:null,s,p,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ns{constructor(t,s,u){this.text=t,this.icon=s,this.skipFade=u}}class Cr{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class ms{constructor(t,s,u,p,g){this.bucketInstanceId=t,this.featureIndex=s,this.sourceLayerIndex=u,this.bucketIndex=p,this.tileID=g}}class gs{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const s=++this.maxGroupID;this.collisionGroups[t]={ID:s,predicate:u=>u.collisionGroupID===s}}return this.collisionGroups[t]}}function Vs(h,t,s,u,p){const{horizontalAlign:g,verticalAlign:x}=a.getAnchorAlignment(h),E=-(g-.5)*t,S=-(x-.5)*s,A=a.evaluateVariableOffset(h,u);return new a.pointGeometry(E+A[0]*p,S+A[1]*p)}function _s(h,t,s,u,p,g){const{x1:x,x2:E,y1:S,y2:A,anchorPointX:z,anchorPointY:L}=h,U=new a.pointGeometry(t,s);return u&&U._rotate(p?g:-g),{x1:x+U.x,y1:S+U.y,x2:E+U.x,y2:A+U.y,anchorPointX:z,anchorPointY:L}}class G{constructor(t,s,u,p,g){this.transform=t.clone(),this.terrain=s,this.collisionIndex=new Us(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new gs(p),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,s,u,p){const g=u.getBucket(s),x=u.latestFeatureIndex;if(!g||!x||s.id!==g.layerIds[0])return;const E=u.collisionBoxArray,S=g.layers[0].layout,A=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),z=u.tileSize/a.EXTENT,L=this.transform.calculatePosMatrix(u.tileID.toUnwrapped()),U=S.get("text-pitch-alignment")==="map",H=S.get("text-rotation-alignment")==="map",W=nn(u,1,this.transform.zoom),Z=gi(L,U,H,this.transform,W);let ne=null;if(U){const ue=li(L,U,H,this.transform,W);ne=a.multiply([],this.transform.labelPlaneMatrix,ue)}this.retainedQueryData[g.bucketInstanceId]=new ms(g.bucketInstanceId,x,g.sourceLayerIndex,g.index,u.tileID);const oe={bucket:g,layout:S,posMatrix:L,textLabelPlaneMatrix:Z,labelToScreenMatrix:ne,scale:A,textPixelRatio:z,holdingForFade:u.holdingForFade(),collisionBoxArray:E,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(p)for(const ue of g.sortKeyRanges){const{sortKey:K,symbolInstanceStart:fe,symbolInstanceEnd:de}=ue;t.push({sortKey:K,symbolInstanceStart:fe,symbolInstanceEnd:de,parameters:oe})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:oe})}attemptAnchorPlacement(t,s,u,p,g,x,E,S,A,z,L,U,H,W,Z,ne){const oe=[U.textOffset0,U.textOffset1],ue=Vs(t,u,p,oe,g),K=this.collisionIndex.placeCollisionBox(_s(s,ue.x,ue.y,x,E,this.transform.angle),L,S,A,z.predicate,ne);if((!Z||this.collisionIndex.placeCollisionBox(_s(Z,ue.x,ue.y,x,E,this.transform.angle),L,S,A,z.predicate,ne).box.length!==0)&&K.box.length>0){let fe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID].text&&(fe=this.prevPlacement.variableOffsets[U.crossTileID].anchor),U.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[U.crossTileID]={textOffset:oe,width:u,height:p,anchor:t,textBoxScale:g,prevAnchor:fe},this.markUsedJustification(H,t,U,W),H.allowVerticalPlacement&&(this.markUsedOrientation(H,W,U),this.placedOrientations[U.crossTileID]=W),{shift:ue,placedGlyphBoxes:K}}}placeLayerBucketPart(t,s,u){const{bucket:p,layout:g,posMatrix:x,textLabelPlaneMatrix:E,labelToScreenMatrix:S,textPixelRatio:A,holdingForFade:z,collisionBoxArray:L,partiallyEvaluatedTextSize:U,collisionGroup:H}=t.parameters,W=g.get("text-optional"),Z=g.get("icon-optional"),ne=a.getOverlapMode(g,"text-overlap","text-allow-overlap"),oe=ne==="always",ue=a.getOverlapMode(g,"icon-overlap","icon-allow-overlap"),K=ue==="always",fe=g.get("text-rotation-alignment")==="map",de=g.get("text-pitch-alignment")==="map",xe=g.get("icon-text-fit")!=="none",we=g.get("symbol-z-order")==="viewport-y",Le=oe&&(K||!p.hasIconData()||Z),ye=K&&(oe||!p.hasTextData()||W);!p.collisionArrays&&L&&p.deserializeCollisionBoxes(L);const at=(Ye,dt)=>{if(s[Ye.crossTileID])return;if(z)return void(this.placements[Ye.crossTileID]=new Ns(!1,!1,!1));let Kt=!1,Qt=!1,Ct=!0,Ei=null,Si={box:null,offscreen:null},ci={box:null,offscreen:null},fi=null,Ai=null,gn=null,Mr=0,vr=0,zr=0;dt.textFeatureIndex?Mr=dt.textFeatureIndex:Ye.useRuntimeCollisionCircles&&(Mr=Ye.featureIndex),dt.verticalTextFeatureIndex&&(vr=dt.verticalTextFeatureIndex);const ss=this.retainedQueryData[p.bucketInstanceId].tileID,ur=this.terrain?(un,ni)=>this.terrain.getElevation(ss,un,ni):null;for(const un of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const ni=dt[un];ni&&(ni.elevation=ur?ur(ni.anchorPointX,ni.anchorPointY):0)}const Gn=dt.textBox;if(Gn){const un=wi=>{let _n=a.WritingMode.horizontal;if(p.allowVerticalPlacement&&!wi&&this.prevPlacement){const yn=this.prevPlacement.placedOrientations[Ye.crossTileID];yn&&(this.placedOrientations[Ye.crossTileID]=yn,_n=yn,this.markUsedOrientation(p,_n,Ye))}return _n},ni=(wi,_n)=>{if(p.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&dt.verticalTextBox){for(const yn of p.writingModes)if(yn===a.WritingMode.vertical?(Si=_n(),ci=Si):Si=wi(),Si&&Si.box&&Si.box.length)break}else Si=wi()};if(g.get("text-variable-anchor")){let wi=g.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ye.crossTileID]){const Wi=this.prevPlacement.variableOffsets[Ye.crossTileID];wi.indexOf(Wi.anchor)>0&&(wi=wi.filter(hr=>hr!==Wi.anchor),wi.unshift(Wi.anchor))}const _n=(Wi,hr,Ts)=>{const cc=Wi.x2-Wi.x1,to=Wi.y2-Wi.y1,Gu=Ye.textBoxScale,uc=xe&&ue==="never"?hr:null;let os={box:[],offscreen:!1};const Es=ne!=="never"?2*wi.length:wi.length;for(let Ss=0;Ss<Es;++Ss){const Ha=this.attemptAnchorPlacement(wi[Ss%wi.length],Wi,cc,to,Gu,fe,de,A,x,H,Ss>=wi.length?ne:"never",Ye,p,Ts,uc,ur);if(Ha&&(os=Ha.placedGlyphBoxes,os&&os.box&&os.box.length)){Kt=!0,Ei=Ha.shift;break}}return os};ni(()=>_n(Gn,dt.iconBox,a.WritingMode.horizontal),()=>{const Wi=dt.verticalTextBox;return p.allowVerticalPlacement&&!(Si&&Si.box&&Si.box.length)&&Ye.numVerticalGlyphVertices>0&&Wi?_n(Wi,dt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Si&&(Kt=Si.box,Ct=Si.offscreen);const yn=un(Si&&Si.box);if(!Kt&&this.prevPlacement){const Wi=this.prevPlacement.variableOffsets[Ye.crossTileID];Wi&&(this.variableOffsets[Ye.crossTileID]=Wi,this.markUsedJustification(p,Wi.anchor,Ye,yn))}}else{const wi=(_n,yn)=>{const Wi=this.collisionIndex.placeCollisionBox(_n,ne,A,x,H.predicate,ur);return Wi&&Wi.box&&Wi.box.length&&(this.markUsedOrientation(p,yn,Ye),this.placedOrientations[Ye.crossTileID]=yn),Wi};ni(()=>wi(Gn,a.WritingMode.horizontal),()=>{const _n=dt.verticalTextBox;return p.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&_n?wi(_n,a.WritingMode.vertical):{box:null,offscreen:null}}),un(Si&&Si.box&&Si.box.length)}}if(fi=Si,Kt=fi&&fi.box&&fi.box.length>0,Ct=fi&&fi.offscreen,Ye.useRuntimeCollisionCircles){const un=p.text.placedSymbolArray.get(Ye.centerJustifiedTextSymbolIndex),ni=a.evaluateSizeForFeature(p.textSizeData,U,un),wi=g.get("text-padding");Ai=this.collisionIndex.placeCollisionCircles(ne,un,p.lineVertexArray,p.glyphOffsetArray,ni,x,E,S,u,de,H.predicate,Ye.collisionCircleDiameter,wi,ur),Ai.circles.length&&Ai.collisionDetected&&!u&&a.warnOnce("Collisions detected, but collision boxes are not shown"),Kt=oe||Ai.circles.length>0&&!Ai.collisionDetected,Ct=Ct&&Ai.offscreen}if(dt.iconFeatureIndex&&(zr=dt.iconFeatureIndex),dt.iconBox){const un=ni=>{const wi=xe&&Ei?_s(ni,Ei.x,Ei.y,fe,de,this.transform.angle):ni;return this.collisionIndex.placeCollisionBox(wi,ue,A,x,H.predicate,ur)};ci&&ci.box&&ci.box.length&&dt.verticalIconBox?(gn=un(dt.verticalIconBox),Qt=gn.box.length>0):(gn=un(dt.iconBox),Qt=gn.box.length>0),Ct=Ct&&gn.offscreen}const Ur=W||Ye.numHorizontalGlyphVertices===0&&Ye.numVerticalGlyphVertices===0,Za=Z||Ye.numIconVertices===0;if(Ur||Za?Za?Ur||(Qt=Qt&&Kt):Kt=Qt&&Kt:Qt=Kt=Qt&&Kt,Kt&&fi&&fi.box&&this.collisionIndex.insertCollisionBox(fi.box,ne,g.get("text-ignore-placement"),p.bucketInstanceId,ci&&ci.box&&vr?vr:Mr,H.ID),Qt&&gn&&this.collisionIndex.insertCollisionBox(gn.box,ue,g.get("icon-ignore-placement"),p.bucketInstanceId,zr,H.ID),Ai&&(Kt&&this.collisionIndex.insertCollisionCircles(Ai.circles,ne,g.get("text-ignore-placement"),p.bucketInstanceId,Mr,H.ID),u)){const un=p.bucketInstanceId;let ni=this.collisionCircleArrays[un];ni===void 0&&(ni=this.collisionCircleArrays[un]=new Cr);for(let wi=0;wi<Ai.circles.length;wi+=4)ni.circles.push(Ai.circles[wi+0]),ni.circles.push(Ai.circles[wi+1]),ni.circles.push(Ai.circles[wi+2]),ni.circles.push(Ai.collisionDetected?1:0)}if(Ye.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ye.crossTileID]=new Ns(Kt||Le,Qt||ye,Ct||p.justReloaded),s[Ye.crossTileID]=!0};if(we){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ye=p.getSortedSymbolIndexes(this.transform.angle);for(let dt=Ye.length-1;dt>=0;--dt){const Kt=Ye[dt];at(p.symbolInstances.get(Kt),p.collisionArrays[Kt])}}else for(let Ye=t.symbolInstanceStart;Ye<t.symbolInstanceEnd;Ye++)at(p.symbolInstances.get(Ye),p.collisionArrays[Ye]);if(u&&p.bucketInstanceId in this.collisionCircleArrays){const Ye=this.collisionCircleArrays[p.bucketInstanceId];a.invert(Ye.invProjMatrix,x),Ye.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}markUsedJustification(t,s,u,p){let g;g=p===a.WritingMode.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];const x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const E of x)E>=0&&(t.text.placedSymbolArray.get(E).crossTileID=g>=0&&E!==g?0:u.crossTileID)}markUsedOrientation(t,s,u){const p=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,g=s===a.WritingMode.vertical?s:0,x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const E of x)t.text.placedSymbolArray.get(E).placedOrientation=p;u.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let u=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const p=s?s.symbolFadeChange(t):1,g=s?s.opacities:{},x=s?s.variableOffsets:{},E=s?s.placedOrientations:{};for(const S in this.placements){const A=this.placements[S],z=g[S];z?(this.opacities[S]=new Ii(z,p,A.text,A.icon),u=u||A.text!==z.text.placed||A.icon!==z.icon.placed):(this.opacities[S]=new Ii(null,p,A.text,A.icon,A.skipFade),u=u||A.text||A.icon)}for(const S in g){const A=g[S];if(!this.opacities[S]){const z=new Ii(A,p,!1,!1);z.isHidden()||(this.opacities[S]=z,u=u||A.text.placed||A.icon.placed)}}for(const S in x)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=x[S]);for(const S in E)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=E[S]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:t)}updateLayerOpacities(t,s){const u={};for(const p of s){const g=p.getBucket(t);g&&p.latestFeatureIndex&&t.id===g.layerIds[0]&&this.updateBucketOpacities(g,u,p.collisionBoxArray)}}updateBucketOpacities(t,s,u){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const p=t.layers[0].layout,g=new Ii(null,0,!1,!1,!0),x=p.get("text-allow-overlap"),E=p.get("icon-allow-overlap"),S=p.get("text-variable-anchor"),A=p.get("text-rotation-alignment")==="map",z=p.get("text-pitch-alignment")==="map",L=p.get("icon-text-fit")!=="none",U=new Ii(null,0,x&&(E||!t.hasIconData()||p.get("icon-optional")),E&&(x||!t.hasTextData()||p.get("text-optional")),!0);!t.collisionArrays&&u&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(u);const H=(W,Z,ne)=>{for(let oe=0;oe<Z/4;oe++)W.opacityVertexArray.emplaceBack(ne)};for(let W=0;W<t.symbolInstances.length;W++){const Z=t.symbolInstances.get(W),{numHorizontalGlyphVertices:ne,numVerticalGlyphVertices:oe,crossTileID:ue}=Z;let K=this.opacities[ue];s[ue]?K=g:K||(K=U,this.opacities[ue]=K),s[ue]=!0;const fe=Z.numIconVertices>0,de=this.placedOrientations[Z.crossTileID],xe=de===a.WritingMode.vertical,we=de===a.WritingMode.horizontal||de===a.WritingMode.horizontalOnly;if(ne>0||oe>0){const Le=se(K.text);H(t.text,ne,xe?_e:Le),H(t.text,oe,we?_e:Le);const ye=K.text.isHidden();[Z.rightJustifiedTextSymbolIndex,Z.centerJustifiedTextSymbolIndex,Z.leftJustifiedTextSymbolIndex].forEach(dt=>{dt>=0&&(t.text.placedSymbolArray.get(dt).hidden=ye||xe?1:0)}),Z.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(Z.verticalPlacedTextSymbolIndex).hidden=ye||we?1:0);const at=this.variableOffsets[Z.crossTileID];at&&this.markUsedJustification(t,at.anchor,Z,de);const Ye=this.placedOrientations[Z.crossTileID];Ye&&(this.markUsedJustification(t,"left",Z,Ye),this.markUsedOrientation(t,Ye,Z))}if(fe){const Le=se(K.icon),ye=!(L&&Z.verticalPlacedIconSymbolIndex&&xe);Z.placedIconSymbolIndex>=0&&(H(t.icon,Z.numIconVertices,ye?Le:_e),t.icon.placedSymbolArray.get(Z.placedIconSymbolIndex).hidden=K.icon.isHidden()),Z.verticalPlacedIconSymbolIndex>=0&&(H(t.icon,Z.numVerticalIconVertices,ye?_e:Le),t.icon.placedSymbolArray.get(Z.verticalPlacedIconSymbolIndex).hidden=K.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Le=t.collisionArrays[W];if(Le){let ye=new a.pointGeometry(0,0);if(Le.textBox||Le.verticalTextBox){let Ye=!0;if(S){const dt=this.variableOffsets[ue];dt?(ye=Vs(dt.anchor,dt.width,dt.height,dt.textOffset,dt.textBoxScale),A&&ye._rotate(z?this.transform.angle:-this.transform.angle)):Ye=!1}Le.textBox&&C(t.textCollisionBox.collisionVertexArray,K.text.placed,!Ye||xe,ye.x,ye.y),Le.verticalTextBox&&C(t.textCollisionBox.collisionVertexArray,K.text.placed,!Ye||we,ye.x,ye.y)}const at=Boolean(!we&&Le.verticalIconBox);Le.iconBox&&C(t.iconCollisionBox.collisionVertexArray,K.icon.placed,at,L?ye.x:0,L?ye.y:0),Le.verticalIconBox&&C(t.iconCollisionBox.collisionVertexArray,K.icon.placed,!at,L?ye.x:0,L?ye.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const W=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=W.invProjMatrix,t.placementViewportMatrix=W.viewportMatrix,t.collisionCircleArray=W.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,s){const u=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*u>t}setStale(){this.stale=!0}}function C(h,t,s,u,p){h.emplaceBack(t?1:0,s?1:0,u||0,p||0),h.emplaceBack(t?1:0,s?1:0,u||0,p||0),h.emplaceBack(t?1:0,s?1:0,u||0,p||0),h.emplaceBack(t?1:0,s?1:0,u||0,p||0)}const R=Math.pow(2,25),j=Math.pow(2,24),q=Math.pow(2,17),Q=Math.pow(2,16),re=Math.pow(2,9),te=Math.pow(2,8),ee=Math.pow(2,1);function se(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const t=h.placed?1:0,s=Math.floor(127*h.opacity);return s*R+t*j+s*q+t*Q+s*re+t*te+s*ee+t}const _e=0;class Me{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,s,u,p,g){const x=this._bucketParts;for(;this._currentTileIndex<t.length;)if(s.getBucketParts(x,p,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((E,S)=>E.sortKey-S.sortKey));this._currentPartIndex<x.length;)if(s.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,g())return!0;return!1}}class ge{constructor(t,s,u,p,g,x,E,S){this.placement=new G(t,s,x,E,S),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(t,s,u){const p=a.exported.now(),g=()=>{const x=a.exported.now()-p;return!this._forceFullPlacement&&x>2};for(;this._currentPlacementIndex>=0;){const x=s[t[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=E)&&(!x.maxzoom||x.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new Me(x)),this._inProgressLayer.continuePlacement(u[x.source],this.placement,this._showCollisionBoxes,x,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const vt=512/a.EXTENT/2;class wt{constructor(t,s,u){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=u;for(let p=0;p<s.length;p++){const g=s.get(p),x=g.key;this.indexedSymbolInstances[x]||(this.indexedSymbolInstances[x]=[]),this.indexedSymbolInstances[x].push({crossTileID:g.crossTileID,coord:this.getScaledCoordinates(g,t)})}}getScaledCoordinates(t,s){const u=vt/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+t.anchorX)*u),y:Math.floor((s.canonical.y*a.EXTENT+t.anchorY)*u)}}findMatches(t,s,u){const p=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let g=0;g<t.length;g++){const x=t.get(g);if(x.crossTileID)continue;const E=this.indexedSymbolInstances[x.key];if(!E)continue;const S=this.getScaledCoordinates(x,s);for(const A of E)if(Math.abs(A.coord.x-S.x)<=p&&Math.abs(A.coord.y-S.y)<=p&&!u[A.crossTileID]){u[A.crossTileID]=!0,x.crossTileID=A.crossTileID;break}}}}class ot{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Pt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const s=Math.round((t-this.lng)/360);if(s!==0)for(const u in this.indexes){const p=this.indexes[u],g={};for(const x in p){const E=p[x];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+s),g[E.tileID.key]=E}this.indexes[u]=g}this.lng=t}addBucket(t,s,u){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let g=0;g<s.symbolInstances.length;g++)s.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const p=this.usedCrossTileIDs[t.overscaledZ];for(const g in this.indexes){const x=this.indexes[g];if(Number(g)>t.overscaledZ)for(const E in x){const S=x[E];S.tileID.isChildOf(t)&&S.findMatches(s.symbolInstances,t,p)}else{const E=x[t.scaledTo(Number(g)).key];E&&E.findMatches(s.symbolInstances,t,p)}}for(let g=0;g<s.symbolInstances.length;g++){const x=s.symbolInstances.get(g);x.crossTileID||(x.crossTileID=u.generate(),p[x.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new wt(t,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(t,s){for(const u in s.indexedSymbolInstances)for(const p of s.indexedSymbolInstances[u])delete this.usedCrossTileIDs[t][p.crossTileID]}removeStaleBuckets(t){let s=!1;for(const u in this.indexes){const p=this.indexes[u];for(const g in p)t[p[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,p[g]),delete p[g],s=!0)}return s}}class Bt{constructor(){this.layerIndexes={},this.crossTileIDs=new ot,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,s,u){let p=this.layerIndexes[t.id];p===void 0&&(p=this.layerIndexes[t.id]=new Pt);let g=!1;const x={};p.handleWrapJump(u);for(const E of s){const S=E.getBucket(t);S&&t.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(E.tileID,S,this.crossTileIDs)&&(g=!0),x[S.bucketInstanceId]=!0)}return p.removeStaleBuckets(x)&&(g=!0),g}pruneUnusedLayers(t){const s={};t.forEach(u=>{s[u]=!0});for(const u in this.layerIndexes)s[u]||delete this.layerIndexes[u]}}var di=a.createLayout([{name:"a_pos",type:"Int16",components:2}]);class jt extends a.Evented{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=t._cache.max,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const t in this._tiles){const s=this._tiles[t];s.textures.forEach(u=>u.destroy()),s.textures=[]}}update(t,s){this.sourceCache.update(t,s),this._renderableTilesKeys=[];for(const u of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))this._renderableTilesKeys.push(u.key),this._tiles[u.key]||(u.posMatrix=new Float64Array(16),a.ortho(u.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),this._tiles[u.key]=new gt(u,this.tileSize))}removeOutdated(t){const s={};this.renderHistory=this.renderHistory.filter((u,p)=>this.renderHistory.indexOf(u)===p).slice(0,this.renderHistorySize);for(const u of this._renderableTilesKeys)s[u]=!0;for(const u of this.renderHistory)s[u]=!0;for(const u in this._tiles)s[u]||(this._tiles[u].clearTextures(t),delete this._tiles[u])}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const s={};for(const u of this._renderableTilesKeys){const p=this._tiles[u].tileID;if(p.canonical.equals(t.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16),a.ortho(g.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),s[u]=g}else if(p.canonical.isChildOf(t.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16);const x=p.canonical.z-t.canonical.z,E=p.canonical.x-(p.canonical.x>>x<<x),S=p.canonical.y-(p.canonical.y>>x<<x),A=a.EXTENT>>x;a.ortho(g.posMatrix,0,A,0,A,0,1),a.translate(g.posMatrix,g.posMatrix,[-E*A,-S*A,0]),s[u]=g}else if(t.canonical.isChildOf(p.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16);const x=t.canonical.z-p.canonical.z,E=t.canonical.x-(t.canonical.x>>x<<x),S=t.canonical.y-(t.canonical.y>>x<<x),A=a.EXTENT>>x;a.ortho(g.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),a.translate(g.posMatrix,g.posMatrix,[E*A,S*A,0]),a.scale(g.posMatrix,g.posMatrix,[1/2**x,1/2**x,0]),s[u]=g}}return s}getSourceTile(t,s){const u=this.sourceCache._source;let p=t.overscaledZ-this.deltaZoom;if(p>u.maxzoom&&(p=u.maxzoom),p<u.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(p).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!g||!g.dem)&&s)for(;p>=u.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(t.scaledTo(p--).key);return g}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(s=>s.timeLoaded>=t)}}class Yt{constructor(t,s,u){this.style=t,this.sourceCache=new jt(s),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.elevationOffset=typeof u.elevationOffset=="number"?u.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(t,s,u,p=a.EXTENT){if(!(s>=0&&s<p&&u>=0&&u<p))return this.elevationOffset;let g=0;const x=this.getTerrainData(t);if(x.tile&&x.tile.dem){const E=a.transformMat4$1([],[s/p*a.EXTENT,u/p*a.EXTENT],x.u_terrain_matrix),S=[E[0]*x.tile.dem.dim,E[1]*x.tile.dem.dim],A=[Math.floor(S[0]),Math.floor(S[1])],z=x.tile.dem.get(A[0],A[1]),L=x.tile.dem.get(A[0],A[1]+1),U=x.tile.dem.get(A[0]+1,A[1]),H=x.tile.dem.get(A[0]+1,A[1]+1);g=a.number(a.number(z,L,S[0]-A[0]),a.number(U,H,S[0]-A[0]),S[1]-A[1])}return g}rememberForRerender(t,s){for(const u in this.sourceCache._tiles){const p=this.sourceCache._tiles[u];(p.tileID.equals(s)||p.tileID.isChildOf(s))&&(t===this.sourceCache.sourceCache.id&&(p.timeLoaded=Date.now()),this._rerender[t]=this._rerender[t]||{},this._rerender[t][p.tileID.key]=!0)}}needsRerender(t,s){return this._rerender[t]&&this._rerender[t][s.key]}clearRerenderCache(){this._rerender={}}getElevation(t,s,u,p=a.EXTENT){return(this.getDEMElevation(t,s,u,p)+this.elevationOffset)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const p=this.style.map.painter.context,g=new a.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Oe(p,g,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Oe(p,new a.RGBAImage({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.identity([])}const s=this.sourceCache.getSourceTile(t,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const p=this.style.map.painter.context;s.demTexture=this.style.map.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new Oe(p,s.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),s.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const u=s&&s+s.tileID.key+t.key;if(u&&!this._demMatrixCache[u]){const p=this.sourceCache.sourceCache._source.maxzoom;let g=t.canonical.z-s.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=p?g=t.canonical.z-p:a.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=t.canonical.x-(t.canonical.x>>g<<g),E=t.canonical.y-(t.canonical.y>>g<<g),S=a.fromScaling(new Float64Array(16),[1/(a.EXTENT<<g),1/(a.EXTENT<<g),0]);a.translate(S,S,[x*a.EXTENT,E*a.EXTENT,0]),this._demMatrixCache[t.key]={matrix:S,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getRTTFramebuffer(){const t=this.style.map.painter;if(!this._rttFramebuffer){const s=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=t.context.createFramebuffer(s,s,!0),this._rttFramebuffer.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,s,s))}return this._rttFramebuffer}getFramebuffer(t){const s=this.style.map.painter,u=s.width/devicePixelRatio,p=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Oe(s.context,{width:u,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Oe(s.context,{width:u,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(u,p,!0),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,u,p))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,x=0;g<this._coordsTextureSize;g++)for(let E=0;E<this._coordsTextureSize;E++,x+=4)s[x+0]=255&E,s[x+1]=255&g,s[x+2]=E>>8<<4|g>>8,s[x+3]=0;const u=new a.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),p=new Oe(t,u,t.gl.RGBA,{premultiply:!1});return p.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(t){const s=new Uint8Array(4),u=this.style.map.painter,p=u.context,g=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(t.x,u.height/devicePixelRatio-t.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,s),p.bindFramebuffer.set(null);const x=s[0]+(s[2]>>4<<8),E=s[1]+((15&s[2])<<8),S=this.coordsIndex[255-s[3]],A=S&&this.sourceCache.getTileByID(S);if(!A)return null;const z=this._coordsTextureSize,L=(1<<A.tileID.canonical.z)*z;return new a.MercatorCoordinate((A.tileID.canonical.x*z+x)/L,(A.tileID.canonical.y*z+E)/L,this.getElevation(A.tileID,x,E,z))}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.style.map.painter.context,s=new a.PosArray,u=new a.TriangleIndexArray,p=this.meshSize,g=a.EXTENT/p,x=p*p;for(let E=0;E<=p;E++)for(let S=0;S<=p;S++)s.emplaceBack(S*g,E*g);for(let E=0;E<x;E+=p+1)for(let S=0;S<p;S++)u.emplaceBack(S+E,p+S+E+1,p+S+E+2),u.emplaceBack(S+E,p+S+E+2,S+E+1);return this._mesh={indexBuffer:t.createIndexBuffer(u),vertexBuffer:t.createVertexBuffer(s,di.members),segments:a.SegmentVector.simpleSegment(0,0,s.length,u.length)},this._mesh}getMinMaxElevation(t){const s=this.getTerrainData(t).tile,u={minElevation:null,maxElevation:null};return s&&s.dem&&(u.minElevation=(s.dem.min+this.elevationOffset)*this.exaggeration,u.maxElevation=(s.dem.max+this.elevationOffset)*this.exaggeration),u}}const pi=(h,t)=>a.emitValidationErrors(h,t&&t.filter(s=>s.identifier!=="source.canvas")),Pi=a.pick(Ie,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),mn=a.pick(Ie,["setCenter","setZoom","setBearing","setPitch"]),Vi=function(){const h={},t=a.spec.$version;for(const s in a.spec.$root){const u=a.spec.$root[s];if(u.required){let p=null;p=s==="version"?t:u.type==="array"?[]:{},p!=null&&(h[s]=p)}}return h}();class Cn extends a.Evented{constructor(t,s={}){super(),this.map=t,this.dispatcher=new Ue(be(),this),this.imageManager=new He,this.imageManager.setEventedParent(this),this.glyphManager=new Ce(t._requestManager,s.localIdeographFontFamily),this.lineAtlas=new it(256,512),this.crossTileSymbolIndex=new Bt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const u=this;this._rtlTextPluginCallback=Cn.registerForPluginStateChange(p=>{u.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(g,x)=>{if(a.triggerPluginCompletionEvent(g),x&&x.every(E=>E))for(const E in u.sourceCaches)u.sourceCaches[E].reload()})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const g=this.sourceCaches[p.sourceId];if(!g)return;const x=g.getSource();if(x&&x.vectorLayerIds)for(const E in this._layers){const S=this._layers[E];S.source===x.id&&this._validateLayer(S)}})}loadURL(t,s={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const u=typeof s.validate!="boolean"||s.validate,p=this.map._requestManager.transformRequest(t,a.ResourceType.Style);this._request=a.getJSON(p,(g,x)=>{this._request=null,g?this.fire(new a.ErrorEvent(g)):x&&this._load(x,u)})}loadJSON(t,s={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(t,s.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Vi,!1)}_load(t,s){if(s&&pi(this,a.validateStyle(t)))return;this._loaded=!0,this.stylesheet=t;for(const p in t.sources)this.addSource(p,t.sources[p],{validate:!1});t.sprite?this._loadSprite(t.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);const u=ke(this.stylesheet.layers);this._order=u.map(p=>p.id),this._layers={},this._serializedLayers={};for(let p of u)p=a.createStyleLayer(p),p.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=p,this._serializedLayers[p.id]=p.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ht(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}_loadSprite(t){this._spriteRequest=function(s,u,p,g){let x,E,S;const A=p>1?"@2x":"";let z=a.getJSON(u.transformRequest(u.normalizeSpriteURL(s,A,".json"),a.ResourceType.SpriteJSON),(H,W)=>{z=null,S||(S=H,x=W,U())}),L=a.getImage(u.transformRequest(u.normalizeSpriteURL(s,A,".png"),a.ResourceType.SpriteImage),(H,W)=>{L=null,S||(S=H,E=W,U())});function U(){if(S)g(S);else if(x&&E){const H=a.exported.getImageData(E),W={};for(const Z in x){const{width:ne,height:oe,x:ue,y:K,sdf:fe,pixelRatio:de,stretchX:xe,stretchY:we,content:Le}=x[Z],ye=new a.RGBAImage({width:ne,height:oe});a.RGBAImage.copy(H,ye,{x:ue,y:K},{x:0,y:0},{width:ne,height:oe}),W[Z]={data:ye,pixelRatio:de,sdf:fe,stretchX:xe,stretchY:we,content:Le}}g(null,W)}}return{cancel(){z&&(z.cancel(),z=null),L&&(L.cancel(),L=null)}}}(t,this.map._requestManager,this.map.getPixelRatio(),(s,u)=>{if(this._spriteRequest=null,s)this.fire(new a.ErrorEvent(s));else if(u)for(const p in u)this.imageManager.addImage(p,u[p]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(t){const s=this.sourceCaches[t.source];if(!s)return;const u=t.sourceLayer;if(!u)return;const p=s.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(u)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${u}" does not exist on source "${p.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const s=[];for(const u of t){const p=this._layers[u];p.type!=="custom"&&s.push(p.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const s=this._changed;if(this._changed){const p=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(p.length||g.length)&&this._updateWorkerLayers(p,g);for(const x in this._updatedSources){const E=this._updatedSources[x];if(E==="reload")this._reloadSource(x);else{if(E!=="clear")throw new Error(`Invalid action ${E}`);this._clearSource(x)}}this._updateTilesForChangedImages();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const u={};for(const p in this.sourceCaches){const g=this.sourceCaches[p];u[p]=g.used,g.used=!1}for(const p of this._order){const g=this._layers[p];g.recalculate(t,this._availableImages),!g.isHidden(t.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const p in u){const g=this.sourceCaches[p];u[p]!==g.used&&g.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(t),this.z=t.zoom,s&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(t){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),t){const s=this.sourceCaches[t.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${t.source}`);this.terrain=new Yt(this,s,t),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=u=>{u.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=u=>{u.tile&&(u.sourceId===t.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(u.sourceId,u.tile.tileID)):u.source.type==="geojson"&&this.terrain.rememberForRerender(u.sourceId,u.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new a.Event("terrain",{terrain:t}))}setState(t){if(this._checkLoaded(),pi(this,a.validateStyle(t)))return!1;(t=a.clone$1(t)).layers=ke(t.layers);const s=function(p,g){if(!p)return[{command:Ie.setStyle,args:[g]}];let x=[];try{if(!B(p.version,g.version))return[{command:Ie.setStyle,args:[g]}];B(p.center,g.center)||x.push({command:Ie.setCenter,args:[g.center]}),B(p.zoom,g.zoom)||x.push({command:Ie.setZoom,args:[g.zoom]}),B(p.bearing,g.bearing)||x.push({command:Ie.setBearing,args:[g.bearing]}),B(p.pitch,g.pitch)||x.push({command:Ie.setPitch,args:[g.pitch]}),B(p.sprite,g.sprite)||x.push({command:Ie.setSprite,args:[g.sprite]}),B(p.glyphs,g.glyphs)||x.push({command:Ie.setGlyphs,args:[g.glyphs]}),B(p.transition,g.transition)||x.push({command:Ie.setTransition,args:[g.transition]}),B(p.light,g.light)||x.push({command:Ie.setLight,args:[g.light]});const E={},S=[];(function(z,L,U,H){let W;for(W in L=L||{},z=z||{})Object.prototype.hasOwnProperty.call(z,W)&&(Object.prototype.hasOwnProperty.call(L,W)||je(W,U,H));for(W in L)Object.prototype.hasOwnProperty.call(L,W)&&(Object.prototype.hasOwnProperty.call(z,W)?B(z[W],L[W])||(z[W].type==="geojson"&&L[W].type==="geojson"&&Be(z,L,W)?U.push({command:Ie.setGeoJSONSourceData,args:[W,L[W].data]}):qe(W,L,U,H)):Ke(W,L,U))})(p.sources,g.sources,S,E);const A=[];p.layers&&p.layers.forEach(z=>{E[z.source]?x.push({command:Ie.removeLayer,args:[z.id]}):A.push(z)}),x=x.concat(S),function(z,L,U){L=L||[];const H=(z=z||[]).map(yt),W=L.map(yt),Z=z.reduce(At,{}),ne=L.reduce(At,{}),oe=H.slice(),ue=Object.create(null);let K,fe,de,xe,we,Le,ye;for(K=0,fe=0;K<H.length;K++)de=H[K],Object.prototype.hasOwnProperty.call(ne,de)?fe++:(U.push({command:Ie.removeLayer,args:[de]}),oe.splice(oe.indexOf(de,fe),1));for(K=0,fe=0;K<W.length;K++)de=W[W.length-1-K],oe[oe.length-1-K]!==de&&(Object.prototype.hasOwnProperty.call(Z,de)?(U.push({command:Ie.removeLayer,args:[de]}),oe.splice(oe.lastIndexOf(de,oe.length-fe),1)):fe++,Le=oe[oe.length-K],U.push({command:Ie.addLayer,args:[ne[de],Le]}),oe.splice(oe.length-K,0,de),ue[de]=!0);for(K=0;K<W.length;K++)if(de=W[K],xe=Z[de],we=ne[de],!ue[de]&&!B(xe,we))if(B(xe.source,we.source)&&B(xe["source-layer"],we["source-layer"])&&B(xe.type,we.type)){for(ye in bt(xe.layout,we.layout,U,de,null,Ie.setLayoutProperty),bt(xe.paint,we.paint,U,de,null,Ie.setPaintProperty),B(xe.filter,we.filter)||U.push({command:Ie.setFilter,args:[de,we.filter]}),B(xe.minzoom,we.minzoom)&&B(xe.maxzoom,we.maxzoom)||U.push({command:Ie.setLayerZoomRange,args:[de,we.minzoom,we.maxzoom]}),xe)Object.prototype.hasOwnProperty.call(xe,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?bt(xe[ye],we[ye],U,de,ye.slice(6),Ie.setPaintProperty):B(xe[ye],we[ye])||U.push({command:Ie.setLayerProperty,args:[de,ye,we[ye]]}));for(ye in we)Object.prototype.hasOwnProperty.call(we,ye)&&!Object.prototype.hasOwnProperty.call(xe,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?bt(xe[ye],we[ye],U,de,ye.slice(6),Ie.setPaintProperty):B(xe[ye],we[ye])||U.push({command:Ie.setLayerProperty,args:[de,ye,we[ye]]}))}else U.push({command:Ie.removeLayer,args:[de]}),Le=oe[oe.lastIndexOf(de)+1],U.push({command:Ie.addLayer,args:[we,Le]})}(A,g.layers,x)}catch(E){console.warn("Unable to compute style diff:",E),x=[{command:Ie.setStyle,args:[g]}]}return x}(this.serialize(),t).filter(p=>!(p.command in mn));if(s.length===0)return!1;const u=s.filter(p=>!(p.command in Pi));if(u.length>0)throw new Error(`Unimplemented: ${u.map(p=>p.command).join(", ")}.`);return s.forEach(p=>{p.command!=="setTransition"&&this[p.command].apply(this,p.args)}),this.stylesheet=t,!0}addImage(t,s){if(this.getImage(t))return this.fire(new a.ErrorEvent(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,s),this._afterImageUpdated(t)}updateImage(t,s){this.imageManager.updateImage(t,s)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new a.ErrorEvent(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,s,u={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(a.validateStyle.source,`sources.${t}`,s,null,u))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const p=this.sourceCaches[t]=new $t(t,s,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:p.serialize(),sourceId:t})),p.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===t)return this.fire(new a.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${u}" is using it.`)));const s=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],s.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,s){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const u=this.sourceCaches[t].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(s),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,s,u={}){this._checkLoaded();const p=t.id;if(this.getLayer(p))return void this.fire(new a.ErrorEvent(new Error(`Layer "${p}" already exists on this map.`)));let g;if(t.type==="custom"){if(pi(this,a.validateCustomStyleLayer(t)))return;g=a.createStyleLayer(t)}else{if(typeof t.source=="object"&&(this.addSource(p,t.source),t=a.clone$1(t),t=a.extend(t,{source:p})),this._validate(a.validateStyle.layer,`layers.${p}`,t,{arrayIndex:-1},u))return;g=a.createStyleLayer(t),this._validateLayer(g),g.setEventedParent(this,{layer:{id:p}}),this._serializedLayers[g.id]=g.serialize()}const x=s?this._order.indexOf(s):this._order.length;if(s&&x===-1)this.fire(new a.ErrorEvent(new Error(`Cannot add layer "${p}" before non-existing layer "${s}".`)));else{if(this._order.splice(x,0,p),this._layerOrderChanged=!0,this._layers[p]=g,this._removedLayers[p]&&g.source&&g.type!=="custom"){const E=this._removedLayers[p];delete this._removedLayers[p],E.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(t,s){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new a.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===s)return;const u=this._order.indexOf(t);this._order.splice(u,1);const p=s?this._order.indexOf(s):this._order.length;s&&p===-1?this.fire(new a.ErrorEvent(new Error(`Cannot move layer "${t}" before non-existing layer "${s}".`))):(this._order.splice(p,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const s=this._layers[t];if(!s)return void this.fire(new a.ErrorEvent(new Error(`Cannot remove non-existing layer "${t}".`)));s.setEventedParent(null);const u=this._order.indexOf(t);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=s,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],s.onRemove&&s.onRemove(this.map)}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,s,u){this._checkLoaded();const p=this.getLayer(t);p?p.minzoom===s&&p.maxzoom===u||(s!=null&&(p.minzoom=s),u!=null&&(p.maxzoom=u),this._updateLayer(p)):this.fire(new a.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,s,u={}){this._checkLoaded();const p=this.getLayer(t);if(p){if(!B(p.filter,s))return s==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(a.validateStyle.filter,`layers.${p.id}.filter`,s,null,u)||(p.filter=a.clone$1(s),this._updateLayer(p)))}else this.fire(new a.ErrorEvent(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return a.clone$1(this.getLayer(t).filter)}setLayoutProperty(t,s,u,p={}){this._checkLoaded();const g=this.getLayer(t);g?B(g.getLayoutProperty(s),u)||(g.setLayoutProperty(s,u,p),this._updateLayer(g)):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,s){const u=this.getLayer(t);if(u)return u.getLayoutProperty(s);this.fire(new a.ErrorEvent(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,s,u,p={}){this._checkLoaded();const g=this.getLayer(t);g?B(g.getPaintProperty(s),u)||(g.setPaintProperty(s,u,p)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,s){return this.getLayer(t).getPaintProperty(s)}setFeatureState(t,s){this._checkLoaded();const u=t.source,p=t.sourceLayer,g=this.sourceCaches[u];if(g===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)));const x=g.getSource().type;x==="geojson"&&p?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||p?(t.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),g.setFeatureState(p,t.id,s)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,s){this._checkLoaded();const u=t.source,p=this.sourceCaches[u];if(p===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)));const g=p.getSource().type,x=g==="vector"?t.sourceLayer:void 0;g!=="vector"||x?s&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(x,t.id,s):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const s=t.source,u=t.sourceLayer,p=this.sourceCaches[s];if(p!==void 0)return p.getSource().type!=="vector"||u?(t.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),p.getFeatureState(u,t.id)):void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.ErrorEvent(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,t=>t.serialize()),layers:this._serializeLayers(this._order)},t=>t!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(t){const s=x=>this._layers[x].type==="fill-extrusion",u={},p=[];for(let x=this._order.length-1;x>=0;x--){const E=this._order[x];if(s(E)){u[E]=x;for(const S of t){const A=S[E];if(A)for(const z of A)p.push(z)}}}p.sort((x,E)=>E.intersectionZ-x.intersectionZ);const g=[];for(let x=this._order.length-1;x>=0;x--){const E=this._order[x];if(s(E))for(let S=p.length-1;S>=0;S--){const A=p[S].feature;if(u[A.layer.id]<x)break;g.push(A),p.pop()}else for(const S of t){const A=S[E];if(A)for(const z of A)g.push(z.feature)}}return g}queryRenderedFeatures(t,s,u){s&&s.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",s.filter,null,s);const p={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const x of s.layers){const E=this._layers[x];if(!E)return this.fire(new a.ErrorEvent(new Error(`The layer '${x}' does not exist in the map's style and cannot be queried for features.`))),[];p[E.source]=!0}}const g=[];s.availableImages=this._availableImages;for(const x in this.sourceCaches)s.layers&&!p[x]||g.push(pn(this.sourceCaches[x],this._layers,this._serializedLayers,t,s,u));return this.placement&&g.push(function(x,E,S,A,z,L,U){const H={},W=L.queryRenderedSymbols(A),Z=[];for(const ne of Object.keys(W).map(Number))Z.push(U[ne]);Z.sort(Te);for(const ne of Z){const oe=ne.featureIndex.lookupSymbolFeatures(W[ne.bucketInstanceId],E,ne.bucketIndex,ne.sourceLayerIndex,z.filter,z.layers,z.availableImages,x);for(const ue in oe){const K=H[ue]=H[ue]||[],fe=oe[ue];fe.sort((de,xe)=>{const we=ne.featureSortOrder;if(we){const Le=we.indexOf(de.featureIndex);return we.indexOf(xe.featureIndex)-Le}return xe.featureIndex-de.featureIndex});for(const de of fe)K.push(de)}}for(const ne in H)H[ne].forEach(oe=>{const ue=oe.feature,K=S[x[ne].source].getFeatureState(ue.layer["source-layer"],ue.id);ue.source=ue.layer.source,ue.layer["source-layer"]&&(ue.sourceLayer=ue.layer["source-layer"]),ue.state=K});return H}(this._layers,this._serializedLayers,this.sourceCaches,t,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(t,s){s&&s.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",s.filter,null,s);const u=this.sourceCaches[t];return u?function(p,g){const x=p.getRenderableIds().map(A=>p.getTileByID(A)),E=[],S={};for(let A=0;A<x.length;A++){const z=x[A],L=z.tileID.canonical.key;S[L]||(S[L]=!0,z.querySourceFeatures(E,g))}return E}(u,s):[]}addSourceType(t,s,u){return Cn.getSourceType(t)?u(new Error(`A source type called "${t}" already exists.`)):(Cn.setSourceType(t,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:s.workerSourceURL},u):u(null,null))}getLight(){return this.light.getLight()}setLight(t,s={}){this._checkLoaded();const u=this.light.getLight();let p=!1;for(const x in t)if(!B(t[x],u[x])){p=!0;break}if(!p)return;const g={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,s),this.light.updateTransitions(g)}_validate(t,s,u,p,g={}){return(!g||g.validate!==!1)&&pi(this,t.call(a.validateStyle,a.extend({key:s,style:this.serialize(),value:u,styleSpec:a.spec},p)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.sourceCaches){const s=this.sourceCaches[t];s.setEventedParent(null),s.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const s in this.sourceCaches)this.sourceCaches[s].update(t,this.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,s,u,p,g=!1){let x=!1,E=!1;const S={};for(const A of this._order){const z=this._layers[A];if(z.type!=="symbol")continue;if(!S[z.source]){const U=this.sourceCaches[z.source];S[z.source]=U.getRenderableIds(!0).map(H=>U.getTileByID(H)).sort((H,W)=>W.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(W.tileID)?-1:1))}const L=this.crossTileSymbolIndex.addLayer(z,S[z.source],t.center.lng);x=x||L}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),t.zoom))&&(this.pauseablePlacement=new ge(t,this.terrain,this._order,g,s,u,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),E=!0),x&&this.pauseablePlacement.placement.setStale()),E||x)for(const A of this._order){const z=this._layers[A];z.type==="symbol"&&this.placement.updateLayerOpacities(z,S[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,s,u){this.imageManager.getImages(s.icons,u),this._updateTilesForChangedImages();const p=this.sourceCaches[s.source];p&&p.setDependencies(s.tileID.key,s.type,s.icons)}getGlyphs(t,s,u){this.glyphManager.getGlyphs(s.stacks,u)}getResource(t,s,u){return a.makeRequest(s,u)}}Cn.getSourceType=function(h){return Bn[h]},Cn.setSourceType=function(h,t){Bn[h]=t},Cn.registerForPluginStateChange=a.registerForPluginStateChange;var js="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const So={prelude:Mi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Mi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Mi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Mi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Mi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Mi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Mi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Mi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Mi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Mi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Mi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Mi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Mi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Mi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Mi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Mi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Mi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Mi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Mi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Mi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Mi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Mi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Mi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Mi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Mi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Mi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Mi("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",js),terrainDepth:Mi("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",js),terrainCoords:Mi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",js)};function Mi(h,t){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=t.match(/attribute ([\w]+) ([\w]+)/g),p=h.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=g?g.concat(p):p,E={};return{fragmentSource:h=h.replace(s,(S,A,z,L,U)=>(E[U]=!0,A==="define"?`
#ifndef HAS_UNIFORM_u_${U}
varying ${z} ${L} ${U};
#else
uniform ${z} ${L} u_${U};
#endif
`:`
#ifdef HAS_UNIFORM_u_${U}
    ${z} ${L} ${U} = u_${U};
#endif
`)),vertexSource:t=t.replace(s,(S,A,z,L,U)=>{const H=L==="float"?"vec2":"vec4",W=U.match(/color/)?"color":H;return E[U]?A==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
attribute ${z} ${H} a_${U};
varying ${z} ${L} ${U};
#else
uniform ${z} ${L} u_${U};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${z} ${L} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = unpack_mix_${W}(a_${U}, u_${U}_t);
#else
    ${z} ${L} ${U} = u_${U};
#endif
`:A==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
attribute ${z} ${H} a_${U};
#else
uniform ${z} ${L} u_${U};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${z} ${L} ${U} = a_${U};
#else
    ${z} ${L} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${z} ${L} ${U} = unpack_mix_${W}(a_${U}, u_${U}_t);
#else
    ${z} ${L} ${U} = u_${U};
#endif
`}),staticAttributes:u,staticUniforms:x}}class Ml{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,s,u,p,g,x,E,S,A){this.context=t;let z=this.boundPaintVertexBuffers.length!==p.length;for(let L=0;!z&&L<p.length;L++)this.boundPaintVertexBuffers[L]!==p[L]&&(z=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===u&&!z&&this.boundIndexBuffer===g&&this.boundVertexOffset===x&&this.boundDynamicVertexBuffer===E&&this.boundDynamicVertexBuffer2===S&&this.boundDynamicVertexBuffer3===A?(t.bindVertexArrayOES.set(this.vao),E&&E.bind(),g&&g.dynamicDraw&&g.bind(),S&&S.bind(),A&&A.bind()):this.freshBind(s,u,p,g,x,E,S,A)}freshBind(t,s,u,p,g,x,E,S){let A;const z=t.numAttributes,L=this.context,U=L.gl;if(L.extVertexArrayObject)this.vao&&this.destroy(),this.vao=L.extVertexArrayObject.createVertexArrayOES(),L.bindVertexArrayOES.set(this.vao),A=0,this.boundProgram=t,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=p,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=E,this.boundDynamicVertexBuffer3=S;else{A=L.currentNumAttributes||0;for(let H=z;H<A;H++)U.disableVertexAttribArray(H)}s.enableAttributes(U,t);for(const H of u)H.enableAttributes(U,t);x&&x.enableAttributes(U,t),E&&E.enableAttributes(U,t),S&&S.enableAttributes(U,t),s.bind(),s.setVertexAttribPointers(U,t,g);for(const H of u)H.bind(),H.setVertexAttribPointers(U,t,g);x&&(x.bind(),x.setVertexAttribPointers(U,t,g)),p&&p.bind(),E&&(E.bind(),E.setVertexAttribPointers(U,t,g)),S&&(S.bind(),S.setVertexAttribPointers(U,t,g)),L.currentNumAttributes=z}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function zl(h){const t=[];for(let s=0;s<h.length;s++){if(h[s]===null)continue;const u=h[s].split(" ");t.push(u.pop())}return t}class au{constructor(t,s,u,p,g,x,E){const S=t.gl;this.program=S.createProgram();const A=zl(u.staticAttributes),z=p?p.getBinderAttributes():[],L=A.concat(z),U=So.prelude.staticUniforms?zl(So.prelude.staticUniforms):[],H=u.staticUniforms?zl(u.staticUniforms):[],W=p?p.getBinderUniforms():[],Z=U.concat(H).concat(W),ne=[];for(const we of Z)ne.indexOf(we)<0&&ne.push(we);const oe=p?p.defines():[];x&&oe.push("#define OVERDRAW_INSPECTOR;"),E&&oe.push("#define TERRAIN3D;");const ue=oe.concat(So.prelude.fragmentSource,u.fragmentSource).join(`
`),K=oe.concat(So.prelude.vertexSource,u.vertexSource).join(`
`),fe=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(fe,ue),S.compileShader(fe),S.attachShader(this.program,fe);const de=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(de,K),S.compileShader(de),S.attachShader(this.program,de),this.attributes={};const xe={};this.numAttributes=L.length;for(let we=0;we<this.numAttributes;we++)L[we]&&(S.bindAttribLocation(this.program,we,L[we]),this.attributes[L[we]]=we);S.linkProgram(this.program),S.deleteShader(de),S.deleteShader(fe);for(let we=0;we<ne.length;we++){const Le=ne[we];if(Le&&!xe[Le]){const ye=S.getUniformLocation(this.program,Le);ye&&(xe[Le]=ye)}}this.fixedUniforms=g(t,xe),this.terrainUniforms=((we,Le)=>({u_depth:new a.Uniform1i(we,Le.u_depth),u_terrain:new a.Uniform1i(we,Le.u_terrain),u_terrain_dim:new a.Uniform1f(we,Le.u_terrain_dim),u_terrain_matrix:new a.UniformMatrix4f(we,Le.u_terrain_matrix),u_terrain_unpack:new a.Uniform4f(we,Le.u_terrain_unpack),u_terrain_offset:new a.Uniform1f(we,Le.u_terrain_offset),u_terrain_exaggeration:new a.Uniform1f(we,Le.u_terrain_exaggeration)}))(t,xe),this.binderUniforms=p?p.getUniforms(t,xe):[]}draw(t,s,u,p,g,x,E,S,A,z,L,U,H,W,Z,ne,oe,ue){const K=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(u),t.setStencilMode(p),t.setColorMode(g),t.setCullFace(x),S){t.activeTexture.set(K.TEXTURE2),K.bindTexture(K.TEXTURE_2D,S.depthTexture),t.activeTexture.set(K.TEXTURE3),K.bindTexture(K.TEXTURE_2D,S.texture);for(const de in this.terrainUniforms)this.terrainUniforms[de].set(S[de])}for(const de in this.fixedUniforms)this.fixedUniforms[de].set(E[de]);Z&&Z.setUniforms(t,this.binderUniforms,H,{zoom:W});let fe=0;switch(s){case K.LINES:fe=2;break;case K.TRIANGLES:fe=3;break;case K.LINE_STRIP:fe=1}for(const de of U.get()){const xe=de.vaos||(de.vaos={});(xe[A]||(xe[A]=new Ml)).bind(t,this,z,Z?Z.getPaintVertexBuffers():[],L,de.vertexOffset,ne,oe,ue),K.drawElements(s,de.primitiveLength*fe,K.UNSIGNED_SHORT,de.primitiveOffset*fe*2)}}}function lu(h,t,s){const u=1/nn(s,1,t.transform.tileZoom),p=Math.pow(2,s.tileID.overscaledZ),g=s.tileSize*Math.pow(2,t.transform.tileZoom)/p,x=g*(s.tileID.canonical.x+s.tileID.wrap*p),E=g*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[u,h.fromScale,h.toScale],u_fade:h.t,u_pixel_coord_upper:[x>>16,E>>16],u_pixel_coord_lower:[65535&x,65535&E]}}const Dl=(h,t,s,u)=>{const p=t.style.light,g=p.properties.get("position"),x=[g.x,g.y,g.z],E=a.create$1();p.properties.get("anchor")==="viewport"&&a.fromRotation(E,-t.transform.angle),a.transformMat3(x,x,E);const S=p.properties.get("color");return{u_matrix:h,u_lightpos:x,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+s,u_opacity:u}},md=(h,t,s,u,p,g,x)=>a.extend(Dl(h,t,s,u),lu(g,t,x),{u_height_factor:-Math.pow(2,p.overscaledZ)/x.tileSize/8}),Ca=h=>({u_matrix:h}),Rl=(h,t,s,u)=>a.extend(Ca(h),lu(s,t,u)),cu=(h,t)=>({u_matrix:h,u_world:t}),uu=(h,t,s,u,p)=>a.extend(Rl(h,t,s,u),{u_world:p}),hu=(h,t,s,u)=>{const p=h.transform;let g,x;if(u.paint.get("circle-pitch-alignment")==="map"){const E=nn(s,1,p.zoom);g=!0,x=[E,E]}else g=!1,x=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:h.translatePosMatrix(t.posMatrix,s,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+g,u_device_pixel_ratio:h.pixelRatio,u_extrude_scale:x}},ys=(h,t,s)=>{const u=nn(s,1,t.zoom),p=Math.pow(2,t.zoom-s.tileID.overscaledZ),g=s.tileID.overscaleFactor();return{u_matrix:h,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[t.pixelsToGLUnits[0]/(u*p),t.pixelsToGLUnits[1]/(u*p)],u_overscale_factor:g}},Io=(h,t,s=1)=>({u_matrix:h,u_color:t,u_overlay:0,u_overlay_scale:s}),qs=h=>({u_matrix:h}),ka=(h,t,s,u)=>({u_matrix:h,u_extrude_scale:nn(t,1,s),u_intensity:u});function Pa(h,t){const s=Math.pow(2,t.canonical.z),u=t.canonical.y;return[new a.MercatorCoordinate(0,u/s).toLngLat().lat,new a.MercatorCoordinate(0,(u+1)/s).toLngLat().lat]}const Gs=(h,t,s,u)=>{const p=h.transform;return{u_matrix:Co(h,t,s,u),u_ratio:1/nn(t,1,p.zoom),u_device_pixel_ratio:h.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Ll=(h,t,s,u,p)=>a.extend(Gs(h,t,s,p),{u_image:0,u_image_height:u}),Ma=(h,t,s,u,p)=>{const g=h.transform,x=ji(t,g);return{u_matrix:Co(h,t,s,p),u_texsize:t.imageAtlasTexture.size,u_ratio:1/nn(t,1,g.zoom),u_device_pixel_ratio:h.pixelRatio,u_image:0,u_scale:[x,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Ao=(h,t,s,u,p,g)=>{const x=h.lineAtlas,E=ji(t,h.transform),S=s.layout.get("line-cap")==="round",A=x.getDash(u.from,S),z=x.getDash(u.to,S),L=A.width*p.fromScale,U=z.width*p.toScale;return a.extend(Gs(h,t,s,g),{u_patternscale_a:[E/L,-A.height/2],u_patternscale_b:[E/U,-z.height/2],u_sdfgamma:x.width/(256*Math.min(L,U)*h.pixelRatio)/2,u_image:0,u_tex_y_a:A.y,u_tex_y_b:z.y,u_mix:p.t})};function ji(h,t){return 1/nn(h,1,t.tileZoom)}function Co(h,t,s,u){return h.translatePosMatrix(u?u.posMatrix:t.tileID.posMatrix,t,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const du=(h,t,s,u,p)=>{return{u_matrix:h,u_tl_parent:t,u_scale_parent:s,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(x=p.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(g=p.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:pu(p.paint.get("raster-hue-rotate"))};var g,x};function pu(h){h*=Math.PI/180;const t=Math.sin(h),s=Math.cos(h);return[(2*s+1)/3,(-Math.sqrt(3)*t-s+1)/3,(Math.sqrt(3)*t-s+1)/3]}const Ol=(h,t,s,u,p,g,x,E,S,A)=>{const z=p.transform;return{u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:z.cameraToCenterDistance,u_pitch:z.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:z.width/z.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:g,u_label_plane_matrix:x,u_coord_matrix:E,u_is_text:+S,u_pitch_with_map:+u,u_texsize:A,u_texture:0}},za=(h,t,s,u,p,g,x,E,S,A,z)=>{const L=p.transform;return a.extend(Ol(h,t,s,u,p,g,x,E,S,A),{u_gamma_scale:u?Math.cos(L._pitch)*L.cameraToCenterDistance:1,u_device_pixel_ratio:p.pixelRatio,u_is_halo:+z})},fu=(h,t,s,u,p,g,x,E,S,A)=>a.extend(za(h,t,s,u,p,g,x,E,!0,S,!0),{u_texsize_icon:A,u_texture_icon:1}),gd=(h,t,s)=>({u_matrix:h,u_opacity:t,u_color:s}),_d=(h,t,s,u,p,g)=>a.extend(function(x,E,S,A){const z=S.imageManager.getPattern(x.from.toString()),L=S.imageManager.getPattern(x.to.toString()),{width:U,height:H}=S.imageManager.getPixelSize(),W=Math.pow(2,A.tileID.overscaledZ),Z=A.tileSize*Math.pow(2,S.transform.tileZoom)/W,ne=Z*(A.tileID.canonical.x+A.tileID.wrap*W),oe=Z*A.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:L.tl,u_pattern_br_b:L.br,u_texsize:[U,H],u_mix:E.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:L.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/nn(A,1,S.transform.tileZoom),u_pixel_coord_upper:[ne>>16,oe>>16],u_pixel_coord_lower:[65535&ne,65535&oe]}}(u,g,s,p),{u_matrix:h,u_opacity:t}),Bl={fillExtrusion:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_lightpos:new a.Uniform3f(h,t.u_lightpos),u_lightintensity:new a.Uniform1f(h,t.u_lightintensity),u_lightcolor:new a.Uniform3f(h,t.u_lightcolor),u_vertical_gradient:new a.Uniform1f(h,t.u_vertical_gradient),u_opacity:new a.Uniform1f(h,t.u_opacity)}),fillExtrusionPattern:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_lightpos:new a.Uniform3f(h,t.u_lightpos),u_lightintensity:new a.Uniform1f(h,t.u_lightintensity),u_lightcolor:new a.Uniform3f(h,t.u_lightcolor),u_vertical_gradient:new a.Uniform1f(h,t.u_vertical_gradient),u_height_factor:new a.Uniform1f(h,t.u_height_factor),u_image:new a.Uniform1i(h,t.u_image),u_texsize:new a.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new a.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new a.Uniform3f(h,t.u_scale),u_fade:new a.Uniform1f(h,t.u_fade),u_opacity:new a.Uniform1f(h,t.u_opacity)}),fill:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix)}),fillPattern:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_image:new a.Uniform1i(h,t.u_image),u_texsize:new a.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new a.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new a.Uniform3f(h,t.u_scale),u_fade:new a.Uniform1f(h,t.u_fade)}),fillOutline:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_world:new a.Uniform2f(h,t.u_world)}),fillOutlinePattern:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_world:new a.Uniform2f(h,t.u_world),u_image:new a.Uniform1i(h,t.u_image),u_texsize:new a.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new a.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new a.Uniform3f(h,t.u_scale),u_fade:new a.Uniform1f(h,t.u_fade)}),circle:(h,t)=>({u_camera_to_center_distance:new a.Uniform1f(h,t.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(h,t.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(h,t.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(h,t.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(h,t.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(h,t.u_matrix)}),collisionBox:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_camera_to_center_distance:new a.Uniform1f(h,t.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(h,t.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(h,t.u_extrude_scale),u_overscale_factor:new a.Uniform1f(h,t.u_overscale_factor)}),collisionCircle:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_inv_matrix:new a.UniformMatrix4f(h,t.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(h,t.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(h,t.u_viewport_size)}),debug:(h,t)=>({u_color:new a.UniformColor(h,t.u_color),u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_overlay:new a.Uniform1i(h,t.u_overlay),u_overlay_scale:new a.Uniform1f(h,t.u_overlay_scale)}),clippingMask:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix)}),heatmap:(h,t)=>({u_extrude_scale:new a.Uniform1f(h,t.u_extrude_scale),u_intensity:new a.Uniform1f(h,t.u_intensity),u_matrix:new a.UniformMatrix4f(h,t.u_matrix)}),heatmapTexture:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_world:new a.Uniform2f(h,t.u_world),u_image:new a.Uniform1i(h,t.u_image),u_color_ramp:new a.Uniform1i(h,t.u_color_ramp),u_opacity:new a.Uniform1f(h,t.u_opacity)}),hillshade:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_image:new a.Uniform1i(h,t.u_image),u_latrange:new a.Uniform2f(h,t.u_latrange),u_light:new a.Uniform2f(h,t.u_light),u_shadow:new a.UniformColor(h,t.u_shadow),u_highlight:new a.UniformColor(h,t.u_highlight),u_accent:new a.UniformColor(h,t.u_accent)}),hillshadePrepare:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_image:new a.Uniform1i(h,t.u_image),u_dimension:new a.Uniform2f(h,t.u_dimension),u_zoom:new a.Uniform1f(h,t.u_zoom),u_unpack:new a.Uniform4f(h,t.u_unpack)}),line:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_ratio:new a.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new a.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(h,t.u_units_to_pixels)}),lineGradient:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_ratio:new a.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new a.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(h,t.u_units_to_pixels),u_image:new a.Uniform1i(h,t.u_image),u_image_height:new a.Uniform1f(h,t.u_image_height)}),linePattern:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_texsize:new a.Uniform2f(h,t.u_texsize),u_ratio:new a.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new a.Uniform1f(h,t.u_device_pixel_ratio),u_image:new a.Uniform1i(h,t.u_image),u_units_to_pixels:new a.Uniform2f(h,t.u_units_to_pixels),u_scale:new a.Uniform3f(h,t.u_scale),u_fade:new a.Uniform1f(h,t.u_fade)}),lineSDF:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_ratio:new a.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new a.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(h,t.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(h,t.u_patternscale_a),u_patternscale_b:new a.Uniform2f(h,t.u_patternscale_b),u_sdfgamma:new a.Uniform1f(h,t.u_sdfgamma),u_image:new a.Uniform1i(h,t.u_image),u_tex_y_a:new a.Uniform1f(h,t.u_tex_y_a),u_tex_y_b:new a.Uniform1f(h,t.u_tex_y_b),u_mix:new a.Uniform1f(h,t.u_mix)}),raster:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_tl_parent:new a.Uniform2f(h,t.u_tl_parent),u_scale_parent:new a.Uniform1f(h,t.u_scale_parent),u_buffer_scale:new a.Uniform1f(h,t.u_buffer_scale),u_fade_t:new a.Uniform1f(h,t.u_fade_t),u_opacity:new a.Uniform1f(h,t.u_opacity),u_image0:new a.Uniform1i(h,t.u_image0),u_image1:new a.Uniform1i(h,t.u_image1),u_brightness_low:new a.Uniform1f(h,t.u_brightness_low),u_brightness_high:new a.Uniform1f(h,t.u_brightness_high),u_saturation_factor:new a.Uniform1f(h,t.u_saturation_factor),u_contrast_factor:new a.Uniform1f(h,t.u_contrast_factor),u_spin_weights:new a.Uniform3f(h,t.u_spin_weights)}),symbolIcon:(h,t)=>({u_is_size_zoom_constant:new a.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new a.Uniform1f(h,t.u_size_t),u_size:new a.Uniform1f(h,t.u_size),u_camera_to_center_distance:new a.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new a.Uniform1f(h,t.u_pitch),u_rotate_symbol:new a.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new a.Uniform1f(h,t.u_fade_change),u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new a.Uniform1i(h,t.u_is_text),u_pitch_with_map:new a.Uniform1i(h,t.u_pitch_with_map),u_texsize:new a.Uniform2f(h,t.u_texsize),u_texture:new a.Uniform1i(h,t.u_texture)}),symbolSDF:(h,t)=>({u_is_size_zoom_constant:new a.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new a.Uniform1f(h,t.u_size_t),u_size:new a.Uniform1f(h,t.u_size),u_camera_to_center_distance:new a.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new a.Uniform1f(h,t.u_pitch),u_rotate_symbol:new a.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new a.Uniform1f(h,t.u_fade_change),u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new a.Uniform1i(h,t.u_is_text),u_pitch_with_map:new a.Uniform1i(h,t.u_pitch_with_map),u_texsize:new a.Uniform2f(h,t.u_texsize),u_texture:new a.Uniform1i(h,t.u_texture),u_gamma_scale:new a.Uniform1f(h,t.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(h,t.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(h,t.u_is_halo)}),symbolTextAndIcon:(h,t)=>({u_is_size_zoom_constant:new a.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new a.Uniform1f(h,t.u_size_t),u_size:new a.Uniform1f(h,t.u_size),u_camera_to_center_distance:new a.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new a.Uniform1f(h,t.u_pitch),u_rotate_symbol:new a.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new a.Uniform1f(h,t.u_fade_change),u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new a.Uniform1i(h,t.u_is_text),u_pitch_with_map:new a.Uniform1i(h,t.u_pitch_with_map),u_texsize:new a.Uniform2f(h,t.u_texsize),u_texsize_icon:new a.Uniform2f(h,t.u_texsize_icon),u_texture:new a.Uniform1i(h,t.u_texture),u_texture_icon:new a.Uniform1i(h,t.u_texture_icon),u_gamma_scale:new a.Uniform1f(h,t.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(h,t.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(h,t.u_is_halo)}),background:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_opacity:new a.Uniform1f(h,t.u_opacity),u_color:new a.UniformColor(h,t.u_color)}),backgroundPattern:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_opacity:new a.Uniform1f(h,t.u_opacity),u_image:new a.Uniform1i(h,t.u_image),u_pattern_tl_a:new a.Uniform2f(h,t.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(h,t.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(h,t.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(h,t.u_pattern_br_b),u_texsize:new a.Uniform2f(h,t.u_texsize),u_mix:new a.Uniform1f(h,t.u_mix),u_pattern_size_a:new a.Uniform2f(h,t.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(h,t.u_pattern_size_b),u_scale_a:new a.Uniform1f(h,t.u_scale_a),u_scale_b:new a.Uniform1f(h,t.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(h,t.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(h,t.u_tile_units_to_pixels)}),terrain:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_texture:new a.Uniform1i(h,t.u_texture)}),terrainDepth:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix)}),terrainCoords:(h,t)=>({u_matrix:new a.UniformMatrix4f(h,t.u_matrix),u_texture:new a.Uniform1i(h,t.u_texture),u_terrain_coords_id:new a.Uniform1f(h,t.u_terrain_coords_id)})};class Fl{constructor(t,s,u){this.context=t;const p=t.gl;this.buffer=p.createBuffer(),this.dynamicDraw=Boolean(u),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const $l={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ul{constructor(t,s,u,p){this.length=s.length,this.attributes=u,this.itemSize=s.bytesPerElement,this.dynamicDraw=p,this.context=t;const g=t.gl;this.buffer=g.createBuffer(),t.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,s){for(let u=0;u<this.attributes.length;u++){const p=s.attributes[this.attributes[u].name];p!==void 0&&t.enableVertexAttribArray(p)}}setVertexAttribPointers(t,s,u){for(let p=0;p<this.attributes.length;p++){const g=this.attributes[p],x=s.attributes[g.name];x!==void 0&&t.vertexAttribPointer(x,g.components,t[$l[g.type]],!1,this.itemSize,g.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class vi{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class mu extends vi{getDefault(){return a.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class yd extends vi{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class ko extends vi{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Po extends vi{getDefault(){return[!0,!0,!0,!0]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class gu extends vi{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Jn extends vi{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Nl extends vi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const s=this.current;(t.func!==s.func||t.ref!==s.ref||t.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Da extends vi{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Ra extends vi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=t,this.dirty=!1}}class Vl extends vi{getDefault(){return[0,1]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class jl extends vi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=t,this.dirty=!1}}class La extends vi{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class ql extends vi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.BLEND):s.disable(s.BLEND),this.current=t,this.dirty=!1}}class Gl extends vi{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Oa extends vi{getDefault(){return a.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class _u extends vi{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class yu extends vi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=t,this.dirty=!1}}class Ws extends vi{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class vd extends vi{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class xd extends vi{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class bd extends vi{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class wd extends vi{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Td extends vi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Ed extends vi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Wl extends vi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Ba extends vi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Zl extends vi{getDefault(){return null}set(t){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Hl extends vi{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class Zs extends vi{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class vu extends vi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class xu extends vi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Fa extends vi{constructor(t,s){super(t),this.context=t,this.parent=s}getDefault(){return null}}class vs extends Fa{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class bu extends Fa{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Hs{constructor(t,s,u,p){this.context=t,this.width=s,this.height=u;const g=t.gl,x=this.framebuffer=g.createFramebuffer();if(this.colorAttachment=new vs(t,x),p&&(this.depthAttachment=new bu(t,x)),g.checkFramebufferStatus(g.FRAMEBUFFER)!==g.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,s=this.colorAttachment.get();if(s&&t.deleteTexture(s),this.depthAttachment){const u=this.depthAttachment.get();u&&t.deleteRenderbuffer(u)}t.deleteFramebuffer(this.framebuffer)}}class Fi{constructor(t,s,u){this.blendFunction=t,this.blendColor=s,this.mask=u}}Fi.Replace=[1,0],Fi.disabled=new Fi(Fi.Replace,a.Color.transparent,[!1,!1,!1,!1]),Fi.unblended=new Fi(Fi.Replace,a.Color.transparent,[!0,!0,!0,!0]),Fi.alphaBlended=new Fi([1,771],a.Color.transparent,[!0,!0,!0,!0]);class wu{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new mu(this),this.clearDepth=new yd(this),this.clearStencil=new ko(this),this.colorMask=new Po(this),this.depthMask=new gu(this),this.stencilMask=new Jn(this),this.stencilFunc=new Nl(this),this.stencilOp=new Da(this),this.stencilTest=new Ra(this),this.depthRange=new Vl(this),this.depthTest=new jl(this),this.depthFunc=new La(this),this.blend=new ql(this),this.blendFunc=new Gl(this),this.blendColor=new Oa(this),this.blendEquation=new _u(this),this.cullFace=new yu(this),this.cullFaceSide=new Ws(this),this.frontFace=new vd(this),this.program=new xd(this),this.activeTexture=new bd(this),this.viewport=new wd(this),this.bindFramebuffer=new Td(this),this.bindRenderbuffer=new Ed(this),this.bindTexture=new Wl(this),this.bindVertexBuffer=new Ba(this),this.bindElementBuffer=new Zl(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Hl(this),this.pixelStoreUnpack=new Zs(this),this.pixelStoreUnpackPremultiplyAlpha=new vu(this),this.pixelStoreUnpackFlipY=new xu(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,s){return new Fl(this,t,s)}createVertexBuffer(t,s,u){return new Ul(this,t,s,u)}createRenderbuffer(t,s,u){const p=this.gl,g=p.createRenderbuffer();return this.bindRenderbuffer.set(g),p.renderbufferStorage(p.RENDERBUFFER,t,s,u),this.bindRenderbuffer.set(null),g}createFramebuffer(t,s,u){return new Hs(this,t,s,u)}clear({color:t,depth:s}){const u=this.gl;let p=0;t&&(p|=u.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(p|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),u.clear(p)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){B(t.blendFunction,Fi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class oi{constructor(t,s,u){this.func=t,this.mask=s,this.range=u}}oi.ReadOnly=!1,oi.ReadWrite=!0,oi.disabled=new oi(519,oi.ReadOnly,[0,1]);const xi=7680;class Bi{constructor(t,s,u,p,g,x){this.test=t,this.ref=s,this.mask=u,this.fail=p,this.depthFail=g,this.pass=x}}Bi.disabled=new Bi({func:519,mask:0},0,0,xi,xi,xi);class qi{constructor(t,s,u){this.enable=t,this.mode=s,this.frontFace=u}}let Mo;function Xs(h,t,s,u,p,g,x){const E=h.context,S=E.gl,A=h.useProgram("collisionBox"),z=[];let L=0,U=0;for(let K=0;K<u.length;K++){const fe=u[K],de=t.getTile(fe),xe=de.getBucket(s);if(!xe)continue;let we=fe.posMatrix;p[0]===0&&p[1]===0||(we=h.translatePosMatrix(fe.posMatrix,de,p,g));const Le=x?xe.textCollisionBox:xe.iconCollisionBox,ye=xe.collisionCircleArray;if(ye.length>0){const at=a.create(),Ye=we;a.mul(at,xe.placementInvProjMatrix,h.transform.glCoordMatrix),a.mul(at,at,xe.placementViewportMatrix),z.push({circleArray:ye,circleOffset:U,transform:Ye,invTransform:at,coord:fe}),L+=ye.length/4,U=L}Le&&A.draw(E,S.LINES,oi.disabled,Bi.disabled,h.colorModeForRenderPass(),qi.disabled,ys(we,h.transform,de),h.style.terrain&&h.style.terrain.getTerrainData(fe),s.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,null,h.transform.zoom,null,null,Le.collisionVertexBuffer)}if(!x||!z.length)return;const H=h.useProgram("collisionCircle"),W=new a.CollisionCircleLayoutArray;W.resize(4*L),W._trim();let Z=0;for(const K of z)for(let fe=0;fe<K.circleArray.length/4;fe++){const de=4*fe,xe=K.circleArray[de+0],we=K.circleArray[de+1],Le=K.circleArray[de+2],ye=K.circleArray[de+3];W.emplace(Z++,xe,we,Le,ye,0),W.emplace(Z++,xe,we,Le,ye,1),W.emplace(Z++,xe,we,Le,ye,2),W.emplace(Z++,xe,we,Le,ye,3)}(!Mo||Mo.length<2*L)&&(Mo=function(K){const fe=2*K,de=new a.QuadTriangleArray;de.resize(fe),de._trim();for(let xe=0;xe<fe;xe++){const we=6*xe;de.uint16[we+0]=4*xe+0,de.uint16[we+1]=4*xe+1,de.uint16[we+2]=4*xe+2,de.uint16[we+3]=4*xe+2,de.uint16[we+4]=4*xe+3,de.uint16[we+5]=4*xe+0}return de}(L));const ne=E.createIndexBuffer(Mo,!0),oe=E.createVertexBuffer(W,a.collisionCircleLayout.members,!0);for(const K of z){const fe={u_matrix:K.transform,u_inv_matrix:K.invTransform,u_camera_to_center_distance:(ue=h.transform).cameraToCenterDistance,u_viewport_size:[ue.width,ue.height]};H.draw(E,S.TRIANGLES,oi.disabled,Bi.disabled,h.colorModeForRenderPass(),qi.disabled,fe,h.style.terrain&&h.style.terrain.getTerrainData(K.coord),s.id,oe,ne,a.SegmentVector.simpleSegment(0,2*K.circleOffset,K.circleArray.length,K.circleArray.length/2),null,h.transform.zoom,null,null,null)}var ue;oe.destroy(),ne.destroy()}qi.disabled=new qi(!1,1029,2305),qi.backCCW=new qi(!0,1029,2305);const Sd=a.identity(new Float32Array(16));function Id(h,t,s,u,p,g){const{horizontalAlign:x,verticalAlign:E}=a.getAnchorAlignment(h),S=-(x-.5)*t,A=-(E-.5)*s,z=a.evaluateVariableOffset(h,u);return new a.pointGeometry((S/p+z[0])*g,(A/p+z[1])*g)}function Tu(h,t,s,u,p,g,x,E,S,A,z){const L=h.text.placedSymbolArray,U=h.text.dynamicLayoutVertexArray,H=h.icon.dynamicLayoutVertexArray,W={};U.clear();for(let Z=0;Z<L.length;Z++){const ne=L.get(Z),oe=h.allowVerticalPlacement&&!ne.placedOrientation,ue=ne.hidden||!ne.crossTileID||oe?null:u[ne.crossTileID];if(ue){const K=new a.pointGeometry(ne.anchorX,ne.anchorY),fe=Ht(K,s?x:g,z),de=ln(p.cameraToCenterDistance,fe.signedDistanceFromCamera);let xe=a.evaluateSizeForFeature(h.textSizeData,S,ne)*de/a.ONE_EM;s&&(xe*=h.tilePixelRatio/E);const{width:we,height:Le,anchor:ye,textOffset:at,textBoxScale:Ye}=ue,dt=Id(ye,we,Le,at,Ye,xe),Kt=s?Ht(K.add(dt),g,z).point:fe.point.add(t?dt.rotate(-p.angle):dt),Qt=h.allowVerticalPlacement&&ne.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let Ct=0;Ct<ne.numGlyphs;Ct++)a.addDynamicAttributes(U,Kt,Qt);A&&ne.associatedIconIndex>=0&&(W[ne.associatedIconIndex]={shiftedAnchor:Kt,angle:Qt})}else Wt(ne.numGlyphs,U)}if(A){H.clear();const Z=h.icon.placedSymbolArray;for(let ne=0;ne<Z.length;ne++){const oe=Z.get(ne);if(oe.hidden)Wt(oe.numGlyphs,H);else{const ue=W[ne];if(ue)for(let K=0;K<oe.numGlyphs;K++)a.addDynamicAttributes(H,ue.shiftedAnchor,ue.angle);else Wt(oe.numGlyphs,H)}}h.icon.dynamicLayoutVertexBuffer.updateData(H)}h.text.dynamicLayoutVertexBuffer.updateData(U)}function Ad(h,t,s){return s.iconsInText&&t?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function $a(h,t,s,u,p,g,x,E,S,A,z,L){const U=h.context,H=U.gl,W=h.transform,Z=E==="map",ne=S==="map",oe=E!=="viewport"&&s.layout.get("symbol-placement")!=="point",ue=Z&&!ne&&!oe,K=!s.layout.get("symbol-sort-key").isConstant();let fe=!1;const de=h.depthModeForSublayer(0,oi.ReadOnly),xe=s.layout.get("text-variable-anchor"),we=[];for(const Le of u){const ye=t.getTile(Le),at=ye.getBucket(s);if(!at)continue;const Ye=p?at.text:at.icon;if(!Ye||!Ye.segments.get().length)continue;const dt=Ye.programConfigurations.get(s.id),Kt=p||at.sdfIcons,Qt=p?at.textSizeData:at.iconSizeData,Ct=ne||W.pitch!==0,Ei=h.useProgram(Ad(Kt,p,at),dt),Si=a.evaluateSizeForZoom(Qt,W.zoom),ci=h.style.terrain&&h.style.terrain.getTerrainData(Le);let fi,Ai,gn,Mr,vr=[0,0],zr=null;if(p){if(Ai=ye.glyphAtlasTexture,gn=H.LINEAR,fi=ye.glyphAtlasTexture.size,at.iconsInText){vr=ye.imageAtlasTexture.size,zr=ye.imageAtlasTexture;const hr=Qt.kind==="composite"||Qt.kind==="camera";Mr=Ct||h.options.rotating||h.options.zooming||hr?H.LINEAR:H.NEAREST}}else{const hr=s.layout.get("icon-size").constantOr(0)!==1||at.iconsNeedLinear;Ai=ye.imageAtlasTexture,gn=Kt||h.options.rotating||h.options.zooming||hr||Ct?H.LINEAR:H.NEAREST,fi=ye.imageAtlasTexture.size}const ss=nn(ye,1,h.transform.zoom),ur=gi(Le.posMatrix,ne,Z,h.transform,ss),Gn=li(Le.posMatrix,ne,Z,h.transform,ss),Ur=xe&&at.hasTextData(),Za=s.layout.get("icon-text-fit")!=="none"&&Ur&&at.hasIconData();if(oe){const hr=h.style.terrain?(cc,to)=>h.style.terrain.getElevation(Le,cc,to):null,Ts=s.layout.get("text-rotation-alignment")==="map";cn(at,Le.posMatrix,h,p,ur,Gn,ne,A,Ts,hr)}const un=h.translatePosMatrix(Le.posMatrix,ye,g,x),ni=oe||p&&xe||Za?Sd:ur,wi=h.translatePosMatrix(Gn,ye,g,x,!0),_n=Kt&&s.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let yn;yn=Kt?at.iconsInText?fu(Qt.kind,Si,ue,ne,h,un,ni,wi,fi,vr):za(Qt.kind,Si,ue,ne,h,un,ni,wi,p,fi,!0):Ol(Qt.kind,Si,ue,ne,h,un,ni,wi,p,fi);const Wi={program:Ei,buffers:Ye,uniformValues:yn,atlasTexture:Ai,atlasTextureIcon:zr,atlasInterpolation:gn,atlasInterpolationIcon:Mr,isSDF:Kt,hasHalo:_n};if(K&&at.canOverlap){fe=!0;const hr=Ye.segments.get();for(const Ts of hr)we.push({segments:new a.SegmentVector([Ts]),sortKey:Ts.sortKey,state:Wi,terrainData:ci})}else we.push({segments:Ye.segments,sortKey:0,state:Wi,terrainData:ci})}fe&&we.sort((Le,ye)=>Le.sortKey-ye.sortKey);for(const Le of we){const ye=Le.state;if(U.activeTexture.set(H.TEXTURE0),ye.atlasTexture.bind(ye.atlasInterpolation,H.CLAMP_TO_EDGE),ye.atlasTextureIcon&&(U.activeTexture.set(H.TEXTURE1),ye.atlasTextureIcon&&ye.atlasTextureIcon.bind(ye.atlasInterpolationIcon,H.CLAMP_TO_EDGE)),ye.isSDF){const at=ye.uniformValues;ye.hasHalo&&(at.u_is_halo=1,zo(ye.buffers,Le.segments,s,h,ye.program,de,z,L,at,Le.terrainData)),at.u_is_halo=0}zo(ye.buffers,Le.segments,s,h,ye.program,de,z,L,ye.uniformValues,Le.terrainData)}}function zo(h,t,s,u,p,g,x,E,S,A){const z=u.context;p.draw(z,z.gl.TRIANGLES,g,x,E,qi.disabled,S,A,s.id,h.layoutVertexBuffer,h.indexBuffer,t,s.paint,u.transform.zoom,h.programConfigurations.get(s.id),h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer)}function Do(h,t,s,u,p,g,x){const E=h.context.gl,S=s.paint.get("fill-pattern"),A=S&&S.constantOr(1),z=s.getCrossfadeParameters();let L,U,H,W,Z;x?(U=A&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",L=E.LINES):(U=A?"fillPattern":"fill",L=E.TRIANGLES);for(const ne of u){const oe=t.getTile(ne);if(A&&!oe.patternsLoaded())continue;const ue=oe.getBucket(s);if(!ue)continue;const K=ue.programConfigurations.get(s.id),fe=h.useProgram(U,K),de=h.style.terrain&&h.style.terrain.getTerrainData(ne);A&&(h.context.activeTexture.set(E.TEXTURE0),oe.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),K.updatePaintBuffers(z));const xe=S.constantOr(null);if(xe&&oe.imageAtlas){const ye=oe.imageAtlas,at=ye.patternPositions[xe.to.toString()],Ye=ye.patternPositions[xe.from.toString()];at&&Ye&&K.setConstantPatternPositions(at,Ye)}const we=de?ne:null,Le=h.translatePosMatrix(we?we.posMatrix:ne.posMatrix,oe,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(x){W=ue.indexBuffer2,Z=ue.segments2;const ye=[E.drawingBufferWidth,E.drawingBufferHeight];H=U==="fillOutlinePattern"&&A?uu(Le,h,z,oe,ye):cu(Le,ye)}else W=ue.indexBuffer,Z=ue.segments,H=A?Rl(Le,h,z,oe):Ca(Le);fe.draw(h.context,L,p,h.stencilModeForClipping(ne),g,qi.disabled,H,de,s.id,ue.layoutVertexBuffer,W,Z,s.paint,h.transform.zoom,K)}}function Ro(h,t,s,u,p,g,x){const E=h.context,S=E.gl,A=s.paint.get("fill-extrusion-pattern"),z=A.constantOr(1),L=s.getCrossfadeParameters(),U=s.paint.get("fill-extrusion-opacity");for(const H of u){const W=t.getTile(H),Z=W.getBucket(s);if(!Z)continue;const ne=h.style.terrain&&h.style.terrain.getTerrainData(H),oe=Z.programConfigurations.get(s.id),ue=h.useProgram(z?"fillExtrusionPattern":"fillExtrusion",oe);z&&(h.context.activeTexture.set(S.TEXTURE0),W.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),oe.updatePaintBuffers(L));const K=A.constantOr(null);if(K&&W.imageAtlas){const we=W.imageAtlas,Le=we.patternPositions[K.to.toString()],ye=we.patternPositions[K.from.toString()];Le&&ye&&oe.setConstantPatternPositions(Le,ye)}const fe=h.translatePosMatrix(H.posMatrix,W,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),de=s.paint.get("fill-extrusion-vertical-gradient"),xe=z?md(fe,h,de,U,H,L,W):Dl(fe,h,de,U);ue.draw(E,E.gl.TRIANGLES,p,g,x,qi.backCCW,xe,ne,s.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,s.paint,h.transform.zoom,oe,h.style.terrain&&Z.centroidVertexBuffer)}}function Xl(h,t,s,u,p,g,x){const E=h.context,S=E.gl,A=s.fbo;if(!A)return;const z=h.useProgram("hillshade"),L=h.style.terrain&&h.style.terrain.getTerrainData(t);E.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,A.colorAttachment.get()),z.draw(E,S.TRIANGLES,p,g,x,qi.disabled,((U,H,W,Z)=>{const ne=W.paint.get("hillshade-shadow-color"),oe=W.paint.get("hillshade-highlight-color"),ue=W.paint.get("hillshade-accent-color");let K=W.paint.get("hillshade-illumination-direction")*(Math.PI/180);W.paint.get("hillshade-illumination-anchor")==="viewport"&&(K-=U.transform.angle);const fe=!U.options.moving;return{u_matrix:Z?Z.posMatrix:U.transform.calculatePosMatrix(H.tileID.toUnwrapped(),fe),u_image:0,u_latrange:Pa(0,H.tileID),u_light:[W.paint.get("hillshade-exaggeration"),K],u_shadow:ne,u_highlight:oe,u_accent:ue}})(h,s,u,L?t:null),L,u.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}function Eu(h,t,s,u,p,g){const x=h.context,E=x.gl,S=t.dem;if(S&&S.data){const A=S.dim,z=S.stride,L=S.getPixels();if(x.activeTexture.set(E.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||h.getTileTexture(z),t.demTexture){const H=t.demTexture;H.update(L,{premultiply:!1}),H.bind(E.NEAREST,E.CLAMP_TO_EDGE)}else t.demTexture=new Oe(x,L,E.RGBA,{premultiply:!1}),t.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);x.activeTexture.set(E.TEXTURE0);let U=t.fbo;if(!U){const H=new Oe(x,{width:A,height:A,data:null},E.RGBA);H.bind(E.LINEAR,E.CLAMP_TO_EDGE),U=t.fbo=x.createFramebuffer(A,A,!0),U.colorAttachment.set(H.texture)}x.bindFramebuffer.set(U.framebuffer),x.viewport.set([0,0,A,A]),h.useProgram("hillshadePrepare").draw(x,E.TRIANGLES,u,p,g,qi.disabled,((H,W)=>{const Z=W.stride,ne=a.create();return a.ortho(ne,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(ne,ne,[0,-a.EXTENT,0]),{u_matrix:ne,u_image:1,u_dimension:[Z,Z],u_zoom:H.overscaledZ,u_unpack:W.getUnpackVector()}})(t.tileID,S),null,s.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function Ua(h,t,s,u,p,g){const x=u.paint.get("raster-fade-duration");if(!g&&x>0){const E=a.exported.now(),S=(E-h.timeAdded)/x,A=t?(E-t.timeAdded)/x:-1,z=s.getSource(),L=p.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),U=!t||Math.abs(t.tileID.overscaledZ-L)>Math.abs(h.tileID.overscaledZ-L),H=U&&h.refreshedUponExpiration?1:a.clamp(U?S:1-A,0,1);return h.refreshedUponExpiration&&S>=1&&(h.refreshedUponExpiration=!1),t?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const Na=new a.Color(1,0,0,1),yr=new a.Color(0,1,0,1),Su=new a.Color(0,0,1,1),Kl=new a.Color(1,0,1,1),Iu=new a.Color(0,1,1,1);function xs(h,t,s,u){Ks(h,0,t+s/2,h.transform.width,s,u)}function Lo(h,t,s,u){Ks(h,t-s/2,0,s,h.transform.height,u)}function Ks(h,t,s,u,p,g){const x=h.context,E=x.gl;E.enable(E.SCISSOR_TEST),E.scissor(t*h.pixelRatio,s*h.pixelRatio,u*h.pixelRatio,p*h.pixelRatio),x.clear({color:g}),E.disable(E.SCISSOR_TEST)}function Cd(h,t,s){const u=h.context,p=u.gl,g=s.posMatrix,x=h.useProgram("debug"),E=oi.disabled,S=Bi.disabled,A=h.colorModeForRenderPass(),z="$debug",L=h.style.terrain&&h.style.terrain.getTerrainData(s);u.activeTexture.set(p.TEXTURE0),h.emptyTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE);const U=t.getTileByID(s.key).latestRawTileData,H=Math.floor((U&&U.byteLength||0)/1024),W=t.getTile(s).tileSize,Z=512/Math.min(W,512)*(s.overscaledZ/h.transform.zoom)*.5;let ne=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(ne+=` => ${s.overscaledZ}`),function(oe,ue){oe.initDebugOverlayCanvas();const K=oe.debugOverlayCanvas,fe=oe.context.gl,de=oe.debugOverlayCanvas.getContext("2d");de.clearRect(0,0,K.width,K.height),de.shadowColor="white",de.shadowBlur=2,de.lineWidth=1.5,de.strokeStyle="white",de.textBaseline="top",de.font="bold 36px Open Sans, sans-serif",de.fillText(ue,5,5),de.strokeText(ue,5,5),oe.debugOverlayTexture.update(K),oe.debugOverlayTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE)}(h,`${ne} ${H}kB`),x.draw(u,p.TRIANGLES,E,S,Fi.alphaBlended,qi.disabled,Io(g,a.Color.transparent,Z),null,z,h.debugBuffer,h.quadTriangleIndexBuffer,h.debugSegments),x.draw(u,p.LINE_STRIP,E,S,A,qi.disabled,Io(g,a.Color.red),L,z,h.debugBuffer,h.tileBorderIndexBuffer,h.debugSegments)}function Va(h,t,s){const u=h.context,p=u.gl,g=h.colorModeForRenderPass(),x=new oi(p.LEQUAL,oi.ReadWrite,h.depthRangeFor3D),E=h.useProgram("terrain"),S=t.getTerrainMesh(),A=t.getTerrainData(s.tileID);u.bindFramebuffer.set(null),u.viewport.set([0,0,h.width,h.height]),u.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,t.getRTTFramebuffer().colorAttachment.get());const z=h.transform.calculatePosMatrix(s.tileID.toUnwrapped());E.draw(u,p.TRIANGLES,x,Bi.disabled,g,qi.backCCW,{u_matrix:z,u_texture:0},A,"terrain",S.vertexBuffer,S.indexBuffer,S.segments)}function Au(h,t,s,u){const p=h.context,g=s.tileSize*t.qualityFactor;s.textures[u]||(s.textures[u]=h.getTileTexture(g)||new Oe(p,{width:g,height:g,data:null},p.gl.RGBA),s.textures[u].bind(p.gl.LINEAR,p.gl.CLAMP_TO_EDGE),u===0&&t.sourceCache.renderHistory.unshift(s.tileID.key));const x=t.getRTTFramebuffer();x.colorAttachment.set(s.textures[u].texture),p.bindFramebuffer.set(x.framebuffer),p.viewport.set([0,0,g,g])}class Cu{constructor(t){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=t,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=t.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const t=this.painter.style,s=t.terrain;for(const u in t.sourceCaches){this._coordsDescendingInv[u]={};const p=t.sourceCaches[u].getVisibleCoordinates();for(const g of p){const x=s.sourceCache.getTerrainCoords(g);for(const E in x)this._coordsDescendingInv[u][E]||(this._coordsDescendingInv[u][E]=[]),this._coordsDescendingInv[u][E].push(x[E])}}for(const u of t._order){const p=t._layers[u],g=p.source;if(this._renderToTexture[p.type]&&!this._coordsDescendingInvStr[g]){this._coordsDescendingInvStr[g]={};for(const x in this._coordsDescendingInv[g])this._coordsDescendingInvStr[g][x]=this._coordsDescendingInv[g][x].map(E=>E.key).sort().join()}}return this._renderableTiles.forEach(u=>{for(const p in this._coordsDescendingInvStr){const g=this._coordsDescendingInvStr[p][u.tileID.key];g&&g!==u.textureCoords[p]&&u.clearTextures(this.painter),s.needsRerender(p,u.tileID)&&u.clearTextures(this.painter)}this._rerender[u.tileID.key]=!u.textures.length}),s.clearRerenderCache(),s.sourceCache.removeOutdated(this.painter),this}renderLayer(t){const s=t.type,u=this.painter,p=u.style._order,g=u.currentLayer,x=g+1===p.length;if(this._renderToTexture[s]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(p[g]),!x))return!0;if(this._renderToTexture[this._prevType]||s==="hillshade"||this._renderToTexture[s]&&x){this._prevType=s;const E=this._stacks.length-1,S=this._stacks[E]||[];for(const A of this._renderableTiles){if(Au(u,u.style.terrain,A,E),this._rerender[A.tileID.key]){u.context.clear({color:a.Color.transparent});for(let z=0;z<S.length;z++){const L=u.style._layers[S[z]],U=L.source?this._coordsDescendingInv[L.source][A.tileID.key]:[A.tileID];u._renderTileClippingMasks(L,U),u.renderLayer(u,u.style.sourceCaches[L.source],L,U),L.source&&(A.textureCoords[L.source]=this._coordsDescendingInvStr[L.source][A.tileID.key])}}Va(u,u.style.terrain,A)}if(s==="hillshade"){this._stacks.push([p[g]]);for(const A of this._renderableTiles){const z=this._coordsDescendingInv[t.source][A.tileID.key];Au(u,u.style.terrain,A,this._stacks.length-1),u.context.clear({color:a.Color.transparent}),u._renderTileClippingMasks(t,z),u.renderLayer(u,u.style.sourceCaches[t.source],t,z),Va(u,u.style.terrain,A)}return!0}return this._renderToTexture[s]}return!1}}const Oo={symbol:function(h,t,s,u,p){if(h.renderPass!=="translucent")return;const g=Bi.disabled,x=h.colorModeForRenderPass();s.layout.get("text-variable-anchor")&&function(E,S,A,z,L,U,H){const W=S.transform,Z=L==="map",ne=U==="map";for(const oe of E){const ue=z.getTile(oe),K=ue.getBucket(A);if(!K||!K.text||!K.text.segments.get().length)continue;const fe=a.evaluateSizeForZoom(K.textSizeData,W.zoom),de=nn(ue,1,S.transform.zoom),xe=gi(oe.posMatrix,ne,Z,S.transform,de),we=A.layout.get("icon-text-fit")!=="none"&&K.hasIconData();if(fe){const Le=Math.pow(2,W.zoom-ue.tileID.overscaledZ);Tu(K,Z,ne,H,W,xe,oe.posMatrix,Le,fe,we,S.style.terrain?(ye,at)=>S.style.terrain.getElevation(oe,ye,at):null)}}}(u,h,s,t,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),p),s.paint.get("icon-opacity").constantOr(1)!==0&&$a(h,t,s,u,!1,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),s.layout.get("icon-rotation-alignment"),s.layout.get("icon-pitch-alignment"),s.layout.get("icon-keep-upright"),g,x),s.paint.get("text-opacity").constantOr(1)!==0&&$a(h,t,s,u,!0,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),s.layout.get("text-keep-upright"),g,x),t.map.showCollisionBoxes&&(Xs(h,t,s,u,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),Xs(h,t,s,u,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(h,t,s,u){if(h.renderPass!=="translucent")return;const p=s.paint.get("circle-opacity"),g=s.paint.get("circle-stroke-width"),x=s.paint.get("circle-stroke-opacity"),E=!s.layout.get("circle-sort-key").isConstant();if(p.constantOr(1)===0&&(g.constantOr(1)===0||x.constantOr(1)===0))return;const S=h.context,A=S.gl,z=h.depthModeForSublayer(0,oi.ReadOnly),L=Bi.disabled,U=h.colorModeForRenderPass(),H=[];for(let W=0;W<u.length;W++){const Z=u[W],ne=t.getTile(Z),oe=ne.getBucket(s);if(!oe)continue;const ue=oe.programConfigurations.get(s.id),K=h.useProgram("circle",ue),fe=oe.layoutVertexBuffer,de=oe.indexBuffer,xe=h.style.terrain&&h.style.terrain.getTerrainData(Z),we={programConfiguration:ue,program:K,layoutVertexBuffer:fe,indexBuffer:de,uniformValues:hu(h,Z,ne,s),terrainData:xe};if(E){const Le=oe.segments.get();for(const ye of Le)H.push({segments:new a.SegmentVector([ye]),sortKey:ye.sortKey,state:we})}else H.push({segments:oe.segments,sortKey:0,state:we})}E&&H.sort((W,Z)=>W.sortKey-Z.sortKey);for(const W of H){const{programConfiguration:Z,program:ne,layoutVertexBuffer:oe,indexBuffer:ue,uniformValues:K,terrainData:fe}=W.state;ne.draw(S,A.TRIANGLES,z,L,U,qi.disabled,K,fe,s.id,oe,ue,W.segments,s.paint,h.transform.zoom,Z)}},heatmap:function(h,t,s,u){if(s.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const p=h.context,g=p.gl,x=Bi.disabled,E=new Fi([g.ONE,g.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(S,A,z){const L=S.gl;S.activeTexture.set(L.TEXTURE1),S.viewport.set([0,0,A.width/4,A.height/4]);let U=z.heatmapFbo;if(U)L.bindTexture(L.TEXTURE_2D,U.colorAttachment.get()),S.bindFramebuffer.set(U.framebuffer);else{const H=L.createTexture();L.bindTexture(L.TEXTURE_2D,H),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MIN_FILTER,L.LINEAR),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MAG_FILTER,L.LINEAR),U=z.heatmapFbo=S.createFramebuffer(A.width/4,A.height/4,!1),function(W,Z,ne,oe){const ue=W.gl;ue.texImage2D(ue.TEXTURE_2D,0,ue.RGBA,Z.width/4,Z.height/4,0,ue.RGBA,W.extRenderToTextureHalfFloat?W.extTextureHalfFloat.HALF_FLOAT_OES:ue.UNSIGNED_BYTE,null),oe.colorAttachment.set(ne)}(S,A,H,U)}})(p,h,s),p.clear({color:a.Color.transparent});for(let S=0;S<u.length;S++){const A=u[S];if(t.hasRenderableParent(A))continue;const z=t.getTile(A),L=z.getBucket(s);if(!L)continue;const U=L.programConfigurations.get(s.id),H=h.useProgram("heatmap",U),{zoom:W}=h.transform;H.draw(p,g.TRIANGLES,oi.disabled,x,E,qi.disabled,ka(A.posMatrix,z,W,s.paint.get("heatmap-intensity")),null,s.id,L.layoutVertexBuffer,L.indexBuffer,L.segments,s.paint,h.transform.zoom,U)}p.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(p,g){const x=p.context,E=x.gl,S=g.heatmapFbo;if(!S)return;x.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,S.colorAttachment.get()),x.activeTexture.set(E.TEXTURE1);let A=g.colorRampTexture;A||(A=g.colorRampTexture=new Oe(x,g.colorRamp,E.RGBA)),A.bind(E.LINEAR,E.CLAMP_TO_EDGE),p.useProgram("heatmapTexture").draw(x,E.TRIANGLES,oi.disabled,Bi.disabled,p.colorModeForRenderPass(),qi.disabled,((z,L,U,H)=>{const W=a.create();a.ortho(W,0,z.width,z.height,0,0,1);const Z=z.context.gl;return{u_matrix:W,u_world:[Z.drawingBufferWidth,Z.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:L.paint.get("heatmap-opacity")}})(p,g),null,g.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments,g.paint,p.transform.zoom)}(h,s))},line:function(h,t,s,u){if(h.renderPass!=="translucent")return;const p=s.paint.get("line-opacity"),g=s.paint.get("line-width");if(p.constantOr(1)===0||g.constantOr(1)===0)return;const x=h.depthModeForSublayer(0,oi.ReadOnly),E=h.colorModeForRenderPass(),S=s.paint.get("line-dasharray"),A=s.paint.get("line-pattern"),z=A.constantOr(1),L=s.paint.get("line-gradient"),U=s.getCrossfadeParameters(),H=z?"linePattern":S?"lineSDF":L?"lineGradient":"line",W=h.context,Z=W.gl;let ne=!0;for(const oe of u){const ue=t.getTile(oe);if(z&&!ue.patternsLoaded())continue;const K=ue.getBucket(s);if(!K)continue;const fe=K.programConfigurations.get(s.id),de=h.context.program.get(),xe=h.useProgram(H,fe),we=ne||xe.program!==de,Le=h.style.terrain&&h.style.terrain.getTerrainData(oe),ye=A.constantOr(null);if(ye&&ue.imageAtlas){const dt=ue.imageAtlas,Kt=dt.patternPositions[ye.to.toString()],Qt=dt.patternPositions[ye.from.toString()];Kt&&Qt&&fe.setConstantPatternPositions(Kt,Qt)}const at=Le?oe:null,Ye=z?Ma(h,ue,s,U,at):S?Ao(h,ue,s,S,U,at):L?Ll(h,ue,s,K.lineClipsArray.length,at):Gs(h,ue,s,at);if(z)W.activeTexture.set(Z.TEXTURE0),ue.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),fe.updatePaintBuffers(U);else if(S&&(we||h.lineAtlas.dirty))W.activeTexture.set(Z.TEXTURE0),h.lineAtlas.bind(W);else if(L){const dt=K.gradients[s.id];let Kt=dt.texture;if(s.gradientVersion!==dt.version){let Qt=256;if(s.stepInterpolant){const Ct=t.getSource().maxzoom,Ei=oe.canonical.z===Ct?Math.ceil(1<<h.transform.maxZoom-oe.canonical.z):1;Qt=a.clamp(a.nextPowerOfTwo(K.maxLineLength/a.EXTENT*1024*Ei),256,W.maxTextureSize)}dt.gradient=a.renderColorRamp({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:Qt,image:dt.gradient||void 0,clips:K.lineClipsArray}),dt.texture?dt.texture.update(dt.gradient):dt.texture=new Oe(W,dt.gradient,Z.RGBA),dt.version=s.gradientVersion,Kt=dt.texture}W.activeTexture.set(Z.TEXTURE0),Kt.bind(s.stepInterpolant?Z.NEAREST:Z.LINEAR,Z.CLAMP_TO_EDGE)}xe.draw(W,Z.TRIANGLES,x,h.stencilModeForClipping(oe),E,qi.disabled,Ye,Le,s.id,K.layoutVertexBuffer,K.indexBuffer,K.segments,s.paint,h.transform.zoom,fe,K.layoutVertexBuffer2),ne=!1}},fill:function(h,t,s,u){const p=s.paint.get("fill-color"),g=s.paint.get("fill-opacity");if(g.constantOr(1)===0)return;const x=h.colorModeForRenderPass(),E=s.paint.get("fill-pattern"),S=h.opaquePassEnabledForLayer()&&!E.constantOr(1)&&p.constantOr(a.Color.transparent).a===1&&g.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===S){const A=h.depthModeForSublayer(1,h.renderPass==="opaque"?oi.ReadWrite:oi.ReadOnly);Do(h,t,s,u,A,x,!1)}if(h.renderPass==="translucent"&&s.paint.get("fill-antialias")){const A=h.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,oi.ReadOnly);Do(h,t,s,u,A,x,!0)}},"fill-extrusion":function(h,t,s,u){const p=s.paint.get("fill-extrusion-opacity");if(p!==0&&h.renderPass==="translucent"){const g=new oi(h.context.gl.LEQUAL,oi.ReadWrite,h.depthRangeFor3D);if(p!==1||s.paint.get("fill-extrusion-pattern").constantOr(1))Ro(h,t,s,u,g,Bi.disabled,Fi.disabled),Ro(h,t,s,u,g,h.stencilModeFor3D(),h.colorModeForRenderPass());else{const x=h.colorModeForRenderPass();Ro(h,t,s,u,g,Bi.disabled,x)}}},hillshade:function(h,t,s,u){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent")return;const p=h.context,g=h.depthModeForSublayer(0,oi.ReadOnly),x=h.colorModeForRenderPass(),[E,S]=h.renderPass==="translucent"?h.stencilConfigForOverlap(u):[{},u];for(const A of S){const z=t.getTile(A);z.needsHillshadePrepare!==void 0&&z.needsHillshadePrepare&&h.renderPass==="offscreen"?Eu(h,z,s,g,Bi.disabled,x):h.renderPass==="translucent"&&Xl(h,A,z,s,g,E[A.overscaledZ],x)}p.viewport.set([0,0,h.width,h.height])},raster:function(h,t,s,u){if(h.renderPass!=="translucent"||s.paint.get("raster-opacity")===0||!u.length)return;const p=h.context,g=p.gl,x=t.getSource(),E=h.useProgram("raster"),S=h.colorModeForRenderPass(),[A,z]=x instanceof Oi?[{},u]:h.stencilConfigForOverlap(u),L=z[z.length-1].overscaledZ,U=!h.options.moving;for(const H of z){const W=h.depthModeForSublayer(H.overscaledZ-L,s.paint.get("raster-opacity")===1?oi.ReadWrite:oi.ReadOnly,g.LESS),Z=t.getTile(H);Z.registerFadeDuration(s.paint.get("raster-fade-duration"));const ne=t.findLoadedParent(H,0),oe=Ua(Z,ne,t,s,h.transform,h.style.terrain);let ue,K;const fe=s.paint.get("raster-resampling")==="nearest"?g.NEAREST:g.LINEAR;p.activeTexture.set(g.TEXTURE0),Z.texture.bind(fe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),p.activeTexture.set(g.TEXTURE1),ne?(ne.texture.bind(fe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),ue=Math.pow(2,ne.tileID.overscaledZ-Z.tileID.overscaledZ),K=[Z.tileID.canonical.x*ue%1,Z.tileID.canonical.y*ue%1]):Z.texture.bind(fe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST);const de=h.style.terrain&&h.style.terrain.getTerrainData(H),xe=de?H:null,we=xe?xe.posMatrix:h.transform.calculatePosMatrix(H.toUnwrapped(),U),Le=du(we,K||[0,0],ue||1,oe,s);x instanceof Oi?E.draw(p,g.TRIANGLES,W,Bi.disabled,S,qi.disabled,Le,de,s.id,x.boundsBuffer,h.quadTriangleIndexBuffer,x.boundsSegments):E.draw(p,g.TRIANGLES,W,A[H.overscaledZ],S,qi.disabled,Le,de,s.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}},background:function(h,t,s,u){const p=s.paint.get("background-color"),g=s.paint.get("background-opacity");if(g===0)return;const x=h.context,E=x.gl,S=h.transform,A=S.tileSize,z=s.paint.get("background-pattern");if(h.isPatternMissing(z))return;const L=!z&&p.a===1&&g===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==L)return;const U=Bi.disabled,H=h.depthModeForSublayer(0,L==="opaque"?oi.ReadWrite:oi.ReadOnly),W=h.colorModeForRenderPass(),Z=h.useProgram(z?"backgroundPattern":"background"),ne=u||S.coveringTiles({tileSize:A,terrain:h.style.terrain});z&&(x.activeTexture.set(E.TEXTURE0),h.imageManager.bind(h.context));const oe=s.getCrossfadeParameters();for(const ue of ne){const K=u?ue.posMatrix:h.transform.calculatePosMatrix(ue.toUnwrapped()),fe=z?_d(K,g,h,z,{tileID:ue,tileSize:A},oe):gd(K,g,p),de=h.style.terrain&&h.style.terrain.getTerrainData(ue);Z.draw(x,E.TRIANGLES,H,U,W,qi.disabled,fe,de,s.id,h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}},debug:function(h,t,s){for(let u=0;u<s.length;u++)Cd(h,t,s[u])},custom:function(h,t,s){const u=h.context,p=s.implementation;if(h.renderPass==="offscreen"){const g=p.prerender;g&&(h.setCustomLayerDefaults(),u.setColorMode(h.colorModeForRenderPass()),g.call(p,u.gl,h.transform.customLayerMatrix()),u.setDirty(),h.setBaseState())}else if(h.renderPass==="translucent"){h.setCustomLayerDefaults(),u.setColorMode(h.colorModeForRenderPass()),u.setStencilMode(Bi.disabled);const g=p.renderingMode==="3d"?new oi(h.context.gl.LEQUAL,oi.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,oi.ReadOnly);u.setDepthMode(g),p.render(u.gl,h.transform.customLayerMatrix()),u.setDirty(),h.setBaseState(),u.bindFramebuffer.set(null)}}};class Jl{constructor(t,s){this.context=new wu(t),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.create(),renderTime:0},this.setup(),this.numSublayers=$t.maxUnderzooming+$t.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Bt,this.gpuTimers={}}resize(t,s,u){if(this.width=t*u,this.height=s*u,this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const t=this.context,s=new a.PosArray;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(s,di.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const u=new a.PosArray;u.emplaceBack(0,0),u.emplaceBack(a.EXTENT,0),u.emplaceBack(0,a.EXTENT),u.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=t.createVertexBuffer(u,di.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const p=new a.RasterBoundsArray;p.emplaceBack(0,0,0,0),p.emplaceBack(a.EXTENT,0,a.EXTENT,0),p.emplaceBack(0,a.EXTENT,0,a.EXTENT),p.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(p,Xt.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const g=new a.PosArray;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(g,di.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const x=new a.LineStripIndexArray;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(x);const E=new a.TriangleIndexArray;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(E),this.emptyTexture=new Oe(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])},t.gl.RGBA);const S=this.context.gl;this.stencilClearMode=new Bi({func:S.ALWAYS,mask:0},0,255,S.ZERO,S.ZERO,S.ZERO)}clearStencil(){const t=this.context,s=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=a.create();a.ortho(u,0,this.width,this.height,0,0,1),a.scale(u,u,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,s.TRIANGLES,oi.disabled,this.stencilClearMode,Fi.disabled,qi.disabled,qs(u),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,s){if(this.currentStencilSource===t.source||!t.isTileClipped()||!s||!s.length)return;this.currentStencilSource=t.source;const u=this.context,p=u.gl;this.nextStencilID+s.length>256&&this.clearStencil(),u.setColorMode(Fi.disabled),u.setDepthMode(oi.disabled);const g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of s){const E=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,S=this.style.terrain&&this.style.terrain.getTerrainData(x);g.draw(u,p.TRIANGLES,oi.disabled,new Bi({func:p.ALWAYS,mask:0},E,255,p.KEEP,p.KEEP,p.REPLACE),Fi.disabled,qi.disabled,qs(x.posMatrix),S,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,s=this.context.gl;return new Bi({func:s.NOTEQUAL,mask:255},t,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(t){const s=this.context.gl;return new Bi({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(t){const s=this.context.gl,u=t.sort((x,E)=>E.overscaledZ-x.overscaledZ),p=u[u.length-1].overscaledZ,g=u[0].overscaledZ-p+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const x={};for(let E=0;E<g;E++)x[E+p]=new Bi({func:s.GEQUAL,mask:255},E+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=g,[x,u]}return[{[p]:Bi.disabled},u]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Fi([t.CONSTANT_COLOR,t.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Fi.unblended:Fi.alphaBlended}depthModeForSublayer(t,s,u){if(!this.opaquePassEnabledForLayer())return oi.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new oi(u||this.context.gl.LEQUAL,s,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,s){this.style=t,this.options=s,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const u=this.style._order,p=this.style.sourceCaches,g=this.style.terrain&&new Cu(this);for(const A in p){const z=p[A];z.used&&z.prepare(this.context)}const x={},E={},S={};for(const A in p){const z=p[A];x[A]=z.getVisibleCoordinates(),E[A]=x[A].slice().reverse(),S[A]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let A=0;A<u.length;A++)if(this.style._layers[u[A]].is3D()){this.opaquePassCutoff=A;break}if(g){this.opaquePassCutoff=0;const A=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||A.length)&&(a.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(z,L){const U=z.context,H=U.gl,W=Fi.unblended,Z=new oi(H.LEQUAL,oi.ReadWrite,[0,1]),ne=L.getTerrainMesh(),oe=L.sourceCache.getRenderableTiles(),ue=z.useProgram("terrainDepth");U.bindFramebuffer.set(L.getFramebuffer("depth").framebuffer),U.viewport.set([0,0,z.width/devicePixelRatio,z.height/devicePixelRatio]),U.clear({color:a.Color.transparent,depth:1});for(const K of oe){const fe=L.getTerrainData(K.tileID),de=z.transform.calculatePosMatrix(K.tileID.toUnwrapped());ue.draw(U,H.TRIANGLES,Z,Bi.disabled,W,qi.backCCW,{u_matrix:de},fe,"terrain",ne.vertexBuffer,ne.indexBuffer,ne.segments)}U.bindFramebuffer.set(null),U.viewport.set([0,0,z.width,z.height])}(this,this.style.terrain),function(z,L){const U=z.context,H=U.gl,W=Fi.unblended,Z=new oi(H.LEQUAL,oi.ReadWrite,[0,1]),ne=L.getTerrainMesh(),oe=L.getCoordsTexture(),ue=L.sourceCache.getRenderableTiles(),K=z.useProgram("terrainCoords");U.bindFramebuffer.set(L.getFramebuffer("coords").framebuffer),U.viewport.set([0,0,z.width/devicePixelRatio,z.height/devicePixelRatio]),U.clear({color:a.Color.transparent,depth:1}),L.coordsIndex=[];for(const fe of ue){const de=L.getTerrainData(fe.tileID);U.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,oe.texture);const xe=z.transform.calculatePosMatrix(fe.tileID.toUnwrapped());K.draw(U,H.TRIANGLES,Z,Bi.disabled,W,qi.backCCW,{u_matrix:xe,u_terrain_coords_id:(255-L.coordsIndex.length)/255,u_texture:0},de,"terrain",ne.vertexBuffer,ne.indexBuffer,ne.segments),L.coordsIndex.push(fe.tileID.key)}U.bindFramebuffer.set(null),U.viewport.set([0,0,z.width,z.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const A of u){const z=this.style._layers[A];if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const L=E[z.source];(z.type==="custom"||L.length)&&this.renderLayer(this,p[z.source],z,L)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!g)for(this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const A=this.style._layers[u[this.currentLayer]],z=p[A.source],L=x[A.source];this._renderTileClippingMasks(A,L),this.renderLayer(this,z,A,L)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const A=this.style._layers[u[this.currentLayer]],z=p[A.source];if(g&&g.renderLayer(A))continue;const L=(A.type==="symbol"?S:E)[A.source];this._renderTileClippingMasks(A,x[A.source]),this.renderLayer(this,z,A,L)}if(this.options.showTileBoundaries){let A,z;Object.values(this.style._layers).forEach(L=>{L.source&&!L.isHidden(this.transform.zoom)&&(L.source!==(z&&z.id)&&(z=this.style.sourceCaches[L.source]),(!A||A.getSource().maxzoom<z.getSource().maxzoom)&&(A=z))}),A&&Oo.debug(this,A,A.getVisibleCoordinates())}this.options.showPadding&&function(A){const z=A.transform.padding;xs(A,A.transform.height-(z.top||0),3,Na),xs(A,z.bottom||0,3,yr),Lo(A,z.left||0,3,Su),Lo(A,A.transform.width-(z.right||0),3,Kl);const L=A.transform.centerPoint;(function(U,H,W,Z){Ks(U,H-1,W-10,2,20,Z),Ks(U,H-10,W-1,20,2,Z)})(A,L.x,A.transform.height-L.y,Iu)}(this),this.context.setDefault()}renderLayer(t,s,u,p){u.isHidden(this.transform.zoom)||(u.type==="background"||u.type==="custom"||(p||[]).length)&&(this.id=u.id,this.gpuTimingStart(u),Oo[u.type](t,s,u,p,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery;let u=this.gpuTimers[t.id];u||(u=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),u.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,u.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}queryGpuTimers(t){const s={};for(const u in t){const p=t[u],g=this.context.extTimerQuery,x=g.getQueryObjectEXT(p.query,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(p.query),s[u]=x}return s}translatePosMatrix(t,s,u,p,g){if(!u[0]&&!u[1])return t;const x=g?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(x){const A=Math.sin(x),z=Math.cos(x);u=[u[0]*z-u[1]*A,u[0]*A+u[1]*z]}const E=[g?u[0]:nn(s,u[0],this.transform.zoom),g?u[1]:nn(s,u[1],this.transform.zoom),0],S=new Float32Array(16);return a.translate(S,t,E),S}saveTileTexture(t){const s=this._tileTextures[t.size[0]];s?s.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const s=this._tileTextures[t];return s&&s.length>0?s.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const s=this.imageManager.getPattern(t.from.toString()),u=this.imageManager.getPattern(t.to.toString());return!s||!u}useProgram(t,s){this.cache=this.cache||{};const u=t+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[u]||(this.cache[u]=new au(this.context,t,So[t],s,Bl[t],this._showOverdrawInspector,this.style.terrain)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Oe(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class ja{constructor(t,s){this.points=t,this.planes=s}static fromInvProjectionMatrix(t,s,u){const p=Math.pow(2,u),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const S=1/(E=a.transformMat4([],E,t))[3]/s*p;return a.mul$1(E,E,[S,S,1/E[3],S])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const S=a.sub([],g[E[0]],g[E[1]]),A=a.sub([],g[E[2]],g[E[1]]),z=a.normalize([],a.cross([],S,A)),L=-a.dot(z,g[E[1]]);return z.concat(L)});return new ja(g,x)}}class Bo{constructor(t,s){this.min=t,this.max=s,this.center=a.scale$1([],a.add([],this.min,this.max),.5)}quadrant(t){const s=[t%2==0,t<2],u=a.clone$2(this.min),p=a.clone$2(this.max);for(let g=0;g<s.length;g++)u[g]=s[g]?this.min[g]:this.center[g],p[g]=s[g]?this.center[g]:this.max[g];return p[2]=this.max[2],new Bo(u,p)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let u=!0;for(let p=0;p<t.planes.length;p++){const g=t.planes[p];let x=0;for(let E=0;E<s.length;E++)a.dot$1(g,s[E])>=0&&x++;if(x===0)return 0;x!==s.length&&(u=!1)}if(u)return 2;for(let p=0;p<3;p++){let g=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let E=0;E<t.points.length;E++){const S=t.points[E][p]-this.min[p];g=Math.min(g,S),x=Math.max(x,S)}if(x<0||g>this.max[p]-this.min[p])return 0}return 1}}class Js{constructor(t=0,s=0,u=0,p=0){if(isNaN(t)||t<0||isNaN(s)||s<0||isNaN(u)||u<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=s,this.left=u,this.right=p}interpolate(t,s,u){return s.top!=null&&t.top!=null&&(this.top=a.number(t.top,s.top,u)),s.bottom!=null&&t.bottom!=null&&(this.bottom=a.number(t.bottom,s.bottom,u)),s.left!=null&&t.left!=null&&(this.left=a.number(t.left,s.left,u)),s.right!=null&&t.right!=null&&(this.right=a.number(t.right,s.right,u)),this}getCenter(t,s){const u=a.clamp((this.left+t-this.right)/2,0,t),p=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.pointGeometry(u,p)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Js(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Fo{constructor(t,s,u,p,g){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=g===void 0||!!g,this._minZoom=t||0,this._maxZoom=s||22,this._minPitch=u==null?0:u,this._maxPitch=p==null?60:p,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Js,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const t=new Fo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t._elevation=this._elevation,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const s=-a.wrap(t,-180,180)*Math.PI/180;var u;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=(u=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u),function(p,g,x){var E=g[0],S=g[1],A=g[2],z=g[3],L=Math.sin(x),U=Math.cos(x);p[0]=E*U+A*L,p[1]=S*U+z*L,p[2]=E*-L+A*U,p[3]=S*-L+z*U}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const s=a.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const s=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,s,u){this._unmodified=!1,this._edgeInsets.interpolate(t,s,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const s=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(t){const s=[new a.UnwrappedTileID(0,t)];if(this._renderWorldCopies){const u=this.pointCoordinate(new a.pointGeometry(0,0)),p=this.pointCoordinate(new a.pointGeometry(this.width,0)),g=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),x=this.pointCoordinate(new a.pointGeometry(0,this.height)),E=Math.floor(Math.min(u.x,p.x,g.x,x.x)),S=Math.floor(Math.max(u.x,p.x,g.x,x.x)),A=1;for(let z=E-A;z<=S+A;z++)z!==0&&s.push(new a.UnwrappedTileID(z,t))}return s}coveringTiles(t){var s,u;let p=this.coveringZoomLevel(t);const g=p;if(t.minzoom!==void 0&&p<t.minzoom)return[];t.maxzoom!==void 0&&p>t.maxzoom&&(p=t.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),E=a.MercatorCoordinate.fromLngLat(this.center),S=Math.pow(2,p),A=[S*x.x,S*x.y,0],z=[S*E.x,S*E.y,0],L=ja.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p);let U=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(U=p);const H=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,W=K=>({aabb:new Bo([K*S,0,0],[(K+1)*S,S,0]),zoom:0,x:0,y:0,wrap:K,fullyVisible:!1}),Z=[],ne=[],oe=p,ue=t.reparseOverscaled?g:p;if(this._renderWorldCopies)for(let K=1;K<=3;K++)Z.push(W(-K)),Z.push(W(K));for(Z.push(W(0));Z.length>0;){const K=Z.pop(),fe=K.x,de=K.y;let xe=K.fullyVisible;if(!xe){const dt=K.aabb.intersects(L);if(dt===0)continue;xe=dt===2}const we=t.terrain?A:z,Le=K.aabb.distanceX(we),ye=K.aabb.distanceY(we),at=Math.max(Math.abs(Le),Math.abs(ye)),Ye=H+(1<<oe-K.zoom)-2;if(K.zoom===oe||at>Ye&&K.zoom>=U){const dt=oe-K.zoom,Kt=A[0]-.5-(fe<<dt),Qt=A[1]-.5-(de<<dt);ne.push({tileID:new a.OverscaledTileID(K.zoom===oe?ue:K.zoom,K.wrap,K.zoom,fe,de),distanceSq:a.sqrLen([z[0]-.5-fe,z[1]-.5-de]),tileDistanceToCamera:Math.sqrt(Kt*Kt+Qt*Qt)})}else for(let dt=0;dt<4;dt++){const Kt=(fe<<1)+dt%2,Qt=(de<<1)+(dt>>1),Ct=K.zoom+1;let Ei=K.aabb.quadrant(dt);if(t.terrain){const Si=new a.OverscaledTileID(Ct,K.wrap,Ct,Kt,Qt),ci=t.terrain.getMinMaxElevation(Si),fi=(s=ci.minElevation)!==null&&s!==void 0?s:this.elevation,Ai=(u=ci.maxElevation)!==null&&u!==void 0?u:this.elevation;Ei=new Bo([Ei.min[0],Ei.min[1],fi],[Ei.max[0],Ei.max[1],Ai])}Z.push({aabb:Ei,zoom:Ct,x:Kt,y:Qt,wrap:K.wrap,fullyVisible:xe})}}return ne.sort((K,fe)=>K.distanceSq-fe.distanceSq).map(K=>K.tileID)}resize(t,s){this.width=t,this.height=s,this.pixelsToGLUnits=[2/t,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const s=a.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.pointGeometry(a.mercatorXfromLng(t.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)}unproject(t){return new a.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(t){this.freezeElevation||(this.elevation=t?this.getElevation(this._center,t):0)}getElevation(t,s){const u=a.MercatorCoordinate.fromLngLat(t),p=(1<<this.tileZoom)*a.EXTENT,g=u.x*p,x=u.y*p,E=Math.floor(g/a.EXTENT),S=Math.floor(x/a.EXTENT),A=new a.OverscaledTileID(this.tileZoom,0,this.tileZoom,E,S);return s.getElevation(A,g%a.EXTENT,x%a.EXTENT,a.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const s=this.pointLocation(this.centerPoint,t),u=this.getElevation(s,t);if(!(this.elevation-u))return;const p=this.getCameraPosition(),g=a.MercatorCoordinate.fromLngLat(p.lngLat,p.altitude),x=a.MercatorCoordinate.fromLngLat(s,u),E=g.x-x.x,S=g.y-x.y,A=g.z-x.z,z=Math.sqrt(E*E+S*S+A*A),L=this.scaleZoom(this.cameraToCenterDistance/z/this.tileSize);this._elevation=u,this._center=s,this.zoom=L}setLocationAtPoint(t,s){const u=this.pointCoordinate(s),p=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(t),x=new a.MercatorCoordinate(g.x-(u.x-p.x),g.y-(u.y-p.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,s){return s?this.coordinatePoint(this.locationCoordinate(t),this.getElevation(t,s),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,s){return this.coordinateLocation(this.pointCoordinate(t,s))}locationCoordinate(t){return a.MercatorCoordinate.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,s){if(s){const U=s.pointCoordinate(t);if(U!=null)return U}const u=[t.x,t.y,0,1],p=[t.x,t.y,1,1];a.transformMat4(u,u,this.pixelMatrixInverse),a.transformMat4(p,p,this.pixelMatrixInverse);const g=u[3],x=p[3],E=u[1]/g,S=p[1]/x,A=u[2]/g,z=p[2]/x,L=A===z?0:(0-A)/(z-A);return new a.MercatorCoordinate(a.number(u[0]/g,p[0]/x,L)/this.worldSize,a.number(E,S,L)/this.worldSize)}coordinatePoint(t,s=0,u=this.pixelMatrix){const p=[t.x*this.worldSize,t.y*this.worldSize,s,1];return a.transformMat4(p,p,u),new a.pointGeometry(p[0]/p[3],p[1]/p[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new a.LngLatBounds().extend(this.pointLocation(new a.pointGeometry(0,t))).extend(this.pointLocation(new a.pointGeometry(this.width,t))).extend(this.pointLocation(new a.pointGeometry(this.width,this.height))).extend(this.pointLocation(new a.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t,s=!1){const u=t.key,p=s?this._alignedPosMatrixCache:this._posMatrixCache;if(p[u])return p[u];const g=t.canonical,x=this.worldSize/this.zoomScale(g.z),E=g.x+Math.pow(2,g.z)*t.wrap,S=a.identity(new Float64Array(16));return a.translate(S,S,[E*x,g.y*x,0]),a.scale(S,S,[x/a.EXTENT,x/a.EXTENT,1]),a.multiply(S,s?this.alignedProjMatrix:this.projMatrix,S),p[u]=new Float32Array(S),p[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let t,s,u,p,g=-90,x=90,E=-180,S=180;const A=this.size,z=this._unmodified;if(this.latRange){const H=this.latRange;g=a.mercatorYfromLat(H[1])*this.worldSize,x=a.mercatorYfromLat(H[0])*this.worldSize,t=x-g<A.y?A.y/(x-g):0}if(this.lngRange){const H=this.lngRange;E=a.wrap(a.mercatorXfromLng(H[0])*this.worldSize,0,this.worldSize),S=a.wrap(a.mercatorXfromLng(H[1])*this.worldSize,0,this.worldSize),S<E&&(S+=this.worldSize),s=S-E<A.x?A.x/(S-E):0}const L=this.point,U=Math.max(s||0,t||0);if(U)return this.center=this.unproject(new a.pointGeometry(s?(S+E)/2:L.x,t?(x+g)/2:L.y)),this.zoom+=this.scaleZoom(U),this._unmodified=z,void(this._constraining=!1);if(this.latRange){const H=L.y,W=A.y/2;H-W<g&&(p=g+W),H+W>x&&(p=x-W)}if(this.lngRange){const H=(E+S)/2,W=a.wrap(L.x,H-this.worldSize/2,H+this.worldSize/2),Z=A.x/2;W-Z<E&&(u=E+Z),W+Z>S&&(u=S-Z)}u===void 0&&p===void 0||(this.center=this.unproject(new a.pointGeometry(u!==void 0?u:L.x,p!==void 0?p:L.y)).wrap()),this._unmodified=z,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,s=this.point.x,u=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let p=a.identity(new Float64Array(16));a.scale(p,p,[this.width/2,-this.height/2,1]),a.translate(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=a.identity(new Float64Array(16)),a.scale(p,p,[1,-1,1]),a.translate(p,p,[-1,-1,0]),a.scale(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const g=Math.PI/2+this._pitch,x=this._fov*(.5+t.y/this.height),E=Math.sin(x)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-g-x,.01,Math.PI-.01)),S=this.getHorizon(),A=2*Math.atan(S/this.cameraToCenterDistance)*(.5+t.y/(2*S)),z=Math.sin(A)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-g-A,.01,Math.PI-.01)),L=Math.cos(Math.PI/2-this._pitch)*E+this.cameraToSeaLevelDistance,U=Math.cos(Math.PI/2-this._pitch)*z+this.cameraToSeaLevelDistance,H=1.01*Math.min(L,U),W=this.height/50;p=new Float64Array(16),a.perspective(p,this._fov,this.width/this.height,W,H),p[8]=2*-t.x/this.width,p[9]=2*t.y/this.height,a.scale(p,p,[1,-1,1]),a.translate(p,p,[0,0,-this.cameraToCenterDistance]),a.rotateX(p,p,this._pitch),a.rotateZ(p,p,this.angle),a.translate(p,p,[-s,-u,0]),this.mercatorMatrix=a.scale([],p,[this.worldSize,this.worldSize,this.worldSize]),a.scale(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,p),a.translate(p,p,[0,0,-this.elevation]),this.projMatrix=p,this.invProjMatrix=a.invert([],p),this.pixelMatrix3D=a.multiply(new Float64Array(16),this.labelPlaneMatrix,p);const Z=this.width%2/2,ne=this.height%2/2,oe=Math.cos(this.angle),ue=Math.sin(this.angle),K=s-Math.round(s)+oe*Z+ue*ne,fe=u-Math.round(u)+oe*ne+ue*Z,de=new Float64Array(p);if(a.translate(de,de,[K>.5?K-1:K,fe>.5?fe-1:fe,0]),this.alignedProjMatrix=de,p=a.invert(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new a.pointGeometry(0,0)),s=[t.x*this.worldSize,t.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,t))}getCameraQueryGeometry(t){const s=this.getCameraPoint();if(t.length===1)return[t[0],s];{let u=s.x,p=s.y,g=s.x,x=s.y;for(const E of t)u=Math.min(u,E.x),p=Math.min(p,E.y),g=Math.max(g,E.x),x=Math.max(x,E.y);return[new a.pointGeometry(u,p),new a.pointGeometry(g,p),new a.pointGeometry(g,x),new a.pointGeometry(u,x),new a.pointGeometry(u,p)]}}}class ku{constructor(t){this._hashName=t&&encodeURIComponent(t),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(s,u){let p=!1,g=null;const x=()=>{g=null,p&&(s(),g=setTimeout(x,300),p=!1)};return()=>(p=!0,g||x(),g)}(this._updateHashUnthrottled.bind(this))}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const s=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,p=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,p),x=Math.round(s.lng*g)/g,E=Math.round(s.lat*g)/g,S=this._map.getBearing(),A=this._map.getPitch();let z="";if(z+=t?`/${x}/${E}/${u}`:`${u}/${E}/${x}`,(S||A)&&(z+="/"+Math.round(10*S)/10),A&&(z+=`/${Math.round(A)}`),this._hashName){const L=this._hashName;let U=!1;const H=window.location.hash.slice(1).split("&").map(W=>{const Z=W.split("=")[0];return Z===L?(U=!0,`${Z}=${z}`):W}).filter(W=>W);return U||H.push(`${L}=${z}`),`#${H.join("&")}`}return`#${z}`}_getCurrentHash(){const t=window.location.hash.replace("#","");if(this._hashName){let s;return t.split("&").map(u=>u.split("=")).forEach(u=>{u[0]===this._hashName&&(s=u)}),(s&&s[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._getCurrentHash();if(t.length>=3&&!t.some(s=>isNaN(s))){const s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:s,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch{}}}const $o={linearity:.3,easing:a.bezier(0,0,.3,1)},Pu=a.extend({deceleration:2500,maxSpeed:1400},$o),Mu=a.extend({deceleration:20,maxSpeed:1400},$o),zu=a.extend({deceleration:1e3,maxSpeed:360},$o),Ys=a.extend({deceleration:1e3,maxSpeed:90},$o);class Du{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,s=a.exported.now();for(;t.length>0&&s-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)s.zoom+=g.zoomDelta||0,s.bearing+=g.bearingDelta||0,s.pitch+=g.pitchDelta||0,g.panDelta&&s.pan._add(g.panDelta),g.around&&(s.around=g.around),g.pinchAround&&(s.pinchAround=g.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(s.pan.mag()){const g=No(s.pan.mag(),u,a.extend({},Pu,t||{}));p.offset=s.pan.mult(g.amount/s.pan.mag()),p.center=this._map.transform.center,Uo(p,g)}if(s.zoom){const g=No(s.zoom,u,Mu);p.zoom=this._map.transform.zoom+g.amount,Uo(p,g)}if(s.bearing){const g=No(s.bearing,u,zu);p.bearing=this._map.transform.bearing+a.clamp(g.amount,-179,179),Uo(p,g)}if(s.pitch){const g=No(s.pitch,u,Ys);p.pitch=this._map.transform.pitch+g.amount,Uo(p,g)}if(p.zoom||p.bearing){const g=s.pinchAround===void 0?s.around:s.pinchAround;p.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),a.extend(p,{noMoveStart:!0})}}function Uo(h,t){(!h.duration||h.duration<t.duration)&&(h.duration=t.duration,h.easing=t.easing)}function No(h,t,s){const{maxSpeed:u,linearity:p,deceleration:g}=s,x=a.clamp(h*p/(t/1e3),-u,u),E=Math.abs(x)/(g*p);return{easing:s.easing,duration:1e3*E,amount:x*(E/2)}}class Yn extends a.Event{constructor(t,s,u,p={}){const g=M.mousePos(s.getCanvasContainer(),u),x=s.unproject(g);super(t,a.extend({point:g,lngLat:x,originalEvent:u},p)),this._defaultPrevented=!1,this.target=s}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Vo extends a.Event{constructor(t,s,u){const p=t==="touchend"?u.changedTouches:u.touches,g=M.touchPos(s.getCanvasContainer(),p),x=g.map(S=>s.unproject(S)),E=g.reduce((S,A,z,L)=>S.add(A.div(L.length)),new a.pointGeometry(0,0));super(t,{points:g,point:E,lngLats:x,lngLat:s.unproject(E),originalEvent:u}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Qn extends a.Event{constructor(t,s,u){super(t,{originalEvent:u}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class kd{constructor(t,s){this._map=t,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Qn(t.type,this._map,t))}mousedown(t,s){return this._mousedownPos=s,this._firePreventable(new Yn(t.type,this._map,t))}mouseup(t){this._map.fire(new Yn(t.type,this._map,t))}click(t,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Yn(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Yn(t.type,this._map,t))}mouseover(t){this._map.fire(new Yn(t.type,this._map,t))}mouseout(t){this._map.fire(new Yn(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Vo(t.type,this._map,t))}touchmove(t){this._map.fire(new Vo(t.type,this._map,t))}touchend(t){this._map.fire(new Vo(t.type,this._map,t))}touchcancel(t){this._map.fire(new Vo(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Qr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Yn(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Yn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Yn(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ru{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,s){this.isEnabled()&&t.shiftKey&&t.button===0&&(M.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(t,s){if(!this._active)return;const u=s;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=u,this._box||(this._box=M.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const g=Math.min(p.x,u.x),x=Math.max(p.x,u.x),E=Math.min(p.y,u.y),S=Math.max(p.y,u.y);M.setTransform(this._box,`translate(${g}px,${E}px)`),this._box.style.width=x-g+"px",this._box.style.height=S-E+"px"}mouseupWindow(t,s){if(!this._active||t.button!==0)return;const u=this._startPos,p=s;if(this.reset(),M.suppressClick(),u.x!==p.x||u.y!==p.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:g=>g.fitScreenCoordinates(u,p,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(M.remove(this._box),this._box=null),M.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,s){return this._map.fire(new a.Event(t,{originalEvent:s}))}}function Fr(h,t){if(h.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${h.length}, points ${t.length}`);const s={};for(let u=0;u<h.length;u++)s[h[u].identifier]=t[u];return s}class jo{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,s,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),u.length===this.numTouches&&(this.centroid=function(p){const g=new a.pointGeometry(0,0);for(const x of p)g._add(x);return g.div(p.length)}(s),this.touches=Fr(u,s)))}touchmove(t,s,u){if(this.aborted||!this.centroid)return;const p=Fr(u,s);for(const g in this.touches){const x=this.touches[g],E=p[g];(!E||E.dist(x)>30)&&(this.aborted=!0)}}touchend(t,s,u){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class Yl{constructor(t){this.singleTap=new jo(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,s,u){this.singleTap.touchstart(t,s,u)}touchmove(t,s,u){this.singleTap.touchmove(t,s,u)}touchend(t,s,u){const p=this.singleTap.touchend(t,s,u);if(p){const g=t.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(p)<30;if(g&&x||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class Pd{constructor(){this._zoomIn=new Yl({numTouches:1,numTaps:2}),this._zoomOut=new Yl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,s,u){this._zoomIn.touchstart(t,s,u),this._zoomOut.touchstart(t,s,u)}touchmove(t,s,u){this._zoomIn.touchmove(t,s,u),this._zoomOut.touchmove(t,s,u)}touchend(t,s,u){const p=this._zoomIn.touchend(t,s,u),g=this._zoomOut.touchend(t,s,u);return p?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()+1,around:x.unproject(p)},{originalEvent:t})}):g?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()-1,around:x.unproject(g)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Md={0:1,2:2};class qa{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(t,s){return!1}_move(t,s){return{}}mousedown(t,s){if(this._lastPoint)return;const u=M.mouseButton(t);this._correctButton(t,u)&&(this._lastPoint=s,this._eventButton=u)}mousemoveWindow(t,s){const u=this._lastPoint;if(u){if(t.preventDefault(),function(p,g){const x=Md[g];return p.buttons===void 0||(p.buttons&x)!==x}(t,this._eventButton))this.reset();else if(this._moved||!(s.dist(u)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(u,s)}}mouseupWindow(t){this._lastPoint&&M.mouseButton(t)===this._eventButton&&(this._moved&&M.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qo extends qa{mousedown(t,s){super.mousedown(t,s),this._lastPoint&&(this._active=!0)}_correctButton(t,s){return s===0&&!t.ctrlKey}_move(t,s){return{around:s,panDelta:s.sub(t)}}}class $r extends qa{_correctButton(t,s){return s===0&&t.ctrlKey||s===2}_move(t,s){const u=.8*(s.x-t.x);if(u)return this._active=!0,{bearingDelta:u}}contextmenu(t){t.preventDefault()}}class mt extends qa{_correctButton(t,s){return s===0&&t.ctrlKey||s===2}_move(t,s){const u=-.5*(s.y-t.y);if(u)return this._active=!0,{pitchDelta:u}}contextmenu(t){t.preventDefault()}}class Lu{constructor(t,s){this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(t,s,u){return this._calculateTransform(t,s,u)}touchmove(t,s,u){if(this._map._cooperativeGestures&&(this._minTouches===2&&u.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,u.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(u.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,s,u)}touchend(t,s,u){this._calculateTransform(t,s,u),this._active&&u.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,s,u){u.length>0&&(this._active=!0);const p=Fr(u,s),g=new a.pointGeometry(0,0),x=new a.pointGeometry(0,0);let E=0;for(const A in p){const z=p[A],L=this._touches[A];L&&(g._add(z),x._add(z.sub(L)),E++,p[A]=z)}if(this._touches=p,E<this._minTouches||!x.mag())return;const S=x.div(E);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(E),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bs{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(t){}_move(t,s,u){return{}}touchstart(t,s,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([s[0],s[1]]))}touchmove(t,s,u){if(!this._firstTwoTouches)return;t.preventDefault();const[p,g]=this._firstTwoTouches,x=es(u,s,p),E=es(u,s,g);if(!x||!E)return;const S=this._aroundCenter?null:x.add(E).div(2);return this._move([x,E],S,t)}touchend(t,s,u){if(!this._firstTwoTouches)return;const[p,g]=this._firstTwoTouches,x=es(u,s,p),E=es(u,s,g);x&&E||(this._active&&M.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function es(h,t,s){for(let u=0;u<h.length;u++)if(h[u].identifier===s)return t[u]}function Ql(h,t){return Math.log(h/t)/Math.LN2}class nt extends bs{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,s){const u=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ql(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ql(this._distance,u),pinchAround:s}}}function Ga(h,t){return 180*h.angleWith(t)/Math.PI}class zd extends bs{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,s){const u=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ga(this._vector,u),pinchAround:s}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const s=25/(Math.PI*this._minDiameter)*360,u=Ga(t,this._startVector);return Math.abs(u)<s}}function ec(h){return Math.abs(h.y)>Math.abs(h.x)}class tc extends bs{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,s,u){super.touchstart(t,s,u),this._currentTouchCount=u.length}_start(t){this._lastPoints=t,ec(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,s,u){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const p=t[0].sub(this._lastPoints[0]),g=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,g,u.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(p.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(t,s,u){if(this._valid!==void 0)return this._valid;const p=t.mag()>=2,g=s.mag()>=2;if(!p&&!g)return;if(!p||!g)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const x=t.y>0==s.y>0;return ec(t)&&ec(s)&&x}}const Ou={panStep:100,bearingStep:15,pitchStep:10};class Bu{constructor(){const t=Ou;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let s=0,u=0,p=0,g=0,x=0;switch(t.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:t.shiftKey?u=-1:(t.preventDefault(),g=-1);break;case 39:t.shiftKey?u=1:(t.preventDefault(),g=1);break;case 38:t.shiftKey?p=1:(t.preventDefault(),x=-1);break;case 40:t.shiftKey?p=-1:(t.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(u=0,p=0),{cameraAnimation:E=>{const S=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:Dd,zoom:s?Math.round(S)+s*(t.shiftKey?2:1):S,bearing:E.getBearing()+u*this._bearingStep,pitch:E.getPitch()+p*this._pitchStep,offset:[-g*this._panStep,-x*this._panStep],center:E.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Dd(h){return h*(2-h)}const Fu=4.000244140625;class ic{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;t.preventDefault()}let s=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const u=a.exported.now(),p=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,s!==0&&s%Fu==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(p*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),t.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=t,this._delta-=s,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=M.mousePos(this._el,t);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;if(this._delta!==0){const E=this._type==="wheel"&&Math.abs(this._delta)>Fu?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&S!==0&&(S=1/S);const A=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(A*S))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,u=this._startZoom,p=this._easing;let g,x=!1;if(this._type==="wheel"&&u&&p){const E=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),S=p(E);g=a.number(u,s,S),E<1?this._frameId||(this._frameId=!0):x=!0}else g=s,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:g-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let s=a.ease;if(this._prevEase){const u=this._prevEase,p=(a.exported.now()-u.start)/u.duration,g=u.easing(p+.01)-u.easing(p),x=.27/Math.sqrt(g*g+1e-4)*.01,E=Math.sqrt(.0729-x*x);s=a.bezier(x,E,.25,1)}return this._prevEase={start:a.exported.now(),duration:t,easing:s},s}reset(){this._active=!1}}class nc{constructor(t,s){this._clickZoom=t,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class rc{constructor(){this.reset()}reset(){this._active=!1}dblclick(t,s){return t.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:u.getZoom()+(t.shiftKey?-1:1),around:u.unproject(s)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sc{constructor(){this._tap=new Yl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(t,s,u){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?u.length>0&&(this._swipePoint=s[0],this._swipeTouch=u[0].identifier):this._tap.touchstart(t,s,u))}touchmove(t,s,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const p=s[0],g=p.y-this._swipePoint.y;return this._swipePoint=p,t.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(t,s,u)}touchend(t,s,u){this._tapTime?this._swipePoint&&u.length===0&&this.reset():this._tap.touchend(t,s,u)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qn{constructor(t,s,u){this._el=t,this._mousePan=s,this._touchPan=u}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ts{constructor(t,s,u){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=s,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class $u{constructor(t,s,u,p){this._el=t,this._touchZoom=s,this._touchRotate=u,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Qs=h=>h.zoom||h.drag||h.pitch||h.rotate;class oc extends a.Event{}function Go(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class Uu{constructor(t,s){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Du(t),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,g,x]of this._listeners)M.addEventListener(p,g,p===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[t,s,u]of this._listeners)M.removeEventListener(t,s,t===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(t){const s=this._map,u=s.getCanvasContainer();this._add("mapEvent",new kd(s,t));const p=s.boxZoom=new Ru(s,t);this._add("boxZoom",p);const g=new Pd,x=new rc;s.doubleClickZoom=new nc(x,g),this._add("tapZoom",g),this._add("clickZoom",x);const E=new sc;this._add("tapDragZoom",E);const S=s.touchPitch=new tc(s);this._add("touchPitch",S);const A=new $r(t),z=new mt(t);s.dragRotate=new ts(t,A,z),this._add("mouseRotate",A,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const L=new qo(t),U=new Lu(t,s);s.dragPan=new qn(u,L,U),this._add("mousePan",L),this._add("touchPan",U,["touchZoom","touchRotate"]);const H=new zd,W=new nt;s.touchZoomRotate=new $u(u,W,H,E),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",W,["touchPan","touchRotate"]);const Z=s.scrollZoom=new ic(s,this);this._add("scrollZoom",Z,["mousePan"]);const ne=s.keyboard=new Bu;this._add("keyboard",ne),this._add("blockableMapEvent",new Qr(s));for(const oe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[oe]&&s[oe].enable(t[oe])}_add(t,s,u){this._handlers.push({handlerName:t,handler:s,allowed:u}),this._handlersById[t]=s}stop(t){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Qs(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,s,u){for(const p in t)if(p!==u&&(!s||s.indexOf(p)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const s=[];for(const u of t)this._el.contains(u.target)&&s.push(u);return s}handleEvent(t,s){if(t.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const u=t.type==="renderFrame"?void 0:t,p={needsRenderFrame:!1},g={},x={},E=t.touches,S=E?this._getMapTouches(E):void 0,A=S?M.touchPos(this._el,S):M.mousePos(this._el,t);for(const{handlerName:U,handler:H,allowed:W}of this._handlers){if(!H.isEnabled())continue;let Z;this._blockedByActive(x,W,U)?H.reset():H[s||t.type]&&(Z=H[s||t.type](t,A,S),this.mergeHandlerResult(p,g,Z,U,u),Z&&Z.needsRenderFrame&&this._triggerRenderFrame()),(Z||H.isActive())&&(x[U]=H)}const z={};for(const U in this._previousActiveHandlers)x[U]||(z[U]=u);this._previousActiveHandlers=x,(Object.keys(z).length||Go(p))&&(this._changes.push([p,g,z]),this._triggerRenderFrame()),(Object.keys(x).length||Go(p))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:L}=p;L&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],L(this._map))}mergeHandlerResult(t,s,u,p,g){if(!u)return;a.extend(t,u);const x={handlerName:p,originalEvent:u.originalEvent||g};u.zoomDelta!==void 0&&(s.zoom=x),u.panDelta!==void 0&&(s.drag=x),u.pitchDelta!==void 0&&(s.pitch=x),u.bearingDelta!==void 0&&(s.rotate=x)}_applyChanges(){const t={},s={},u={};for(const[p,g,x]of this._changes)p.panDelta&&(t.panDelta=(t.panDelta||new a.pointGeometry(0,0))._add(p.panDelta)),p.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(t.around=p.around),p.pinchAround!==void 0&&(t.pinchAround=p.pinchAround),p.noInertia&&(t.noInertia=p.noInertia),a.extend(s,g),a.extend(u,x);this._updateMapTransform(t,s,u),this._changes=[]}_updateMapTransform(t,s,u){const p=this._map,g=p.transform,x=p.style&&p.style.terrain;if(!(Go(t)||x&&this._drag))return this._fireEvents(s,u,!0);let{panDelta:E,zoomDelta:S,bearingDelta:A,pitchDelta:z,around:L,pinchAround:U}=t;U!==void 0&&(L=U),p._stop(!0),L=L||p.transform.centerPoint;const H=g.pointLocation(E?L.sub(E):L);A&&(g.bearing+=A),z&&(g.pitch+=z),S&&(g.zoom+=S),x?s.drag&&!this._drag?(this._drag={center:g.centerPoint,lngLat:g.pointLocation(L),point:L,handlerName:s.drag.handlerName},p.fire(new a.Event("freezeElevation",{freeze:!0}))):this._drag&&u[this._drag.handlerName]?(p.fire(new a.Event("freezeElevation",{freeze:!1})),this._drag=null):s.drag&&this._drag&&(g.center=g.pointLocation(g.centerPoint.sub(E))):g.setLocationAtPoint(H,L),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(s,u,!0)}_fireEvents(t,s,u){const p=Qs(this._eventsInProgress),g=Qs(t),x={};for(const z in t){const{originalEvent:L}=t[z];this._eventsInProgress[z]||(x[`${z}start`]=L),this._eventsInProgress[z]=t[z]}!p&&g&&this._fireEvent("movestart",g.originalEvent);for(const z in x)this._fireEvent(z,x[z]);g&&this._fireEvent("move",g.originalEvent);for(const z in t){const{originalEvent:L}=t[z];this._fireEvent(z,L)}const E={};let S;for(const z in this._eventsInProgress){const{handlerName:L,originalEvent:U}=this._eventsInProgress[z];this._handlersById[L].isActive()||(delete this._eventsInProgress[z],S=s[L]||U,E[`${z}end`]=S)}for(const z in E)this._fireEvent(z,E[z]);const A=Qs(this._eventsInProgress);if(u&&(p||g)&&!A){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),L=U=>U!==0&&-this._bearingSnap<U&&U<this._bearingSnap;z?(L(z.bearing||this._map.getBearing())&&(z.bearing=0),this._map.easeTo(z,{originalEvent:S})):(this._map.fire(new a.Event("moveend",{originalEvent:S})),L(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,s){this._map.fire(new a.Event(t,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new oc("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const cr={extend:(h,...t)=>a.extend(h,...t),run(h){h()},logToElement(h,t=!1,s="log"){const u=window.document.getElementById(s);u&&(t&&(u.innerHTML=""),u.innerHTML+=`<br>${h}`)}};class Gi extends a.Evented{constructor(t,s){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=s.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,s){return this.jumpTo({center:t},s)}panBy(t,s,u){return t=a.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,a.extend({offset:t},s),u)}panTo(t,s,u){return this.easeTo(a.extend({center:t},s),u)}getZoom(){return this.transform.zoom}setZoom(t,s){return this.jumpTo({zoom:t},s),this}zoomTo(t,s,u){return this.easeTo(a.extend({zoom:t},s),u)}zoomIn(t,s){return this.zoomTo(this.getZoom()+1,t,s),this}zoomOut(t,s){return this.zoomTo(this.getZoom()-1,t,s),this}getBearing(){return this.transform.bearing}setBearing(t,s){return this.jumpTo({bearing:t},s),this}getPadding(){return this.transform.padding}setPadding(t,s){return this.jumpTo({padding:t},s),this}rotateTo(t,s,u){return this.easeTo(a.extend({bearing:t},s),u)}resetNorth(t,s){return this.rotateTo(0,a.extend({duration:1e3},t),s),this}resetNorthPitch(t,s){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},t),s),this}snapToNorth(t,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,s):this}getPitch(){return this.transform.pitch}setPitch(t,s){return this.jumpTo({pitch:t},s),this}cameraForBounds(t,s){t=a.LngLatBounds.convert(t);const u=s&&s.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),u,s)}_cameraForBoxAndBearing(t,s,u,p){const g={top:0,bottom:0,right:0,left:0};if(typeof(p=a.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const de=p.padding;p.padding={top:de,bottom:de,right:de,left:de}}p.padding=a.extend(g,p.padding);const x=this.transform,E=x.padding,S=x.project(a.LngLat.convert(t)),A=x.project(a.LngLat.convert(s)),z=S.rotate(-u*Math.PI/180),L=A.rotate(-u*Math.PI/180),U=new a.pointGeometry(Math.max(z.x,L.x),Math.max(z.y,L.y)),H=new a.pointGeometry(Math.min(z.x,L.x),Math.min(z.y,L.y)),W=U.sub(H),Z=(x.width-(E.left+E.right+p.padding.left+p.padding.right))/W.x,ne=(x.height-(E.top+E.bottom+p.padding.top+p.padding.bottom))/W.y;if(ne<0||Z<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const oe=Math.min(x.scaleZoom(x.scale*Math.min(Z,ne)),p.maxZoom),ue=a.pointGeometry.convert(p.offset),K=new a.pointGeometry((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(u*Math.PI/180),fe=ue.add(K).mult(x.scale/x.zoomScale(oe));return{center:x.unproject(S.add(A).div(2).sub(fe)),zoom:oe,bearing:u}}fitBounds(t,s,u){return this._fitInternal(this.cameraForBounds(t,s),s,u)}fitScreenCoordinates(t,s,u,p,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(t)),this.transform.pointLocation(a.pointGeometry.convert(s)),u,p),p,g)}_fitInternal(t,s,u){return t?(delete(s=a.extend(t,s)).padding,s.linear?this.easeTo(s,u):this.flyTo(s,u)):this}jumpTo(t,s){this.stop();const u=this.transform;let p=!1,g=!1,x=!1;return"zoom"in t&&u.zoom!==+t.zoom&&(p=!0,u.zoom=+t.zoom),t.center!==void 0&&(u.center=a.LngLat.convert(t.center)),"bearing"in t&&u.bearing!==+t.bearing&&(g=!0,u.bearing=+t.bearing),"pitch"in t&&u.pitch!==+t.pitch&&(x=!0,u.pitch=+t.pitch),t.padding==null||u.isPaddingEqual(t.padding)||(u.padding=t.padding),this.fire(new a.Event("movestart",s)).fire(new a.Event("move",s)),p&&this.fire(new a.Event("zoomstart",s)).fire(new a.Event("zoom",s)).fire(new a.Event("zoomend",s)),g&&this.fire(new a.Event("rotatestart",s)).fire(new a.Event("rotate",s)).fire(new a.Event("rotateend",s)),x&&this.fire(new a.Event("pitchstart",s)).fire(new a.Event("pitch",s)).fire(new a.Event("pitchend",s)),this.fire(new a.Event("moveend",s))}calculateCameraOptionsFromTo(t,s,u,p=0){const g=a.MercatorCoordinate.fromLngLat(t,s),x=a.MercatorCoordinate.fromLngLat(u,p),E=x.x-g.x,S=x.y-g.y,A=x.z-g.z,z=Math.hypot(E,S,A);if(z===0)throw new Error("Can't calculate camera options with same From and To");const L=Math.hypot(E,S),U=this.transform.scaleZoom(this.transform.cameraToCenterDistance/z/this.transform.tileSize),H=180*Math.atan2(E,-S)/Math.PI;let W=180*Math.acos(L/z)/Math.PI;return W=A<0?90-W:90+W,{center:x.toLngLat(),zoom:U,pitch:W,bearing:H}}easeTo(t,s){this._stop(!1,t.easeId),((t=a.extend({offset:[0,0],duration:500,easing:a.ease},t)).animate===!1||!t.essential&&a.exported.prefersReducedMotion)&&(t.duration=0);const u=this.transform,p=this.getZoom(),g=this.getBearing(),x=this.getPitch(),E=this.getPadding(),S="zoom"in t?+t.zoom:p,A="bearing"in t?this._normalizeBearing(t.bearing,g):g,z="pitch"in t?+t.pitch:x,L="padding"in t?t.padding:u.padding,U=a.pointGeometry.convert(t.offset);let H=u.centerPoint.add(U);const W=u.pointLocation(H),Z=a.LngLat.convert(t.center||W);this._normalizeCenter(Z);const ne=u.project(W),oe=u.project(Z).sub(ne),ue=u.zoomScale(S-p);let K,fe;t.around&&(K=a.LngLat.convert(t.around),fe=u.locationPoint(K));const de={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||S!==p,this._rotating=this._rotating||g!==A,this._pitching=this._pitching||z!==x,this._padding=!u.isPaddingEqual(L),this._easeId=t.easeId,this._prepareEase(s,t.noMoveStart,de),this._ease(xe=>{if(this._zooming&&(u.zoom=a.number(p,S,xe)),this._rotating&&(u.bearing=a.number(g,A,xe)),this._pitching&&(u.pitch=a.number(x,z,xe)),this._padding&&(u.interpolatePadding(E,L,xe),H=u.centerPoint.add(U)),K)u.setLocationAtPoint(K,fe);else{const we=u.zoomScale(u.zoom-p),Le=S>p?Math.min(2,ue):Math.max(.5,ue),ye=Math.pow(Le,1-xe),at=u.unproject(ne.add(oe.mult(xe*ye)).mult(we));u.setLocationAtPoint(u.renderWorldCopies?at.wrap():at,H)}this._fireMoveEvents(s)},xe=>{this._afterEase(s,xe)},t),this}_prepareEase(t,s,u={}){this._moving=!0,this.fire(new a.Event("freezeElevation",{freeze:!0})),s||u.moving||this.fire(new a.Event("movestart",t)),this._zooming&&!u.zooming&&this.fire(new a.Event("zoomstart",t)),this._rotating&&!u.rotating&&this.fire(new a.Event("rotatestart",t)),this._pitching&&!u.pitching&&this.fire(new a.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new a.Event("move",t)),this._zooming&&this.fire(new a.Event("zoom",t)),this._rotating&&this.fire(new a.Event("rotate",t)),this._pitching&&this.fire(new a.Event("pitch",t))}_afterEase(t,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId,this.fire(new a.Event("freezeElevation",{freeze:!1}));const u=this._zooming,p=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new a.Event("zoomend",t)),p&&this.fire(new a.Event("rotateend",t)),g&&this.fire(new a.Event("pitchend",t)),this.fire(new a.Event("moveend",t))}flyTo(t,s){if(!t.essential&&a.exported.prefersReducedMotion){const Ct=a.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ct,s)}this.stop(),t=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},t);const u=this.transform,p=this.getZoom(),g=this.getBearing(),x=this.getPitch(),E=this.getPadding(),S="zoom"in t?a.clamp(+t.zoom,u.minZoom,u.maxZoom):p,A="bearing"in t?this._normalizeBearing(t.bearing,g):g,z="pitch"in t?+t.pitch:x,L="padding"in t?t.padding:u.padding,U=u.zoomScale(S-p),H=a.pointGeometry.convert(t.offset);let W=u.centerPoint.add(H);const Z=u.pointLocation(W),ne=a.LngLat.convert(t.center||Z);this._normalizeCenter(ne);const oe=u.project(Z),ue=u.project(ne).sub(oe);let K=t.curve;const fe=Math.max(u.width,u.height),de=fe/U,xe=ue.mag();if("minZoom"in t){const Ct=a.clamp(Math.min(t.minZoom,p,S),u.minZoom,u.maxZoom),Ei=fe/u.zoomScale(Ct-p);K=Math.sqrt(Ei/xe*2)}const we=K*K;function Le(Ct){const Ei=(de*de-fe*fe+(Ct?-1:1)*we*we*xe*xe)/(2*(Ct?de:fe)*we*xe);return Math.log(Math.sqrt(Ei*Ei+1)-Ei)}function ye(Ct){return(Math.exp(Ct)-Math.exp(-Ct))/2}function at(Ct){return(Math.exp(Ct)+Math.exp(-Ct))/2}const Ye=Le(0);let dt=function(Ct){return at(Ye)/at(Ye+K*Ct)},Kt=function(Ct){return fe*((at(Ye)*(ye(Ei=Ye+K*Ct)/at(Ei))-ye(Ye))/we)/xe;var Ei},Qt=(Le(1)-Ye)/K;if(Math.abs(xe)<1e-6||!isFinite(Qt)){if(Math.abs(fe-de)<1e-6)return this.easeTo(t,s);const Ct=de<fe?-1:1;Qt=Math.abs(Math.log(de/fe))/K,Kt=function(){return 0},dt=function(Ei){return Math.exp(Ct*K*Ei)}}return t.duration="duration"in t?+t.duration:1e3*Qt/("screenSpeed"in t?+t.screenSpeed/K:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=g!==A,this._pitching=z!==x,this._padding=!u.isPaddingEqual(L),this._prepareEase(s,!1),this._ease(Ct=>{const Ei=Ct*Qt,Si=1/dt(Ei);u.zoom=Ct===1?S:p+u.scaleZoom(Si),this._rotating&&(u.bearing=a.number(g,A,Ct)),this._pitching&&(u.pitch=a.number(x,z,Ct)),this._padding&&(u.interpolatePadding(E,L,Ct),W=u.centerPoint.add(H));const ci=Ct===1?ne:u.unproject(oe.add(ue.mult(Kt(Ei))).mult(Si));u.setLocationAtPoint(u.renderWorldCopies?ci.wrap():ci,W),this._fireMoveEvents(s)},()=>this._afterEase(s),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,s)}if(!t){const u=this.handlers;u&&u.stop(!1)}return this}_ease(t,s,u){u.animate===!1||u.duration===0?(t(1),s()):(this._easeStart=a.exported.now(),this._easeOptions=u,this._onEaseFrame=t,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,s){t=a.wrap(t,-180,180);const u=Math.abs(t-s);return Math.abs(t-360-s)<u&&(t-=360),Math.abs(t+360-s)<u&&(t+=360),t}_normalizeCenter(t){const s=this.transform;if(!s.renderWorldCopies||s.lngRange)return;const u=t.lng-s.center.lng;t.lng+=u>180?-360:u<-180?360:0}}class Wo{constructor(t={}){this.options=t,a.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=M.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=M.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=M.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){M.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,s){const u=this._map._getUIString(`AttributionControl.${s}`);t.title=u,t.setAttribute("aria-label",u)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"&&t.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const s=this._map.style.sourceCaches;for(const p in s){const g=s[p];if(g.used||g.usedForTerrain){const x=g.getSource();x.attribution&&t.indexOf(x.attribution)<0&&t.push(x.attribution)}}t=t.filter(p=>String(p).trim()),t.sort((p,g)=>p.length-g.length),t=t.filter((p,g)=>{for(let x=g+1;x<t.length;x++)if(t[x].indexOf(p)>=0)return!1;return!0});const u=t.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,t.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Wa{constructor(t={}){this.options=t,a.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=M.create("div","maplibregl-ctrl mapboxgl-ctrl");const s=M.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){M.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const t=this._container.children;if(t.length){const s=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&s.classList.add("maplibregl-compact","mapboxgl-compact"):s.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class Nu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const s=++this._id;return this._queue.push({callback:t,id:s,cancelled:!1}),s}remove(t){const s=this._currentlyRunning,u=s?this._queue.concat(s):this._queue;for(const p of u)if(p.id===t)return void(p.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const u of s)if(!u.cancelled&&(u.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Vu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},ju={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Rd={showCompass:!0,showZoom:!0,visualizePitch:!1};class kr{constructor(t,s,u=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new $r({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,u&&(this.mousePitch=new mt({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),M.addEventListener(s,"mousedown",this.mousedown),M.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),M.addEventListener(s,"touchmove",this.touchmove),M.addEventListener(s,"touchend",this.touchend),M.addEventListener(s,"touchcancel",this.reset)}down(t,s){this.mouseRotate.mousedown(t,s),this.mousePitch&&this.mousePitch.mousedown(t,s),M.disableDrag()}move(t,s){const u=this.map,p=this.mouseRotate.mousemoveWindow(t,s);if(p&&p.bearingDelta&&u.setBearing(u.getBearing()+p.bearingDelta),this.mousePitch){const g=this.mousePitch.mousemoveWindow(t,s);g&&g.pitchDelta&&u.setPitch(u.getPitch()+g.pitchDelta)}}off(){const t=this.element;M.removeEventListener(t,"mousedown",this.mousedown),M.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),M.removeEventListener(t,"touchmove",this.touchmove),M.removeEventListener(t,"touchend",this.touchend),M.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){M.enableDrag(),M.removeEventListener(window,"mousemove",this.mousemove),M.removeEventListener(window,"mouseup",this.mouseup)}mousedown(t){this.down(a.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),M.mousePos(this.element,t)),M.addEventListener(window,"mousemove",this.mousemove),M.addEventListener(window,"mouseup",this.mouseup)}mousemove(t){this.move(t,M.mousePos(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=M.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=M.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Zo(h,t,s){if(h=new a.LngLat(h.lng,h.lat),t){const u=new a.LngLat(h.lng-360,h.lat),p=new a.LngLat(h.lng+360,h.lat),g=s.locationPoint(h).distSqr(t);s.locationPoint(u).distSqr(t)<g?h=u:s.locationPoint(p).distSqr(t)<g&&(h=p)}for(;Math.abs(h.lng-s.center.lng)>180;){const u=s.locationPoint(h);if(u.x>=0&&u.y>=0&&u.x<=s.width&&u.y<=s.height)break;h.lng>s.center.lng?h.lng-=360:h.lng+=360}return h}const Tt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Mt(h,t,s){const u=h.classList;for(const p in Tt)u.remove(`maplibregl-${s}-anchor-${p}`,`mapboxgl-${s}-anchor-${p}`);u.add(`maplibregl-${s}-anchor-${t}`,`mapboxgl-${s}-anchor-${t}`)}class eo extends a.Evented{constructor(t,s){if(super(),(t instanceof HTMLElement||s)&&(t=a.extend({element:t},s)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=a.pointGeometry.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=M.create("div"),this._element.setAttribute("aria-label","Map marker");const u=M.createNS("http://www.w3.org/2000/svg","svg"),p=41,g=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${p}px`),u.setAttributeNS(null,"width",`${g}px`),u.setAttributeNS(null,"viewBox",`0 0 ${g} ${p}`);const x=M.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const E=M.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const S=M.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const A=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of A){const K=M.createNS("http://www.w3.org/2000/svg","ellipse");K.setAttributeNS(null,"opacity","0.04"),K.setAttributeNS(null,"cx","10.5"),K.setAttributeNS(null,"cy","5.80029008"),K.setAttributeNS(null,"rx",ue.rx),K.setAttributeNS(null,"ry",ue.ry),S.appendChild(K)}const z=M.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const L=M.createNS("http://www.w3.org/2000/svg","path");L.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(L);const U=M.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"opacity","0.25"),U.setAttributeNS(null,"fill","#000000");const H=M.createNS("http://www.w3.org/2000/svg","path");H.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),U.appendChild(H);const W=M.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"transform","translate(6.0, 7.0)"),W.setAttributeNS(null,"fill","#FFFFFF");const Z=M.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ne=M.createNS("http://www.w3.org/2000/svg","circle");ne.setAttributeNS(null,"fill","#000000"),ne.setAttributeNS(null,"opacity","0.25"),ne.setAttributeNS(null,"cx","5.5"),ne.setAttributeNS(null,"cy","5.5"),ne.setAttributeNS(null,"r","5.4999962");const oe=M.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#FFFFFF"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962"),Z.appendChild(ne),Z.appendChild(oe),E.appendChild(S),E.appendChild(z),E.appendChild(U),E.appendChild(W),E.appendChild(Z),u.appendChild(E),u.setAttributeNS(null,"height",p*this._scale+"px"),u.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(u),this._offset=a.pointGeometry.convert(t&&t.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),Mt(this._element,this._anchor,"marker"),this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),M.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=a.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const p=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(t){const s=t.code,u=t.charCode||t.keyCode;s!=="Space"&&s!=="Enter"&&u!==32&&u!==13||this.togglePopup()}_onMapClick(t){const s=t.originalEvent.target,u=this._element;this._popup&&(s===u||u.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}_update(t){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Zo(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let s="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?s=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(s=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let u="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?u="rotateX(0deg)":this._pitchAlignment==="map"&&(u=`rotateX(${this._map.getPitch()}deg)`),t&&t.type!=="moveend"||(this._pos=this._pos.round()),M.setTransform(this._element,`${Tt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${u} ${s}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const p=this._map.unproject(this._pos),g=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=p.distanceTo(this._lngLat)>20*g?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(t){return this._offset=a.pointGeometry.convert(t),this._update(),this}_onMove(t){if(!this._isDragging){const s=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=s}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const ac={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let is,Tn=0,ns=!1;const Pr={maxWidth:100,unit:"metric"};function qu(h,t,s){const u=s&&s.maxWidth||100,p=h._container.clientHeight/2,g=h.unproject([0,p]),x=h.unproject([u,p]),E=g.distanceTo(x);if(s&&s.unit==="imperial"){const S=3.2808*E;S>5280?rs(t,u,S/5280,h._getUIString("ScaleControl.Miles")):rs(t,u,S,h._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?rs(t,u,E/1852,h._getUIString("ScaleControl.NauticalMiles")):E>=1e3?rs(t,u,E/1e3,h._getUIString("ScaleControl.Kilometers")):rs(t,u,E,h._getUIString("ScaleControl.Meters"))}function rs(h,t,s,u){const p=function(g){const x=Math.pow(10,`${Math.floor(g)}`.length-1);let E=g/x;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:function(S){const A=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*A)/A}(E),x*E}(s);h.style.width=t*(p/s)+"px",h.innerHTML=`${p}&nbsp;${u}`}const Xi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rn=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function lc(h){if(h){if(typeof h=="number"){const t=Math.round(Math.sqrt(.5*Math.pow(h,2)));return{center:new a.pointGeometry(0,0),top:new a.pointGeometry(0,h),"top-left":new a.pointGeometry(t,t),"top-right":new a.pointGeometry(-t,t),bottom:new a.pointGeometry(0,-h),"bottom-left":new a.pointGeometry(t,-t),"bottom-right":new a.pointGeometry(-t,-t),left:new a.pointGeometry(h,0),right:new a.pointGeometry(-h,0)}}if(h instanceof a.pointGeometry||Array.isArray(h)){const t=a.pointGeometry.convert(h);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:a.pointGeometry.convert(h.center||[0,0]),top:a.pointGeometry.convert(h.top||[0,0]),"top-left":a.pointGeometry.convert(h["top-left"]||[0,0]),"top-right":a.pointGeometry.convert(h["top-right"]||[0,0]),bottom:a.pointGeometry.convert(h.bottom||[0,0]),"bottom-left":a.pointGeometry.convert(h["bottom-left"]||[0,0]),"bottom-right":a.pointGeometry.convert(h["bottom-right"]||[0,0]),left:a.pointGeometry.convert(h.left||[0,0]),right:a.pointGeometry.convert(h.right||[0,0])}}return lc(new a.pointGeometry(0,0))}const ws={supported:k,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends Gi{constructor(h){var t;if(a.PerformanceUtils.mark(a.PerformanceMarkers.create),(h=a.extend({},ju,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Fo(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),{bearingSnap:h.bearingSnap}),this._interactive=h.interactive,this._cooperativeGestures=h.cooperativeGestures,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._renderTaskQueue=new Nu,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Vu,h.locale),this._clickTolerance=h.clickTolerance,this._pixelRatio=(t=h.pixelRatio)!==null&&t!==void 0?t:devicePixelRatio,this._requestManager=new le(h.transformRequest),typeof h.container=="string"){if(this._container=document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Uu(this,h),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=h.hash&&new ku(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,a.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localIdeographFontFamily:h.localIdeographFontFamily}),h.attributionControl&&this.addControl(new Wo({customAttribution:h.customAttribution})),h.maplibreLogo&&this.addControl(new Wa,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new a.Event(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new a.Event(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new a.Event("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(h,t){if(t===void 0&&(t=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=h.onAdd(this);this._controls.push(h);const u=this._controlPositions[t];return t.indexOf("bottom")!==-1?u.insertBefore(s,u.firstChild):u.appendChild(s),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(h);return t>-1&&this._controls.splice(t,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}calculateCameraOptionsFromTo(h,t,s,u){return u==null&&this.style.terrain&&(u=this.transform.getElevation(s,this.style.terrain)),super.calculateCameraOptionsFromTo(h,t,s,u)}resize(h){const t=this._containerDimensions(),s=t[0],u=t[1];this._resizeCanvas(s,u,this.getPixelRatio()),this.transform.resize(s,u),this.painter.resize(s,u,this.getPixelRatio());const p=!this._moving;return p&&(this.stop(),this.fire(new a.Event("movestart",h)).fire(new a.Event("move",h))),this.fire(new a.Event("resize",h)),p&&this.fire(new a.Event("moveend",h)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(h){const[t,s]=this._containerDimensions();this._pixelRatio=h,this._resizeCanvas(t,s,h),this.painter.resize(t,s,h)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(h){return this.transform.setMaxBounds(a.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h==null?-2:h)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h&&this.setZoom(h),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h==null?22:h)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h&&this.setZoom(h),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h==null?0:h)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h&&this.setPitch(h),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h==null?60:h)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h&&this.setPitch(h),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this._update()}project(h){return this.transform.locationPoint(a.LngLat.convert(h),this.style&&this.style.terrain)}unproject(h){return this.transform.pointLocation(a.pointGeometry.convert(h),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(h,t,s){if(h==="mouseenter"||h==="mouseover"){let u=!1;return{layer:t,listener:s,delegates:{mousemove:g=>{const x=this.getLayer(t)?this.queryRenderedFeatures(g.point,{layers:[t]}):[];x.length?u||(u=!0,s.call(this,new Yn(h,this,g.originalEvent,{features:x}))):u=!1},mouseout:()=>{u=!1}}}}if(h==="mouseleave"||h==="mouseout"){let u=!1;return{layer:t,listener:s,delegates:{mousemove:x=>{(this.getLayer(t)?this.queryRenderedFeatures(x.point,{layers:[t]}):[]).length?u=!0:u&&(u=!1,s.call(this,new Yn(h,this,x.originalEvent)))},mouseout:x=>{u&&(u=!1,s.call(this,new Yn(h,this,x.originalEvent)))}}}}{const u=p=>{const g=this.getLayer(t)?this.queryRenderedFeatures(p.point,{layers:[t]}):[];g.length&&(p.features=g,s.call(this,p),delete p.features)};return{layer:t,listener:s,delegates:{[h]:u}}}}on(h,t,s){if(s===void 0)return super.on(h,t);const u=this._createDelegatedListener(h,t,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(u);for(const p in u.delegates)this.on(p,u.delegates[p]);return this}once(h,t,s){if(s===void 0)return super.once(h,t);const u=this._createDelegatedListener(h,t,s);for(const p in u.delegates)this.once(p,u.delegates[p]);return this}off(h,t,s){return s===void 0?super.off(h,t):(this._delegatedListeners&&this._delegatedListeners[h]&&(u=>{const p=this._delegatedListeners[h];for(let g=0;g<p.length;g++){const x=p[g];if(x.layer===t&&x.listener===s){for(const E in x.delegates)this.off(E,x.delegates[E]);return p.splice(g,1),this}}})(),this)}queryRenderedFeatures(h,t){if(!this.style)return[];let s;if(t!==void 0||h===void 0||h instanceof a.pointGeometry||Array.isArray(h)||(t=h,h=void 0),t=t||{},(h=h||[[0,0],[this.transform.width,this.transform.height]])instanceof a.pointGeometry||typeof h[0]=="number")s=[a.pointGeometry.convert(h)];else{const u=a.pointGeometry.convert(h[0]),p=a.pointGeometry.convert(h[1]);s=[u,new a.pointGeometry(p.x,u.y),p,new a.pointGeometry(u.x,p.y),u]}return this.style.queryRenderedFeatures(s,t,this.transform)}querySourceFeatures(h,t){return this.style.querySourceFeatures(h,t)}setStyle(h,t){return(t=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&h?(this._diffStyle(h,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(h,t))}setTransformRequest(h){return this._requestManager.setTransformRequest(h),this}_getUIString(h){const t=this._locale[h];if(t==null)throw new Error(`Missing UI string '${h}'`);return t}_updateStyle(h,t){return this.style&&(this.style.setEventedParent(null),this.style._remove()),h?(this.style=new Cn(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Cn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,t){if(typeof h=="string"){const s=this._requestManager.transformRequest(h,a.ResourceType.Style);a.getJSON(s,(u,p)=>{u?this.fire(new a.ErrorEvent(u)):p&&this._updateDiff(p,t)})}else typeof h=="object"&&this._updateDiff(h,t)}_updateDiff(h,t){try{this.style.setState(h)&&this._update(!0)}catch(s){a.warnOnce(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(h,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(h,t){return this._lazyInitEmptyStyle(),this.style.addSource(h,t),this._update(!0)}isSourceLoaded(h){const t=this.style&&this.style.sourceCaches[h];if(t!==void 0)return t.loaded();this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${h}'`)))}setTerrain(h){return this.style.setTerrain(h),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const h=this.style&&this.style.sourceCaches;for(const t in h){const s=h[t]._tiles;for(const u in s){const p=s[u];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}addSourceType(h,t,s){return this._lazyInitEmptyStyle(),this.style.addSourceType(h,t,s)}removeSource(h){return this.style.removeSource(h),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,t,{pixelRatio:s=1,sdf:u=!1,stretchX:p,stretchY:g,content:x}={}){if(this._lazyInitEmptyStyle(),t instanceof HTMLImageElement||a.isImageBitmap(t)){const{width:E,height:S,data:A}=a.exported.getImageData(t);this.style.addImage(h,{data:new a.RGBAImage({width:E,height:S},A),pixelRatio:s,stretchX:p,stretchY:g,content:x,sdf:u,version:0})}else{if(t.width===void 0||t.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:S,data:A}=t,z=t;this.style.addImage(h,{data:new a.RGBAImage({width:E,height:S},new Uint8Array(A)),pixelRatio:s,stretchX:p,stretchY:g,content:x,sdf:u,version:0,userImage:z}),z.onAdd&&z.onAdd(this,h)}}}updateImage(h,t){const s=this.style.getImage(h);if(!s)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=t instanceof HTMLImageElement||a.isImageBitmap(t)?a.exported.getImageData(t):t,{width:p,height:g,data:x}=u;if(p===void 0||g===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==s.data.width||g!==s.data.height)return this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const E=!(t instanceof HTMLImageElement||a.isImageBitmap(t));s.data.replace(x,E),this.style.updateImage(h,s)}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,t){a.getImage(this._requestManager.transformRequest(h,a.ResourceType.Image),t)}listImages(){return this.style.listImages()}addLayer(h,t){return this._lazyInitEmptyStyle(),this.style.addLayer(h,t),this._update(!0)}moveLayer(h,t){return this.style.moveLayer(h,t),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,t,s){return this.style.setLayerZoomRange(h,t,s),this._update(!0)}setFilter(h,t,s={}){return this.style.setFilter(h,t,s),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,t,s,u={}){return this.style.setPaintProperty(h,t,s,u),this._update(!0)}getPaintProperty(h,t){return this.style.getPaintProperty(h,t)}setLayoutProperty(h,t,s,u={}){return this.style.setLayoutProperty(h,t,s,u),this._update(!0)}getLayoutProperty(h,t){return this.style.getLayoutProperty(h,t)}setLight(h,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(h,t){return this.style.setFeatureState(h,t),this._update()}removeFeatureState(h,t){return this.style.removeFeatureState(h,t),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let h=0,t=0;return this._container&&(h=this._container.clientWidth||400,t=this._container.clientHeight||300),[h,t]}_setupContainer(){const h=this._container;h.classList.add("maplibregl-map","mapboxgl-map");const t=this._canvasContainer=M.create("div","maplibregl-canvas-container mapboxgl-canvas-container",h);this._interactive&&t.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=M.create("canvas","maplibregl-canvas mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const s=this._containerDimensions();this._resizeCanvas(s[0],s[1],this.getPixelRatio());const u=this._controlContainer=M.create("div","maplibregl-control-container mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(g=>{p[g]=M.create("div",`maplibregl-ctrl-${g} mapboxgl-ctrl-${g}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const h=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=M.create("div","maplibregl-cooperative-gesture-screen",h);let t="Control",s=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(s=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map",t="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${s}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",u=>{u.key===t&&(this._metaPress=!0)}),document.addEventListener("keyup",u=>{u.key===t&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",u=>{this._onCooperativeGesture(u,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(h,t,s){this._canvas.width=s*h,this._canvas.height=s*t,this._canvas.style.width=`${h}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const h=a.extend({},k.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);t?(this.painter=new Jl(t,this.transform),a.exported$1.testSupport(t)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(h,t,s){return!t&&s<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_render(h){let t,s=0;const u=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(t=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,t),s=a.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(h),this._removed)return;let p=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const x=this.transform.zoom,E=a.exported.now();this.style.zoomHistory.update(x,E);const S=new a.EvaluationParameters(x,{now:E,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),A=S.crossFadingFactor();A===1&&A===this._crossFadingFactor||(p=!0,this._crossFadingFactor=A),this.style.update(S)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.load),this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||p)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const x=a.exported.now()-s;u.endQueryEXT(u.TIME_ELAPSED_EXT,t),setTimeout(()=>{const E=u.getQueryObjectEXT(t,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(t),this.fire(new a.Event("gpu-timing-frame",{cpuTime:x,gpuTime:E}))},50)}if(this.listens("gpu-timing-layer")){const x=this.painter.collectGpuTimers();setTimeout(()=>{const E=this.painter.queryGpuTimers(x);this.fire(new a.Event("gpu-timing-layer",{layerTimes:E}))},50)}const g=this._sourcesDirty||this._styleDirty||this._placementDirty;return g||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),M.remove(this._canvasContainer),M.remove(this._controlContainer),this._cooperativeGestures&&M.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),a.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.exported.frame(h=>{a.PerformanceUtils.frame(h),this._frame=null,this._render(h)}))}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}_setCacheLimits(h,t){a.setCacheLimits(h,t)}get version(){return"2.4.0"}},NavigationControl:class{constructor(h){this.options=a.extend({},Rd,h),this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),M.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),M.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=M.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map.getZoom(),t=h===this._map.getMaxZoom(),s=h===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=s,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",s.toString())}_rotateCompassArrow(){const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=h}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new kr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){M.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(h,t){const s=M.create("button",h,this._container);return s.type="button",s.addEventListener("click",t),s}_setButtonTitle(h,t){const s=this._map._getUIString(`NavigationControl.${t}`);h.title=s,h.setAttribute("aria-label",s)}},GeolocateControl:class extends a.Evented{constructor(h){super(),this.options=a.extend({},ac,h),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(h){var t;return this._map=h,this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),t=this._setupUI,is!==void 0?t(is):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(s=>{is=s.state!=="denied",t(is)}):(is=!!window.navigator.geolocation,t(is)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),M.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Tn=0,ns=!1}_isOutOfMapMaxBounds(h){const t=this._map.getMaxBounds(),s=h.coords;return t&&(s.longitude<t.getWest()||s.longitude>t.getEast()||s.latitude<t.getSouth()||s.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",h)),this._finish()}}_updateCamera(h){const t=new a.LngLat(h.coords.longitude,h.coords.latitude),s=h.coords.accuracy,u=this._map.getBearing(),p=a.extend({bearing:u},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(s),p,{geolocateSource:!0})}_updateMarker(h){if(h){const t=new a.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map._container.clientHeight/2,t=this._map.unproject([0,h]),s=this._map.unproject([1,h]),u=t.distanceTo(s),p=Math.ceil(2*this._accuracy/u);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&ns)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=M.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),M.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=M.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new eo(this._dotElement),this._circleElement=M.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new eo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Tn--,ns=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Tn++,Tn>1?(h={maximumAge:6e5,timeout:0},ns=!0):(h=this.options.positionOptions,ns=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Wo,LogoControl:Wa,ScaleControl:class{constructor(h){this.options=a.extend({},Pr,h),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){qu(this._map,this._container,this.options)}onAdd(h){return this._map=h,this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){M.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(h){this.options.unit=h,qu(this._map,this._container,this.options)}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof HTMLElement?this._container=h.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=M.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){M.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=M.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);M.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.title=h}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(h){this.options=h,a.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(h){return this._map=h,this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=M.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),M.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){M.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends a.Evented{constructor(h){super(),this.options=a.extend(Object.create(Xi),h),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&M.remove(this._content),this._container&&(M.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=a.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(document.createTextNode(h))}setHTML(h){const t=document.createDocumentFragment(),s=document.createElement("body");let u;for(s.innerHTML=h;u=s.firstChild,u;)t.appendChild(u);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=M.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(h){this._container&&this._container.classList.add(h)}removeClassName(h){this._container&&this._container.classList.remove(h)}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){if(this._container)return this._container.classList.toggle(h)}_createCloseButton(){this.options.closeButton&&(this._closeButton=M.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(h){this._update(h.point)}_onMouseMove(h){this._update(h.point)}_onDrag(h){this._update(h.point)}_update(h){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=M.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=M.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(g=>this._container.classList.add(g)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Zo(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!h))return;const t=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat);let s=this.options.anchor;const u=lc(this.options.offset);if(!s){const g=this._container.offsetWidth,x=this._container.offsetHeight;let E;E=t.y+u.bottom.y<x?["top"]:t.y>this._map.transform.height-x?["bottom"]:[],t.x<g/2?E.push("left"):t.x>this._map.transform.width-g/2&&E.push("right"),s=E.length===0?"bottom":E.join("-")}const p=t.add(u[s]).round();M.setTransform(this._container,`${Tt[s]} translate(${p.x}px,${p.y}px)`),Mt(this._container,s,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(rn);h&&h.focus()}_onClose(){this.remove()}},Marker:eo,Style:Cn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,AJAXError:a.AJAXError,config:a.config,CanvasSource:In,GeoJSONSource:St,ImageSource:Oi,RasterDEMTileSource:We,RasterTileSource:ai,VectorTileSource:Rt,VideoSource:Ni,prewarm:function(){be().acquire(Ft)},clearPrewarmedResources:function(){const h=ie;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(Ft),ie=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return ri.workerCount},set workerCount(h){ri.workerCount=h},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){a.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){a.clearTileCache(h)},workerUrl:"",addProtocol(h,t){a.config.REGISTERED_PROTOCOLS[h]=t},removeProtocol(h){delete a.config.REGISTERED_PROTOCOLS[h]}};return cr.extend(ws,{isSafari:a.isSafari,getPerformanceMetrics:a.PerformanceUtils.getPerformanceMetrics}),ws});var w=y;return w})})(_l);const Xx=Symbol("MapLibreGLMap"),ZA=Symbol("MapLibreGLMarker"),HA=n=>n.addControl(new _l.exports.FullscreenControl({container:document.querySelector("body")})).addControl(new _l.exports.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0})).addControl(new _l.exports.ScaleControl({unit:"imperial"})),XA={class:"maplibre-map"},KA={class:"flex gap-4 justify-end items-center my-2"},JA=["onClick"],YA=Dt({__name:"Map",props:{center:{type:null,required:!0},zoom:{type:Number,required:!0},apiKey:{type:String,required:!0},esriSourceUrl:{type:String,required:!1}},emits:["click","load"],setup(n,{emit:o}){const c=n,f=Ci(null),y=Ci(null),v={satellite:{label:"Satellite",name:"ArcGIS:Imagery",type:"style"},streets:{label:"Street",name:"ArcGIS:Navigation",type:"style"}},w=Ci("satellite"),a=F=>{const B="https://basemaps-api.arcgis.com/arcgis/rest/services/styles",{name:M,type:le,url:Ee}=v[F];return Ee||`${B}/${M}?type=${le}&token=${c.apiKey}`},k=F=>{w.value=F};function $(){!y.value||y.value.setStyle(a(w.value))}return lr(w,$),Al(()=>{if(!f.value)throw Error("Cannot create Map: container not defined:");y.value=HA(new _l.exports.Map({container:f.value,center:c.center?[c.center.lng,c.center.lat]:[0,0],style:a(w.value),zoom:c.zoom})),y.value.on("click",F=>{if(!y.value)throw new Error("there was a click but no map");o("click",F,y.value)}),y.value.on("load",()=>{if(!y.value)throw new Error("cannot emit load event: no mapRef");o("load",y.value)}),Wx(f,()=>{!y.value||y.value.resize()})}),ml(Xx,y),(F,B)=>(ve(),$e("div",XA,[_t("div",KA,[(ve(),$e(ui,null,bn(v,(M,le)=>_t("button",{key:le,class:ar(["text-sm uppercase",{"font-bold border-b-2 border-b-neutral-900":le===w.value,"text-neutral-500":le!==w.value}]),onClick:Ee=>k(le)},ii(M.label),11,JA)),64))]),_t("div",{ref_key:"mapContainerRef",ref:f,class:"map-container"},null,512),Ui(F.$slots,"default",{},void 0,!0)]))}});const Kx=zt(YA,[["__scopeId","data-v-8b4ea7f5"],["__file","/opt/elevator/assets/elevator-ui/src/components/Map/Map.vue"]]),QA={class:"map-marker"},eC=Dt({__name:"MapMarker",props:{lng:{type:Number,required:!0},lat:{type:Number,required:!0},color:{type:String,required:!1,default:"#f43f5e"},draggable:{type:Boolean,required:!1,default:!1}},emits:["drag"],setup(n,{emit:o}){const c=n,f=Jr(Xx),y=Ci(null);return lr([f,()=>c],()=>{const v=Ve(f);if(!v){console.log("Cannot add marker yet. No map.");return}const w=Ve(y);w&&w.remove(),y.value=new _l.exports.Marker({color:c.color,draggable:c.draggable}).setLngLat([c.lng,c.lat]).addTo(v).on("dragend",()=>{var k;const a=(k=y.value)==null?void 0:k.getLngLat();!a||o("drag",{lng:a.lng,lat:a.lat})})},{immediate:!0}),ml(ZA,y),(v,w)=>(ve(),$e("div",QA,[Ui(v.$slots,"default")]))}}),Jx=zt(eC,[["__file","/opt/elevator/assets/elevator-ui/src/components/MapMarker/MapMarker.vue"]]),tC=Dt({__name:"Button",props:{icon:{type:String,required:!1,default:void 0},iconPosition:{type:String,required:!1,default:"end"},label:{type:String,required:!1,default:void 0},href:{type:String,required:!1,default:void 0},variant:{type:String,required:!1,default:"secondary"}},setup(n){return(o,c)=>(ve(),hi(Sa(n.href?"a":"button"),ru({href:n.href,title:n.label,class:["inline-flex items-center gap-1 no-underline hover:no-underline rounded justify-center leading-none transition-colors ease-in-out group",{"bg-neutral-900 border-2 border-neutral-900 text-white hover:bg-blue-600 hover:border-blue-600 p-2 ":n.variant==="primary"," border-neutral-900 text-neutral-900 hover:text-blue-600 hover:border-blue-600 p-2 border-2 ":n.variant==="secondary","font-medium text-gray-700 text-sm hover:bg-blue-100 focus:bg-blue-100 hover:text-blue-800 focus:text-blue-800 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 px-2 bg-transparent-black-50":n.variant==="tertiary","flex-row-reverse":n.iconPosition==="start"}]},o.$attrs),{default:It(()=>[Ui(o.$slots,"default"),n.icon?(ve(),hi(Eo,{key:0,class:"text-gray-400 text-xl group-hover:text-blue-800 group-focus:text-blue-800","aria-hidden":"true",label:"label"},{default:It(()=>[_i(ii(n.icon),1)]),_:1})):bi("v-if",!0)]),_:3},16,["href","title","class"]))}}),wa=zt(tC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Button/Button.vue"]]),iC={class:"accordion overflow-hidden bg-neutral-50 w-full mt-2 rounded border"},nC=["label","icon"],rC={class:"flex-1 block text-left font-normal"},sC={class:"flex place-items-center"},oC={class:"material-symbols-outlined"},aC={key:0,class:"accordion__panel p-4 pt-6 flex flex-col gap-6 border-t"},lC=Dt({__name:"Accordion",props:{label:{type:String,required:!1,default:"-"}},emits:["toggle","open"],setup(n,{emit:o}){const c=Ci(!1);function f(){c.value=!c.value,o("toggle"),c.value&&o("open")}return(y,v)=>(ve(),$e("div",iC,[_t("button",{class:"accordion__header flex w-full justify-between items-center p-4 gap-2 bg-white border-none rounded-b-none",label:c.value?"close":"open",icon:c.value?"expand_less":"expand_more",onClick:f},[Ui(y.$slots,"label",{},()=>[_t("span",rC,ii(n.label),1)]),_t("div",sC,[Ui(y.$slots,"label-icon",{},()=>[_t("span",oC,ii(c.value?"expand_less":"expand_more"),1)])])],8,nC),c.value?(ve(),$e("div",aC,[Ui(y.$slots,"default")])):bi("v-if",!0)]))}}),hm=zt(lC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Accordion/Accordion.vue"]]),cC={key:0,class:"flex gap-6"},uC={key:1},hC={key:0,class:"my-4 flex gap-4 w-min"},dC=_i("Show Location"),pC={class:"my-4 flex gap-4 w-min"},fC=Dt({__name:"LocationItem",props:{locationContent:{type:null,required:!0},widget:{type:null,required:!0}},setup(n){const o=n,c=Ut(()=>{var F,B,M;return(M=(B=(F=o.locationContent.loc)==null?void 0:F.coordinates)==null?void 0:B[1])!=null?M:0}),f=Ut(()=>{var F,B,M;return(M=(B=(F=o.locationContent.loc)==null?void 0:F.coordinates)==null?void 0:B[0])!=null?M:0}),y=Ut(()=>f.value?f.value.toFixed(4):"-"),v=Ut(()=>c.value?c.value.toFixed(4):"-"),w=Ut(()=>({lng:f.value,lat:c.value})),a=Ut(()=>{var F;return(F=o.locationContent.locationLabel||o.locationContent.address)!=null?F:null}),k=Ut(()=>f.value!==0&&c.value!==0),$=Ci(!1);return(F,B)=>(ve(),$e(ui,null,[lt(hm,null,{label:It(()=>[Ve(a)?(ve(),$e("span",uC,ii(Ve(a)),1)):(ve(),$e("div",cC,[lt(fr,{label:"Latitude",class:"w-auto",variant:"inline"},{default:It(()=>[_i(ii(Ve(v)),1)]),_:1}),lt(fr,{label:"Longitude",class:"w-auto",variant:"inline"},{default:It(()=>[_i(ii(Ve(y)),1)]),_:1})]))]),default:It(()=>[Ve(a)?(ve(),$e("div",hC,[lt(fr,{label:"Latitude",class:"w-auto"},{default:It(()=>[_i(ii(Ve(v)),1)]),_:1}),lt(fr,{label:"Longitude",class:"w-auto"},{default:It(()=>[_i(ii(Ve(y)),1)]),_:1})])):bi("v-if",!0),Ve(k)?(ve(),hi(wa,{key:1,icon:"map",iconPosition:"start",onClick:B[0]||(B[0]=M=>$.value=!0)},{default:It(()=>[dC]),_:1})):bi("v-if",!0)]),_:1}),lt(dd,{isOpen:$.value,label:Ve(a),onClose:B[1]||(B[1]=M=>$.value=!1)},{default:It(()=>[lt(Kx,{center:Ve(w),zoom:10,mapStyle:"streets",apiKey:Ve(tn).arcgis.apiKey,class:"rounded bg-neutral-100 p-1"},{default:It(()=>[lt(Jx,{lng:Ve(w).lng,lat:Ve(w).lat},null,8,["lng","lat"])]),_:1},8,["center","apiKey"]),_t("div",pC,[lt(fr,{label:"Latitude",class:"w-auto"},{default:It(()=>[_i(ii(Ve(v)),1)]),_:1}),lt(fr,{label:"Longitude",class:"w-auto"},{default:It(()=>[_i(ii(Ve(y)),1)]),_:1})])]),_:1},8,["isOpen","label"])],64))}}),mC=zt(fC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/LocationWidget/LocationItem.vue"]]),gC=Dt({__name:"LocationWidget",props:{widget:{type:null,required:!0},contents:{type:Array,required:!0}},setup(n){return(o,c)=>(ve(),$e("ul",null,[(ve(!0),$e(ui,null,bn(n.contents,(f,y)=>(ve(),$e("li",{key:y},[lt(mC,{widget:n.widget,locationContent:f},null,8,["widget","locationContent"])]))),128))]))}}),_C=zt(gC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/LocationWidget/LocationWidget.vue"]]),yC={key:0,class:"thumbnail-image__icon absolute z-10 bg-transparent-white-500 rounded-full w-12 h-12 flex justify-center items-center backdrop-blur-sm top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 transition-opacity duration-300 opacity-0"},vC=["src","alt"],xC=Dt({__name:"ThumbnailImage",props:{src:{type:String,required:!0},alt:{type:String,required:!0},href:{type:String,required:!1,default:void 0},iconOnHover:{type:String,required:!1,default:void 0},isActive:{type:Boolean,required:!1,default:!1}},setup(n){return(o,c)=>(ve(),hi(Sa(n.href?"a":"div"),{href:n.href,class:ar(["thumbnail-image block rounded overflow-hidden hover:shadow-md w-24 aspect-square relative border border-transparent-black-200 shadow-sm",{"ring ring-offset-1 ring-blue-600":n.isActive}])},{default:It(()=>[n.iconOnHover?(ve(),$e("div",yC,[lt(Eo,{class:"text-neutral-900"},{default:It(()=>[_i(ii(n.iconOnHover),1)]),_:1})])):bi("v-if",!0),_t("img",{src:n.src,class:"thumbnail-image__img w-full h-full object-cover opacity-80 transition-all ease-in",alt:n.alt},null,8,vC),Ui(o.$slots,"default",{},void 0,!0)]),_:3},8,["href","class"]))}});const Yx=zt(xC,[["__scopeId","data-v-b63656e6"],["__file","/opt/elevator/assets/elevator-ui/src/components/ThumbnailImage/ThumbnailImage.vue"]]),bC={class:"upload-widget flex gap-2 flex-wrap"},wC=["onClick"],TC=Dt({__name:"UploadWidget",props:{widget:{type:null,required:!0},contents:{type:Array,required:!0}},setup(n){const o=Aa(),c=f=>o.activeFileObjectId===f;return(f,y)=>(ve(),$e("div",bC,[(ve(!0),$e(ui,null,bn(n.contents,(v,w)=>(ve(),$e("button",{key:w,onClick:a=>Ve(o).activeFileObjectId=v.fileId},[lt(Yx,{src:`${Ve(tn).baseUrl}/fileManager/tinyImageByFileId/${v.fileId}/true`,alt:v.fileDescription,isActive:c(v.fileId),iconOnHover:"arrow_forward"},null,8,["src","alt","isActive"])],8,wC))),128))]))}}),EC=zt(TC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/UploadWidget/UploadWidget.vue"]]),SC=Dt({__name:"Chip",props:{href:{type:String,required:!1,default:void 0}},setup(n){return(o,c)=>(ve(),hi(Sa(n.href?"a":"span"),{href:n.href,class:ar(["inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-transparent-black-100 hover:no-underline no-underline text-neutral-700",{"border border-blue-700  bg-blue-100 text-blue-700 cursor-pointer hover:bg-blue-700 hover:text-white transition-colors ease-in-out":n.href}])},{default:It(()=>[Ui(o.$slots,"default")]),_:3},8,["href","class"]))}}),IC=zt(SC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Chip/Chip.vue"]]),AC={class:"flex gap-2"},CC=Dt({__name:"TagWidget",props:{widget:{type:null,required:!0},contents:{type:Array,required:!0}},setup(n){return(o,c)=>(ve(),$e("ul",null,[(ve(!0),$e(ui,null,bn(n.contents,(f,y)=>(ve(),$e("li",{key:y},[_t("ul",AC,[(ve(!0),$e(ui,null,bn(f.tags,(v,w)=>(ve(),$e("li",{key:w},[lt(IC,{href:Ve(qx)(v,n.widget)},{default:It(()=>[_i(ii(v),1)]),_:2},1032,["href"])]))),128))])]))),128))]))}}),kC=zt(CC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/TagWidget/TagWidget.vue"]]);function pd(n){var o,c;return(c=(o=n==null?void 0:n.relatedAssetTitle)==null?void 0:o[0])!=null?c:"(No Title)"}const PC={class:"accordion-related-asset-widget-item"},MC={key:0,class:"flex gap-2 items-center w-full flex-1"},zC={class:"w-[2rem] h-[2rem] overflow-hidden rounded border"},DC=["src","alt"],RC=Dt({__name:"AccordionRelatedAssetWidgetItem",props:{assetId:{type:String,required:!0},assetCache:{type:null,required:!0}},setup(n){const o=n,c=Ut(()=>pd(o.assetCache));return(f,y)=>{var v;return ve(),$e("div",PC,[lt(hm,{label:Ve(c)},kw({default:It(()=>[lt(ou,{assetId:n.assetId},null,8,["assetId"]),Ui(f.$slots,"default")]),_:2},[(v=n.assetCache)!=null&&v.primaryHandler?{name:"label",fn:It(()=>{var w;return[(w=n.assetCache)!=null&&w.primaryHandler?(ve(),$e("div",MC,[_t("div",zC,[_t("img",{src:Ve(Vx)(n.assetCache.primaryHandler),alt:Ve(c),class:"object-cover w-full h-full"},null,8,DC)]),_t("h3",null,ii(Ve(c)),1)])):bi("v-if",!0)]}),key:"0"}:void 0]),1032,["label"])])}}}),LC=zt(RC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/RelatedAssetWidget/AccordionRelatedAssetWidgetItem.vue"]]);function fd(n){const o=Ci(null),c=Ci(null);return lr(n,async()=>{const{asset:f,template:y}=await El.getAssetWithTemplate(n.value);o.value=f,c.value=y},{immediate:!0}),{asset:o,template:c}}const OC={key:0,class:"collapsed-inline-related-asset-widget-item flex flex-col gap-8"},BC=Dt({__name:"CollapsedInlineRelatedAssetWidgetItem",props:{assetId:{type:String,required:!0},assetCache:{type:null,required:!0}},setup(n){const o=n,c=Ut(()=>pd(o.assetCache)),f=Ut(()=>o.assetId),{asset:y}=fd(f);return(v,w)=>Ve(y)?(ve(),$e("section",OC,[_t("h3",null,ii(Ve(c)),1),lt(ou,{assetId:n.assetId},null,8,["assetId"])])):bi("v-if",!0)}}),FC=zt(BC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/RelatedAssetWidget/CollapsedInlineRelatedAssetWidgetItem.vue"]]),$C={key:1},UC=_i("image"),NC=Dt({__name:"ThumbnailRelatedAssetWidgetItem",props:{assetId:{type:String,required:!0},assetCache:{type:null,required:!0}},setup(n){const o=n,c=Aa(),f=Ut(()=>pd(o.assetCache)),y=Ut(()=>c.activeObjectId===o.assetId);return(v,w)=>{const a=Av("RouterLink");return ve(),hi(a,{title:Ve(f),class:"inline-block mr-2 last:mr-0",to:`#${n.assetId}`},{default:It(()=>[n.assetCache.primaryHandler?(ve(),hi(Yx,{key:0,src:Ve(Vx)(n.assetCache.primaryHandler),alt:Ve(f),isActive:Ve(y),iconOnHover:"arrow_forward"},null,8,["src","alt","isActive"])):(ve(),$e("div",$C,[lt(Eo,null,{default:It(()=>[UC]),_:1}),_t("p",null,ii(Ve(f)),1)]))]),_:1},8,["title","to"])}}}),VC=zt(NC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/RelatedAssetWidget/ThumbnailRelatedAssetWidgetItem.vue"]]),jC=Dt({__name:"Link",props:{to:{type:String,required:!1},href:{type:String,required:!1}},setup(n){return(o,c)=>(ve(),hi(Sa(n.to?Ve(Qf):"a"),{to:n.to,href:n.href,class:"cursor-pointer"},{default:It(()=>[Ui(o.$slots,"default")]),_:3},8,["to","href"]))}}),Qx=zt(jC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Link/Link.vue"]]),qC={class:"linked-related-asset-widget-item"},GC=Dt({__name:"LinkedRelatedAssetWidgetItem",props:{assetId:{type:String,required:!0},assetCache:{type:null,required:!0}},setup(n){const o=n,c=Ut(()=>pd(o.assetCache)),f=Ut(()=>Sl(o.assetId));return(y,v)=>(ve(),$e("div",qC,[lt(Qx,{to:Ve(f)},{default:It(()=>[_i(ii(Ve(c)),1)]),_:1},8,["to"])]))}}),WC=zt(GC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/RelatedAssetWidget/LinkedRelatedAssetWidgetItem.vue"]]),ZC=_i("arrow_forward"),HC=Dt({__name:"ArrowButton",props:{to:{type:String,required:!1},href:{type:String,required:!1}},setup(n){const o=n,c=Ut(()=>o.to?Qf:o.href?"a":"button");return(f,y)=>(ve(),hi(Sa(Ve(c)),ru({class:"flex justify-center items-center bg-neutral-100 p-2 rounded-full hover:bg-neutral-900 hover:text-white gap-2 hover:no-underline text-neutral-900 cursor-pointer"},o),{default:It(()=>[Ui(f.$slots,"default"),lt(Eo,null,{default:It(()=>[ZC]),_:1})]),_:3},16))}}),dm=zt(HC,[["__file","/opt/elevator/assets/elevator-ui/src/components/ArrowButton/ArrowButton.vue"]]),XC={class:"related-asset-widget"},KC={class:"flex justify-end items-center gap-2"},JC=Dt({__name:"RelatedAssetWidget",props:{widget:{type:null,required:!0},contents:{type:Array,required:!0},asset:{type:null,required:!0}},setup(n){const o=n,c=Ut(()=>o.widget.fieldData.collapseNestedChildren?FC:o.widget.fieldData.thumbnailView?VC:o.widget.fieldData.nestData?LC:WC),f=Ut(()=>o.contents.filter(y=>!!y.targetAssetId));return(y,v)=>(ve(),$e("div",XC,[(ve(!0),$e(ui,null,bn(Ve(f),w=>{var a,k;return ve(),hi(Sa(Ve(c)),{key:w.targetAssetId,assetId:w.targetAssetId,assetCache:(a=n.asset.relatedAssetCache)==null?void 0:a[w.targetAssetId],label:(k=w.label)!=null?k:""},{default:It(()=>[_t("div",KC,[lt(dm,{to:`/asset/viewAsset/${w.targetAssetId}`},null,8,["to"])])]),_:2},1032,["assetId","assetCache","label"])}),128))]))}}),YC=zt(JC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/RelatedAssetWidget/RelatedAssetWidget.vue"]]),QC=Dt({__name:"Widget",props:{widget:{type:null,required:!0},asset:{type:null,required:!0}},setup(n){const o=n,c=Ut(()=>lm({asset:o.asset,widget:o.widget})),f={text:jI,select:HI,checkbox:YI,"text area":kA,date:DA,multiselect:$A,location:_C,upload:EC,"tag list":kC,"related asset":YC};function y(v){return f[v]||null}return(v,w)=>(ve(),hi(fr,{label:n.widget.label},{default:It(()=>[y(n.widget.type)?(ve(),hi(Sa(y(n.widget.type)),{key:0,widget:n.widget,contents:Ve(c),asset:n.asset},null,8,["widget","contents","asset"])):bi("v-if",!0)]),_:1},8,["label"]))}}),ek=zt(QC,[["__file","/opt/elevator/assets/elevator-ui/src/components/Widget/Widget.vue"]]),tk={key:0,class:"widget-list flex flex-col gap-8"},ik=Dt({__name:"WidgetList",props:{assetId:{type:String,required:!0}},setup(n){const o=n,c=Ut(()=>o.assetId),{asset:f,template:y}=fd(c),v=Ut(()=>DI({asset:f.value,template:y.value}));return(w,a)=>(ve(),hi(Zf,{name:"fade"},{default:It(()=>[Ve(f)&&Ve(y)?(ve(),$e("div",tk,[(ve(!0),$e(ui,null,bn(Ve(v),k=>(ve(),hi(ek,{key:k.widgetId,widget:k,asset:Ve(f)},null,8,["widget","asset"]))),128))])):bi("v-if",!0)]),_:1}))}});const ou=zt(ik,[["__scopeId","data-v-2dd18f03"],["__file","/opt/elevator/assets/elevator-ui/src/components/WidgetList/WidgetList.vue"]]),nk={class:"h-full bg-neutral-300 sm:p-8"},rk={class:"m-auto sm:max-w-3xl bg-white h-full overflow-auto p-4 sm:p-12 rounded shadow sm:px-8"},sk={class:"text-3xl mb-12 sm:text-5xl font-bold py-8 after:content-[''] after:w-8 after:bg-neutral-900 after:h-2 after:block relative after:absolute after:bottom-0 after:left-0"},ok=Dt({__name:"MetaDataOnlyView",props:{assetId:{type:[String,null],required:!0}},setup(n){const o=n,c=Ut(()=>o.assetId),{asset:f}=fd(c),y=Ut(()=>f.value?jx(f.value):"Unknown");return(v,w)=>(ve(),$e("div",nk,[_t("article",rk,[_t("h2",sk,ii(Ve(y)),1),n.assetId?(ve(),hi(ou,{key:0,assetId:n.assetId},null,8,["assetId"])):bi("v-if",!0)])]))}});const ak=zt(ok,[["__scopeId","data-v-cce2583b"],["__file","/opt/elevator/assets/elevator-ui/src/pages/MetaDataOnlyView.vue"]]),lk={class:"object-viewer bg-neutral-300"},ck=_t("h2",{class:"sr-only"},"Object Viewer",-1),uk=["src"],hk={key:1,class:"w-full h-full min-h-[20rem] bg-neutral-400 place-items-center p-8"},dk=_t("p",null,"No asset file found.",-1),pk={class:"text-sm"},fk=Dt({__name:"ObjectViewer",props:{fileHandlerId:{type:[String,null],required:!0}},setup(n){return(o,c)=>{var f;return ve(),$e("section",lk,[ck,n.fileHandlerId?(ve(),$e("iframe",{key:0,class:"object-viewer__iframe w-full h-full min-h-[20rem]",src:`${Ve(tn).baseUrl}/asset/getEmbed/${n.fileHandlerId}`,frameBorder:"0",allowfullscreen:"true"},null,8,uk)):(ve(),$e("div",hk,[dk,_t("code",pk,"FileHandlerId: "+ii((f=n.fileHandlerId)!=null?f:"null"),1)]))])}}}),mk=zt(fk,[["__file","/opt/elevator/assets/elevator-ui/src/components/ObjectViewer/ObjectViewer.vue"]]),gk=["title"],_k=["innerHTML"],yk=Dt({__name:"DrawerLabel",props:{label:{type:String,required:!0},variant:{type:String,required:!0},isOpen:{type:Boolean,required:!0}},setup(n){return(o,c)=>(ve(),$e("h1",{class:ar(["header-label font-bold relative text-left",{"sm:text-3xl md:text-4xl":n.variant==="primary"&&n.isOpen,"sm:text-2xl md:text-3xl":n.label.length>=100&&n.label.length<200&&n.isOpen,"sm:text-xl md:text-xl":n.label.length>=200&&n.isOpen}]),title:n.label},[_t("span",{class:"min-w-0 block",innerHTML:n.label},null,8,_k)],10,gk))}}),vk=zt(yk,[["__file","/opt/elevator/assets/elevator-ui/src/components/Drawer/DrawerLabel.vue"]]),xk={class:"drawer bg-neutral-100 flex flex-col"},bk=["disabled"],wk={key:0,class:"material-symbols-outlined"},Tk=Dt({__name:"Drawer",props:{label:{type:String,required:!0},variant:{type:String,required:!1,default:"primary"},isOpen:{type:Boolean,required:!1,default:!0},showToggle:{type:Boolean,required:!1,default:!0}},emits:["toggle"],setup(n){return(o,c)=>(ve(),$e("section",xk,[_t("header",{class:ar(["flex items-center sticky top-0 left-0 justify-between z-10",{"bg-neutral-50":n.variant==="primary","bg-neutral-900 text-neutral-200":n.variant==="secondary","h-full":!n.isOpen,"md:py-4":n.variant==="primary"&&n.isOpen}])},[_t("button",{disabled:!n.showToggle,class:"flex items-center p-4 leading-tight gap-4 flex-1",onClick:c[0]||(c[0]=f=>o.$emit("toggle"))},[n.showToggle?(ve(),$e("span",wk,ii(n.isOpen?"expand_more":"expand_less"),1)):bi("v-if",!0),Ui(o.$slots,"header-label",{},()=>[lt(vk,{label:n.label,variant:n.variant,isOpen:n.isOpen},null,8,["label","variant","isOpen"])],!0)],8,bk),_t("div",null,[Ui(o.$slots,"header-utils",{},void 0,!0)])],2),Cw(_t("div",{class:ar(["text-neutral-500 flex flex-col gap-8 px-4 py-8 md:p-8 flex-1 h-min overflow-auto",{"bg-neutral-200":n.variant==="secondary"}])},[Ui(o.$slots,"default",{},void 0,!0)],2),[[K2,n.isOpen]])]))}});const e0=zt(Tk,[["__scopeId","data-v-196de012"],["__file","/opt/elevator/assets/elevator-ui/src/components/Drawer/Drawer.vue"]]),Ek={class:"p-2 flex items-center"},Sk=Dt({__name:"ActiveFileViewButton",setup(n){return(o,c)=>(ve(),$e("button",Ek,[lt(Eo,null,{default:It(()=>[Ui(o.$slots,"default")]),_:3})]))}}),pm=zt(Sk,[["__file","/opt/elevator/assets/elevator-ui/src/components/ActiveFileViewToolbar/ActiveFileViewButton.vue"]]),Ik={},Ak={class:"rounded-md max-w-sm w-full py-4"},Ck=u2('<div class="animate-pulse flex space-x-4"><div class="flex-1 space-y-6 py-1"><div class="h-4 bg-neutral-300 rounded w-1/2"></div><div class="h-2 bg-neutral-300 rounded"></div><div class="space-y-3"><div class="grid grid-cols-3 gap-4"><div class="h-2 bg-neutral-300 rounded col-span-2"></div><div class="h-2 bg-neutral-300 rounded col-span-1"></div></div><div class="h-2 bg-neutral-50 rounded"></div></div></div></div>',1),kk=[Ck];function Pk(n,o){return ve(),$e("div",Ak,kk)}const Mk=zt(Ik,[["render",Pk],["__file","/opt/elevator/assets/elevator-ui/src/components/Skeleton/Skeleton.vue"]]),zk=_i(" info "),Dk={key:0},Rk={key:1},Lk={key:0},Ok={key:1,class:"flex flex-col gap-6"},Bk={class:"bg-neutral-200 p-4 rounded-xl"},Fk={key:2},$k=_t("h2",{class:"text-xl font-bold mt-6 border-t pt-6"},"EXIF Details",-1),Uk=Dt({__name:"MoreFileInfoButton",setup(n){const o=Ci(!1),c=Ci(void 0),f=Ut(()=>c.value!==void 0),y=Aa();async function v(){o.value=!o.value,c.value=void 0,c.value=await El.getFileMetaData(y.activeFileObjectId)}return(w,a)=>(ve(),hi(pm,{onClick:v},{default:It(()=>[zk,lt(dd,{label:"File Info",isOpen:o.value,class:"max-w-4xl m-auto",onClose:a[0]||(a[0]=k=>o.value=!1)},{default:It(()=>{var k;return[Ve(f)?bi("v-if",!0):(ve(),$e("div",Dk,[(ve(),$e(ui,null,bn(10,$=>lt(Mk,{key:$})),64))])),Ve(f)?(ve(),$e("div",Rk,[c.value?bi("v-if",!0):(ve(),$e("span",Lk,"No meta data found.")),c.value?(ve(),$e("section",Ok,[lt(fr,{label:"File Type"},{default:It(()=>[_i(ii(c.value.exif.File.FileType),1)]),_:1}),lt(fr,{label:"Original Name"},{default:It(()=>[_i(ii(c.value.sourcefile),1)]),_:1}),lt(fr,{label:"File Size"},{default:It(()=>[_i(ii(c.value.exif.File.FileSize),1)]),_:1}),lt(fr,{label:"Image Size"},{default:It(()=>[_i(ii(c.value.width)+"x"+ii(c.value.height),1)]),_:1}),c.value.coordinates?(ve(),hi(fr,{key:0,label:"Location"},{default:It(()=>[_t("div",Bk,[lt(Kx,{center:{lng:c.value.coordinates[0],lat:c.value.coordinates[1]},zoom:10,mapStyle:"streets",apiKey:Ve(tn).arcgis.apiKey,class:""},{default:It(()=>[lt(Jx,{lng:c.value.coordinates[0],lat:c.value.coordinates[1]},null,8,["lng","lat"])]),_:1},8,["center","apiKey"])])]),_:1})):bi("v-if",!0)])):bi("v-if",!0),(k=c.value)!=null&&k.exif?(ve(),$e("section",Fk,[$k,(ve(!0),$e(ui,null,bn(c.value.exif,($,F)=>(ve(),hi(hm,{key:F,label:F,class:"border mt-6"},{default:It(()=>[(ve(!0),$e(ui,null,bn($,(B,M)=>(ve(),hi(fr,{key:M,label:M},{default:It(()=>[_i(ii(B),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["label"]))),128))])):bi("v-if",!0)])):bi("v-if",!0)]}),_:1},8,["isOpen"])]),_:1}))}}),Nk=zt(Uk,[["__file","/opt/elevator/assets/elevator-ui/src/components/ActiveFileViewToolbar/MoreFileInfoButton.vue"]]),Vk=_i(" download "),jk={key:0},qk={key:0},Gk={key:1},Wk={key:0},Zk=["href"],Hk=Dt({__name:"DownloadFileButton",setup(n){const o=Aa(),c=Ci(!1),f=Ci(void 0),y=Ut(()=>f.value!==void 0),v=a=>{const k=a.split(".");return k[k.length-1]};async function w(){c.value=!0,f.value=void 0,f.value=await El.getFileDownloadInfo(o.activeFileObjectId,o.activeAssetId)}return(a,k)=>(ve(),$e(ui,null,[lt(pm,{onClick:w},{default:It(()=>[Vk]),_:1}),lt(dd,{label:"File Downloads",isOpen:c.value,onClose:k[0]||(k[0]=$=>c.value=!1)},{default:It(()=>{var $;return[Ve(y)?(ve(),$e("div",jk,[f.value?bi("v-if",!0):(ve(),$e("span",qk,"No Downloads available")),f.value?(ve(),$e("ul",Gk,[($=f.value.screen)!=null&&$.ready?(ve(),$e("li",Wk,[_t("a",{href:`${Ve(tn).baseUrl}/fileManager/getDerivativeById/${Ve(o).activeFileObjectId}/screen`}," Download Derivative ("+ii(v(f.value.screen.originalFilename))+") ",9,Zk)])):bi("v-if",!0)])):bi("v-if",!0)])):bi("v-if",!0)]}),_:1},8,["isOpen"])],64))}}),Xk=zt(Hk,[["__file","/opt/elevator/assets/elevator-ui/src/components/ActiveFileViewToolbar/DownloadFileButton.vue"]]),Kk={class:"flex justify-between items-baseline"},Jk={for:"share-embed",class:"block text-sm font-medium text-gray-700"},Yk={class:"mt-1 flex rounded-md shadow-sm relative"},Qk=["placeholder","value"],eP=Dt({__name:"TextArea",props:{label:{type:String,required:!0},value:{type:String,required:!0},placeholder:{type:String,required:!1,default:""}},emits:["input"],setup(n){return(o,c)=>(ve(),$e("div",null,[_t("div",Kk,[Ui(o.$slots,"label",{},()=>[_t("label",Jk,ii(n.label),1)]),_t("div",null,[Ui(o.$slots,"corner")])]),_t("div",Yk,[_t("textarea",{id:"share-embed",name:"share-embed",class:"block w-full rounded border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 font-mono text-neutral-500 focus:text-neutral-900 h-24",placeholder:n.placeholder,value:n.value,onInput:c[0]||(c[0]=f=>o.$emit("input",f))},null,40,Qk)])]))}}),tP=zt(eP,[["__file","/opt/elevator/assets/elevator-ui/src/components/TextArea/TextArea.vue"]]),iP=Dt({__name:"CopyableTextArea",props:{label:{type:String,required:!0},value:{type:String,required:!0},placeholder:{type:String,required:!1,default:""}},setup(n){const c=Oc(n,"value"),{copy:f,copied:y}=uA({source:c,copiedDuring:3e3});return(v,w)=>(ve(),hi(tP,{label:n.label,value:n.value,placeholder:n.placeholder},{corner:It(()=>[lt(wa,{icon:Ve(y)?"check":"content_copy",variant:"tertiary",onClick:w[0]||(w[0]=a=>Ve(f)())},{default:It(()=>[bi(" eslint-disable-next-line vue/no-textarea-mustache"),_i(ii(Ve(y)?"Copied":"Copy"),1)]),_:1},8,["icon"])]),_:1},8,["label","value","placeholder"]))}}),Iy=zt(iP,[["__file","/opt/elevator/assets/elevator-ui/src/components/CopyableTextArea/CopyableTextArea.vue"]]),nP=_i("share"),rP={class:"flex flex-col gap-4"},sP=_i("Open Viewer in New Window"),oP=Dt({__name:"ShareButton",setup(n){const o=Aa(),c=w=>w.replace(/\s+/g," ").trim(),f=Ci(!1),y=Ut(()=>`${tn.baseUrl}/asset/getEmbed/${o.activeFileObjectId}/null/true`),v=Ut(()=>c(`
  <iframe width="560" height="480" src="${y.value}" frameborder="0" allowfullscreen></iframe>`));return(w,a)=>(ve(),$e(ui,null,[lt(pm,{onClick:a[0]||(a[0]=k=>f.value=!f.value)},{default:It(()=>[nP]),_:1}),lt(dd,{label:"Share",isOpen:f.value,class:"max-w-xl mx-auto",onClose:a[1]||(a[1]=k=>f.value=!1)},{default:It(()=>[_t("div",rP,[lt(Iy,{label:"Embed",value:Ve(v)},null,8,["value"]),lt(Iy,{label:"Link",value:Ve(y)},null,8,["value"]),lt(wa,{icon:"open_in_new",label:"Open in New Window",href:Ve(y),target:"_blank"},{default:It(()=>[sP]),_:1},8,["href"])])]),_:1},8,["isOpen"])],64))}}),aP=zt(oP,[["__file","/opt/elevator/assets/elevator-ui/src/components/ActiveFileViewToolbar/ShareButton.vue"]]),lP={class:"object-toolbar"},cP={class:"flex justify-between items-center w-full px-4 py-2"},uP={class:"flex gap-1 items-center leading-none"},hP=Dt({__name:"ActiveFileViewToolbar",setup(n){return(o,c)=>(ve(),$e("div",lP,[_t("div",cP,[_t("div",uP,[lt(Nk),lt(Xk),lt(aP)])])]))}}),Ay=zt(hP,[["__file","/opt/elevator/assets/elevator-ui/src/components/ActiveFileViewToolbar/ActiveFileViewToolbar.vue"]]),dP={class:"object-details"},pP={key:0,class:"bg-neutral-900 text-neutral-300 h-full flex justify-end"},fP={key:1,class:"flex gap-2"},mP=_i(" Old View "),gP=_i(" JSON "),_P=Dt({__name:"ObjectDetailsDrawer",props:{objectId:{type:[String,null],required:!0},isOpen:{type:Boolean,required:!0,default:!1},showToggle:{type:Boolean,required:!1,default:!0}},emits:["toggle"],setup(n){const o=n,c=Ut(()=>o.objectId?Sl(o.objectId):null);return(f,y)=>(ve(),$e("div",dP,[n.objectId?(ve(),hi(e0,{key:1,label:"Details",variant:"secondary",isOpen:n.isOpen,showToggle:n.showToggle,class:"h-full",onToggle:y[0]||(y[0]=v=>f.$emit("toggle"))},{"header-utils":It(()=>[lt(Ay)]),default:It(()=>[n.objectId?(ve(),hi(ou,{key:0,assetId:n.objectId},null,8,["assetId"])):bi("v-if",!0),n.objectId?(ve(),$e("footer",fP,[Ve(c)?(ve(),hi(dm,{key:0,to:Ve(c)},null,8,["to"])):bi("v-if",!0),lt(wa,{href:`${Ve(tn).baseUrl}/${Ve(c)}`,icon:"image",target:"_blank",variant:"tertiary"},{default:It(()=>[mP]),_:1},8,["href"]),lt(wa,{href:`${Ve(tn).baseUrl}/${Ve(c)}/true`,label:"Asset Json",icon:"data_object",target:"_blank",variant:"tertiary"},{default:It(()=>[gP]),_:1},8,["href"])])):bi("v-if",!0)]),_:1},8,["isOpen","showToggle"])):(ve(),$e("div",pP,[lt(Ay)]))]))}}),yP=zt(_P,[["__file","/opt/elevator/assets/elevator-ui/src/components/ObjectDetailsDrawer/ObjectDetailsDrawer.vue"]]),vP={class:"border shadow-sm rounded-md overflow-hidden flex flex-col"},xP={class:"placeholder-image bg-neutral-300 w-full aspect-video flex justify-center items-center overflow-hidden"},bP=["src","alt"],wP={class:"p-4 bg-white flex-1"},TP=Dt({__name:"MediaCard",props:{imgSrc:{type:[String,null],required:!1},imgAlt:{type:[String,null],required:!1},fallbackThumbnailIcon:{type:String,required:!1}},setup(n){return(o,c)=>(ve(),$e("article",vP,[_t("div",xP,[n.imgSrc?(ve(),$e("img",{key:0,src:n.imgSrc,alt:n.imgAlt||"Untitled",class:"w-full h-full object-cover"},null,8,bP)):(ve(),hi(Eo,{key:1},{default:It(()=>[_i(ii(n.fallbackThumbnailIcon||"image"),1)]),_:1}))]),_t("div",wP,[Ui(o.$slots,"default")])]))}}),EP=zt(TP,[["__file","/opt/elevator/assets/elevator-ui/src/components/MediaCard/MediaCard.vue"]]),SP={class:"h-full pb-16 relative"},IP={class:"font-bold text-xl mb-2 text-neutral-900"},AP={key:0,class:"grid gap-3"},CP={class:"text-xs text-neutral-400 uppercase col-span-1 flex items-start justify-start hyphens"},kP={class:"text-sm col-span-2"},PP=Dt({__name:"SearchResultCard",props:{searchMatch:{type:null,required:!0}},setup(n){const o=n,c=Ut(()=>Array.isArray(o.searchMatch.title)?o.searchMatch.title.join(","):o.searchMatch.title&&o.searchMatch.title.length>0?o.searchMatch.title:"(no title)"),f=Ut(()=>{const{primaryHandlerId:y}=o.searchMatch;return y?PI(y):null});return(y,v)=>(ve(),hi(EP,{imgSrc:Ve(f),imgAlt:Ve(c),class:"hover:shadow-lg transition-shadow"},{default:It(()=>{var w;return[_t("div",SP,[lt(Qx,{to:Ve(Sl)(n.searchMatch.objectId)},{default:It(()=>[_t("h1",IP,ii(Ve(c)),1)]),_:1},8,["to"]),(w=o.searchMatch)!=null&&w.entries?(ve(),$e("dl",AP,[(ve(!0),$e(ui,null,bn(o.searchMatch.entries,(a,k)=>{var $;return ve(),$e("div",{key:k},[_t("dt",CP,ii((a==null?void 0:a.label)||"Item"),1),_t("dd",kP,ii(($=a.entries)==null?void 0:$.join(", ")),1)])}),128))])):bi("v-if",!0),lt(dm,{to:Ve(Sl)(n.searchMatch.objectId),class:"absolute bottom-0 right-0"},null,8,["to"])])]}),_:1},8,["imgSrc","imgAlt"]))}});const MP=zt(PP,[["__scopeId","data-v-c7907e1c"],["__file","/opt/elevator/assets/elevator-ui/src/components/SearchResultCard/SearchResultCard.vue"]]),zP={key:0,class:"border-t border-neutral-900 mt-6 pt-6"},DP={class:"font-bold text-xl text-neutral-900 flex items-center gap-2 flex-wrap mb-4"},RP=_i(" More Like This "),LP={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-normal bg-neutral-900 text-neutral-100"},OP=Dt({__name:"MoreLikeThis",props:{items:{type:Array,required:!0}},setup(n){return(o,c)=>n.items.length?(ve(),$e("div",zP,[_t("h3",DP,[RP,_t("span",LP,ii(n.items.length),1)]),(ve(!0),$e(ui,null,bn(n.items,f=>(ve(),hi(MP,{key:f.objectId,searchMatch:f},null,8,["searchMatch"]))),128))])):bi("v-if",!0)}}),BP=zt(OP,[["__file","/opt/elevator/assets/elevator-ui/src/components/MoreLikeThis/MoreLikeThis.vue"]]);function t0(n){const o=Ci([]);return lr(n,async()=>{o.value=await El.getMoreLikeThis(n.value)},{immediate:!0}),{matches:o}}const FP={class:"asset-details"},$P={key:1,class:"flex gap-2"},UP=_i(" Old View "),NP=_i(" JSON "),VP=Dt({__name:"AssetDetailsDrawer",props:{assetId:{type:[String,null],required:!0},isOpen:{type:Boolean,required:!1,default:!0},showToggle:{type:Boolean,required:!1,default:!0}},emits:["toggle"],setup(n){const o=n,c=Ut(()=>o.assetId),{asset:f}=fd(c),{matches:y}=t0(c),v=Ut(()=>f.value?jx(f.value):"");return(w,a)=>(ve(),$e("div",FP,[lt(e0,{label:Ve(v),isOpen:n.isOpen,showToggle:n.showToggle,class:"h-full",onToggle:a[0]||(a[0]=k=>w.$emit("toggle"))},{default:It(()=>[n.assetId?(ve(),hi(ou,{key:0,assetId:n.assetId},null,8,["assetId"])):bi("v-if",!0),lt(BP,{items:Ve(y)},null,8,["items"]),n.assetId?(ve(),$e("footer",$P,[lt(wa,{href:`${Ve(tn).baseUrl}/${Ve(Sl)(n.assetId)}`,icon:"image",target:"_blank",variant:"tertiary"},{default:It(()=>[UP]),_:1},8,["href"]),lt(wa,{href:`${Ve(tn).baseUrl}/${Ve(Sl)(n.assetId)}/true`,label:"Asset Json",icon:"data_object",target:"_blank",variant:"tertiary"},{default:It(()=>[NP]),_:1},8,["href"])])):bi("v-if",!0)]),_:1},8,["label","isOpen","showToggle"])]))}}),jP=zt(VP,[["__file","/opt/elevator/assets/elevator-ui/src/components/AssetDetailsDrawer/AssetDetailsDrawer.vue"]]),qP={class:"h-full relative"},GP=Dt({__name:"AssetView",props:{assetId:{type:[String,null],required:!0},objectId:{type:[String,null],required:!1}},setup(n){const o=n,c=Ci(!0),f=Ci(!1),y=Aa(),v=Ut(()=>o.assetId),{matches:w}=t0(v),a=cA("(min-width: 768px)");return(k,$)=>(ve(),$e("div",qP,[lt(mk,{class:ar(["h-[75vh] md:h-auto md:absolute md:top-0",{"md:top-0 md:bottom-1/2 md:left-sm md:right-0":c.value&&f.value,"md:top-0 md:bottom-16 md:left-sm md:right-0":c.value&&!f.value,"md:top-0 md:bottom-16 md:left-0 md:right-sm":!c.value&&f.value,"md:top-0 md:bottom-16 md:left-0 md:right-0":!c.value&&!f.value}]),fileHandlerId:Ve(y).activeFileObjectId},null,8,["class","fileHandlerId"]),lt(jP,{class:ar(["md:absolute md:overflow-y-scroll",{"md:bottom-0 md:left-0 md:top-0 md:w-sm":c.value,"md:bottom-0 md:left-0 md:h-16 md:right-sm":!c.value&&f.value,"md:bottom-0 md:left-0 md:h-16 md:w-1/2":!c.value&&!f.value}]),showToggle:Ve(a),assetId:Ve(y).activeAssetId,isOpen:Ve(a)?c.value:!0,onToggle:$[0]||($[0]=F=>c.value=!c.value)},null,8,["class","showToggle","assetId","isOpen"]),lt(yP,{class:ar(["md:absolute",{"md:bottom-0 md:right-0 md:h-16 md:left-sm":!f.value&&c.value,"md:bottom-0 md:right-0 md:h-1/2 md:left-sm":f.value&&c.value,"md:bottom-0 md:right-0 md:top-0 md:w-sm":f.value&&!c.value,"md:bottom-0 md:right-0 md:h-16 md:w-1/2":!f.value&&!c.value}]),showToggle:Ve(a),moreLikeThisItems:Ve(w),objectId:Ve(y).activeObjectId,isOpen:Ve(a)?f.value:!0,onToggle:$[1]||($[1]=F=>f.value=!f.value)},null,8,["class","showToggle","moreLikeThisItems","objectId","isOpen"])]))}}),WP=zt(GP,[["__file","/opt/elevator/assets/elevator-ui/src/pages/AssetView.vue"]]),ZP={src:"https://dev.elevator.umn.edu/assets/instanceAssets/7.png",alt:"Elevator DCL Logo"},HP=[{name:"Home",href:"https://dev.elevator.umn.edu"},{name:"About",href:"https://dev.elevator.umn.edu/dcl/page/view/1"},{name:"Collections",children:["Recent Collections",{name:"Weisman Art Museum",href:"https://dcl.elevator.umn.edu/search/s/f6200137-aee5-4a78-bf88-4c6f3689e06a"},{name:"American Studies, Dept. of",href:"https://dcl.elevator.umn.edu/search/s/5a3c5350-0e02-466f-8efb-3cd0b03bdc67"},null,{name:"All Collections",href:"https://dcl.elevator.umn.edu/search/listCollections"}]}],XP=["label","icon"],KP={class:"flex-1 block text-left font-normal"},JP={class:"flex place-items-center"},YP={class:"material-symbols-outlined"},QP={key:0,class:"relative z-10"},eM=Dt({__name:"MenuAccordion",props:{label:{type:String,required:!1,default:"-"}},emits:["toggle","open"],setup(n,{emit:o}){const c=Ci(!1);function f(){c.value=!c.value,o("toggle"),c.value&&o("open")}return(y,v)=>(ve(),$e("div",null,[_t("button",{class:"flex justify-between items-center gap-2 border-none rounded-b-none text-link-b",label:c.value?"close":"open",icon:c.value?"expand_less":"expand_more",onClick:f},[Ui(y.$slots,"label",{},()=>[_t("span",KP,ii(n.label),1)]),_t("div",JP,[Ui(y.$slots,"label-icon",{},()=>[_t("span",YP,ii(c.value?"expand_less":"expand_more"),1)])])],8,XP),c.value?(ve(),$e("div",QP,[Ui(y.$slots,"default")])):bi("v-if",!0)]))}}),tM=zt(eM,[["__file","/opt/elevator/assets/elevator-ui/src/components/AppHeader/MenuAccordion.vue"]]),iM={class:"absolute flex flex-col gap-2 w-48 bg-neutral-50 p-4 shadow rounded top-full mt-2 right-0"},nM=["href"],rM=["href"],sM=Dt({__name:"LoginMenu",setup(n){return(o,c)=>(ve(),hi(tM,{label:"Login"},{default:It(()=>[_t("ul",iM,[_t("li",null,[_t("a",{href:`${Ve(tn).baseUrl}/loginManager/remoteLogin/?redirect=${o.$route.fullPath}`},"University Login",8,nM)]),_t("li",null,[_t("a",{href:`${Ve(tn).baseUrl}/loginManager/localLogin/?redirect=${o.$route.fullPath}`}," Guest Login ",8,rM)])])]),_:1}))}}),oM=zt(sM,[["__file","/opt/elevator/assets/elevator-ui/src/components/AppHeader/LoginMenu.vue"]]),aM={class:"bg-umn-gold-light flex justify-between items-center p-4"},lM={class:"flex items-center gap-4"},cM=["href"],uM=_t("h1",{class:"h-12"},[_t("img",{src:"https://dev.elevator.umn.edu/assets/instanceAssets/7.png",alt:"Elevator Digital Content Library logo",class:"max-h-full"})],-1),hM=[uM],dM={class:"flex items-center gap-4"},pM=Dt({__name:"AppHeader",props:{logoImg:{type:null,required:!1,default:()=>ZP},menuItems:{type:Array,required:!1,default:()=>HP}},setup(n){return(o,c)=>(ve(),$e("header",aM,[_t("div",lM,[_t("a",{href:Ve(tn).baseUrl},hM,8,cM)]),_t("div",dM,[lt(oM)])]))}}),fM=zt(pM,[["__file","/opt/elevator/assets/elevator-ui/src/components/AppHeader/AppHeader.vue"]]),mM={class:"h-screen flex flex-col"},gM={class:"flex-1"},_M=Dt({__name:"DefaultLayout",props:{logoImg:{type:null,required:!1},menuItems:{type:Array,required:!1}},setup(n){return(o,c)=>(ve(),$e("div",mM,[lt(fM,{logoImg:n.logoImg,menuItems:n.menuItems,class:""},null,8,["logoImg","menuItems"]),_t("div",gM,[Ui(o.$slots,"default")])]))}}),i0=zt(_M,[["__file","/opt/elevator/assets/elevator-ui/src/layouts/DefaultLayout.vue"]]),yM=Dt({__name:"AssetViewPage",props:{assetId:{type:String,required:!0},objectId:{type:[String,null],required:!1,default:null}},setup(n){const o=n,c=Aa(),f=Ut(()=>!c.activeFileObjectId),y=Ci(!1),v=lS(),w=Ut(()=>{var a;return((a=v.hash)==null?void 0:a.substring(1))||o.objectId||null});return lr([()=>o.assetId,()=>{var a;return(a=v.params)==null?void 0:a.assetId}],async()=>{console.log("asset change",{props:o,routeparams:v.params}),y.value=!1,await c.setActiveAsset(o.assetId,w.value),y.value=!0},{immediate:!0}),lr([()=>o.objectId,()=>v.hash],async()=>{await c.setActiveObject(w.value)}),(a,k)=>y.value?(ve(),hi(i0,{key:0},{default:It(()=>[Ve(f)?(ve(),hi(ak,{key:0,assetId:Ve(c).activeAssetId},null,8,["assetId"])):(ve(),hi(WP,{key:1,assetId:Ve(c).activeAssetId,objectId:Ve(c).activeObjectId},null,8,["assetId","objectId"]))]),_:1})):bi("v-if",!0)}}),vM=zt(yM,[["__file","/opt/elevator/assets/elevator-ui/src/pages/AssetViewPage.vue"]]),xM=_t("h1",null,"Not Found",-1),bM=Dt({__name:"NotFoundPage",props:{route:{type:null,required:!0}},setup(n){return(o,c)=>(ve(),hi(i0,null,{default:It(()=>[xM,_t("pre",null,"      "+ii(n.route)+`
    `,1)]),_:1}))}}),wM=zt(bM,[["__file","/opt/elevator/assets/elevator-ui/src/pages/NotFoundPage.vue"]]),TM=[{path:"/test",redirect:"asset/viewAsset/56a3bb007d58ae8a488b4657#632dfcc223e48b6a531c8832"},{path:"/asset/viewAsset/:assetId",component:()=>vM,props:n=>{var o;return{assetId:n.params.assetId,objectId:(o=n.hash)==null?void 0:o.substring(1)}}},{path:"/:pathMatch(.*)",component:wM,props:n=>({route:n})}];const EM=Q2(oT),SM=MT(),IM=oS({history:oE(tn.baseUrl),routes:TM});EM.use(SM).use(IM).mount("#app");
//# sourceMappingURL=index.js.map
